<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="Content-Security-Policy" content="connect-src 'none';"><meta http-equiv="Content-Security-Policy" content="default-src 'unsafe-inline' data:;"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Joel谈软件</title><meta name="keywords" content="在线创作,图书,在线图书,资料,个人笔记,写书"><meta name="description" content="treelib 在线图书馆 致力于提供更好的创建文档,写作,发布和查找书籍的平台 .支持匿名投稿,创建任意级章节目录,打包为HTML,CHM离线格式等."><style type="text/css">*{margin:0;padding:0}html{min-width:1200px;color:#666;background:#fcfcfc}ul{list-style:none}a{text-decoration:none;color:#2fa4e7}.hidden{display:none}.show{display:block}.fl{float:left}.fr{float:right}.clear{clear:both}.gbg{background:#25c26b;color:#fff}.nbs{box-shadow:1px 2px 2px 1px #777}.btn{padding:8px 20px;border-radius:5px;border:none;font-size:20px;outline:0;display:inline-block;cursor:pointer}.btn-small{padding:5px 10px;font-size:15px}.btn:active{box-shadow:none}.btn-warning{background-color:#dd5600;background-image:-webkit-gradient(linear,0 0,0 100%,from(#ff6707),color-stop(60%,#dd5600),to(#c94e00));background-image:-webkit-linear-gradient(#ff6707,#dd5600 60%,#c94e00);background-image:-moz-linear-gradient(top,#ff6707,#dd5600 60%,#c94e00);background-image:linear-gradient(#ff6707,#dd5600 60%,#c94e00);background-repeat:no-repeat;border-bottom:1px solid #aa4200}.btn-disable{color:#999;background:#eee}.lib_table{width:96%;margin:20px auto}.lib_table tr{height:40px}.lib_table tr:nth-child(even){background:#f9f9f9}.lib_table th{text-align:left}.lib_table tr:hover{background:#eee}.word_break{word-break:break-all;word-wrap:break-word}.form_control{width:100%;min-height:40px;text-indent:10px;margin:10px 0}.form_control span{width:20%;display:inline-block;color:#25c26b}.form_control input[type=submit],.form_control input[type=text],.form_control select,.form_control textarea{width:70%;height:35px;display:inline-block;border:1px solid #25c26b;border-radius:5px;font-size:20px;outline:0}.form_control .code{width:30%!important}.form_control img{float:right;margin-right:10px}.form_control textarea{height:150px;vertical-align:top}.form_control button[type=submit],.form_control input[type=submit]{margin:10px 0;margin-left:40%}.form_control :focus{box-shadow:0 0 4px 0 #25c26b}.tab_container{width:100%;height:40px;line-height:40px;border-bottom:1px solid #ccc;color:#25c26b}.tab_selecte,.tab_selected{display:inline-block;width:110px;text-align:center;cursor:pointer}.tab_selected{border:1px solid #ccc;height:38px;position:relative;top:2px;background:#ebf4f0;border-radius:5px 5px 0 0;border-bottom:none}.tab_selecte a{width:110px;height:40px;display:inline-block}.book-md,.book-md-background-img,.book-md-background-shade,.book_create_con{width:160px;height:210px}.book-md,.book_create_con{float:left;margin:10px 0}.book-md{border-radius:5px;box-shadow:5px 5px 6px #777,0 5px 6px #999;background:#fcfcfc;position:relative;cursor:pointer;overflow:hidden}.book-md:active{left:-1px;top:-1px;box-shadow:4px 4px 5px #555}.book-md-background-img,.book-md-background-shade{position:absolute;top:0;left:0}.book-md-background-img{z-index:4}.book-md-background-shade{border-radius:5px;height:290px;top:130px;text-align:center;text-break:all;color:#fff;word-wrap:break-word;background:rgba(80,80,80,.6);filter:Alpha(opacity=60);z-index:6}.book-md-background-shade h2,.book-md-background-shade p,.book-md-background-shade span{overflow:hidden;position:relative}.book-md-background-shade h2{font-size:16px;font-weight:700;margin:7px 0 0 0;height:34px;color:#fdfdfd}.book-md-background-shade p{margin:0;font-size:13px}.book-md-background-shade p span{color:red}.book-md-content-line{height:20px}.book-md-avatar{width:80px;height:80px;border-radius:80px;border:1px solid #fff;box-shadow:0 0 3px #000}.book-md-in-shadow{height:210px;z-index:5;left:10px;position:absolute;width:4px;box-shadow:1px 0 1px #666 inset,1px 0 1px #eee;border-top:none;border-bottom:none}.book-md-background-shade h2 a{color:#fff!important}.page{width:100%;text-align:center}.pagination{display:inline-block;padding-left:0;margin:20px 0;border-radius:4px}.pagination>li{display:inline}.pagination>li>a,.pagination>li>span{position:relative;float:left;padding:8px 12px;margin-left:-1px;line-height:1.428571429;text-decoration:none;background-color:#fff;border:1px solid #ddd}.pagination>li:first-child>a,.pagination>li:first-child>span{margin-left:0;border-bottom-left-radius:4px;border-top-left-radius:4px}.pagination>li:last-child>a,.pagination>li:last-child>span{border-top-right-radius:4px;border-bottom-right-radius:4px}.pagination>li>a:focus,.pagination>li>a:hover,.pagination>li>span:focus,.pagination>li>span:hover{background-color:#eee}.pagination>.active>a,.pagination>.active>a:focus,.pagination>.active>a:hover,.pagination>.active>span,.pagination>.active>span:focus,.pagination>.active>span:hover{z-index:2;color:#999;cursor:default;background-color:#f5f5f5}.pagination>.disabled>a,.pagination>.disabled>a:focus,.pagination>.disabled>a:hover,.pagination>.disabled>span,.pagination>.disabled>span:focus,.pagination>.disabled>span:hover{color:#999;cursor:not-allowed;background-color:#fff;border-color:#ddd}.nav{height:40px;width:100%;position:relative}.sl{border-left:1px solid #ddd}.sr{border-right:1px solid #888}.menu{padding:0 10px;line-height:40px;color:#fff;font-size:1.25em}.logo{font-size:1.45em}.nav_ucenter_dropdown_menu{position:absolute;right:5px;top:45px;border-radius:5px;z-index:99999}.nav_ucenter_dropdown_menu a{padding:0 25px;line-height:35px;color:#fff;display:block}.nav_ucenter_dropdown_menu li:hover{background:#ebf4f0}.nav_ucenter_dropdown_menu li:hover a{text-shadow:0 1px 1px #25c26b;color:#25c26b}.nav_ucenter_triangle{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid #fff;position:relative;top:15px;left:5px}.index_search{width:640px;margin:70px auto}.index_search p{color:#25c26b}.index_search input[type=text]{margin-top:20px;border:2px solid #25c26b;height:45px;line-height:1.5em;font-size:1.5em;width:500px;border-radius:5px;outline:0;text-indent:5px}.index_search input[type=text]:focus{box-shadow:0 0 4px 0 #25c26b}.index_search input[type=submit]{height:45px;line-height:45px;width:100px;border-radius:10px;font-size:1.5em;border:none;position:relative;top:2px;margin-left:20px;outline:0;box-shadow:1px 1px 1px 1px #999}.index_search input[type=submit]:active{box-shadow:none}.index_new{width:1020px;margin:0 auto;color:#25c26b}.index_new h3{margin:10px}.index_new .new_add_list{width:500px}.index_new .new_add_list .new_add{height:65px;margin-top:10px}.index_new .new_add_list p{max-height:12px;width:400px;margin-left:20px;margin-top:8px}.new_add_avatar{width:60px;height:60px;border-radius:60px;border:2px solid #25c26b}.new_add_book{width:45px;height:60px;border:2px solid #25c26b}.warter_bg{width:100%;border:none;display:block}.search_page_container{width:80%;margin:20px auto}.search_page_container .index_search{margin:20px auto}.search_form_bottom{margin:10px auto}.search_form_bottom label{margin:0 5px}.search_form_bottom select{line-height:25px;height:25px;border:1px solid #ccc}.search_page_container .search_result_status{font-size:14px;color:#c09853;margin-bottom:10px}.search_page_container .search_result_error{color:red}.search_result-list dd{margin-bottom:10px}.search_result-list em{color:#c00;font-weight:700}.category_content{margin:25px 0;min-width:1200px}.left_menu_restore{width:30px;height:35px;background:#25c26b;position:absolute;box-shadow:0 1px 1px 1px #777}.left_menu_restore div{width:25px;height:20px;background:#ebf4f0;border:1px solid #666;margin-top:10px;margin-left:1px;cursor:pointer}.left_menu_container{margin-top:30px;box-shadow:0 2px 1px 1px #777;height:540px;width:270px;min-width:200px;background:#25c26b;position:relative;float:left}.left_menu_selecte_list{position:absolute;top:-30px}.left_menu_selecte,.left_menu_selected{cursor:pointer;margin-right:1px;display:inline-block;color:#fff;width:80px;line-height:30px;text-align:center;border-radius:8px 8px 0 0;background-color:#25c26b}.left_menu_selected{height:30px;box-shadow:1px -1px 1px 0 #333}.left_menu_selecte{height:29px;border-bottom:1px solid #ccc}.left_menu_control input{height:30px;width:180px;background:#ebf4f0;border-radius:5px;padding:0 10px;margin:5px;border:1px solid #666;color:#25c26b;display:inline-block}.left_menu_minimum{width:30px;height:8px;background:#ebf4f0;border:1px solid #666;display:inline-block;margin:16px 15px 16px 0;cursor:pointer}.left_menu_data_list{height:473px;width:255px;min-width:185px;background:#ebf4f0;border:1px solid #666;color:#25c26b;overflow:auto;padding:20px 0 0 10px;box-shadow:0 0 1px 1px #aaa inset}.left_menu_search_keyword_result li{font-size:13px;margin:10px 0;padding:0 10px;text-decoration:underline;cursor:pointer;width:90%;overflow:hidden;height:15px}.left_menu_search_keyword_result p{font-weight:700}.left_menu_search_keyword_result li:hover{text-decoration:none}.drag_bar{height:495px;width:3px;background:#25c26b;cursor:e-resize}.drag_long_bar,.drag_short_bar{width:1px;background:#25c26b;position:relative}.drag_short_bar{height:10px;left:-3px;top:7px}.drag_long_bar{height:25px;left:-3px;top:43%}.right_book{float:left;margin-left:20px;width:75%;min-width:850px}.books{margin-left:10px}.books table{width:100%}.right_top_filters_container{height:40px;border-bottom:2px solid #25c26b}.right_top_filter,.right_top_filter_selected{width:110px;height:30px;border-radius:5px;border:none;color:#fff;font-size:15px;box-shadow:0 1px 1px 1px #777;margin-top:4px;margin-left:15px;cursor:pointer}.right_top_filter_selected{background-color:#aaa}.right_top_filter{background-color:#25c26b}.num_count_span{background:#25c26b;color:#fff;padding:2px 5px;border-radius:10px;position:relative;top:-5px;left:5px}.collect,.give_praise{float:right;height:40px;width:110px;text-align:center;color:#25c26b;font-size:18px}.collect img,.give_praise img{position:relative;top:3px}.main_content,.offline_download{margin:30px 0;color:#25c26b}.offline_download_btn{background-color:#25c26b;color:#fff;border:1px solid #ccc;padding:5px 10px;border-radius:5px}.main_content{font-size:18px}#detail_page_content .top_page_panel{margin-top:15px;width:100%}#detail_page_content iframe{width:100%!important;height:auto;border:none!important;min-height:300px!important}.write_comment{margin-top:15px}.write_comment textarea{width:85%;height:100px;font-size:18px;outline:0;border:2px solid #25c26b;border-radius:10px}.write_comment input{width:80px;height:50px;border:none;float:right;margin-right:40px;font-size:24px;border-radius:10px;box-shadow:1px 1px 1px 1px #777;font-weight:700}.write_comment p{color:#999;margin-bottom:5px}.comment_user_container{width:100px;height:100px;text-align:center;color:#25c26b}.comment_avatar{width:60px;height:60px;border-radius:60px;border:2px solid #25c26b;display:inline-block}.comment_container{width:100%;border-bottom:1px solid #ddd;padding:15px 0}.comment_container .comment_container{width:87%;padding:15px 20px 0 0;border-bottom:none}.comment_right_container{border:2px solid #25c26b;min-height:90px;width:84%;border-radius:10px;margin-left:20px;background-color:#ebf4f0}.comment_right_top{padding:5px;border-bottom:1px solid #ddd;color:#aaa}.comment_right_top .fr a{margin:0 8px}.comment_detail_content{color:#333;padding:8px;word-break:break-all;word-wrap:break-word}.contribute_submit_container span{font-size:20px;color:#25c26b}.contribute_verify_code{width:100px;height:40px;font-size:18px;border:1px solid #25c26b;border-radius:5px}.contribute_position{width:400px;display:inline-block}.contribute_submit_container img{position:relative;top:13px;margin:0 30px}.contribute_submit{padding:7px 15px;border-radius:5px;border:none;font-size:20px}#book_history{padding:20px}#book_history p{font-size:18px;color:#25c26b;height:25px;line-height:25px;margin:5px 0}.site_messages_container{margin:40px auto;width:1200px}.site_messages_left{width:800px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAACCAYAAACg/LjIAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEQ5OTEwNThFNzZGMTFFNDg3QzNGMDQ0NDEzNzU1RTAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEQ5OTEwNTlFNzZGMTFFNDg3QzNGMDQ0NDEzNzU1RTAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4RDk5MTA1NkU3NkYxMUU0ODdDM0YwNDQ0MTM3NTVFMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4RDk5MTA1N0U3NkYxMUU0ODdDM0YwNDQ0MTM3NTVFMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoiM2UQAAABESURBVHja7NAxEYAwEETRHF7SBwMYip4YwgD0iDmCCQZm3qt+uxuZWf4sIlrd+/H0tY117jkLAADwSYsLAACAt9wCDACv8gsBdXrOIAAAAABJRU5ErkJggg==) repeat-y;float:left}.site_messages_left_bottom,.site_messages_left_top{width:100%;height:40px;border-radius:5px}.site_messages_left_top{font-size:22px;line-height:40px;text-indent:20px}.site_messages_left_top_triangle{position:relative;left:36px;top:-12px}.site_messages{width:95%;margin:35px auto}.site_message_avatar{width:53px;height:53px;border-radius:55px;border:2px solid #25c26b}.site_message_container{width:660px;min-height:80px;margin-left:25px;border:2px solid #25c26b;color:#25c26b;border-radius:5px;box-shadow:1px 1px 1px 1px #777;overflow:hidden;position:relative}.site_message{margin:20px 0;position:relative}.site_message_container p{padding:5px 10px}.site_message_info{background-color:#ebf4f0;border-bottom:1px solid #ccc}.site_message_left_triangle{width:0;height:0;border-top:7px solid transparent;border-bottom:7px solid transparent;border-right:10px solid #25c26b;position:absolute;left:73px;top:10px;z-index:5}.site_message_small .site_message_container{margin-right:14px}.site_message_small p{color:#ff7e7e}.site_message_top_triangle{width:0;height:0;border-left:7px solid transparent;border-right:7px solid transparent;border-bottom:10px solid #25c26b;position:absolute;left:130px;top:-10px;z-index:5}.site_messages_left_bottom{position:relative;padding:3px 0}.site_messages_left_bottom_triangle{position:absolute;top:-10px;left:36px}.site_messages_left_bottom .pagination{margin:0 auto;margin-left:160px}.site_messages_left_bottom .pagination a{background-color:#25c26b;color:#fff}.site_messages_left_bottom .pagination .active a{background-color:#ddd}.site_messages_left_line{float:left;width:2px;background-color:red;height:100%}.site_message_right{width:370px;height:380px;float:right;border:2px solid #25c26b;border-radius:5px}.site_message_right_top{height:40px;width:100%;line-height:40px;font-size:22px;text-indent:10px}.big_tree_bg_container{position:relative}.big_tree_bg{width:100%;border:none;display:block;opacity:0;-moz-opacity:0;min-height:500px}.big_tree_bg_mask{width:100%;height:100%;position:absolute;top:0;border:none;background:#fff;opacity:.25}.login_form_container,.register_form_container{width:100%;position:absolute;top:100px;margin:0 auto}.member_form_top{height:40px;line-height:40px;font-size:24px;width:550px;border-radius:15px 15px 0 0;text-indent:30px}.login_form,.register_form{width:550px;height:500px;background-color:#fff;border:4px solid #25c26b;border-radius:20px;margin:0 auto;color:#25c26b}.login_form{height:420px}.login_form p,.register_form p{width:450px;margin:30px auto;height:40px;line-height:40px;font-size:20px}.member_form_small_text,.member_form_text{height:40px;width:340px;line-height:40px;border:1px solid #25c26b;border-radius:5px;text-indent:5px;font-size:18px;outline:0}.member_form_small_text:focus,.member_form_text:focus{box-shadow:0 0 4px 0 #25c26b}.member_form_small_text{width:200px}.member_form_submit{width:200px;height:45px;border:none;border-radius:5px;margin-left:130px;font-size:22px;outline:0}.member_form_submit:active{box-shadow:none}.forgot_password{font-size:18px;position:relative;top:-5px;left:10px}.ucenter_container{width:1100px;margin:40px auto;min-height:300px;border-radius:15px;border:2px solid #25c26b}.ucenter_container_top{height:35px;line-height:35px;font-size:20px;text-indent:30px;border-radius:10px 10px 0 0}.ucenter_empty_notice{min-height:100px;line-height:100px;text-indent:100px}.ucenter_message{width:96%;margin:20px 20px;font-size:18px}.ucenter_message .gbg{padding:3px 7px;border-radius:5px;margin:5px 5px}.ucenter_tab_content_container{padding:20px}.ucenter_one_message_detail{position:relative;margin:10px auto}.ucenter_one_message_detail p{line-height:60px;height:60px;margin-left:80px;width:80%;display:inline-block}.ucenter_one_message_detail:hover{background-color:#ebf4f0}.ucenter_one_message_detail img{width:60px;height:60px;border-radius:60px;position:absolute;left:0}.ucenter_submission_content{font-size:18px;width:96%;margin:20px 2%}.ucenter_submission_bottom .gbg{margin-left:260px;margin-bottom:20px}.ucenter_submission_bottom{margin:30px;color:#25c26b;text-decoration:underline}.ucenter_submission_content iframe{width:100%!important;height:auto;border:none!important;min-height:600px!important}.ucenter_mybooks_contianer{width:96%;margin:2%}.book_create_con,.ucenter_mybooks_contianer .book-md{margin:20px}.create_new_book{position:relative;margin:25px auto;width:150px;height:150px;border-radius:150px;border:3px solid #1995dc;box-shadow:1px 1px 1px #000 inset,2px 2px 3px #000}.create_new_book a{-webkit-transition:-webkit-transform .3s ease-in-out;-moz-transition:-moz-transform .2s ease-in-out;-o-transition:-o-transform .2s ease-in-out;-ms-transition:-ms-transform .2s ease-in-out;transition:transform .2s ease-in-out;display:block;width:140px;height:140px;margin:6px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIwAAACMCAMAAACZHrEMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTFBQjVDRkNBM0E1MTFFNDlEOTVBQzM2M0Y1OEIxQjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTFBQjVDRkRBM0E1MTFFNDlEOTVBQzM2M0Y1OEIxQjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMUFCNUNGQUEzQTUxMUU0OUQ5NUFDMzYzRjU4QjFCMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMUFCNUNGQkEzQTUxMUU0OUQ5NUFDMzYzRjU4QjFCMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlOUaKIAAAA8UExURS+k5/39/Z+fn11dXf////7+/m9vb6mpqcDAwJiYmMHBwfr6+tbW1o2NjVNTU2RkZDw8PCMjIzs7O////2yRq+gAAAAUdFJOU/////////////////////////8AT0/nEQAAAQBJREFUeNrs3MtqwzAQBVA5key87LTJ//9rlhFlaBGkSJhzP2A4Cy0kLpr0HCgJBgYGZmRMLtPPlNwJk6Kcrl0wOcScL7kHpoSYeSk9MFOIOR4mGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBiYj2OCLuu33ELMtt6aptRtWYVJfVK1ZW9M7oSp2rI3pnTCVG1Z+uM8/n+qEw8DAwMDAwMDsx/MUDe9fDnPx5Zs4ezvr61pyhzegZ/X03JoyRpiHve1acoSvg7Gejd53sLAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7AYz1B//sC2bO20/CNuypdNeiLE2Znw8MDAwu8S8BBgAtWgfOvsY4qIAAAAASUVORK5CYII=)}.create_new_book:hover{box-shadow:1px 1px 1px #000 inset,3px 3px 5px 3px #666}.create_new_book:hover a{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-ms-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg);color:#2fa4e7}.create_new_book a:hover{text-decoration:none}.create_new_book:active{left:-2px;top:-2px;box-shadow:1px 1px 1px #333 inset,1px 1px 2px #000}.create_new_book_container{width:800px;margin:70px auto}.create_new_book_left{width:200px}.book_create_info{width:600px}.create_new_book_container .gbg{margin-left:70px}.child_cate{margin-left:138px}.help-block{margin-left:130px}.top_page_panel{border:1px solid #25c26b;width:95%;border-radius:5px;text-indent:20px;box-shadow:0 1px 1px 1px #777}.top_page_panel_heading{border-radius:5px 5px 0 0;line-height:35px;font-size:18px}.top_page_panel_body{line-height:30px;font-size:16px;padding:10px}.ucenter_top_page .btn{margin:20px 0}.book_index_tree_icon_root{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACZUlEQVR42oWTTUhUURTHf88ZP5px7DXpmI6lEKi1GjctKm36WoREz0UUEqiLoKAoFyK08aMiKGLGWmQQOdBGaGEKGdRCA2lRkNIimhHC6ZPUpjGdGD/mTeeNVs8vunDvuZd7/r9zzn3nKaw1zlAiqyZzn1pm0VybHYTeREeYoYZOxsyuiklUn7vD6isvdavjE1OUbHORmQ7l211YLRZicbh19fkYDgFMMyKgxmUASzsDl5uPesNjiwFisRgLicRfvt1up6CgAKfqpPPBM0Ivog0CCShL0Vsl1ZbaYxVEvk+sqihpzGQyNbNzcnAXFnOlud9vZKGI+GLpbtVXf6KS4Lsg8dl4SqCLc0JPitVT+9R5yVZXHqDF/5BoMNGgZF3jR3uTpr4aHmZufn6V85+9GZbjcHBk1x5u3O1DUX2W5KGqcqZiE/8E5si6vgym6wZQ53S1lsrCKKHr3KWq+uDHUabl4RLrRDVn47DZyM/YwtPuUMAA9HTcOand6+9b09mwRR8S7B+EvsPwNRcy0i00ace5cLZ70ABoRR5bj26Pk56tpAQ1vTpbY/DNBeENUDsDryPgl9aSish32ihMy2OoN9ymmDqvK9OD17YRiSyiJ1C3E35GIcsO1yfhsZwJycwiSoQO+Yyt5k70yMUAFlQ2QWka3P8FmXmS9qhcC+SL0VeL7fxodSsvQlRZjWzqyuJogWJKrE749BZuTtI2lEdg/X/BNG7vTYEGDp7CE5uF8TC8f0nj+SH8K32VNcReMT6nG4/qlveYg2np7sjn1HWFQEb+B/hThmHrrBl4F+akbjmLeHCl/28Ig0BcPhKKzAAAAABJRU5ErkJggg==)!important;background-size:auto!important;background-position:50% 50%!important}.ucenter_edit_profile{padding:20px}.upload_avatar{height:130px;xwidth:150px;display:block;margin:100px;margin-top:50px}.upload_avatar span{display:block;text-align:center;margin:5px auto}#edit_profile form{margin:30px 0;width:600px}#change_password{margin:60px auto;width:600px}.ucenter_tools{width:90%;margin:30px 5%}.book_tool_div{display:block;width:140px;text-align:center;margin:0 20px;float:left}.book_tool_div img{height:120px;border:1px solid #ccc;border-radius:120px}.book_tool_div span{margin:10px auto}.tmakedown_notice{padding:20px}.margin30{margin-bottom:30px;width:100%}.footer{border-top:1px solid #d8eee2}.footer h3{margin:10px 0}.footer_left,.footer_right{width:45%;margin-left:30px;height:140px}.join_qq{position:relative;top:5px}</style><meta property="wayback:source:url" content="http://www.treelib.com/book-detail-id-56-aid-3211.html"></head><body><div class="nav gbg nbs"><a class="logo menu fl sr" href="http://www.treelib.com/">在线图书馆</a> <a class="menu fl sl sr" href="http://www.treelib.com/">首页</a> <a class="menu fl sl sr" href="http://www.treelib.com/category-index.html">所有分类</a> <a class="menu fl sl" href="http://www.treelib.com/site-message.html">留言</a> <a class="no_login menu fr" href="http://www.treelib.com/user-register.html">注册</a> <a class="no_login menu fr" href="http://www.treelib.com/user-login.html">登录</a><ul class="nav_ucenter_dropdown_menu logined fr gbg nbs hidden"><li><a href="http://www.treelib.com/ucenter-message.html">最新动态</a></li><li><a href="http://www.treelib.com/ucenter-mybooks.html">我的书籍</a></li><li><a href="http://www.treelib.com/ucenter-myfav.html">我的收藏</a></li><li><a href="http://www.treelib.com/ucenter-profile.html">个人设置</a></li><li><a href="http://www.treelib.com/ucenter-tools.html">应用中心</a></li><li><a href="javascript:void(0);" data-url="/user-logout.html" class="logout">退出</a></li></ul><a class="logined menu fr nav_ucenter_dropdown_btn" href="javascript:void(0);">个人中心<span class="nav_ucenter_triangle"></span></a> <a class="logined menu fr nickname" href="javascript:void(0);"></a></div><div class="category_content"><div class="left_menu_restore hidden nbs" title="恢复"><div></div></div><div class="left_menu_container"><div class="left_menu_selecte_list"><p class="left_menu_selected">目录</p><p class="left_menu_selecte">搜索</p></div><div class="left_menu_list"><div class="left_menu_control"><div class="left_menu_minimum fr" title="最小化"></div></div><div class="left_menu_data_list left_menu_tree_data_list clear fl"><ul><li class="jstree-open" data-jstree="{&quot;type&quot;:&quot;root&quot;,&quot;pid&quot;:&quot;0&quot;}" id="3147"><a href="http://www.treelib.com/book-detail-id-56-aid-3147.html">Joel谈软件</a><ul><li id="3170"><a href="http://www.treelib.com/book-detail-id-56-aid-3170.html">系列文章</a><ul><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3148"><a href="http://www.treelib.com/book-detail-id-56-aid-3148.html">1 开发人员、市场及销售人员</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3149"><a href="http://www.treelib.com/book-detail-id-56-aid-3149.html">2 易用的界面，简单的一步</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3150"><a href="http://www.treelib.com/book-detail-id-56-aid-3150.html">3 主次分明</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3152"><a href="http://www.treelib.com/book-detail-id-56-aid-3152.html">5 第四战略篇：膨胀软件与80/20的谣传</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3151"><a href="http://www.treelib.com/book-detail-id-56-aid-3151.html">4 每日构建（daily build）是你的朋友</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3153"><a href="http://www.treelib.com/book-detail-id-56-aid-3153.html">6 行进中开火</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3154"><a href="http://www.treelib.com/book-detail-id-56-aid-3154.html">7 看起来简单， 实际上复杂</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3155"><a href="http://www.treelib.com/book-detail-id-56-aid-3155.html">8 给计算机系学生的建议</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3156"><a href="http://www.treelib.com/book-detail-id-56-aid-3156.html">9 轻松面试找到理想员工－非官方的面试技术指南</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3157"><a href="http://www.treelib.com/book-detail-id-56-aid-3157.html">10 The Joel Test: 软件开发成功 12 法则</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3158"><a href="http://www.treelib.com/book-detail-id-56-aid-3158.html">11 《微独立软件供应商：从理想到现实》序</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3159"><a href="http://www.treelib.com/book-detail-id-56-aid-3159.html">12 抽象渗漏法则</a></li></ul></li><li id="3160"><a href="http://www.treelib.com/book-detail-id-56-aid-3160.html">相关文章</a><ul><li id="3161"><a href="http://www.treelib.com/book-detail-id-56-aid-3161.html">2000年</a><ul><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3169"><a href="http://www.treelib.com/book-detail-id-56-aid-3169.html">两个故事 - Two Stories</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3171"><a href="http://www.treelib.com/book-detail-id-56-aid-3171.html">软件人员面试教战守则 - The Guerilla Guide to Interviewing</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3172"><a href="http://www.treelib.com/book-detail-id-56-aid-3172.html">无痛软件时程 - Painless Software Schedule</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3173"><a href="http://www.treelib.com/book-detail-id-56-aid-3173.html">激励有害 - Incentive Pay Considered Harmful</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3174"><a href="http://www.treelib.com/book-detail-id-56-aid-3174.html">你绝对不应该做的事 之一 - Things You Should Never Do, Part One</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3175"><a href="http://www.treelib.com/book-detail-id-56-aid-3175.html">程式师的使用介面设计手册 第一章：控制你的环境使你快乐</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3176"><a href="http://www.treelib.com/book-detail-id-56-aid-3176.html">程式师的使用介面设计手册 第二章：找出使用者的期望</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3177"><a href="http://www.treelib.com/book-detail-id-56-aid-3177.html">程式师的使用介面设计手册 第三章：选择</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3178"><a href="http://www.treelib.com/book-detail-id-56-aid-3178.html">程式师的使用介面设计手册 第四章：情境支持与隐喻</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3179"><a href="http://www.treelib.com/book-detail-id-56-aid-3179.html">程式师的使用介面设计手册 第五章：一致性及其他怪东西</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3180"><a href="http://www.treelib.com/book-detail-id-56-aid-3180.html">程式师的使用介面设计手册 第六章：为节省大家的麻烦所作的设计</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3181"><a href="http://www.treelib.com/book-detail-id-56-aid-3181.html">程式师的使用介面设计手册 第七章：为节省大家的麻烦所作的设计，第二部份</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3182"><a href="http://www.treelib.com/book-detail-id-56-aid-3182.html">不用测试人员的五大(错误)藉口</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3183"><a href="http://www.treelib.com/book-detail-id-56-aid-3183.html">程式师的使用介面设计手册 第八章：为节省大家的麻烦所作的设计，第三部份</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3184"><a href="http://www.treelib.com/book-detail-id-56-aid-3184.html">程式师的使用介面设计手册 第九章：一个产品的设计程序</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3185"><a href="http://www.treelib.com/book-detail-id-56-aid-3185.html">策略书之一： Ben and Jerry模式与Amazon模式</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3186"><a href="http://www.treelib.com/book-detail-id-56-aid-3186.html">策略书之二：鸡生蛋蛋生鸡问题</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3187"><a href="http://www.treelib.com/book-detail-id-56-aid-3187.html">读程式码就像读犹太法典 - Reading Code is Like Reading the Talmud</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3188"><a href="http://www.treelib.com/book-detail-id-56-aid-3188.html">策略书之三：让我换回去！ - Strategy Letter III: Let Me Go Back!</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3189"><a href="http://www.treelib.com/book-detail-id-56-aid-3189.html">微软疯了 - Microsoft Goes Bonkers</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3190"><a href="http://www.treelib.com/book-detail-id-56-aid-3190.html">匿名回应 - Anonymous Response</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3191"><a href="http://www.treelib.com/book-detail-id-56-aid-3191.html">约耳测试：迈向高品质的12个步骤 - The Joel Test: 12 Steps to Better Code</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3192"><a href="http://www.treelib.com/book-detail-id-56-aid-3192.html">资讯科学中三个错误的想法 - Three Wrong Ideas from Computer Science</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3193"><a href="http://www.treelib.com/book-detail-id-56-aid-3193.html">无痛功能规格 - 第一篇：何必麻烦呢？</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3261"><a href="http://www.treelib.com/book-detail-id-56-aid-3261.html">无痛功能规格 - 第二篇：规格是什么？</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3195"><a href="http://www.treelib.com/book-detail-id-56-aid-3195.html">无痛功能规格 - 第三篇：不过...要怎么做呢？</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3196"><a href="http://www.treelib.com/book-detail-id-56-aid-3196.html">无痛功能规格 - 第四篇：提示</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3197"><a href="http://www.treelib.com/book-detail-id-56-aid-3197.html">另一种似乎行不通的商业模式</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3198"><a href="http://www.treelib.com/book-detail-id-56-aid-3198.html">无痛错误追踪 - Painless Bug Tracking</a></li></ul></li><li id="3162"><a href="http://www.treelib.com/book-detail-id-56-aid-3162.html">2001年</a><ul><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3199"><a href="http://www.treelib.com/book-detail-id-56-aid-3199.html">大麦克对原味主厨 - Big Macs vs. The Naked Chef</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3200"><a href="http://www.treelib.com/book-detail-id-56-aid-3200.html">每日编译(Daily Build)是你的好朋友 - Daily Builds Are Your Friend</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3201"><a href="http://www.treelib.com/book-detail-id-56-aid-3201.html">人的工作切换有害无益 - Human Task Switches Considered Harmful</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3202"><a href="http://www.treelib.com/book-detail-id-56-aid-3202.html">策略书之四：肿胀软体(bloatware)与80/20神话</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3203"><a href="http://www.treelib.com/book-detail-id-56-aid-3203.html">别让架构太空人吓到你 - Don't Let Architecture Astronauts Scare You</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3260"><a href="http://www.treelib.com/book-detail-id-56-aid-3260.html">这个国家的狗做什么工作？ - What Is the Work of Dogs in this Country</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3204"><a href="http://www.treelib.com/book-detail-id-56-aid-3204.html">绝不妥协的抓虫行动 - Hard-Assed Bug Fixin'</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3205"><a href="http://www.treelib.com/book-detail-id-56-aid-3205.html">为非我发明症辩护 - In Defense of Not-Invented-Here Syndrome</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3206"><a href="http://www.treelib.com/book-detail-id-56-aid-3206.html">操练严格才好打仗 - A Hard Drill Makes an Easy Battle</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3207"><a href="http://www.treelib.com/book-detail-id-56-aid-3207.html">小员工也能做大事 - Getting Things Done When You're Only a Grunt</a></li></ul></li><li id="3163"><a href="http://www.treelib.com/book-detail-id-56-aid-3163.html">2002年</a><ul><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3209"><a href="http://www.treelib.com/book-detail-id-56-aid-3209.html">边开火边移动 - Fire and Motion</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3210"><a href="http://www.treelib.com/book-detail-id-56-aid-3210.html">揭露冰山般的秘密 - The Iceberg Secret, Revealed</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3211"><a href="http://www.treelib.com/book-detail-id-56-aid-3211.html">没有事情像表面看起来那么简单 - Nothing is as Simple as it Seems</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3212"><a href="http://www.treelib.com/book-detail-id-56-aid-3212.html">我们的.NET策略 - Our .NET Strategy</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3213"><a href="http://www.treelib.com/book-detail-id-56-aid-3213.html">五个世界 - Five Worlds</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3214"><a href="http://www.treelib.com/book-detail-id-56-aid-3214.html">策略书之五</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3215"><a href="http://www.treelib.com/book-detail-id-56-aid-3215.html">测量 - Measurement</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3216"><a href="http://www.treelib.com/book-detail-id-56-aid-3216.html">平台 - Platforms</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3217"><a href="http://www.treelib.com/book-detail-id-56-aid-3217.html">抽象渗漏法则 - The Law of Leaky Abstractions</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3218"><a href="http://www.treelib.com/book-detail-id-56-aid-3218.html">回归原点 - Back to Basics</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3219"><a href="http://www.treelib.com/book-detail-id-56-aid-3219.html">程式设计领域的帕麦尔斯顿勋爵 - Lord Palmerston on Programming</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3220"><a href="http://www.treelib.com/book-detail-id-56-aid-3220.html">墨菲定律发威的一周 - A Week of Murphy's Law Gone Wild</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3221"><a href="http://www.treelib.com/book-detail-id-56-aid-3221.html">约耳的程式师书柜 - Book Reviews</a></li></ul></li><li id="3164"><a href="http://www.treelib.com/book-detail-id-56-aid-3164.html">2003年</a><ul><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3222"><a href="http://www.treelib.com/book-detail-id-56-aid-3222.html">纸上原型制作 - Paper Prototyping</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3223"><a href="http://www.treelib.com/book-detail-id-56-aid-3223.html">Rick Chapman在寻找愚蠢 - Rick Chapman is In Search of Stupidity</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3224"><a href="http://www.treelib.com/book-detail-id-56-aid-3224.html">每个软体开发者都绝对一定要会的Unicode及字元集必备知识(没有藉口！)</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3225"><a href="http://www.treelib.com/book-detail-id-56-aid-3225.html">例外处理 - Exceptions</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3226"><a href="http://www.treelib.com/book-detail-id-56-aid-3226.html">工匠技艺 - Craftsmanship</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3227"><a href="http://www.treelib.com/book-detail-id-56-aid-3227.html">双元文化主义 - Biculturalism</a></li></ul></li><li id="3165"><a href="http://www.treelib.com/book-detail-id-56-aid-3165.html">2004年</a><ul><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3228"><a href="http://www.treelib.com/book-detail-id-56-aid-3228.html">让你的履历有可读性 - Getting Your Résumé Read</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3229"><a href="http://www.treelib.com/book-detail-id-56-aid-3229.html">先生可以赏我一个连结程式吗？ - Please Sir May I Have a Linker</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3230"><a href="http://www.treelib.com/book-detail-id-56-aid-3230.html">从代码工到开发者 - Coder To Developer</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3231"><a href="http://www.treelib.com/book-detail-id-56-aid-3231.html">微软如何输掉API战争 - How Microsoft Lost the API War</a></li></ul></li><li id="3166"><a href="http://www.treelib.com/book-detail-id-56-aid-3166.html">2005年</a><ul><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3232"><a href="http://www.treelib.com/book-detail-id-56-aid-3232.html">给资讯科系学生的建议 - Advice for Computer Science College Students</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3233"><a href="http://www.treelib.com/book-detail-id-56-aid-3233.html">让错的程式看得出错 - Making Wrong Code Look Wrong</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3234"><a href="http://www.treelib.com/book-detail-id-56-aid-3234.html">最佳软体文选I - 介绍 - Introduction to Best Software Writing I</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3235"><a href="http://www.treelib.com/book-detail-id-56-aid-3235.html">达到卓越 - Hitting the High Notes</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3236"><a href="http://www.treelib.com/book-detail-id-56-aid-3236.html">设定优先顺序 - Set Your Priorities</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3237"><a href="http://www.treelib.com/book-detail-id-56-aid-3237.html">Fog Creek软体管理训练课程</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3238"><a href="http://www.treelib.com/book-detail-id-56-aid-3238.html">Fog Creek 软体管理训练课程书单</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3239"><a href="http://www.treelib.com/book-detail-id-56-aid-3239.html">java学校的危害</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3240"><a href="http://www.treelib.com/book-detail-id-56-aid-3240.html">自我测试 - Test Yourself</a></li></ul></li><li id="3167"><a href="http://www.treelib.com/book-detail-id-56-aid-3167.html">2006年</a><ul><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3241"><a href="http://www.treelib.com/book-detail-id-56-aid-3241.html">介绍卓越设计 - Introduction to Great Design</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3242"><a href="http://www.treelib.com/book-detail-id-56-aid-3242.html">卓越设计：何谓设计？ - Great Design: What is Design?</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3243"><a href="http://www.treelib.com/book-detail-id-56-aid-3243.html">卓越设计：目录 - Great Design - Table of Contents</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3244"><a href="http://www.treelib.com/book-detail-id-56-aid-3244.html">卓越的关键是什么？ - What Makes It Great?</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3245"><a href="http://www.treelib.com/book-detail-id-56-aid-3245.html">开发抽象层</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3246"><a href="http://www.treelib.com/book-detail-id-56-aid-3246.html">FogBugz 4½与主观幸福感 - FogBugz 4½ and Subjective Well-Being</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3247"><a href="http://www.treelib.com/book-detail-id-56-aid-3247.html">我的第一次BillG审议 - My First BillG Review</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3248"><a href="http://www.treelib.com/book-detail-id-56-aid-3248.html">你的程式语言可以这样做吗？ - Can Your Programming Language Do This?</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3249"><a href="http://www.treelib.com/book-detail-id-56-aid-3249.html">三种管理的方法（序言） - Three Management Methods (Introduction)</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3250"><a href="http://www.treelib.com/book-detail-id-56-aid-3250.html">军事化管理方法 - The Command and Control Management Method</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3251"><a href="http://www.treelib.com/book-detail-id-56-aid-3251.html">语言战争 - Language Wars</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3252"><a href="http://www.treelib.com/book-detail-id-56-aid-3252.html">开发人员完全指南 - A Field Guide to Developers</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3253"><a href="http://www.treelib.com/book-detail-id-56-aid-3253.html">再探Ruby效能 - Ruby Performance Revisited</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3254"><a href="http://www.treelib.com/book-detail-id-56-aid-3254.html">“超越Java：探讨程式语言的未来”书评 - Book Review: Beyond Java</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3255"><a href="http://www.treelib.com/book-detail-id-56-aid-3255.html">软体人员面试教战守则(第三版)</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3256"><a href="http://www.treelib.com/book-detail-id-56-aid-3256.html">从"你叫这敏捷?"部门谈起</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3257"><a href="http://www.treelib.com/book-detail-id-56-aid-3257.html">在大型专案使用版本管理工具 - Using source control tools on huge projects</a></li></ul></li><li id="3168"><a href="http://www.treelib.com/book-detail-id-56-aid-3168.html">其它</a><ul><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3258"><a href="http://www.treelib.com/book-detail-id-56-aid-3258.html">卓越客户服务的七步骤 - Seven steps to remarkable customer service</a></li><li data-jstree="{&quot;type&quot;:&quot;file&quot;}" id="3259"><a href="http://www.treelib.com/book-detail-id-56-aid-3259.html">为什么微软 Office 的档案格式如此复杂？（以及一些解决方案）</a></li></ul></li></ul></li></ul></li></ul></div><div class="drag_bar fl"><div class="drag_long_bar"><div class="drag_short_bar"></div></div></div></div><div class="left_menu_search hidden"><div class="left_menu_control"><input type="text" class="left_menu_search_keyword" placeholder="输入关键字,回车搜索"><div class="left_menu_minimum fr" title="最小化"></div></div><div class="left_menu_data_list clear fl"><div class="left_menu_search_keyword_result"></div></div><div class="drag_bar fl"><div class="drag_long_bar"><div class="drag_short_bar"></div></div></div></div><div class="clear"></div></div><div class="right_book"><div class="tab_container child_tab_container"><p class="tab_selecte tab_selected" data-content-id="detail_page_content">内容详情</p><p class="tab_selecte" data-content-id="contribute">投稿</p><a class="collect" href="#" title="收藏"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAXCAMAAAAm/38fAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTQxREQ0MTdFNDMwMTFFNDk5MTQ5MTg2QkZEMzk0QUEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTQxREQ0MThFNDMwMTFFNDk5MTQ5MTg2QkZEMzk0QUEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBNDFERDQxNUU0MzAxMUU0OTkxNDkxODZCRkQzOTRBQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBNDFERDQxNkU0MzAxMUU0OTkxNDkxODZCRkQzOTRBQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pst0tHsAAACKUExURSXCa/z+/c/y3u/69IvesMfv2ZzjvK7oyCjDbZ/kvv3//vb8+VXPjF7SkuT47er58FHOiS7EcfT89y/FcrnrzzHFc9Hy4O3682/Xndr15pbiuLvs0SrDbkDJfa/pyZPhtr/t0+H366voxuL366rnxvn9+8zx3Pr+/M3x3b7t06/pyCfCbJXht////7H0+VoAAAAudFJOU////////////////////////////////////////////////////////////wCCj3NVAAAAq0lEQVR42mzRVxaDIBAF0AHsvXdjemf/24vKiYzK+wHmwqEBl2EMDQD1q0oNF4CTEjwATwUFjCkU0E/Q76GFOe0KHEbtXEBuU+bMUOpNBJtEjV5C0IEiXQC8VtQ/9bQH3QMVm7+29eP/VOa6bsp7DLj+RRe8Y3gieGM4INAwaAh8DD6CVEwVC1MJZBxahsu5a1hjlyyQQHy9idd+nGNIFggzIv+UZOHU/AQYAJJgNGh5hSSJAAAAAElFTkSuQmCC">0</a> <a class="give_praise" href="#" title="赞一个"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAZCAMAAAAc9R5vAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzU3ODM4M0NFNDMwMTFFNEE1QzhERDQyRENENDUyMTgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzU3ODM4M0RFNDMwMTFFNEE1QzhERDQyRENENDUyMTgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDNTc4MzgzQUU0MzAxMUU0QTVDOERENDJEQ0Q0NTIxOCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDNTc4MzgzQkU0MzAxMUU0QTVDOERENDJEQ0Q0NTIxOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PtrN1YAAAADSUExURSXCa/3//lvRkPr+/Ov58vz+/fL79vv+/CrDbmPTlWnVmdLy4LPqy+f47yjDba/pyd/26aLlwIXdrIjermTUlofers/y3oDcqfP894Lcqrrs0JPhtuT37PX8+FfQjUvNhXbZosHu1fb8+ZzjvK/pyJ3jvIPcqyzEcDbHd2fUmIrer13SkdPz4Y/gs4zfsc7x3tz15/f9+qzox7/t08fv2TjHeLHpyjPGdOX47lrRj83x3cjw2lTPi9/26n3bp0zNhvj9+i7EcbXqzTTGdUXLgf///14I7WoAAABGdFJOU////////////////////////////////////////////////////////////////////////////////////////////wBplkTQAAAAtUlEQVR42mzQVQ7DMBAE0HGwTZmZmZkZfP8rNU5bKYl3fmzNkyzvgntS6P5v8MIOWRIYkCShDCgU6DfAIoAFAWxlUA92v9ElaL7tHnH5u+IdTLkEe9EjJEPVAYyWxdMl74IS3Ok/2Q868CXlgFH393hhHhvWpBqBI86gEo0gQwLSCNOwwpjs1xwaCS0OlYSZPXmP6BNiJQoBbQGT7/3hHk8T0BgoVu5qcLaoiPWYqnln9vkRYAAl0EmQvwUh2wAAAABJRU5ErkJggg==">0</a></div><div><div id="detail_page_content"><iframe sandbox="" src="data:text/html; charset=utf-8;base64,PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJ6aC1jbiI+DQoJPGhlYWQ+DQoJICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4NCgkgICAgPG1ldGEgaHR0cC1lcXVpdj0iWC1VQS1Db21wYXRpYmxlIiBjb250ZW50PSJJRT1lZGdlIj4NCgkgICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xIj4NCgkJPHRpdGxlPjwvdGl0bGU+DQoJCTxzdHlsZT4NCgkJCS5jb250ZW50e3BhZGRpbmctdG9wOjVweCAhaW1wb3J0YW50O30NCgkJCS5jb250ZW50ICp7d29yZC1icmVhazpicmVhay1hbGwgIWltcG9ydGFudDsgd29yZC13cmFwOmJyZWFrLXdvcmQgIWltcG9ydGFudDt9DQoJCTwvc3R5bGU+DQoJCTxzY3JpcHQ+DQoJCQlsb2NhdGlvbi5ocmVmPScvYm9vay1kZXRhaWwtaWQtNTYtYWlkLTMyMTEuaHRtbCc7DQoJCTwvc2NyaXB0Pg0KCTwvaGVhZD4NCgk8Ym9keT4NCgkJPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCQk8aDI+PHNwYW4gY2xhc3M9Im13LWhlYWRsaW5lIiBpZD0iLkU2LkIyLjkyLkU2LjlDLjg5LkU0LkJBLjhCLkU2LjgzLjg1LkU1LjgzLjhGLkU4LkExLkE4LkU5LjlELkEyLkU3LjlDLjhCLkU4LkI1LkI3LkU0LkJFLjg2LkU5LjgyLkEzLkU5LkJBLkJDLkU3LkIwLkExLkU1Ljk2LkFFIj7msqHmnInkuovmg4Xlg4/ooajpnaLnnIvotbfmnaXpgqPkuYjnroDljZU8L3NwYW4+PC9oMj48cD7kvZzogIXvvJrlkajmgJ3ljZogKEpvZWwgU3BvbHNreSk8YnIvPuivke+8mlBhdWwgTWF5IOaiheaZruWNjjxici8+TW9uZGF5LCBNYXJjaCAwNCwgMjAwMjxici8+5bGe5LqOSm9lbCBvbiBTb2Z0d2FyZSwgPGEgaHJlZj0iaHR0cDovL3d3dy5qb2Vsb25zb2Z0d2FyZS5jb20vIiBjbGFzcz0iZXh0ZXJuYWwgZnJlZSIgcmVsPSJub2ZvbGxvdyI+aHR0cDovL3d3dy5qb2Vsb25zb2Z0d2FyZS5jb208L2E+PGJyLz48L3A+PHA+PGEgaHJlZj0iaHR0cDovL3d3dy5mb2djcmVlay5jb20vQ2l0eURlc2siIGNsYXNzPSJleHRlcm5hbCB0ZXh0IiByZWw9Im5vZm9sbG93Ij5DaXR5RGVzazwvYT7mnInkuKrlsI/lsI/nmoTkvb/nlKjmgKfpl67popjjgII8L3A+PHA+6Zeu6aKY5piv6L+Z5qC355qE77ya5L2g5Y+v5Lul55So6YCJ5Y2V55Sx572R6Lev5LiK5rGH5YWl5qGj5qGIKEltcG9ydCBXZWIgUGFnZSnvvIzkuZ/lj6/ku6XnlKjmu5HpvKDmi5bmi4nno4Hnop/ph4znmoTmoaPmoYjmsYflhaVDaXR5RGVza+OAguS4jei/h+ayoeaciemAieWNleWPr+S7peaxh+WFpeejgeein+S4reeahOaho+ahiO+8jOaJgOS7peWkp+WutuS4jeaYrzxhIGhyZWY9Imh0dHA6Ly9kaXNjdXNzLmZvZ2NyZWVrLmNvbS9jaXR5ZGVzay9kZWZhdWx0LmFzcD9jbWQ9c2hvdyZpeFBvc3Q9MjE4NyIgY2xhc3M9ImV4dGVybmFsIHRleHQiIHJlbD0ibm9mb2xsb3ciPuayoeacieWPkeeOsDwvYT7lj6/ku6Xov5nmoLflgZrvvIzlsLHmmK88YSBocmVmPSJodHRwOi8vZGlzY3Vzcy5mb2djcmVlay5jb20vY2l0eWRlc2svZGVmYXVsdC5hc3A/Y21kPXNob3cmaXhQb3N0PTMzMSIgY2xhc3M9ImV4dGVybmFsIHRleHQiIHJlbD0ibm9mb2xsb3ciPuWwneivlTwvYT7nlKhJbXBvcnQgV2ViIFBhZ2Xlip/og73msYflhaXno4Hnop/kuK3nmoTmoaPmoYjvvIzogIzlkI7ogIXlvZPnhLbkuZ/mmK/kuI3og73nlKjnmoTjgII8L3A+PHA+5oiR6K6k5Li655So5Lik6aG155qE57K+54G15Y+v5Lul6L275piT55qE6Kej5Yaz6L+Z5Liq6Zeu6aKY44CC5aSn5qaC55qE5pa55rOV5piv55So57K+54G155qE56ys5LiA6aG16Zeu4oCc5L2g6KaB55Sx5ZOq6YeM5rGH5YWl6LWE5paZ77yf4oCd77yM5aaC5p6c5L2g6YCJ4oCc56OB56Kf4oCd77yM56ys5LqM6aG15bCx5o+Q56S65L2g6L6T5YWl5qGj5ZCN77yb5aaC5p6c6YCJ5oup4oCcd2Vi4oCd77yM56ys5LqM6aG15bCx5o+Q56S66L6T5YWlVVJM6Lev5b6E44CCPC9wPjxwPuaIkeWHoOS5juimgeW8gOWni+WunuS9nO+8jOS4jei/h+i/mOaYr+WBnOS4i+adpeedgOaJi+WGmeS4gOS7vei/t+S9oOinhOagvOOAguS4i+mdouaYr+i/meS7veinhOagvOeahOWFqOaWh++8mjwvcD48YmxvY2txdW90ZT48c3Ryb25nPuesrOS4gOmhtTxici8+PC9zdHJvbmc+5L2g6KaB55Sx5ZOq6YeM5rGH5YWl6LWE5paZ77yfKOejgeeiny9XZWIpPGJyLz48YnIvPjxzdHJvbmc+56ys5LqM6aG1KOejgeeinyk8L3N0cm9uZz48YnIvPuagh+WHhueahOW8gOWQr+aho+ahiOWvueivneebkjxzdHJvbmc+56ys5LqM6aG1KFdlYik8YnIvPjwvc3Ryb25nPuaciei/t+S9oOe9kemhtea1j+iniOWZqOeahFVSTOi+k+WFpeeUu+mdojwvYmxvY2txdW90ZT48cD7nqoHnhLbpl7TmiJHmg7PliLDkuIDku7bkuovjgILmnInlip7ms5XmiorpgJrluLjnlLFPU+aPkOS+m+eahOW8gOaho+WvueivneebkjxlbT7mlL7lnKg8L2VtPueyvueBtemHjOWQl++8nzwvcD48cD7lkYMuLi48L3A+PHA+5oiR5Y675p+l6L+H5LqG44CC57uT5p6c5piv5Y+v5Lul55qE77yM5LiN6L+HPGEgaHJlZj0iaHR0cDovL3d3dy52YmFjY2VsZXJhdG9yLmNvbS9jb2RlbGliL2NtZGxnZC9jbWRsZ3RwLmh0bSIgY2xhc3M9ImV4dGVybmFsIHRleHQiIHJlbD0ibm9mb2xsb3ciPuS4jeWkquWlveeOqTwvYT7ogIzkuJTopoHoirHlh6DkuKrlsI/ml7blt6XlpKvjgILpgqPkuYjlj6/ku6XkuI3nlKjnsr7ngbXmnaXlgZrlkJfvvJ/miJHmiorop4TmoLzph43lhpnmiJDvvJo8L3A+PGJsb2NrcXVvdGU+PHN0cm9uZz7kuKTkuKrpgInljZXvvJo8L3N0cm9uZz48YnIvPjxzdHJvbmc+MSnnlLFJbnRlcm5ldOaxh+WFpee9kemhtTwvc3Ryb25nPiAtJmd0OyDmmL7npLpVUkzlr7nor53nm5IgPGJyLz48c3Ryb25nPjIp55Sx56OB56Kf5rGH5YWl572R6aG1PC9zdHJvbmc+IC0mZ3Q7IOaYvuekuuW8gOaho+WvueivneebkjwvYmxvY2txdW90ZT48cD7lpb3lpJrkuobjgILkuInliIbpkp/nmoTorr7orqHnnIHkuobmiJHlh6DlsI/ml7bnmoTnqIvlvI/lt6XlpKvjgII8L3A+PHA+5aaC5p6c5L2g6L+Z6L6I5a2Q5YaZ6L+HMjDliIbpkp/ku6XkuIrnmoTnqIvlvI/vvIzlj6/og73lt7Lnu4/lj5HnjrDov5nkuKrlvojlpb3nmoTln7rmnKzljp/liJnvvJo8c3Ryb25nPuayoeacieS6i+aDheWDj+ihqOmdoueci+i1t+adpemCo+S5iOeugOWNlTwvc3Ryb25nPi48L3A+PHA+5bCx6L+e5aSN5Yi25LiA5Liq5qGj5qGI6L+Z5LmI566A5Y2V55qE5Yqo5L2c6YO95YWF5ruh6Zm36Zix44CC5aaC5p6c56ys5LiA5Liq5Y+C5pWw5piv55uu5b2V5Lya5aaC5L2V77yf5aaC5p6c56ys5LqM5Liq5Y+C5pWw5piv5qGj5qGI5Y+I5aaC5L2V77yf5aaC5p6c55uu55qE5Zyw5bey57uP5pyJ55u45ZCM5qGj5ZCN55qE5qGj5qGI5Y+I5Lya5oCO5qC377yf5LiH5LiA5rKh5pyJ5YaZ5YWl5p2D6ZmQ5Y+I5oCO5LmI5Yqe77yfPC9wPjxwPuWmguaenOaho+ahiOaLt+WIsOS4gOWNiuWHuumUmeimgeWmguS9le+8n+WmguaenOebrueahOWcsOaYr+mcgOimgeiupOivgeaJjeiDvee7p+e7reeahOi/nOerr+acuuWZqOWPiOWmguS9le+8n+WmguaenOaho+ahiOW+iOWkp+iAjOi/nue6v+W+iOaFou+8jOW/hemhu+aYvuekuui/m+W6puagj+aXtuWPiOS8muWmguS9le+8n+S4h+S4gOS8oOi+k+mAn+W6puaFouWIsDxlbT7lh6DkuY48L2VtPuWujOWFqOS4jeWKqC4uLuS9oOimgeetieWkmuS5heaJjeaUvuW8g+W5tuS8oOWbnumUmeivr+iur+aBr+WRou+8nzwvcD48cD7mnInkuKrlpb3mlrnms5Xlj6/ku6XnlKjmnaXpnaLor5XlupTlvoHmtYvor5Xlt6XkvZznmoTkurrvvIzlsLHmmK/opoHku5bpkojlr7nkuIDku7bnroDljZXnmoTmk43kvZzvvIzmiormiYDmnInlj6/og73lh7rplJnnmoTlnLDmlrnlhajpg73liJfkuL7lh7rmnaXjgILlvq7ova/lr7npnaLor5XmtYvor5XkurrlkZjmnInkuKrnu4/lhbjpopjnm67vvJrlpoLkvZXmtYvor5XlvIDmoaPlr7nor53nm5LvvJ/kvJjnp4DnmoTmtYvor5XkurrlkZjlj6/ku6Xmu5Tmu5TkuI3nu53lnLDliJflh7rlh6DljYHnp43mtYvor5Xpobnnm64o5Zyo5L2g6YCJ5aW95qGj5qGI77yM6KaB5oyJ4oCcPHN0cm9uZz7lvIDlkK88L3N0cm9uZz7igJ3kuYvliY3vvIzlj6bkuIDkuKrkvb/nlKjogIXmiorljp/mnKzlrZjlnKjnmoTmoaPmoYjmnYDmjonkuoYp44CCPC9wPjxwPuWlveS6hu+8jOaJgOS7peaIkeS7rOW+l+WIsOS4gOS4quWumueQhu+8muayoeacieS6i+aDheWDj+ihqOmdoueci+i1t+adpemCo+S5iOeugOWNleOAgjwvcD48cD7ova/kvZPlt6XnqIvph4zmnInlj6blpJbkuIDkuKrlrprnkIbvvIzlsLHmmK/pmo/ml7bpmo/lnLDpg73opoHlsJ3or5XpmY3kvY7po47pmanjgILlhbbkuK3kuIDpobnlv4Xpobvpgb/lhY3nmoTph43lpKfpo47pmanmmK/ov5vluqbpo47pmanvvIzlsLHmmK/mn5Dku7bkuovoirHnmoTml7bpl7Tmr5TpooTmnJ/lpJrjgILov5vluqbpo47pmakK55qE5Z2P5aSE5Zyo5LqO5L2g5Lya6KKr6ICB5p2/5ZC86ICM5b6I55eb6Ium44CC5aaC5p6c5L2g6KeJ5b6X6L+Z5rKh5LuA5LmI77yM5Y+v5Lul5pS555Sx57uP5rWO6KeC54K56ICD6JmR6L+b5bqm6aOO6Zmp55qE5Z2P5aSE44CC5aaC5p6c5Zug5Li65b2T5Yid6K+E5Lyw6ZyA6KaB5LiA5ZGo6ICM5Yaz5a6a6KaB5YGa5p+Q5Liq5Yqf6IO977yM5LqL5ZCO5omN5Y+R546w5YW2CuWunumcgOimgTIw5ZGo77yM6YKj5LmI5YmN6Z2i55qE5Yaz562W5bCx6ZSZ5LqG44CC5aaC5p6c5L2g5pep55+l6YGT6ZyA6KaBMjDlkajlvojlj6/og73lsLHkvJrlgZrkuI3kuIDmoLfnmoTlhrPlrprjgILogIzplJnor6/nmoTlhrPnrZbmhIjlpJrvvIzljbDmnInkvaDlhazlj7jmoIflv5fnmoTotK3nianooovmhIjmnInlj6/og73mtYHokL3liLDotYTkuqfmuIUK566X55qEPGEgaHJlZj0iaHR0cDovL25ld3MuYmJjLmNvLnVrL2hpL2VuZ2xpc2gvYnVzaW5lc3MvbmV3c2lkXzEyMjkwMDAvMTIyOTI3OS5zdG0iIGNsYXNzPSJleHRlcm5hbCB0ZXh0IiByZWw9Im5vZm9sbG93Ij7ku5PlupM8L2E+77yM6ICM5ZCM5pe26Ze05L2g55qE5YmN5omn6KGM6ZW/6L+Y5Zyo5oCo5Y+54oCc55yf5oOo5ZWK77yM5oiR5Lus6L+Y5rKh5pyJ6KKrPGEgaHJlZj0iaHR0cDovL3d3dy5mdWNrZWRjb21wYW55LmNvbS8iIGNsYXNzPSJleHRlcm5hbCB0ZXh0IiByZWw9Im5vZm9sbG93Ij7ng4Llhazlj7g8L2E+5oql5a+85YmN5bCx5YCS5LqG77yB4oCdPC9wPjxwPuKAnOayoeacieS6i+aDheWDj+ihqOmdoueci+i1t+adpemCo+S5iOeugOWNleKAneWGjeWKoOS4iuKAnOmZjeS9jumjjumZqeKAneWPquS8muWvvOWHuuS4gOS4que7k+iuuu+8mjwvcD48YmxvY2txdW90ZT48c3Ryb25nPuS9oOW/hemhu+WFiOWBmuiuvuiuoeWGjeWOu+WunuS9nOOAgjwvc3Ryb25nPjwvYmxvY2txdW90ZT48cD7miJHlvojmirHmrYnorqnkvaDlpLHmnJvkuobjgILmsqHplJnvvIzmiJHnn6XpgZPkvaDnnIvov4dLZW50IEJlY2vnmoTkuabvvIzogIzkuJTnjrDlnKjorqTkuLrkuI3lhYjorr7orqHogIznm7TmjqXlrp7kvZzmmK/mraPluLjnmoTjgILlvojmirHmrYnvvIzov5nlubY8ZW0+5LiNPC9lbT7mraPluLjjgILmlLnnqIvlvI/lsLHmmK88c3Ryb25nPuayoeazleWtkDwvc3Ryb25nPuWSjArmlLnorr7orqHmlofku7bigJzkuIDmoLfnroDljZUgCuKAneOAguWkp+WutuS4gOebtOmDvei/meagt+ivtO+8jOS4jei/h+i/meW5tuS4jeWvueOAguKAnOeOsOWcqOaIkeS7rOmDveeUqEphdmHlkoxYTUzov5nnp43pq5jpmLblt6XlhbfvvIzlh6DliIbpkp/lsLHlj6/ku6XmlLnlpb3nqIvlvI/vvIzkuLrku4DkuYjkuI3nm7TmjqXlnKjlhpnnqIvlvI/ml7blgZrorr7orqHlkaLvvJ/igJ3miJHnmoTmnIsK5Y+L77yM5L2g5Y+v5Lul5pu/5L2g6ICB5aaI6KOF5LiK6L2u5a2Q77yM5LiN6L+H5aW55bm25LiN5Lya5Zug6ICM5Y+Y5oiQ5be05aOr44CC5Y+m5aSW5aaC5p6c5L2g6Ieq6K6k6IO95oqK6ZSZ55So5omn6KGM57uq55qE5qGj5qGI5aSN5Yi25Ye95pWw77yM6YeN5pW05pS55q2j5oiQ5YWI5Y2g5aSa5bel55qE5L2c5rOV77yM6ICM5LiU6YCf5bqm5ZKM5oiR5YaZ6L+Z5Liq5Y+lCuWtkOS4gOagt+W/q++8jOS9oOagueacrOWwseWcqOiHquW3semql+iHquW3sShkZWVwIGRlbmlhbCnjgII8L3A+PHA+5peg6K665aaC5L2V77yM5oiR5LiN6K6k5Li65p6B6ZmQ56iL5byP6K6+6K6h55yf55qE5Zyo5o+Q5YCh6Zu26K6+6K6h44CC5LuW5Lus5Y+q5piv6K+04oCc5LiN6KaB5YGa5peg6LCT55qE6K6+6K6h4oCd77yM6ICM6L+Z5LiA54K55piv5rKh5pyJ6Zeu6aKY55qE44CC5LiN6L+H5aSn5a62PGVtPuWQrOWIsDwvZW0+55qECuS4jeaYr+i/meS5iOWbnuS6i+OAguWkp+mDqOS7veeoi+W8j+W4iOmDveWwveWPr+iDveWcsOaJvuWvu+iDveS4jeWcqOWunuS9nOWJjeWFiOWBmuWfuuacrOiuvuiuoeeahOiXieWPo++8jOaJgOS7peS7luS7rOWwseWDj+aNleiaiueBr+mHjOeahOiaiuWtkOS4gOagt+m7j+S9j+KAnOaXoOiuvuiuoeKAnei/meS4quaDs+azleOAgui/meWFtuWunuWPquaYr+WBt+m4oeS4jeedgAromoDmiornsbPnmoTlj6bnsbvmh5Lmg7DjgILmiJHmh5LlvpflhYjlnKjnurjkuIrorr7orqHlip/og73miYDku6Xnm7TmjqXlhpnnqIvlvI/vvIznqIvlvI/lgZrlvpfkuI3lr7nlj6rlpb3lho3oirHml7bpl7Tkv67mraPvvIznu5Pmnpzlj6rkvJroirHmm7TlpJrnmoTml7bpl7TjgILov5jmnInmm7TluLjop4HnmoTnirblhrXvvIzlsLHmmK/nqIvlvI/lhpnplJnkuoblj6/mmK8K5p2l5LiN5Y+K5pS55q2j77yM5LqO5piv5Lqn5ZOB55qE5ZOB6LSo5L2O6JC977yM5Y+q5aW95LiA55u05om+6JeJ5Y+j6Kej6YeK5Lic6KW/5Li65LuA5LmI4oCc5b+F6aG75YaZ5oiQ6L+Z5qC34oCd44CC5qC55pys5bCx5piv5oeS5pWj5Y+I5LiN5LiT5Lia44CCPC9wPjxwPuW9k0xpbnVzIFRvcnZhbGRzPGEgaHJlZj0iaHR0cDovL3d3dy51d3NnLml1LmVkdS9oeXBlcm1haWwvbGludXgva2VybmVsLzAxMTIuMC8wMDA0Lmh0bWwiIGNsYXNzPSJleHRlcm5hbCB0ZXh0IiByZWw9Im5vZm9sbG93Ij7nl5vmlqXorr7orqE8L2E+5pe2CuiwiOeahOaYr+W3qOWkp+eahOezu+e7n++8jOi/meenjeezu+e7n+W/hemhu+mAkOa4kOa8lOi/m++8jOWQpuWImeWwseS8muWDj011bHRpY3PpgqPmoLfmrbvot6/kuIDmnaHjgILku5bor7TnmoTlubbkuI3mmK/kvaDnmoTmoaPmoYjlpI3liLbnqIvlvI/jgILkurrku6zorqTkuLpMaW51c+acieW+iOa4healmueahOiuoeWIku+8jOehrgrlrp7nn6XpgZPlvoDlkI7opoHmgI7kuYjov5vooYzvvIzml6DmgKpMaW51c+S8muS4jeaAjuS5iOeci+mHjeiuvuiuoeOAguaJgOS7peWIq+S4iuW9k+S6hu+8jOi/meenjeS9nOazleW+iOWPr+iDveW5tuS4jemAguWQiOS9oOOAguS9leWGtUxpbnVz5q+U5oiR5Lus6KaB6IGq5piOPGVtPuWkmuS6hjwvZW0+77yM5LuW6IO95YGa55qE5LqL5oiR5Lus5LiA6Iis5Lq65piv5YGa5LiN5p2l55qE44CCPC9wPjxwPua4kOi/m+W8j+eahOiuvuiuoeWSjOWunuS9nOaYr+WlveeahOOAguW4uOW4uOWPkeihjOS5n+aYr+WlveeahOOAguS4jei/h+WwseWll+ijhei9r+S9k+aIluWkp+S8l+W4guWcuuiAjOiogO+8jOmikee5geeahOWPkeihjOaWsOeJiOS8muiuqeWuouaIt+eWr+aOie+8jOW5tuS4jeaYr+S4quWlveS4u+aEj++8jOW6lOivpeaUueaIkOWcqOWGhQrpg6jlr4bpm4bnmoTlj5HooYzjgILlpKrmi5jms6Xkuo7orr7orqHnu4boioLkvJrmtarotLnml7bpl7TvvIzmiJHku47mnaXmsqHnnIvov4flk6rkuKrkuJPmoYjvvIzkvJrlm6DkuI3pnIDliqjohJHnmoTmtYHnqIvlm77miJZVTUzmiJZDUkPmiJbmmK/lhbbku5bmtYHooYznjqnmhI/ogIzojrfnm4rjgIJMaW51c+ivtOeahOmCo+S6m+aciQrkuIDljYPkuIfooYznqIvlvI/nmoTotoXlpKflnovmgKrnianns7vnu588ZW0+5bqU6K+lPC9lbT7opoHpgJDmuJDmvJTov5vvvIzlm6DkuLrkurrnsbvnoa7lrp7kuI3nn6XpgZPopoHlpoLkvZXorr7orqHpgqPnp43op4TmqKHnmoTova/kvZPjgII8L3A+PHA+5LiN6L+H5b2T5L2g5Z2Q5LiL5p2l6KaB5YaZ5qGj5qGI5aSN5Yi255qE56iL5byP77yM5oiW5piv6K6h5YiS5LiL5LiA54mI6L2v5L2T55qE5Yqf6IO95pe277yM5LiA5a6a6KaB5YGa6K6+6K6h44CC5LiN6KaB6K6p6YKj5Lqb6K+05rOV6L+35oOR5LqG5L2g44CCPC9wPjxwPjxlbT48c3BhbiBzdHlsZT0iZm9udC1zaXplOjEycHgiPuS9oOWPr+S7peWcqOWbm+aciDI55Yiw5LqU5pyI5LiA5pel6Ze077yM5Yiw6bq75bee5YmR5qGl55qEPC9zcGFuPjxhIGhyZWY9Imh0dHA6Ly93d3cuY3V0dGVyLmNvbS9zdW1taXQvIiBjbGFzcz0iZXh0ZXJuYWwgdGV4dCIgcmVsPSJub2ZvbGxvdyI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMnB4Ij5DdXR0ZXIgU3VtbWl0PC9zcGFuPjwvYT48c3BhbiBzdHlsZT0iZm9udC1zaXplOjEycHgiPuWSjOaIkeW9k+mdouiuqOiuuu+8jOaIkeS8muWSjFRvbSBEZU1hcmNvLCBLZW50IEJlY2vlkozlhbbku5bkurrkuIDotbfjgII8L3NwYW4+PC9lbT48L3A+PHA+PGJyLz48L3A+CQk8L2Rpdj4NCgk8L2JvZHk+DQo8L2h0bWw+"></iframe></div><div class="hidden" id="contribute"><form class="contribute_submit_container"><p class="form_control"><span>　　标题:</span><input type="text" name="title"></p><p class="form_control"><span>投稿位置:</span> <label><input type="radio" value="1" name="position" checked="">当前章节子章节　</label> <label><input type="radio" value="2" name="position">替换当前章节　</label> <label><input type="radio" value="3" name="position">当前章节前　</label> <label><input type="radio" value="4" name="position">当前章节后　</label></p><textarea name="content" id="container"></textarea> <input type="hidden" name="bid" value="56"> <input type="hidden" name="aid" value="3211"> <span>验证码: </span><input type="text" class="contribute_verify_code" name="code"> <img class="verifyimg reloadverify" alt="点击切换" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIwAAAAoCAMAAAAbk+L0AAAAilBMVEXz+/4kVWOvz9XZqcLNva/dm6KeusWv4Kqq2N6az6rD4cefxanZ5uq/0ddXfomLqLCViZ46X26Zx840ZXJ3pq9WhpGlvMM9aXZxk51+f5KrlKpRanrCnrYzY2thjYYyZGtfkoZBc3SAqZeLv6Fwm46OrbgzYW9hh5SHrKFfiYg3Zm9Qgn16q481ZmuWrjbzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAD/ElEQVRYhaWYiXacMAxFwTAEBgNN2zB03/f0/3+vlmQbydswqU7i4zAEXZ6eZZiqcnE6VUfjfE4c7Do7ubuzY9/DhMYbI4ApXSkH0yGQhOmfCnNiQE+A6Ugeg0E/ANIfVqbz0iLMicvDYfQxGDvuMOlomjRLfMzT7DDTvByA0d/+DyYVEcyz+7qWypwxJMlW1/X31cFQ3AbTBWUSMEjTP39hstxfu5Wlptgq7+CIpcVoDEkSJqyS9Aytg5eQYykLO11qFz8ShXcsbmwyMAHOSaymCZzyACl0EWatWYRWlzB0nSNlClKY233oe6jSpciycRZTqDwNRAYGiipZxtHN9ELKbxOMrwos2p2otyvSIAbT5zCMv11M9Tp/9YlOW/f/+YnLLF773jPGxDQ/DOPXB6ylPEulmRw0/5WBsWVCFElzZ5uS9IyBGT3Qbsu8DSonx7bPf+dgLFLXtdKq1AcSyoxMHr9g37xNL0YMLs1UhsE+2AIKIHGWTJlMWk+jZ2eckimZNLoIQwoATEsGojaehwEFzOgOeJopD8OkQWU2yBDuFkwBD0PnMRgZY12I4NzF8+3SoOknJBEw65RQ5uwU9J7xQQmLNALJ2PuyaSkNCnMhCg6j4dzJegaqoZRyn1Gh2BaPSWyuqzSWCM09rcuqvTSrZYr2dCz2oh8fNeRUYA1Hk7AWp6lYg8Qs2nUc1nkoaLXNWrNja3RxKxhdy9Ao9lGyAfACMBrIdrFWWDQ7V8Q8/CmxVPuWvlQSJtuMeFgYvGM05iV40pN74+qlSS26XdC/yLLDXGNBDCfMkrvXKfQQSZNsRw7U6POIBkYaGEosIwQ0PW+Zmcoc72r4wQwzjsR2DfbUubkCaXdbSiliSTy9epZK7pR0T0twEGL19uDWZbZjfUyHnMdD5F3rd+/hMXgc5YuPe4JxM2PxQRKxDjbbM0oRv1eNFOzIshIGjLxU/lFnu7gSVIMJIZIt0y5iPlTfq0rxFQ8YwxBUBGF6hGHCBO6d+X/UySgLo5T9kTBSmarZYdhR2jy3JEuBKA9jEgQwA9YogAEaqB+HWW1pqH2EDcgGFOkwkIphhvgss8aBhJdpGD7AVd9VsFSXpWwGFiWgEGbASMA0RpQWfluHrD9+quvPR/q4CPNClgMCGHPTQpn4ewtsf02Dr6RIQ7zDl6/jrTDuzTkFRCS7Q9rWwESN1r3+NW46DGkJj8JQREDE4Wna3sBEvSd6F3UYqSYerc+QRrw6M1f3vWtnDgaUiTah+MUYacyQgrlCQ0T8r2CdMZiqT8E04VcGtko3w4TftqSAXNV2GOvRgWDEJs5CwmCOK8oEZcoR5WEwhWoaFaU4AGM1NJ/tX8yUgmD+AdJ+LKZ7RtF/AAAAAElFTkSuQmCC"> <input type="submit" class="contribute_submit gbg" name="" value="提 交"></form></div></div></div></div><script type="text/javascript">var _bdhmProtocol="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cscript src='"+_bdhmProtocol+"hm.baidu.com/h.js%3Fc7ddc796ca7a7742c464d88c48be8385' type='text/javascript'%3E%3C/script%3E"))</script><script>!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(h,e){function t(e,t){return t.toUpperCase()}var n=[],c=n.slice,g=n.concat,a=n.push,i=n.indexOf,r={},o=r.toString,m=r.hasOwnProperty,v={},y=h.document,s="2.1.3",w=function(e,t){return new w.fn.init(e,t)},u=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,l=/^-ms-/,f=/-([\da-z])/gi;function p(e){var t=e.length,n=w.type(e);return"function"!==n&&!w.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e))}w.fn=w.prototype={jquery:s,constructor:w,selector:"",length:0,toArray:function(){return c.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:c.call(this)},pushStack:function(e){e=w.merge(this.constructor(),e);return e.prevObject=this,e.context=this.context,e},each:function(e,t){return w.each(this,e,t)},map:function(n){return this.pushStack(w.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(c.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,e=+e+(e<0?t:0);return this.pushStack(0<=e&&e<t?[this[e]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:a,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,o=arguments[0]||{},s=1,a=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[s]||{},s++),"object"==typeof o||w.isFunction(o)||(o={}),s===a&&(o=this,s--);s<a;s++)if(null!=(e=arguments[s]))for(t in e)i=o[t],n=e[t],o!==n&&(u&&n&&(w.isPlainObject(n)||(r=w.isArray(n)))?(i=r?(r=!1,i&&w.isArray(i)?i:[]):i&&w.isPlainObject(i)?i:{},o[t]=w.extend(u,i,n)):void 0!==n&&(o[t]=n));return o},w.extend({expando:"jQuery"+(s+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===w.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!w.isArray(e)&&0<=e-parseFloat(e)+1},isPlainObject:function(e){return"object"===w.type(e)&&!e.nodeType&&!w.isWindow(e)&&!(e.constructor&&!m.call(e.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(e){for(var t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?r[o.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;(e=w.trim(e))&&(1===e.indexOf("use strict")?((t=y.createElement("script")).text=e,y.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(l,"ms-").replace(f,t)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,s=p(e);if(n){if(s)for(;i<o&&!1!==(r=t.apply(e[i],n));i++);else for(i in e)if(r=t.apply(e[i],n),!1===r)break}else if(s)for(;i<o&&!1!==(r=t.call(e[i],i,e[i]));i++);else for(i in e)if(r=t.call(e[i],i,e[i]),!1===r)break;return e},trim:function(e){return null==e?"":(e+"").replace(u,"")},makeArray:function(e,t){t=t||[];return null!=e&&(p(Object(e))?w.merge(t,"string"==typeof e?[e]:e):a.call(t,e)),t},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,s=!n;i<o;i++)!t(e[i],i)!=s&&r.push(e[i]);return r},map:function(e,t,n){var r,i=0,o=e.length,s=[];if(p(e))for(;i<o;i++)null!=(r=t(e[i],i,n))&&s.push(r);else for(i in e)r=t(e[i],i,n),null!=r&&s.push(r);return g.apply([],s)},guid:1,proxy:function(e,t){var n,r;return"string"==typeof t&&(r=e[t],t=e,e=r),w.isFunction(e)?(n=c.call(arguments,2),(r=function(){return e.apply(t||this,n.concat(c.call(arguments)))}).guid=e.guid=e.guid||w.guid++,r):void 0},now:Date.now,support:v}),w.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){r["[object "+t+"]"]=t.toLowerCase()});var d=function(n){function f(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(65536+r):String.fromCharCode(r>>10|55296,1023&r|56320)}function t(){m()}var e,d,b,o,r,h,p,g,w,l,c,m,T,i,v,y,s,a,x,C="sizzle"+ +new Date,N=n.document,k=0,E=0,u=oe(),S=oe(),D=oe(),j=function(e,t){return e===t&&(c=!0),0},A={}.hasOwnProperty,L=[],q=L.pop,H=L.push,O=L.push,F=L.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",W="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",$=W.replace("w","w#"),I="\\["+M+"*("+W+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+$+"))|)"+M+"*\\]",B=":("+W+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+I+")*)|.*)\\)|)",_=new RegExp(M+"+","g"),z=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),X=new RegExp("^"+M+"*,"+M+"*"),U=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),V=new RegExp("="+M+"*([^\\]'\"]*?)"+M+"*\\]","g"),Y=new RegExp(B),G=new RegExp("^"+$+"$"),Q={ID:new RegExp("^#("+W+")"),CLASS:new RegExp("^\\.("+W+")"),TAG:new RegExp("^("+W.replace("w","w*")+")"),ATTR:new RegExp("^"+I),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},J=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,ee=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,te=/[+~]/,ne=/'|\\/g,re=new RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig");try{O.apply(L=F.call(N.childNodes),N.childNodes),L[N.childNodes.length].nodeType}catch(e){O={apply:L.length?function(e,t){H.apply(e,F.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function ie(e,t,n,r){var i,o,s,a,u,l,c,f,p;if((t?t.ownerDocument||t:N)!==T&&m(t),n=n||[],s=(t=t||T).nodeType,"string"!=typeof e||!e||1!==s&&9!==s&&11!==s)return n;if(!r&&v){if(11!==s&&(i=ee.exec(e)))if(l=i[1]){if(9===s){if(!(o=t.getElementById(l))||!o.parentNode)return n;if(o.id===l)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(l))&&x(t,o)&&o.id===l)return n.push(o),n}else{if(i[2])return O.apply(n,t.getElementsByTagName(e)),n;if((l=i[3])&&d.getElementsByClassName)return O.apply(n,t.getElementsByClassName(l)),n}if(d.qsa&&(!y||!y.test(e))){if(c=l=C,f=t,p=1!==s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(u=h(e),(l=t.getAttribute("id"))?c=l.replace(ne,"\\$&"):t.setAttribute("id",c),c="[id='"+c+"'] ",a=u.length;a--;)u[a]=c+de(u[a]);f=te.test(e)&&fe(t.parentNode)||t,p=u.join(",")}if(p)try{return O.apply(n,f.querySelectorAll(p)),n}catch(e){}finally{l||t.removeAttribute("id")}}}return g(e.replace(z,"$1"),t,n,r)}function oe(){var n=[];function r(e,t){return n.push(e+" ")>b.cacheLength&&delete r[n.shift()],r[e+" "]=t}return r}function se(e){return e[C]=!0,e}function ae(e){var t=T.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ue(e,t){for(var n=e.split("|"),r=e.length;r--;)b.attrHandle[n[r]]=t}function le(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ce(s){return se(function(o){return o=+o,se(function(e,t){for(var n,r=s([],e.length,o),i=r.length;i--;)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function fe(e){return e&&void 0!==e.getElementsByTagName&&e}for(e in d=ie.support={},r=ie.isXML=function(e){e=e&&(e.ownerDocument||e).documentElement;return!!e&&"HTML"!==e.nodeName},m=ie.setDocument=function(e){var u=e?e.ownerDocument||e:N;return u!==T&&9===u.nodeType&&u.documentElement?(i=(T=u).documentElement,(e=u.defaultView)&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",t,!1):e.attachEvent&&e.attachEvent("onunload",t)),v=!r(u),d.attributes=ae(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ae(function(e){return e.appendChild(u.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=Z.test(u.getElementsByClassName),d.getById=ae(function(e){return i.appendChild(e).id=C,!u.getElementsByName||!u.getElementsByName(C).length}),d.getById?(b.find.ID=function(e,t){if(void 0!==t.getElementById&&v){e=t.getElementById(e);return e&&e.parentNode?[e]:[]}},b.filter.ID=function(e){var t=e.replace(re,f);return function(e){return e.getAttribute("id")===t}}):(delete b.find.ID,b.filter.ID=function(e){var t=e.replace(re,f);return function(e){e=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return e&&e.value===t}}),b.find.TAG=d.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"!==e)return o;for(;n=o[i++];)1===n.nodeType&&r.push(n);return r},b.find.CLASS=d.getElementsByClassName&&function(e,t){return v?t.getElementsByClassName(e):void 0},s=[],y=[],(d.qsa=Z.test(u.querySelectorAll))&&(ae(function(e){i.appendChild(e).innerHTML="<a id='"+C+"'></a><select id='"+C+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&y.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||y.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+C+"-]").length||y.push("~="),e.querySelectorAll(":checked").length||y.push(":checked"),e.querySelectorAll("a#"+C+"+*").length||y.push(".#.+[+~]")}),ae(function(e){var t=u.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&y.push("name"+M+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||y.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),y.push(",.*:")})),(d.matchesSelector=Z.test(a=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.oMatchesSelector||i.msMatchesSelector))&&ae(function(e){d.disconnectedMatch=a.call(e,"div"),a.call(e,"[s!='']:x"),s.push("!=",B)}),y=y.length&&new RegExp(y.join("|")),s=s.length&&new RegExp(s.join("|")),e=Z.test(i.compareDocumentPosition),x=e||Z.test(i.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,t=t&&t.parentNode;return e===t||!(!t||1!==t.nodeType||!(n.contains?n.contains(t):e.compareDocumentPosition&&16&e.compareDocumentPosition(t)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},j=e?function(e,t){if(e===t)return c=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e===u||e.ownerDocument===N&&x(N,e)?-1:t===u||t.ownerDocument===N&&x(N,t)?1:l?P(l,e)-P(l,t):0:4&n?-1:1)}:function(e,t){if(e===t)return c=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!i||!o)return e===u?-1:t===u?1:i?-1:o?1:l?P(l,e)-P(l,t):0;if(i===o)return le(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;s[r]===a[r];)r++;return r?le(s[r],a[r]):s[r]===N?-1:a[r]===N?1:0},u):T},ie.matches=function(e,t){return ie(e,null,null,t)},ie.matchesSelector=function(e,t){if((e.ownerDocument||e)!==T&&m(e),t=t.replace(V,"='$1']"),!(!d.matchesSelector||!v||s&&s.test(t)||y&&y.test(t)))try{var n=a.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return 0<ie(t,T,null,[e]).length},ie.contains=function(e,t){return(e.ownerDocument||e)!==T&&m(e),x(e,t)},ie.attr=function(e,t){(e.ownerDocument||e)!==T&&m(e);var n=b.attrHandle[t.toLowerCase()],n=n&&A.call(b.attrHandle,t.toLowerCase())?n(e,t,!v):void 0;return void 0!==n?n:d.attributes||!v?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},ie.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ie.uniqueSort=function(e){var t,n=[],r=0,i=0;if(c=!d.detectDuplicates,l=!d.sortStable&&e.slice(0),e.sort(j),c){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return l=null,e},o=ie.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=o(t);return n},(b=ie.selectors={cacheLength:50,createPseudo:se,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(re,f),e[3]=(e[3]||e[4]||e[5]||"").replace(re,f),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ie.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ie.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Q.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&Y.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(re,f).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=u[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&u(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(t,n,r){return function(e){e=ie.attr(e,t);return null==e?"!="===n:!n||(e+="","="===n?e===r:"!="===n?e!==r:"^="===n?r&&0===e.indexOf(r):"*="===n?r&&-1<e.indexOf(r):"$="===n?r&&e.slice(-r.length)===r:"~="===n?-1<(" "+e.replace(_," ")+" ").indexOf(r):"|="===n&&(e===r||e.slice(0,r.length+1)===r+"-"))}},CHILD:function(d,e,t,h,g){var m="nth"!==d.slice(0,3),v="last"!==d.slice(-4),y="of-type"===e;return 1===h&&0===g?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,s,a,u,l=m!=v?"nextSibling":"previousSibling",c=e.parentNode,f=y&&e.nodeName.toLowerCase(),p=!n&&!y;if(c){if(m){for(;l;){for(o=e;o=o[l];)if(y?o.nodeName.toLowerCase()===f:1===o.nodeType)return!1;u=l="only"===d&&!u&&"nextSibling"}return!0}if(u=[v?c.firstChild:c.lastChild],v&&p){for(a=(r=(i=c[C]||(c[C]={}))[d]||[])[0]===k&&r[1],s=r[0]===k&&r[2],o=a&&c.childNodes[a];o=++a&&o&&o[l]||(s=a=0)||u.pop();)if(1===o.nodeType&&++s&&o===e){i[d]=[k,a,s];break}}else if(p&&(r=(e[C]||(e[C]={}))[d])&&r[0]===k)s=r[1];else for(;(o=++a&&o&&o[l]||(s=a=0)||u.pop())&&((y?o.nodeName.toLowerCase()!==f:1!==o.nodeType)||!++s||(p&&((o[C]||(o[C]={}))[d]=[k,s]),o!==e)););return(s-=g)===h||s%h==0&&0<=s/h}}},PSEUDO:function(e,o){var t,s=b.pseudos[e]||b.setFilters[e.toLowerCase()]||ie.error("unsupported pseudo: "+e);return s[C]?s(o):1<s.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,t){for(var n,r=s(e,o),i=r.length;i--;)e[n=P(e,r[i])]=!(t[n]=r[i])}):function(e){return s(e,0,t)}):s}},pseudos:{not:se(function(e){var r=[],i=[],a=p(e.replace(z,"$1"));return a[C]?se(function(e,t,n,r){for(var i,o=a(e,null,r,[]),s=e.length;s--;)(i=o[s])&&(e[s]=!(t[s]=i))}):function(e,t,n){return r[0]=e,a(r,null,n,i),r[0]=null,!i.pop()}}),has:se(function(t){return function(e){return 0<ie(t,e).length}}),contains:se(function(t){return t=t.replace(re,f),function(e){return-1<(e.textContent||e.innerText||o(e)).indexOf(t)}}),lang:se(function(n){return G.test(n||"")||ie.error("unsupported lang: "+n),n=n.replace(re,f).toLowerCase(),function(e){var t;do{if(t=v?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===i},focus:function(e){return e===T.activeElement&&(!T.hasFocus||T.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return K.test(e.nodeName)},input:function(e){return J.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(e=e.getAttribute("type"))||"text"===e.toLowerCase())},first:ce(function(){return[0]}),last:ce(function(e,t){return[t-1]}),eq:ce(function(e,t,n){return[n<0?n+t:n]}),even:ce(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ce(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ce(function(e,t,n){for(var r=n<0?n+t:n;0<=--r;)e.push(r);return e}),gt:ce(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=function(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}(e);function pe(){}function de(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function he(s,e,t){var a=e.dir,u=t&&"parentNode"===a,l=E++;return e.first?function(e,t,n){for(;e=e[a];)if(1===e.nodeType||u)return s(e,t,n)}:function(e,t,n){var r,i,o=[k,l];if(n){for(;e=e[a];)if((1===e.nodeType||u)&&s(e,t,n))return!0}else for(;e=e[a];)if(1===e.nodeType||u){if((r=(i=e[C]||(e[C]={}))[a])&&r[0]===k&&r[1]===l)return o[2]=r[2];if((i[a]=o)[2]=s(e,t,n))return!0}}}function ge(i){return 1<i.length?function(e,t,n){for(var r=i.length;r--;)if(!i[r](e,t,n))return!1;return!0}:i[0]}function me(e,t,n,r,i){for(var o,s=[],a=0,u=e.length,l=null!=t;a<u;a++)!(o=e[a])||n&&!n(o,r,i)||(s.push(o),l&&t.push(a));return s}function ve(d,h,g,m,v,e){return m&&!m[C]&&(m=ve(m)),v&&!v[C]&&(v=ve(v,e)),se(function(e,t,n,r){var i,o,s,a=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)ie(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:me(c,a,d,n,r),p=g?v||(e?d:l||m)?[]:t:f;if(g&&g(f,p,n,r),m)for(i=me(p,u),m(i,[],n,r),o=i.length;o--;)(s=i[o])&&(p[u[o]]=!(f[u[o]]=s));if(e){if(v||d){if(v){for(i=[],o=p.length;o--;)(s=p[o])&&i.push(f[o]=s);v(null,p=[],i,r)}for(o=p.length;o--;)(s=p[o])&&-1<(i=v?P(e,s):a[o])&&(e[i]=!(t[i]=s))}}else p=me(p===t?p.splice(l,p.length):p),v?v(null,t,p,r):O.apply(t,p)})}function ye(m,v){function e(e,t,n,r,i){var o,s,a,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t!==T&&t);l!==g&&null!=(o=d[l]);l++){if(x&&o){for(s=0;a=m[s++];)if(a(o,t,n)){r.push(o);break}i&&(k=h)}y&&((o=!a&&o)&&u--,e&&c.push(o))}if(u+=l,y&&l!==u){for(s=0;a=v[s++];)a(c,f,t,n);if(e){if(0<u)for(;l--;)c[l]||f[l]||(f[l]=q.call(r));f=me(f)}O.apply(r,f),i&&!e&&0<f.length&&1<u+v.length&&ie.uniqueSort(r)}return i&&(k=h,w=p),c}var y=0<v.length,x=0<m.length;return y?se(e):e}return pe.prototype=b.filters=b.pseudos,b.setFilters=new pe,h=ie.tokenize=function(e,t){var n,r,i,o,s,a,u,l=S[e+" "];if(l)return t?0:l.slice(0);for(s=e,a=[],u=b.preFilter;s;){for(o in n&&!(r=X.exec(s))||(r&&(s=s.slice(r[0].length)||s),a.push(i=[])),n=!1,(r=U.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(z," ")}),s=s.slice(n.length)),b.filter)!(r=Q[o].exec(s))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?ie.error(e):S(e,a).slice(0)},p=ie.compile=function(e,t){var n,r=[],i=[],o=D[e+" "];if(!o){for(n=(t=t||h(e)).length;n--;)((o=function e(t){for(var r,n,i,o=t.length,s=b.relative[t[0].type],a=s||b.relative[" "],u=s?1:0,l=he(function(e){return e===r},a,!0),c=he(function(e){return-1<P(r,e)},a,!0),f=[function(e,t,n){return n=!s&&(n||t!==w)||((r=t).nodeType?l:c)(e,t,n),r=null,n}];u<o;u++)if(n=b.relative[t[u].type])f=[he(ge(f),n)];else{if((n=b.filter[t[u].type].apply(null,t[u].matches))[C]){for(i=++u;i<o&&!b.relative[t[i].type];i++);return ve(1<u&&ge(f),1<u&&de(t.slice(0,u-1).concat({value:" "===t[u-2].type?"*":""})).replace(z,"$1"),n,u<i&&e(t.slice(u,i)),i<o&&e(t=t.slice(i)),i<o&&de(t))}f.push(n)}return ge(f)}(t[n]))[C]?r:i).push(o);(o=D(e,ye(i,r))).selector=e}return o},g=ie.select=function(e,t,n,r){var i,o,s,a,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(s=o[0]).type&&d.getById&&9===t.nodeType&&v&&b.relative[o[1].type]){if(!(t=(b.find.ID(s.matches[0].replace(re,f),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=Q.needsContext.test(e)?0:o.length;i--&&(s=o[i],!b.relative[a=s.type]);)if((u=b.find[a])&&(r=u(s.matches[0].replace(re,f),te.test(o[0].type)&&fe(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&de(o)))return O.apply(n,r),n;break}}return(l||p(e,c))(r,t,!v,n,te.test(e)&&fe(t.parentNode)||t),n},d.sortStable=C.split("").sort(j).join("")===C,d.detectDuplicates=!!c,m(),d.sortDetached=ae(function(e){return 1&e.compareDocumentPosition(T.createElement("div"))}),ae(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ue("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ae(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ue("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),ae(function(e){return null==e.getAttribute("disabled")})||ue(R,function(e,t,n){return n?void 0:!0===e[t]?t.toLowerCase():(t=e.getAttributeNode(t))&&t.specified?t.value:null}),ie}(h);w.find=d,w.expr=d.selectors,w.expr[":"]=w.expr.pseudos,w.unique=d.uniqueSort,w.text=d.getText,w.isXMLDoc=d.isXML,w.contains=d.contains;var x=w.expr.match.needsContext,b=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,T=/^.[^:#\[\.,]*$/;function C(e,n,r){if(w.isFunction(n))return w.grep(e,function(e,t){return!!n.call(e,t,e)!==r});if(n.nodeType)return w.grep(e,function(e){return e===n!==r});if("string"==typeof n){if(T.test(n))return w.filter(n,e,r);n=w.filter(n,e)}return w.grep(e,function(e){return 0<=i.call(n,e)!==r})}w.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},w.fn.extend({find:function(e){var t,n=this.length,r=[],i=this;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;t<n;t++)if(w.contains(i[t],this))return!0}));for(t=0;t<n;t++)w.find(e,i[t],r);return(r=this.pushStack(1<n?w.unique(r):r)).selector=this.selector?this.selector+" "+e:e,r},filter:function(e){return this.pushStack(C(this,e||[],!1))},not:function(e){return this.pushStack(C(this,e||[],!0))},is:function(e){return!!C(this,"string"==typeof e&&x.test(e)?w(e):e||[],!1).length}});var N,k=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(w.fn.init=function(e,t){var n,r;if(!e)return this;if("string"!=typeof e)return e.nodeType?(this.context=this[0]=e,this.length=1,this):w.isFunction(e)?void 0!==N.ready?N.ready(e):e(w):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),w.makeArray(e,this));if(!(n="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:k.exec(e))||!n[1]&&t)return(!t||t.jquery?t||N:this.constructor(t)).find(e);if(n[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:y,!0)),b.test(n[1])&&w.isPlainObject(t))for(n in t)w.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return(r=y.getElementById(n[2]))&&r.parentNode&&(this.length=1,this[0]=r),this.context=y,this.selector=e,this}).prototype=w.fn,N=w(y);var E=/^(?:parents|prev(?:Until|All))/,S={children:!0,contents:!0,next:!0,prev:!0};function D(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}w.extend({dir:function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&w(e).is(n))break;r.push(e)}return r},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,r=0,i=this.length,o=[],s=x.test(e)||"string"!=typeof e?w(e,t||this.context):0;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?-1<s.index(n):1===n.nodeType&&w.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?w.unique(o):o)},index:function(e){return e?"string"==typeof e?i.call(w(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.unique(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){e=e.parentNode;return e&&11!==e.nodeType?e:null},parents:function(e){return w.dir(e,"parentNode")},parentsUntil:function(e,t,n){return w.dir(e,"parentNode",n)},next:function(e){return D(e,"nextSibling")},prev:function(e){return D(e,"previousSibling")},nextAll:function(e){return w.dir(e,"nextSibling")},prevAll:function(e){return w.dir(e,"previousSibling")},nextUntil:function(e,t,n){return w.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return w.dir(e,"previousSibling",n)},siblings:function(e){return w.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return w.sibling(e.firstChild)},contents:function(e){return e.contentDocument||w.merge([],e.childNodes)}},function(r,i){w.fn[r]=function(e,t){var n=w.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=w.filter(t,n)),1<this.length&&(S[r]||w.unique(n),E.test(r)&&n.reverse()),this.pushStack(n)}});var j,A=/\S+/g,L={};function q(){y.removeEventListener("DOMContentLoaded",q,!1),h.removeEventListener("load",q,!1),w.ready()}w.Callbacks=function(i){var e,n;i="string"==typeof i?L[i]||(n=L[e=i]={},w.each(e.match(A)||[],function(e,t){n[t]=!0}),n):w.extend({},i);var t,r,o,s,a,u,l=[],c=!i.once&&[],f=function(e){for(t=i.memory&&e,r=!0,u=s||0,s=0,a=l.length,o=!0;l&&u<a;u++)if(!1===l[u].apply(e[0],e[1])&&i.stopOnFalse){t=!1;break}o=!1,l&&(c?c.length&&f(c.shift()):t?l=[]:p.disable())},p={add:function(){var e;return l&&(e=l.length,function r(e){w.each(e,function(e,t){var n=w.type(t);"function"===n?i.unique&&p.has(t)||l.push(t):t&&t.length&&"string"!==n&&r(t)})}(arguments),o?a=l.length:t&&(s=e,f(t))),this},remove:function(){return l&&w.each(arguments,function(e,t){for(var n;-1<(n=w.inArray(t,l,n));)l.splice(n,1),o&&(n<=a&&a--,n<=u&&u--)}),this},has:function(e){return e?-1<w.inArray(e,l):!(!l||!l.length)},empty:function(){return l=[],a=0,this},disable:function(){return l=c=t=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,t||p.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!l||r&&!c||(t=[e,(t=t||[]).slice?t.slice():t],o?c.push(t):f(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!r}};return p},w.extend({Deferred:function(e){var o=[["resolve","done",w.Callbacks("once memory"),"resolved"],["reject","fail",w.Callbacks("once memory"),"rejected"],["notify","progress",w.Callbacks("memory")]],i="pending",s={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var i=arguments;return w.Deferred(function(r){w.each(o,function(e,t){var n=w.isFunction(i[e])&&i[e];a[t[1]](function(){var e=n&&n.apply(this,arguments);e&&w.isFunction(e.promise)?e.promise().done(r.resolve).fail(r.reject).progress(r.notify):r[t[0]+"With"](this===s?r.promise():this,n?[e]:arguments)})}),i=null}).promise()},promise:function(e){return null!=e?w.extend(e,s):s}},a={};return s.pipe=s.then,w.each(o,function(e,t){var n=t[2],r=t[3];s[t[1]]=n.add,r&&n.add(function(){i=r},o[1^e][2].disable,o[2][2].lock),a[t[0]]=function(){return a[t[0]+"With"](this===a?s:this,arguments),this},a[t[0]+"With"]=n.fireWith}),s.promise(a),e&&e.call(a,a),a},when:function(e){function t(t,n,r){return function(e){n[t]=this,r[t]=1<arguments.length?c.call(arguments):e,r===i?l.notifyWith(n,r):--u||l.resolveWith(n,r)}}var i,n,r,o=0,s=c.call(arguments),a=s.length,u=1!==a||e&&w.isFunction(e.promise)?a:0,l=1===u?e:w.Deferred();if(1<a)for(i=new Array(a),n=new Array(a),r=new Array(a);o<a;o++)s[o]&&w.isFunction(s[o].promise)?s[o].promise().done(t(o,r,s)).fail(l.reject).progress(t(o,n,i)):--u;return u||l.resolveWith(r,s),l.promise()}}),w.fn.ready=function(e){return w.ready.promise().done(e),this},w.extend({isReady:!1,readyWait:1,holdReady:function(e){e?w.readyWait++:w.ready(!0)},ready:function(e){(!0===e?--w.readyWait:w.isReady)||((w.isReady=!0)!==e&&0<--w.readyWait||(j.resolveWith(y,[w]),w.fn.triggerHandler&&(w(y).triggerHandler("ready"),w(y).off("ready"))))}}),w.ready.promise=function(e){return j||(j=w.Deferred(),"complete"===y.readyState?setTimeout(w.ready):(y.addEventListener("DOMContentLoaded",q,!1),h.addEventListener("load",q,!1))),j.promise(e)},w.ready.promise();var H=w.access=function(e,t,n,r,i,o,s){var a=0,u=e.length,l=null==n;if("object"===w.type(n))for(a in i=!0,n)w.access(e,t,a,n[a],!0,o,s);else if(void 0!==r&&(i=!0,w.isFunction(r)||(s=!0),l&&(t=s?(t.call(e,r),null):(l=t,function(e,t,n){return l.call(w(e),n)})),t))for(;a<u;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:l?t.call(e):u?t(e[0],n):o};function O(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=w.expando+O.uid++}w.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},O.uid=1,O.accepts=w.acceptData,O.prototype={key:function(t){if(!O.accepts(t))return 0;var n={},r=t[this.expando];if(!r){r=O.uid++;try{n[this.expando]={value:r},Object.defineProperties(t,n)}catch(e){n[this.expando]=r,w.extend(t,n)}}return this.cache[r]||(this.cache[r]={}),r},set:function(e,t,n){var r,e=this.key(e),i=this.cache[e];if("string"==typeof t)i[t]=n;else if(w.isEmptyObject(i))w.extend(this.cache[e],t);else for(r in t)i[r]=t[r];return i},get:function(e,t){e=this.cache[this.key(e)];return void 0===t?e:e[t]},access:function(e,t,n){var r;return void 0===t||t&&"string"==typeof t&&void 0===n?void 0!==(r=this.get(e,t))?r:this.get(e,w.camelCase(t)):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r,e=this.key(e),i=this.cache[e];if(void 0===t)this.cache[e]={};else{n=(r=w.isArray(t)?t.concat(t.map(w.camelCase)):(e=w.camelCase(t),t in i?[t,e]:(r=e)in i?[r]:r.match(A)||[])).length;for(;n--;)delete i[r[n]]}},hasData:function(e){return!w.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var F=new O,P=new O,R=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,M=/([A-Z])/g;function W(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(M,"-$1").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:R.test(n)?w.parseJSON(n):n)}catch(e){}P.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return P.hasData(e)||F.hasData(e)},data:function(e,t,n){return P.access(e,t,n)},removeData:function(e,t){P.remove(e,t)},_data:function(e,t,n){return F.access(e,t,n)},_removeData:function(e,t){F.remove(e,t)}}),w.fn.extend({data:function(r,e){var t,n,i,o=this[0],s=o&&o.attributes;if(void 0!==r)return"object"==typeof r?this.each(function(){P.set(this,r)}):H(this,function(t){var e,n=w.camelCase(r);if(o&&void 0===t)return void 0!==(e=P.get(o,r))||void 0!==(e=P.get(o,n))?e:void 0!==(e=W(o,n,void 0))?e:void 0;this.each(function(){var e=P.get(this,n);P.set(this,n,t),-1!==r.indexOf("-")&&void 0!==e&&P.set(this,r,t)})},null,e,1<arguments.length,null,!0);if(this.length&&(i=P.get(o),1===o.nodeType&&!F.get(o,"hasDataAttrs"))){for(t=s.length;t--;)s[t]&&(0===(n=s[t].name).indexOf("data-")&&(n=w.camelCase(n.slice(5)),W(o,n,i[n])));F.set(o,"hasDataAttrs",!0)}return i},removeData:function(e){return this.each(function(){P.remove(this,e)})}}),w.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=F.get(e,t),n&&(!r||w.isArray(n)?r=F.access(e,t,w.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),o=w._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){w.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return F.get(e,n)||F.access(e,n,{empty:w.Callbacks("once memory").add(function(){F.remove(e,[t+"queue",n])})})}}),w.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?w.queue(this[0],t):void 0===n?this:this.each(function(){var e=w.queue(this,t,n);w._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&w.dequeue(this,t)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function n(){--i||o.resolveWith(s,[s])}var r,i=1,o=w.Deferred(),s=this,a=this.length;for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(r=F.get(s[a],e+"queueHooks"))&&r.empty&&(i++,r.empty.add(n));return n(),o.promise(t)}});function $(e,t){return e=t||e,"none"===w.css(e,"display")||!w.contains(e.ownerDocument,e)}var n=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,I=["Top","Right","Bottom","Left"],B=/^(?:checkbox|radio)$/i;s=y.createDocumentFragment().appendChild(y.createElement("div")),(d=y.createElement("input")).setAttribute("type","radio"),d.setAttribute("checked","checked"),d.setAttribute("name","t"),s.appendChild(d),v.checkClone=s.cloneNode(!0).cloneNode(!0).lastChild.checked,s.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!s.cloneNode(!0).lastChild.defaultValue;var _="undefined";v.focusinBubbles="onfocusin"in h;var z=/^key/,X=/^(?:mouse|pointer|contextmenu)|click/,U=/^(?:focusinfocus|focusoutblur)$/,V=/^([^.]*)(?:\.(.+)|)$/;function Y(){return!0}function G(){return!1}function Q(){try{return y.activeElement}catch(e){}}w.event={global:{},add:function(t,e,n,r,i){var o,s,a,u,l,c,f,p,d,h=F.get(t);if(h)for(n.handler&&(n=(o=n).handler,i=o.selector),n.guid||(n.guid=w.guid++),(a=h.events)||(a=h.events={}),(s=h.handle)||(s=h.handle=function(e){return typeof w!=_&&w.event.triggered!==e.type?w.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(A)||[""]).length;u--;)f=d=(l=V.exec(e[u])||[])[1],p=(l[2]||"").split(".").sort(),f&&(c=w.event.special[f]||{},f=(i?c.delegateType:c.bindType)||f,c=w.event.special[f]||{},l=w.extend({type:f,origType:d,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&w.expr.match.needsContext.test(i),namespace:p.join(".")},o),(d=a[f])||((d=a[f]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(t,r,p,s)||t.addEventListener&&t.addEventListener(f,s,!1)),c.add&&(c.add.call(t,l),l.handler.guid||(l.handler.guid=n.guid)),i?d.splice(d.delegateCount++,0,l):d.push(l),w.event.global[f]=!0)},remove:function(e,t,n,r,i){var o,s,a,u,l,c,f,p,d,h,g,m=F.hasData(e)&&F.get(e);if(m&&(u=m.events)){for(l=(t=(t||"").match(A)||[""]).length;l--;)if(d=g=(a=V.exec(t[l])||[])[1],h=(a[2]||"").split(".").sort(),d){for(f=w.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],a=a[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=p.length;o--;)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));s&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,m.handle)||w.removeEvent(e,d,m.handle),delete u[d])}else for(d in u)w.event.remove(e,d+t[l],n,r,!0);w.isEmptyObject(u)&&(delete m.handle,F.remove(e,"events"))}},trigger:function(e,t,n,r){var i,o,s,a,u,l,c=[n||y],f=m.call(e,"type")?e.type:e,p=m.call(e,"namespace")?e.namespace.split("."):[],d=o=n=n||y;if(3!==n.nodeType&&8!==n.nodeType&&!U.test(f+w.event.triggered)&&(0<=f.indexOf(".")&&(f=(p=f.split(".")).shift(),p.sort()),a=f.indexOf(":")<0&&"on"+f,(e=e[w.expando]?e:new w.Event(f,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:w.makeArray(t,[e]),l=w.event.special[f]||{},r||!l.trigger||!1!==l.trigger.apply(n,t))){if(!r&&!l.noBubble&&!w.isWindow(n)){for(s=l.delegateType||f,U.test(s+f)||(d=d.parentNode);d;d=d.parentNode)c.push(d),o=d;o===(n.ownerDocument||y)&&c.push(o.defaultView||o.parentWindow||h)}for(i=0;(d=c[i++])&&!e.isPropagationStopped();)e.type=1<i?s:l.bindType||f,(u=(F.get(d,"events")||{})[e.type]&&F.get(d,"handle"))&&u.apply(d,t),(u=a&&d[a])&&u.apply&&w.acceptData(d)&&(e.result=u.apply(d,t),!1===e.result&&e.preventDefault());return e.type=f,r||e.isDefaultPrevented()||l._default&&!1!==l._default.apply(c.pop(),t)||!w.acceptData(n)||a&&w.isFunction(n[f])&&!w.isWindow(n)&&((o=n[a])&&(n[a]=null),n[w.event.triggered=f](),w.event.triggered=void 0,o&&(n[a]=o)),e.result}},dispatch:function(e){e=w.event.fix(e);var t,n,r,i,o,s=c.call(arguments),a=(F.get(this,"events")||{})[e.type]||[],u=w.event.special[e.type]||{};if((s[0]=e).delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,e)){for(o=w.event.handlers.call(this,e,a),t=0;(r=o[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,n=0;(i=r.handlers[n++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(i.namespace)||(e.handleObj=i,e.data=i.data,void 0!==(i=((w.event.special[i.origType]||{}).handle||i.handler).apply(r.elem,s))&&!1===(e.result=i)&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,s=[],a=t.delegateCount,u=e.target;if(a&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!==this;u=u.parentNode||this)if(!0!==u.disabled||"click"!==e.type){for(r=[],n=0;n<a;n++)void 0===r[i=(o=t[n]).selector+" "]&&(r[i]=o.needsContext?0<=w(i,this).index(u):w.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return a<t.length&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i=t.button;return null==e.pageX&&null!=t.clientX&&(n=(r=e.target.ownerDocument||y).documentElement,r=r.body,e.pageX=t.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)),e.which||void 0===i||(e.which=1&i?1:2&i?3:4&i?2:0),e}},fix:function(e){if(e[w.expando])return e;var t,n,r,i=e.type,o=e,s=this.fixHooks[i];for(s||(this.fixHooks[i]=s=X.test(i)?this.mouseHooks:z.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new w.Event(o),t=r.length;t--;)e[n=r[t]]=o[n];return e.target||(e.target=y),3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==Q()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===Q()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&w.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return w.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){e=w.extend(new w.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?w.event.trigger(e,null,t):w.event.dispatch.call(t,e),e.isDefaultPrevented()&&n.preventDefault()}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},w.Event=function(e,t){return this instanceof w.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Y:G):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||w.now(),void(this[w.expando]=!0)):new w.Event(e,t)},w.Event.prototype={isDefaultPrevented:G,isPropagationStopped:G,isImmediatePropagationStopped:G,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Y,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Y,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Y,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){w.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||w.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),v.focusinBubbles||w.each({focus:"focusin",blur:"focusout"},function(n,r){function i(e){w.event.simulate(r,e.target,w.event.fix(e),!0)}w.event.special[r]={setup:function(){var e=this.ownerDocument||this,t=F.access(e,r);t||e.addEventListener(n,i,!0),F.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=F.access(e,r)-1;t?F.access(e,r,t):(e.removeEventListener(n,i,!0),F.remove(e,r))}}}),w.fn.extend({on:function(e,t,n,r,i){var o,s;if("object"==typeof e){for(s in"string"!=typeof t&&(n=n||t,t=void 0),e)this.on(s,t,n,e[s],i);return this}if(null==n&&null==r?(r=t,n=t=void 0):null==r&&("string"==typeof t?(r=n,n=void 0):(r=n,n=t,t=void 0)),!1===r)r=G;else if(!r)return this;return 1===i&&(o=r,(r=function(e){return w().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=w.guid++)),this.each(function(){w.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,w(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=G),this.each(function(){w.event.remove(this,e,n,t)});for(i in e)this.off(i,t,e[i]);return this},trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?w.event.trigger(e,t,n,!0):void 0}});var J=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,K=/<([\w:]+)/,Z=/<|&#?\w+;/,ee=/<(?:script|style|link)/i,te=/checked\s*(?:[^=]|=\s*.checked.)/i,ne=/^$|\/(?:java|ecma)script/i,re=/^true\/(.*)/,ie=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,oe={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function se(e,t){return w.nodeName(e,"table")&&w.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ae(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ue(e){var t=re.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function le(e,t){for(var n=0,r=e.length;n<r;n++)F.set(e[n],"globalEval",!t||F.get(t[n],"globalEval"))}function ce(e,t){var n,r,i,o,s,a;if(1===t.nodeType){if(F.hasData(e)&&(o=F.access(e),s=F.set(t,o),a=o.events))for(i in delete s.handle,s.events={},a)for(n=0,r=a[i].length;n<r;n++)w.event.add(t,i,a[i][n]);P.hasData(e)&&(e=P.access(e),e=w.extend({},e),P.set(t,e))}}function fe(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&w.nodeName(e,t)?w.merge([e],n):n}oe.optgroup=oe.option,oe.tbody=oe.tfoot=oe.colgroup=oe.caption=oe.thead,oe.th=oe.td,w.extend({clone:function(e,t,n){var r,i,o,s,a,u,l,c=e.cloneNode(!0),f=w.contains(e.ownerDocument,e);if(!(v.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(s=fe(c),r=0,i=(o=fe(e)).length;r<i;r++)a=o[r],u=s[r],l=void 0,"input"===(l=u.nodeName.toLowerCase())&&B.test(a.type)?u.checked=a.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=a.defaultValue);if(t)if(n)for(o=o||fe(e),s=s||fe(c),r=0,i=o.length;r<i;r++)ce(o[r],s[r]);else ce(e,c);return 0<(s=fe(c,"script")).length&&le(s,!f&&fe(e,"script")),c},buildFragment:function(e,t,n,r){for(var i,o,s,a,u,l=t.createDocumentFragment(),c=[],f=0,p=e.length;f<p;f++)if((i=e[f])||0===i)if("object"===w.type(i))w.merge(c,i.nodeType?[i]:i);else if(Z.test(i)){for(o=o||l.appendChild(t.createElement("div")),s=(K.exec(i)||["",""])[1].toLowerCase(),s=oe[s]||oe._default,o.innerHTML=s[1]+i.replace(J,"<$1></$2>")+s[2],u=s[0];u--;)o=o.lastChild;w.merge(c,o.childNodes),(o=l.firstChild).textContent=""}else c.push(t.createTextNode(i));for(l.textContent="",f=0;i=c[f++];)if((!r||-1===w.inArray(i,r))&&(a=w.contains(i.ownerDocument,i),o=fe(l.appendChild(i),"script"),a&&le(o),n))for(u=0;i=o[u++];)ne.test(i.type||"")&&n.push(i);return l},cleanData:function(e){for(var t,n,r,i,o=w.event.special,s=0;void 0!==(n=e[s]);s++){if(w.acceptData(n)&&((i=n[F.expando])&&(t=F.cache[i]))){if(t.events)for(r in t.events)o[r]?w.event.remove(n,r):w.removeEvent(n,r,t.handle);F.cache[i]&&delete F.cache[i]}delete P.cache[n[P.expando]]}}}),w.fn.extend({text:function(e){return H(this,function(e){return void 0===e?w.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||se(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){var t;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(t=se(this,e)).insertBefore(e,t.firstChild)})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=e?w.filter(e,this):this,i=0;null!=(n=r[i]);i++)t||1!==n.nodeType||w.cleanData(fe(n)),n.parentNode&&(t&&w.contains(n.ownerDocument,n)&&le(fe(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(fe(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return H(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ee.test(e)&&!oe[(K.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(J,"<$1></$2>");try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(fe(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,w.cleanData(fe(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(n,r){n=g.apply([],n);var e,t,i,o,s,a,u=0,l=this.length,c=this,f=l-1,p=n[0],d=w.isFunction(p);if(d||1<l&&"string"==typeof p&&!v.checkClone&&te.test(p))return this.each(function(e){var t=c.eq(e);d&&(n[0]=p.call(this,e,t.html())),t.domManip(n,r)});if(l&&(t=(e=w.buildFragment(n,this[0].ownerDocument,!1,this)).firstChild,1===e.childNodes.length&&(e=t),t)){for(o=(i=w.map(fe(e,"script"),ae)).length;u<l;u++)s=e,u!==f&&(s=w.clone(s,!0,!0),o&&w.merge(i,fe(s,"script"))),r.call(this[u],s,u);if(o)for(a=i[i.length-1].ownerDocument,w.map(i,ue),u=0;u<o;u++)s=i[u],ne.test(s.type||"")&&!F.access(s,"globalEval")&&w.contains(a,s)&&(s.src?w._evalUrl&&w._evalUrl(s.src):w.globalEval(s.textContent.replace(ie,"")))}return this}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,s){w.fn[e]=function(e){for(var t,n=[],r=w(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),w(r[o])[s](t),a.apply(n,t.get());return this.pushStack(n)}});var pe,de={};function he(e,t){var t=w(t.createElement(e)).appendTo(t.body),n=h.getDefaultComputedStyle&&(n=h.getDefaultComputedStyle(t[0]))?n.display:w.css(t[0],"display");return t.detach(),n}function ge(e){var t=y,n=de[e];return n||("none"!==(n=he(e,t))&&n||((t=(pe=(pe||w("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),n=he(e,t),pe.detach()),de[e]=n),n}var me,ve,ye,xe,be,we=/^margin/,Te=new RegExp("^("+n+")(?!px)[a-z%]+$","i"),Ce=function(e){return(e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView:h).getComputedStyle(e,null)};function Ne(e,t,n){var r,i,o=e.style;return(n=n||Ce(e))&&(i=n.getPropertyValue(t)||n[t]),n&&(""!==i||w.contains(e.ownerDocument,e)||(i=w.style(e,t)),Te.test(i)&&we.test(t)&&(r=o.width,e=o.minWidth,t=o.maxWidth,o.minWidth=o.maxWidth=o.width=i,i=n.width,o.width=r,o.minWidth=e,o.maxWidth=t)),void 0!==i?i+"":i}function ke(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function Ee(){be.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",be.innerHTML="",ye.appendChild(xe);var e=h.getComputedStyle(be,null);me="1%"!==e.top,ve="4px"===e.width,ye.removeChild(xe)}ye=y.documentElement,xe=y.createElement("div"),(be=y.createElement("div")).style&&(be.style.backgroundClip="content-box",be.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===be.style.backgroundClip,xe.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",xe.appendChild(be),h.getComputedStyle&&w.extend(v,{pixelPosition:function(){return Ee(),me},boxSizingReliable:function(){return null==ve&&Ee(),ve},reliableMarginRight:function(){var e,t=be.appendChild(y.createElement("div"));return t.style.cssText=be.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",be.style.width="1px",ye.appendChild(xe),e=!parseFloat(h.getComputedStyle(t,null).marginRight),ye.removeChild(xe),be.removeChild(t),e}})),w.swap=function(e,t,n,r){var i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.apply(e,r||[]),t)e.style[i]=o[i];return r};var Se=/^(none|table(?!-c[ea]).+)/,De=new RegExp("^("+n+")(.*)$","i"),je=new RegExp("^([+-])=("+n+")","i"),Ae={position:"absolute",visibility:"hidden",display:"block"},Le={letterSpacing:"0",fontWeight:"400"},qe=["Webkit","O","Moz","ms"];function He(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),r=t,i=qe.length;i--;)if((t=qe[i]+n)in e)return t;return r}function Oe(e,t,n){var r=De.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Fe(e,t,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===t?1:0,s=0;o<4;o+=2)"margin"===n&&(s+=w.css(e,n+I[o],!0,i)),r?("content"===n&&(s-=w.css(e,"padding"+I[o],!0,i)),"margin"!==n&&(s-=w.css(e,"border"+I[o]+"Width",!0,i))):(s+=w.css(e,"padding"+I[o],!0,i),"padding"!==n&&(s+=w.css(e,"border"+I[o]+"Width",!0,i)));return s}function Pe(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Ce(e),s="border-box"===w.css(e,"boxSizing",!1,o);if(i<=0||null==i){if(((i=Ne(e,t,o))<0||null==i)&&(i=e.style[t]),Te.test(i))return i;r=s&&(v.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+Fe(e,t,n||(s?"border":"content"),r,o)+"px"}function Re(e,t){for(var n,r,i,o=[],s=0,a=e.length;s<a;s++)(r=e[s]).style&&(o[s]=F.get(r,"olddisplay"),n=r.style.display,t?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&$(r)&&(o[s]=F.access(r,"olddisplay",ge(r.nodeName)))):(i=$(r),"none"===n&&i||F.set(r,"olddisplay",i?n:w.css(r,"display"))));for(s=0;s<a;s++)(r=e[s]).style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[s]||"":"none"));return e}function Me(e,t,n,r,i){return new Me.prototype.init(e,t,n,r,i)}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){e=Ne(e,"opacity");return""===e?"1":e}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=w.camelCase(t),u=e.style;return t=w.cssProps[a]||(w.cssProps[a]=He(u,a)),s=w.cssHooks[t]||w.cssHooks[a],void 0===n?s&&"get"in s&&void 0!==(i=s.get(e,!1,r))?i:u[t]:("string"===(o=typeof n)&&(i=je.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(w.css(e,t)),o="number"),void(null!=n&&n==n&&("number"!==o||w.cssNumber[a]||(n+="px"),v.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,r))||(u[t]=n))))}},css:function(e,t,n,r){var i,o=w.camelCase(t);return t=w.cssProps[o]||(w.cssProps[o]=He(e.style,o)),(o=w.cssHooks[t]||w.cssHooks[o])&&"get"in o&&(i=o.get(e,!0,n)),void 0===i&&(i=Ne(e,t,r)),"normal"===i&&t in Le&&(i=Le[t]),""===n||n?(t=parseFloat(i),!0===n||w.isNumeric(t)?t||0:i):i}}),w.each(["height","width"],function(e,i){w.cssHooks[i]={get:function(e,t,n){return t?Se.test(w.css(e,"display"))&&0===e.offsetWidth?w.swap(e,Ae,function(){return Pe(e,i,n)}):Pe(e,i,n):void 0},set:function(e,t,n){var r=n&&Ce(e);return Oe(0,t,n?Fe(e,i,n,"border-box"===w.css(e,"boxSizing",!1,r),r):0)}}}),w.cssHooks.marginRight=ke(v.reliableMarginRight,function(e,t){return t?w.swap(e,{display:"inline-block"},Ne,[e,"marginRight"]):void 0}),w.each({margin:"",padding:"",border:"Width"},function(i,o){w.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+I[t]+o]=r[t]||r[t-2]||r[0];return n}},we.test(i)||(w.cssHooks[i+o].set=Oe)}),w.fn.extend({css:function(e,t){return H(this,function(e,t,n){var r,i,o={},s=0;if(w.isArray(t)){for(r=Ce(e),i=t.length;s<i;s++)o[t[s]]=w.css(e,t[s],!1,r);return o}return void 0!==n?w.style(e,t,n):w.css(e,t)},e,t,1<arguments.length)},show:function(){return Re(this,!0)},hide:function(){return Re(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){$(this)?w(this).show():w(this).hide()})}}),(w.Tween=Me).prototype={constructor:Me,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(w.cssNumber[n]?"":"px")},cur:function(){var e=Me.propHooks[this.prop];return(e&&e.get?e:Me.propHooks._default).get(this)},run:function(e){var t=Me.propHooks[this.prop];return this.pos=e=this.options.duration?w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(t&&t.set?t:Me.propHooks._default).set(this),this}},Me.prototype.init.prototype=Me.prototype,Me.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[w.cssProps[e.prop]]||w.cssHooks[e.prop])?w.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Me.propHooks.scrollTop=Me.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},w.fx=Me.prototype.init,w.fx.step={};var We,$e,Ie=/^(?:toggle|show|hide)$/,Be=new RegExp("^(?:([+-])=|)("+n+")([a-z%]*)$","i"),_e=/queueHooks$/,ze=[function(t,e,n){var r,i,o,s,a,u,l,c=this,f={},p=t.style,d=t.nodeType&&$(t),h=F.get(t,"fxshow");for(r in n.queue||(null==(a=w._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,c.always(function(){c.always(function(){a.unqueued--,w.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],l=w.css(t,"display"),"inline"===("none"===l?F.get(t,"olddisplay")||ge(t.nodeName):l)&&"none"===w.css(t,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",c.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),e)if(i=e[r],Ie.exec(i)){if(delete e[r],o=o||"toggle"===i,i===(d?"hide":"show")){if("show"!==i||!h||void 0===h[r])continue;d=!0}f[r]=h&&h[r]||w.style(t,r)}else l=void 0;if(w.isEmptyObject(f))"inline"===("none"===l?ge(t.nodeName):l)&&(p.display=l);else for(r in h?"hidden"in h&&(d=h.hidden):h=F.access(t,"fxshow",{}),o&&(h.hidden=!d),d?w(t).show():c.done(function(){w(t).hide()}),c.done(function(){for(var e in F.remove(t,"fxshow"),f)w.style(t,e,f[e])}),f)s=Ye(d?h[r]:0,r,c),r in h||(h[r]=s.start,d&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}],Xe={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),t=Be.exec(t),i=t&&t[3]||(w.cssNumber[e]?"":"px"),o=(w.cssNumber[e]||"px"!==i&&+r)&&Be.exec(w.css(n.elem,e)),s=1,a=20;if(o&&o[3]!==i)for(i=i||o[3],t=t||[],o=+r||1;s=s||".5",o/=s,w.style(n.elem,e,o+i),s!==(s=n.cur()/r)&&1!==s&&--a;);return t&&(o=n.start=+o||+r||0,n.unit=i,n.end=t[1]?o+(t[1]+1)*t[2]:+t[2]),n}]};function Ue(){return setTimeout(function(){We=void 0}),We=w.now()}function Ve(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=I[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function Ye(e,t,n){for(var r,i=(Xe[t]||[]).concat(Xe["*"]),o=0,s=i.length;o<s;o++)if(r=i[o].call(n,t,e))return r}function Ge(i,e,t){var n,o,r=0,s=ze.length,a=w.Deferred().always(function(){delete u.elem}),u=function(){if(o)return!1;for(var e=We||Ue(),e=Math.max(0,l.startTime+l.duration-e),t=1-(e/l.duration||0),n=0,r=l.tweens.length;n<r;n++)l.tweens[n].run(t);return a.notifyWith(i,[l,t,e]),t<1&&r?e:(a.resolveWith(i,[l]),!1)},l=a.promise({elem:i,props:w.extend({},e),opts:w.extend(!0,{specialEasing:{}},t),originalProperties:e,originalOptions:t,startTime:We||Ue(),duration:t.duration,tweens:[],createTween:function(e,t){e=w.Tween(i,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(e),e},stop:function(e){var t=0,n=e?l.tweens.length:0;if(o)return this;for(o=!0;t<n;t++)l.tweens[t].run(1);return e?a.resolveWith(i,[l,e]):a.rejectWith(i,[l,e]),this}}),c=l.props;for(function(e,t){var n,r,i,o,s;for(n in e)if(r=w.camelCase(n),i=t[r],o=e[n],w.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),s=w.cssHooks[r],s&&"expand"in s)for(n in o=s.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<s;r++)if(n=ze[r].call(l,i,c,l.opts))return n;return w.map(c,Ye,l),w.isFunction(l.opts.start)&&l.opts.start.call(i,l),w.fx.timer(w.extend(u,{elem:i,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}w.Animation=w.extend(Ge,{tweener:function(e,t){for(var n,r=0,i=(e=w.isFunction(e)?(t=e,["*"]):e.split(" ")).length;r<i;r++)n=e[r],Xe[n]=Xe[n]||[],Xe[n].unshift(t)},prefilter:function(e,t){t?ze.unshift(e):ze.push(e)}}),w.speed=function(e,t,n){var r=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||w.isFunction(e)&&e,duration:e,easing:n&&t||t&&!w.isFunction(t)&&t};return r.duration=w.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in w.fx.speeds?w.fx.speeds[r.duration]:w.fx.speeds._default,null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){w.isFunction(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.fn.extend({fadeTo:function(e,t,n,r){return this.filter($).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=w.isEmptyObject(t),o=w.speed(e,n,r),r=function(){var e=Ge(this,w.extend({},t),o);(i||F.get(this,"finish"))&&e.stop(!0)};return r.finish=r,i||!1===o.queue?this.each(r):this.queue(o.queue,r)},stop:function(i,e,o){function s(e){var t=e.stop;delete e.stop,t(o)}return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&!1!==i&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=w.timers,r=F.get(this);if(t)r[t]&&r[t].stop&&s(r[t]);else for(t in r)r[t]&&r[t].stop&&_e.test(t)&&s(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||w.dequeue(this,i)})},finish:function(s){return!1!==s&&(s=s||"fx"),this.each(function(){var e,t=F.get(this),n=t[s+"queue"],r=t[s+"queueHooks"],i=w.timers,o=n?n.length:0;for(t.finish=!0,w.queue(this,s,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===s&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),w.each(["toggle","show","hide"],function(e,r){var i=w.fn[r];w.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(Ve(r,!0),e,t,n)}}),w.each({slideDown:Ve("show"),slideUp:Ve("hide"),slideToggle:Ve("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){w.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(We=w.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),We=void 0},w.fx.timer=function(e){w.timers.push(e),e()?w.fx.start():w.timers.pop()},w.fx.interval=13,w.fx.start=function(){$e=$e||setInterval(w.fx.tick,w.fx.interval)},w.fx.stop=function(){clearInterval($e),$e=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(r,e){return r=w.fx&&w.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=setTimeout(e,r);t.stop=function(){clearTimeout(n)}})},d=y.createElement("input"),s=y.createElement("select"),n=s.appendChild(y.createElement("option")),d.type="checkbox",v.checkOn=""!==d.value,v.optSelected=n.selected,s.disabled=!0,v.optDisabled=!n.disabled,(d=y.createElement("input")).value="t",d.type="radio",v.radioValue="t"===d.value;var Qe,Je=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return H(this,w.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute==_?w.prop(e,t,n):(1===o&&w.isXMLDoc(e)||(t=t.toLowerCase(),r=w.attrHooks[t]||(w.expr.match.bool.test(t)?Qe:void 0)),void 0===n?r&&"get"in r&&null!==(i=r.get(e,t))?i:null==(i=w.find.attr(e,t))?void 0:i:null!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):void w.removeAttr(e,t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(A);if(o&&1===e.nodeType)for(;n=o[i++];)r=w.propFix[n]||n,w.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!v.radioValue&&"radio"===t&&w.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),Qe={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,t){var o=Je[t]||w.find.attr;Je[t]=function(e,t,n){var r,i;return n||(i=Je[t],Je[t]=r,r=null!=o(e,t,n)?t.toLowerCase():null,Je[t]=i),r}});var Ke=/^(?:input|select|textarea|button)$/i;w.fn.extend({prop:function(e,t){return H(this,w.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[w.propFix[e]||e]})}}),w.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,n){var r,i,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return(1!==o||!w.isXMLDoc(e))&&(t=w.propFix[t]||t,i=w.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||Ke.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),v.optSelected||(w.propHooks.selected={get:function(e){e=e.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this});var Ze=/[\t\r\n\f]/g;w.fn.extend({addClass:function(t){var e,n,r,i,o,s,a="string"==typeof t&&t,u=0,l=this.length;if(w.isFunction(t))return this.each(function(e){w(this).addClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(A)||[];u<l;u++)if(r=1===(n=this[u]).nodeType&&(n.className?(" "+n.className+" ").replace(Ze," "):" ")){for(o=0;i=e[o++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");s=w.trim(r),n.className!==s&&(n.className=s)}return this},removeClass:function(t){var e,n,r,i,o,s,a=0===arguments.length||"string"==typeof t&&t,u=0,l=this.length;if(w.isFunction(t))return this.each(function(e){w(this).removeClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(A)||[];u<l;u++)if(r=1===(n=this[u]).nodeType&&(n.className?(" "+n.className+" ").replace(Ze," "):"")){for(o=0;i=e[o++];)for(;0<=r.indexOf(" "+i+" ");)r=r.replace(" "+i+" "," ");s=t?w.trim(r):"",n.className!==s&&(n.className=s)}return this},toggleClass:function(i,t){var o=typeof i;return"boolean"==typeof t&&"string"==o?t?this.addClass(i):this.removeClass(i):this.each(w.isFunction(i)?function(e){w(this).toggleClass(i.call(this,e,this.className,t),t)}:function(){if("string"==o)for(var e,t=0,n=w(this),r=i.match(A)||[];e=r[t++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else o!=_&&"boolean"!=o||(this.className&&F.set(this,"__className__",this.className),this.className=!this.className&&!1!==i&&F.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;n<r;n++)if(1===this[n].nodeType&&0<=(" "+this[n].className+" ").replace(Ze," ").indexOf(t))return!0;return!1}});var et=/\r/g;w.fn.extend({val:function(t){var n,e,r,i=this[0];return arguments.length?(r=w.isFunction(t),this.each(function(e){1===this.nodeType&&(null==(e=r?t.call(this,e,w(this).val()):t)?e="":"number"==typeof e?e+="":w.isArray(e)&&(e=w.map(e,function(e){return null==e?"":e+""})),(n=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,e,"value")||(this.value=e))})):i?(n=w.valHooks[i.type]||w.valHooks[i.nodeName.toLowerCase()])&&"get"in n&&void 0!==(e=n.get(i,"value"))?e:"string"==typeof(e=i.value)?e.replace(et,""):null==e?"":e:void 0}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:w.trim(w.text(e))}},select:{get:function(e){for(var t,n=e.options,r=e.selectedIndex,i="select-one"===e.type||r<0,o=i?null:[],s=i?r+1:n.length,a=r<0?s:i?r:0;a<s;a++)if(!(!(t=n[a]).selected&&a!==r||(v.optDisabled?t.disabled:null!==t.getAttribute("disabled"))||t.parentNode.disabled&&w.nodeName(t.parentNode,"optgroup"))){if(t=w(t).val(),i)return t;o.push(t)}return o},set:function(e,t){for(var n,r,i=e.options,o=w.makeArray(t),s=i.length;s--;)((r=i[s]).selected=0<=w.inArray(r.value,o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,t){return w.isArray(t)?e.checked=0<=w.inArray(w(e).val(),t):void 0}},v.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),w.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,n){w.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var tt=w.now(),nt=/\?/;w.parseJSON=function(e){return JSON.parse(e+"")},w.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+e),t};var rt=/#.*$/,it=/([?&])_=[^&]*/,ot=/^(.*?):[ \t]*([^\r\n]*)$/gm,st=/^(?:GET|HEAD)$/,at=/^\/\//,ut=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,lt={},ct={},ft="*/".concat("*"),pt=h.location.href,dt=ut.exec(pt.toLowerCase())||[];function ht(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(A)||[];if(w.isFunction(t))for(;n=i[r++];)"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function gt(t,r,i,o){var s={},a=t===ct;function u(e){var n;return s[e]=!0,w.each(t[e]||[],function(e,t){t=t(r,i,o);return"string"!=typeof t||a||s[t]?a?!(n=t):void 0:(r.dataTypes.unshift(t),u(t),!1)}),n}return u(r.dataTypes[0])||!s["*"]&&u("*")}function mt(e,t){var n,r,i=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r=r||{})[n]=t[n]);return r&&w.extend(!0,e,r),e}w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:pt,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(dt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ft,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":w.parseJSON,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?mt(mt(e,w.ajaxSettings),t):mt(w.ajaxSettings,e)},ajaxPrefilter:ht(lt),ajaxTransport:ht(ct),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var u,l,c,n,f,p,r,d=w.ajaxSetup({},t),h=d.context||d,g=d.context&&(h.nodeType||h.jquery)?w(h):w.event,m=w.Deferred(),v=w.Callbacks("once memory"),y=d.statusCode||{},i={},o={},x=0,s="canceled",b={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!n)for(n={};t=ot.exec(c);)n[t[1].toLowerCase()]=t[2];t=n[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?c:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=o[n]=o[n]||e,i[e]=t),this},overrideMimeType:function(e){return x||(d.mimeType=e),this},statusCode:function(e){if(e)if(x<2)for(var t in e)y[t]=[y[t],e[t]];else b.always(e[b.status]);return this},abort:function(e){e=e||s;return u&&u.abort(e),a(0,e),this}};if(m.promise(b).complete=v.add,b.success=b.done,b.error=b.fail,d.url=((e||d.url||pt)+"").replace(rt,"").replace(at,dt[1]+"//"),d.type=t.method||t.type||d.method||d.type,d.dataTypes=w.trim(d.dataType||"*").toLowerCase().match(A)||[""],null==d.crossDomain&&(e=ut.exec(d.url.toLowerCase()),d.crossDomain=!(!e||e[1]===dt[1]&&e[2]===dt[2]&&(e[3]||("http:"===e[1]?"80":"443"))===(dt[3]||("http:"===dt[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=w.param(d.data,d.traditional)),gt(lt,d,t,b),2===x)return b;for(r in(p=w.event&&d.global)&&0==w.active++&&w.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!st.test(d.type),l=d.url,d.hasContent||(d.data&&(l=d.url+=(nt.test(l)?"&":"?")+d.data,delete d.data),!1===d.cache&&(d.url=it.test(l)?l.replace(it,"$1_="+tt++):l+(nt.test(l)?"&":"?")+"_="+tt++)),d.ifModified&&(w.lastModified[l]&&b.setRequestHeader("If-Modified-Since",w.lastModified[l]),w.etag[l]&&b.setRequestHeader("If-None-Match",w.etag[l])),(d.data&&d.hasContent&&!1!==d.contentType||t.contentType)&&b.setRequestHeader("Content-Type",d.contentType),b.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+ft+"; q=0.01":""):d.accepts["*"]),d.headers)b.setRequestHeader(r,d.headers[r]);if(d.beforeSend&&(!1===d.beforeSend.call(h,b,d)||2===x))return b.abort();for(r in s="abort",{success:1,error:1,complete:1})b[r](d[r]);if(u=gt(ct,d,t,b)){b.readyState=1,p&&g.trigger("ajaxSend",[b,d]),d.async&&0<d.timeout&&(f=setTimeout(function(){b.abort("timeout")},d.timeout));try{x=1,u.send(i,a)}catch(e){if(!(x<2))throw e;a(-1,e)}}else a(-1,"No Transport");function a(e,t,n,r){var i,o,s,a=t;2!==x&&(x=2,f&&clearTimeout(f),u=void 0,c=r||"",b.readyState=0<e?4:0,r=200<=e&&e<300||304===e,n&&(s=function(e,t,n){for(var r,i,o,s,a=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s=s||i}o=o||s}return o?(o!==u[0]&&u.unshift(o),n[o]):void 0}(d,b,n)),s=function(e,t,n,r){var i,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(s=l[u+" "+o]||l["* "+o]))for(i in l)if(a=i.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){!0===s?s=l[i]:!0!==l[i]&&(o=a[0],c.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(d,s,b,r),r?(d.ifModified&&((n=b.getResponseHeader("Last-Modified"))&&(w.lastModified[l]=n),(n=b.getResponseHeader("etag"))&&(w.etag[l]=n)),204===e||"HEAD"===d.type?a="nocontent":304===e?a="notmodified":(a=s.state,i=s.data,r=!(o=s.error))):(o=a,!e&&a||(a="error",e<0&&(e=0))),b.status=e,b.statusText=(t||a)+"",r?m.resolveWith(h,[i,a,b]):m.rejectWith(h,[b,a,o]),b.statusCode(y),y=void 0,p&&g.trigger(r?"ajaxSuccess":"ajaxError",[b,d,r?i:o]),v.fireWith(h,[b,a]),p&&(g.trigger("ajaxComplete",[b,d]),--w.active||w.event.trigger("ajaxStop")))}return b},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,i){w[i]=function(e,t,n,r){return w.isFunction(t)&&(r=r||n,n=t,t=void 0),w.ajax({url:e,type:i,dataType:r,data:t,success:n})}}),w._evalUrl=function(e){return w.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},w.fn.extend({wrapAll:function(t){var e;return w.isFunction(t)?this.each(function(e){w(this).wrapAll(t.call(this,e))}):(this[0]&&(e=w(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(n){return this.each(w.isFunction(n)?function(e){w(this).wrapInner(n.call(this,e))}:function(){var e=w(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=w.isFunction(t);return this.each(function(e){w(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){w.nodeName(this,"body")||w(this).replaceWith(this.childNodes)}).end()}}),w.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},w.expr.filters.visible=function(e){return!w.expr.filters.hidden(e)};var vt=/%20/g,yt=/\[\]$/,xt=/\r?\n/g,bt=/^(?:submit|button|image|reset|file)$/i,wt=/^(?:input|select|textarea|keygen)/i;w.param=function(e,t){function n(e,t){t=w.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)}var r,i=[];if(void 0===t&&(t=w.ajaxSettings&&w.ajaxSettings.traditional),w.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){n(this.name,this.value)});else for(r in e)!function n(r,e,i,o){if(w.isArray(e))w.each(e,function(e,t){i||yt.test(r)?o(r,t):n(r+"["+("object"==typeof t?e:"")+"]",t,i,o)});else if(i||"object"!==w.type(e))o(r,e);else for(var t in e)n(r+"["+t+"]",e[t],i,o)}(r,e[r],t,n);return i.join("&").replace(vt,"+")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&wt.test(this.nodeName)&&!bt.test(e)&&(this.checked||!B.test(e))}).map(function(e,t){var n=w(this).val();return null==n?null:w.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(xt,"\r\n")}}):{name:t.name,value:n.replace(xt,"\r\n")}}).get()}}),w.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var Tt=0,Ct={},Nt={0:200,1223:204},kt=w.ajaxSettings.xhr();h.attachEvent&&h.attachEvent("onunload",function(){for(var e in Ct)Ct[e]()}),v.cors=!!kt&&"withCredentials"in kt,v.ajax=kt=!!kt,w.ajaxTransport(function(o){var s;return v.cors||kt&&!o.crossDomain?{send:function(e,t){var n,r=o.xhr(),i=++Tt;if(r.open(o.type,o.url,o.async,o.username,o.password),o.xhrFields)for(n in o.xhrFields)r[n]=o.xhrFields[n];for(n in o.mimeType&&r.overrideMimeType&&r.overrideMimeType(o.mimeType),o.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);s=function(e){return function(){s&&(delete Ct[i],s=r.onload=r.onerror=null,"abort"===e?r.abort():"error"===e?t(r.status,r.statusText):t(Nt[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=s(),r.onerror=s("error"),s=Ct[i]=s("abort");try{r.send(o.hasContent&&o.data||null)}catch(e){if(s)throw e}},abort:function(){s&&s()}}:void 0}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),w.ajaxTransport("script",function(n){var r,i;if(n.crossDomain)return{send:function(e,t){r=w("<script>").prop({async:!0,charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),y.head.appendChild(r[0])},abort:function(){i&&i()}}});var Et=[],St=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Et.pop()||w.expando+"_"+tt++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,s=!1!==e.jsonp&&(St.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&St.test(e.data)&&"data");return s||"jsonp"===e.dataTypes[0]?(r=e.jsonpCallback=w.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(St,"$1"+r):!1!==e.jsonp&&(e.url+=(nt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||w.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=h[r],h[r]=function(){o=arguments},n.always(function(){h[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Et.push(r)),o&&w.isFunction(i)&&i(o[0]),o=i=void 0}),"script"):void 0}),w.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||y;var r=b.exec(e),n=!n&&[];return r?[t.createElement(r[1])]:(r=w.buildFragment([e],t,n),n&&n.length&&w(n).remove(),w.merge([],r.childNodes))};var Dt=w.fn.load;w.fn.load=function(e,t,n){if("string"!=typeof e&&Dt)return Dt.apply(this,arguments);var r,i,o,s=this,a=e.indexOf(" ");return 0<=a&&(r=w.trim(e.slice(a)),e=e.slice(0,a)),w.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<s.length&&w.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?w("<div>").append(w.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.expr.filters.animated=function(t){return w.grep(w.timers,function(e){return t===e.elem}).length};var jt=h.document.documentElement;function At(e){return w.isWindow(e)?e:9===e.nodeType&&e.defaultView}w.offset={setOffset:function(e,t,n){var r,i,o,s,a=w.css(e,"position"),u=w(e),l={};"static"===a&&(e.style.position="relative"),o=u.offset(),r=w.css(e,"top"),s=w.css(e,"left"),s=("absolute"===a||"fixed"===a)&&-1<(r+s).indexOf("auto")?(i=(a=u.position()).top,a.left):(i=parseFloat(r)||0,parseFloat(s)||0),w.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(l.top=t.top-o.top+i),null!=t.left&&(l.left=t.left-o.left+s),"using"in t?t.using.call(e,l):u.css(l)}},w.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){w.offset.setOffset(this,t,e)});var e,n=this[0],r={top:0,left:0},i=n&&n.ownerDocument;return i?(e=i.documentElement,w.contains(e,n)?(typeof n.getBoundingClientRect!=_&&(r=n.getBoundingClientRect()),i=At(i),{top:r.top+i.pageYOffset-e.clientTop,left:r.left+i.pageXOffset-e.clientLeft}):r):void 0},position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===w.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),w.nodeName(e[0],"html")||(r=e.offset()),r.top+=w.css(e[0],"borderTopWidth",!0),r.left+=w.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-w.css(n,"marginTop",!0),left:t.left-r.left-w.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||jt;e&&!w.nodeName(e,"html")&&"static"===w.css(e,"position");)e=e.offsetParent;return e||jt})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;w.fn[t]=function(e){return H(this,function(e,t,n){var r=At(e);return void 0===n?r?r[i]:e[t]:void(r?r.scrollTo(o?h.pageXOffset:n,o?n:h.pageYOffset):e[t]=n)},t,e,arguments.length,null)}}),w.each(["top","left"],function(e,n){w.cssHooks[n]=ke(v.pixelPosition,function(e,t){return t?(t=Ne(e,n),Te.test(t)?w(e).position()[n]+"px":t):void 0})}),w.each({Height:"height",Width:"width"},function(o,s){w.each({padding:"inner"+o,content:s,"":"outer"+o},function(r,e){w.fn[e]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return H(this,function(e,t,n){var r;return w.isWindow(e)?e.document.documentElement["client"+o]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+o],r["scroll"+o],e.body["offset"+o],r["offset"+o],r["client"+o])):void 0===n?w.css(e,t,i):w.style(e,t,n,i)},s,n?e:void 0,n,null)}})}),w.fn.size=function(){return this.length},w.fn.andSelf=w.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return w});var Lt=h.jQuery,qt=h.$;return w.noConflict=function(e){return h.$===w&&(h.$=qt),e&&h.jQuery===w&&(h.jQuery=Lt),w},typeof e==_&&(h.jQuery=h.$=w),w})</script><script>!function(){function t(t,e){o[t]=e}var o={};t("jquery",function(){return jQuery}),t("popup",function(t){function s(){this.destroyed=!1,this.__popup=m("<div />").attr({tabindex:"-1"}).css({display:"none",position:"absolute",outline:0}).html(this.innerHTML).appendTo("body"),this.__backdrop=m("<div />"),this.node=this.__popup[0],this.backdrop=this.__backdrop[0],0}var m=t("jquery"),o=!("minWidth"in m("html")[0].style),n=!o;return m.extend(s.prototype,{node:null,backdrop:null,fixed:!1,destroyed:!0,open:!1,returnValue:"",autofocus:!0,align:"bottom left",backdropBackground:"#000",backdropOpacity:.7,innerHTML:"",className:"ui-popup",show:function(t){if(this.destroyed)return this;var e=this,i=this.__popup;return this.__activeElement=this.__getActive(),this.open=!0,this.follow=t||this.follow,this.__ready||(i.addClass(this.className),this.modal&&this.__lock(),i.html()||i.html(this.innerHTML),o||m(window).on("resize",this.__onresize=function(){e.reset()}),this.__ready=!0),i.addClass(this.className+"-show").attr("role",this.modal?"alertdialog":"dialog").css("position",this.fixed?"fixed":"absolute").show(),this.__backdrop.show(),this.reset().focus(),this.__dispatchEvent("show"),this},showModal:function(){return this.modal=!0,this.show.apply(this,arguments)},close:function(t){return!this.destroyed&&this.open&&(void 0!==t&&(this.returnValue=t),this.__popup.hide().removeClass(this.className+"-show"),this.__backdrop.hide(),this.open=!1,this.blur(),this.__dispatchEvent("close")),this},remove:function(){if(this.destroyed)return this;for(var t in this.__dispatchEvent("beforeremove"),s.current===this&&(s.current=null),this.__unlock(),this.__popup.remove(),this.__backdrop.remove(),o||m(window).off("resize",this.__onresize),this.__dispatchEvent("remove"),this)delete this[t];return this},reset:function(){var t=this.follow;return t?this.__follow(t):this.__center(),this.__dispatchEvent("reset"),this},focus:function(){var t=this.node,e=s.current;return e&&e!==this&&e.blur(!1),m.contains(t,this.__getActive())||(e=this.__popup.find("[autofocus]")[0],!this._autofocus&&e?this._autofocus=!0:e=t,this.__focus(e)),(s.current=this).__popup.addClass(this.className+"-focus"),this.__zIndex(),this.__dispatchEvent("focus"),this},blur:function(){var t=this.__activeElement;return!1!==arguments[0]&&this.__focus(t),this._autofocus=!1,this.__popup.removeClass(this.className+"-focus"),this.__dispatchEvent("blur"),this},addEventListener:function(t,e){return this.__getEventListener(t).push(e),this},removeEventListener:function(t,e){for(var i=this.__getEventListener(t),o=0;o<i.length;o++)e===i[o]&&i.splice(o--,1);return this},__getEventListener:function(t){var e=this.__listener;return(e=e||(this.__listener={}))[t]||(e[t]=[]),e[t]},__dispatchEvent:function(t){var e=this.__getEventListener(t);this["on"+t]&&this["on"+t]();for(var i=0;i<e.length;i++)e[i].call(this)},__focus:function(t){try{this.autofocus&&!/^iframe$/i.test(t.nodeName)&&t.focus()}catch(t){}},__getActive:function(){try{var t=document.activeElement,e=t.contentDocument;return e&&e.activeElement||t}catch(t){}},__zIndex:function(){var t=s.zIndex++;this.__popup.css("zIndex",t),this.__backdrop.css("zIndex",t-1),this.zIndex=t},__center:function(){var t=this.__popup,e=m(window),i=m(document),o=this.fixed,s=o?0:i.scrollLeft(),o=o?0:i.scrollTop(),i=e.width(),e=e.height(),i=(i-t.width())/2+s,e=382*(e-t.height())/1e3+o,t=t[0].style;t.left=Math.max(parseInt(i),s)+"px",t.top=Math.max(parseInt(e),o)+"px"},__follow:function(t){var e=t.parentNode&&m(t),i=this.__popup;if(this.__followSkin&&i.removeClass(this.__followSkin),e){var o=e.offset();if(o.left*o.top<0)return this.__center()}var s=this.fixed,n=m(window),a=m(document),r=n.width(),c=n.height(),l=a.scrollLeft(),d=a.scrollTop(),h=i.width(),u=i.height(),p=e?e.outerWidth():0,o=e?e.outerHeight():0,n=this.__offset(t),a=n.left,t=n.top,n=s?a-l:a,a=s?t-d:t,t=s?0:l,l=s?0:d,s=t+r-h,d=l+c-u,r={},f=this.align.split(" "),c=this.className+"-",_={top:"bottom",bottom:"top",left:"right",right:"left"},v={top:"top",bottom:"top",left:"left",right:"left"},g=[{top:a-u,bottom:a+o,left:n-h,right:n+p},{top:a,bottom:a-u+o,left:n,right:n-h+p}],u={left:n+p/2-h/2,top:a+o/2-u/2},b={left:[t,s],top:[l,d]};m.each(f,function(t,e){g[t][e]>b[v[e]][1]&&(e=f[t]=_[e]),g[t][e]<b[v[e]][0]&&(f[t]=_[e])}),f[1]||(v[f[1]]="left"===v[f[0]]?"top":"left",g[1][f[1]]=u[v[f[1]]]),c+=f.join("-")+" "+this.className+"-follow",this.__followSkin=c,e&&i.addClass(c),r[v[f[0]]]=parseInt(g[0][f[0]]),r[v[f[1]]]=parseInt(g[1][f[1]]),i.css(r)},__offset:function(t){var e=t.parentNode,i=e?m(t).offset():{left:t.pageX,top:t.pageY},o=(t=e?t:t.target).ownerDocument,s=o.defaultView||o.parentWindow;if(s==window)return i;e=s.frameElement,t=m(o),s=t.scrollLeft(),o=t.scrollTop(),t=m(e).offset(),e=t.left,t=t.top;return{left:i.left+e-s,top:i.top+t-o}},__lock:function(){var t=this,e=this.__popup,i=this.__backdrop,o={position:"fixed",left:0,top:0,width:"100%",height:"100%",overflow:"hidden",userSelect:"none",opacity:0,background:this.backdropBackground};e.addClass(this.className+"-modal"),s.zIndex=s.zIndex+2,this.__zIndex(),n||m.extend(o,{position:"absolute",width:m(window).width()+"px",height:m(document).height()+"px"}),i.css(o).animate({opacity:this.backdropOpacity},150).insertAfter(e).attr({tabindex:"0"}).on("focus",function(){t.focus()})},__unlock:function(){this.modal&&(this.__popup.removeClass(this.className+"-modal"),this.__backdrop.remove(),delete this.modal)}}),s.zIndex=1024,s.current=null,s}),t("dialog-config",{content:'<span class="ui-dialog-loading">Loading..</span>',title:"",statusbar:"",button:null,ok:null,cancel:null,okValue:"ok",cancelValue:"cancel",cancelDisplay:!0,width:"",height:"",padding:"",skin:"",quickClose:!1,cssUri:"../css/ui-dialog.css",innerHTML:'<div i="dialog" class="ui-dialog"><div class="ui-dialog-arrow-a"></div><div class="ui-dialog-arrow-b"></div><table class="ui-dialog-grid"><tr><td i="header" class="ui-dialog-header"><button i="close" class="ui-dialog-close">&#215;</button><div i="title" class="ui-dialog-title"></div></td></tr><tr><td i="body" class="ui-dialog-body"><div i="content" class="ui-dialog-content"></div></td></tr><tr><td i="footer" class="ui-dialog-footer"><div i="statusbar" class="ui-dialog-statusbar"></div><div i="button" class="ui-dialog-button"></div></td></tr></table></div>'}),t("dialog",function(t){var a=t("jquery"),n=t("popup"),e=t("dialog-config"),i=e.cssUri;!i||(t=t[t.toUrl?"toUrl":"resolve"])&&(i='<link rel="stylesheet" href="'+t(i)+'" />',a("base")[0]?a("base").before(i):a("head").append(i));var r=0,c=+new Date,i=!("minWidth"in a("html")[0].style),l="createTouch"in document&&!("onmousemove"in document)||/(iPhone|iPad|iPod)/i.test(navigator.userAgent),d=!i&&!l,h=function(t,e,i){var o=t=t||{};"string"!=typeof t&&1!==t.nodeType||(t={content:t,fixed:!l}),(t=a.extend(!0,{},h.defaults,t))._=o;var s=t.id=t.id||c+r,n=h.get(s);return n?n.focus():(d||(t.fixed=!1),t.quickClose&&(t.modal=!0,o.backdropOpacity||(t.backdropOpacity=0)),a.isArray(t.button)||(t.button=[]),void 0!==i&&(t.cancel=i),t.cancel&&t.button.push({id:"cancel",value:t.cancelValue,callback:t.cancel,display:t.cancelDisplay}),void 0!==e&&(t.ok=e),t.ok&&t.button.push({id:"ok",value:t.okValue,callback:t.ok,autofocus:!0}),h.list[s]=new h.create(t))},i=function(){};i.prototype=n.prototype;i=h.prototype=new i;return h.create=function(t){var s=this;a.extend(this,new n);var e=a(this.node).html(t.innerHTML);return this.options=t,this._popup=e,a.each(t,function(t,e){"function"==typeof s[t]?s[t](e):s[t]=e}),t.zIndex&&(n.zIndex=t.zIndex),e.attr({"aria-labelledby":this._$("title").attr("id","title:"+this.id).attr("id"),"aria-describedby":this._$("content").attr("id","content:"+this.id).attr("id")}),this._$("close").css("display",!1===this.cancel?"none":"").attr("title",this.cancelValue).on("click",function(t){s._trigger("cancel"),t.preventDefault()}),this._$("dialog").addClass(this.skin),this._$("body").css("padding",this.padding),t.quickClose&&a(this.backdrop).on("onmousedown"in document?"mousedown":"click",function(){return s._trigger("cancel"),!1}),this._esc=function(t){var e=t.target,i=e.nodeName,o=n.current===s,t=t.keyCode;!o||/^input|textarea$/i.test(i)&&"button"!==e.type||27===t&&s._trigger("cancel")},a(document).on("keydown",this._esc),this.addEventListener("remove",function(){a(document).off("keydown",this._esc),delete h.list[this.id]}),r++,h.oncreate(this),this},h.create.prototype=i,a.extend(i,{content:function(t){return this._$("content").empty("")["object"==typeof t?"append":"html"](t),this.reset()},title:function(t){return this._$("title").text(t),this._$("header")[t?"show":"hide"](),this},width:function(t){return this._$("content").css("width",t),this.reset()},height:function(t){return this._$("content").css("height",t),this.reset()},button:function(t){t=t||[];var o=this,s="",n=0;return this.callbacks={},"string"==typeof t?(s=t,n++):a.each(t,function(t,e){e.id=e.id||e.value,o.callbacks[e.id]=e.callback;var i="";!1===e.display?i=' style="display:none"':n++,s+='<button type="button" data-id="'+e.id+'"'+i+(e.disabled?" disabled":"")+(e.autofocus?' autofocus class="ui-dialog-autofocus"':"")+">"+e.value+"</button>"}),this._$("footer")[n?"show":"hide"](),this._$("button").html(s).on("click","[data-id]",function(t){var e=a(this);e.attr("disabled")||o._trigger(e.data("id")),t.preventDefault()}),this},statusbar:function(t){return this._$("statusbar").html(t)[t?"show":"hide"](),this},_$:function(t){return this._popup.find("[i="+t+"]")},_trigger:function(t){t=this.callbacks[t];return"function"!=typeof t||!1!==t.call(this)?this.close().remove():this}}),h.oncreate=a.noop,h.getCurrent=function(){return n.current},h.get=function(t){return void 0===t?h.list:h.list[t]},h.list={},h.defaults=e,h}),window.dialog=function t(e){var i=o[e],e="exports";return"object"==typeof i?i:(i[e]||(i[e]={},i[e]=i.call(i[e],t,i[e],i)||i[e]),i[e])}("dialog")}()</script><script>!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(s){var n=/\+/g;function f(e){return x.raw?e:encodeURIComponent(e)}function m(e,o){e=x.raw?e:function(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(n," ")),x.json?JSON.parse(e):e}catch(e){}}(e);return s.isFunction(o)?o(e):e}var x=s.cookie=function(e,o,n){var i,r;if(void 0!==o&&!s.isFunction(o))return"number"==typeof(n=s.extend({},x.defaults,n)).expires&&(r=n.expires,(i=n.expires=new Date).setTime(+i+864e5*r)),document.cookie=[f(e),"=",(r=o,f(x.json?JSON.stringify(r):String(r))),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("");for(var t=e?void 0:{},c=document.cookie?document.cookie.split("; "):[],u=0,a=c.length;u<a;u++){var d=c[u].split("="),p=(p=d.shift(),x.raw?p:decodeURIComponent(p)),d=d.join("=");if(e&&e===p){t=m(d,o);break}e||void 0===(d=m(d))||(t[p]=d)}return t};x.defaults={},s.removeCookie=function(e,o){return void 0!==s.cookie(e)&&(s.cookie(e,"",s.extend({},o,{expires:-1})),!s.cookie(e))}})</script><style type="text/css">/*!
 * ui-dialog.css
 * Date: 2014-07-03
 * https://github.com/aui/artDialog
 * (c) 2009-2014 TangBin, http://www.planeArt.cn
 *
 * This is licensed under the GNU LGPL, version 2.1 or later.
 * For details, see: http://www.gnu.org/licenses/lgpl-2.1.html
 */.ui-dialog{position:relative;background-color:#fff;border:1px solid #999;border-radius:6px;outline:0;background-clip:padding-box;font-family:Helvetica,arial,sans-serif;font-size:14px;line-height:1.428571429;color:#333;opacity:0;-webkit-transform:scale(0);transform:scale(0);-webkit-transition:-webkit-transform .15s ease-in-out,opacity .15s ease-in-out;transition:transform .15s ease-in-out,opacity .15s ease-in-out}.ui-popup-show .ui-dialog{opacity:1;-webkit-transform:scale(1);transform:scale(1)}.ui-popup-focus .ui-dialog{box-shadow:0 0 8px rgba(0,0,0,.1)}.ui-popup-modal .ui-dialog{box-shadow:0 0 8px rgba(0,0,0,.1),0 0 256px rgba(255,255,255,.3)}.ui-dialog-grid{width:auto;margin:0;border:0 none;border-collapse:collapse;border-spacing:0;background:0 0}.ui-dialog-body,.ui-dialog-footer,.ui-dialog-header{padding:0;border:0 none;text-align:left;background:0 0}.ui-dialog-header{white-space:nowrap;border-bottom:1px solid #e5e5e5}.ui-dialog-close{position:relative;float:right;top:13px;right:13px;padding:0 4px;font-size:21px;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:.2;cursor:pointer;background:0 0;border:0;-webkit-appearance:none}.ui-dialog-close:focus,.ui-dialog-close:hover{color:#000;text-decoration:none;cursor:pointer;outline:0;opacity:.5}.ui-dialog-title{margin:0;line-height:1.428571429;min-height:16.428571429px;padding:15px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-weight:700;cursor:default}.ui-dialog-body{padding:20px;text-align:center}.ui-dialog-content{display:inline-block;position:relative;vertical-align:middle;text-align:left}.ui-dialog-footer{padding:0 20px 20px 20px}.ui-dialog-statusbar{float:left;margin-right:20px;padding:6px 0;line-height:1.428571429;font-size:14px;color:#888;white-space:nowrap}.ui-dialog-statusbar label:hover{color:#333}.ui-dialog-statusbar .label,.ui-dialog-statusbar input{vertical-align:middle}.ui-dialog-button{float:right;white-space:nowrap}.ui-dialog-footer button+button{margin-bottom:0;margin-left:5px}.ui-dialog-footer button{width:auto;overflow:visible;display:inline-block;padding:6px 12px;margin-bottom:0;font-size:14px;font-weight:400;line-height:1.428571429;text-align:center;white-space:nowrap;vertical-align:middle;cursor:pointer;background-image:none;border:1px solid transparent;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}.ui-dialog-footer button:focus{outline:thin dotted #333;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.ui-dialog-footer button:focus,.ui-dialog-footer button:hover{color:#333;text-decoration:none}.ui-dialog-footer button:active{background-image:none;outline:0;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.ui-dialog-footer button[disabled]{pointer-events:none;cursor:not-allowed;opacity:.65;-webkit-box-shadow:none;box-shadow:none}.ui-dialog-footer button{color:#333;background-color:#fff;border-color:#ccc}.ui-dialog-footer button:active,.ui-dialog-footer button:focus,.ui-dialog-footer button:hover{color:#333;background-color:#ebebeb;border-color:#adadad}.ui-dialog-footer button:active{background-image:none}.ui-dialog-footer button[disabled],.ui-dialog-footer button[disabled]:active,.ui-dialog-footer button[disabled]:focus,.ui-dialog-footer button[disabled]:hover{background-color:#fff;border-color:#ccc}.ui-dialog-footer button.ui-dialog-autofocus{color:#fff;background-color:#428bca;border-color:#357ebd}.ui-dialog-footer button.ui-dialog-autofocus:active,.ui-dialog-footer button.ui-dialog-autofocus:focus,.ui-dialog-footer button.ui-dialog-autofocus:hover{color:#fff;background-color:#3276b1;border-color:#285e8e}.ui-dialog-footer button.ui-dialog-autofocus:active{background-image:none}.ui-popup-top .ui-dialog,.ui-popup-top-left .ui-dialog,.ui-popup-top-right .ui-dialog{top:-8px}.ui-popup-bottom .ui-dialog,.ui-popup-bottom-left .ui-dialog,.ui-popup-bottom-right .ui-dialog{top:8px}.ui-popup-left .ui-dialog,.ui-popup-left-bottom .ui-dialog,.ui-popup-left-top .ui-dialog{left:-8px}.ui-popup-right .ui-dialog,.ui-popup-right-bottom .ui-dialog,.ui-popup-right-top .ui-dialog{left:8px}.ui-dialog-arrow-a,.ui-dialog-arrow-b{position:absolute;display:none;width:0;height:0;overflow:hidden;border:8px dashed transparent}.ui-popup-follow .ui-dialog-arrow-a,.ui-popup-follow .ui-dialog-arrow-b{display:block}.ui-popup-top .ui-dialog-arrow-a,.ui-popup-top-left .ui-dialog-arrow-a,.ui-popup-top-right .ui-dialog-arrow-a{bottom:-16px;border-top:8px solid #7c7c7c}.ui-popup-top .ui-dialog-arrow-b,.ui-popup-top-left .ui-dialog-arrow-b,.ui-popup-top-right .ui-dialog-arrow-b{bottom:-15px;border-top:8px solid #fff}.ui-popup-top-left .ui-dialog-arrow-a,.ui-popup-top-left .ui-dialog-arrow-b{left:15px}.ui-popup-top .ui-dialog-arrow-a,.ui-popup-top .ui-dialog-arrow-b{left:50%;margin-left:-8px}.ui-popup-top-right .ui-dialog-arrow-a,.ui-popup-top-right .ui-dialog-arrow-b{right:15px}.ui-popup-bottom .ui-dialog-arrow-a,.ui-popup-bottom-left .ui-dialog-arrow-a,.ui-popup-bottom-right .ui-dialog-arrow-a{top:-16px;border-bottom:8px solid #7c7c7c}.ui-popup-bottom .ui-dialog-arrow-b,.ui-popup-bottom-left .ui-dialog-arrow-b,.ui-popup-bottom-right .ui-dialog-arrow-b{top:-15px;border-bottom:8px solid #fff}.ui-popup-bottom-left .ui-dialog-arrow-a,.ui-popup-bottom-left .ui-dialog-arrow-b{left:15px}.ui-popup-bottom .ui-dialog-arrow-a,.ui-popup-bottom .ui-dialog-arrow-b{margin-left:-8px;left:50%}.ui-popup-bottom-right .ui-dialog-arrow-a,.ui-popup-bottom-right .ui-dialog-arrow-b{right:15px}.ui-popup-left .ui-dialog-arrow-a,.ui-popup-left-bottom .ui-dialog-arrow-a,.ui-popup-left-top .ui-dialog-arrow-a{right:-16px;border-left:8px solid #7c7c7c}.ui-popup-left .ui-dialog-arrow-b,.ui-popup-left-bottom .ui-dialog-arrow-b,.ui-popup-left-top .ui-dialog-arrow-b{right:-15px;border-left:8px solid #fff}.ui-popup-left-top .ui-dialog-arrow-a,.ui-popup-left-top .ui-dialog-arrow-b{top:15px}.ui-popup-left .ui-dialog-arrow-a,.ui-popup-left .ui-dialog-arrow-b{margin-top:-8px;top:50%}.ui-popup-left-bottom .ui-dialog-arrow-a,.ui-popup-left-bottom .ui-dialog-arrow-b{bottom:15px}.ui-popup-right .ui-dialog-arrow-a,.ui-popup-right-bottom .ui-dialog-arrow-a,.ui-popup-right-top .ui-dialog-arrow-a{left:-16px;border-right:8px solid #7c7c7c}.ui-popup-right .ui-dialog-arrow-b,.ui-popup-right-bottom .ui-dialog-arrow-b,.ui-popup-right-top .ui-dialog-arrow-b{left:-15px;border-right:8px solid #fff}.ui-popup-right-top .ui-dialog-arrow-a,.ui-popup-right-top .ui-dialog-arrow-b{top:15px}.ui-popup-right .ui-dialog-arrow-a,.ui-popup-right .ui-dialog-arrow-b{margin-top:-8px;top:50%}.ui-popup-right-bottom .ui-dialog-arrow-a,.ui-popup-right-bottom .ui-dialog-arrow-b{bottom:15px}@-webkit-keyframes ui-dialog-loading{0%{-webkit-transform:rotate(0)}100%{-webkit-transform:rotate(360deg)}}@keyframes ui-dialog-loading{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.ui-dialog-loading{vertical-align:middle;position:relative;display:block;overflow:hidden;width:32px;height:32px;top:50%;margin:-16px auto 0 auto;font-size:0;text-indent:-999em;color:#666}.ui-dialog-loading::after{position:absolute;content:'';width:3px;height:3px;margin:14.5px 0 0 14.5px;border-radius:100%;box-shadow:0 -10px 0 1px #ccc,10px 0 #ccc,0 10px #ccc,-10px 0 #ccc,-7px -7px 0 .5px #ccc,7px -7px 0 1.5px #ccc,7px 7px #ccc,-7px 7px #ccc;-webkit-transform:rotate(360deg);-webkit-animation:ui-dialog-loading 1.5s infinite linear;transform:rotate(360deg);animation:ui-dialog-loading 1.5s infinite linear}</style><style type="text/css"></style><script>!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(O,A){"use strict";var s,n,a,o,i,e,p,t,r,d,c,l,h,_,u,g,f;O.jstree||(s=0,o=a=n=!1,i=[],e=O("script:last").attr("src"),r=document,(p=r.createElement("LI")).setAttribute("role","treeitem"),(t=r.createElement("I")).className="jstree-icon jstree-ocl",t.setAttribute("role","presentation"),p.appendChild(t),(t=r.createElement("A")).className="jstree-anchor",t.setAttribute("href","#"),t.setAttribute("tabindex","-1"),(r=r.createElement("I")).className="jstree-icon jstree-themeicon",r.setAttribute("role","presentation"),t.appendChild(r),p.appendChild(t),t=r=null,O.jstree={version:"3.0.8",defaults:{plugins:[]},plugins:{},path:e&&-1!==e.indexOf("/")?e.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%]/g},O.jstree.create=function(e,i){var r=new O.jstree.core(++s),t=i;return i=O.extend(!0,{},O.jstree.defaults,i),t&&t.plugins&&(i.plugins=t.plugins),O.each(i.plugins,function(e,t){"core"!==e&&(r=r.plugin(t,i[t]))}),r.init(e,i),r},O.jstree.destroy=function(){O(".jstree:jstree").jstree("destroy"),O(document).off(".jstree")},O.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},O.jstree.reference=function(t){var i=null,e=null;if(t&&t.id&&(t=t.id),!e||!e.length)try{e=O(t)}catch(e){}if(!e||!e.length)try{e=O("#"+t.replace(O.jstree.idregex,"\\$&"))}catch(e){}return e&&e.length&&(e=e.closest(".jstree")).length&&(e=e.data("jstree"))?i=e:O(".jstree").each(function(){var e=O(this).data("jstree");return e&&e._model.data[t]?(i=e,!1):A}),i},O.fn.jstree=function(i){var r="string"==typeof i,s=Array.prototype.slice.call(arguments,1),n=null;return!(!0===i&&!this.length)&&(this.each(function(){var e=O.jstree.reference(this),t=r&&e?e[i]:null;return n=r&&t?t.apply(e,s):null,e||r||i!==A&&!O.isPlainObject(i)||O(this).data("jstree",new O.jstree.create(this,i)),(e&&!r||!0===i)&&(n=e||!1),(null===n||n===A)&&A}),null!==n&&n!==A?n:this)},O.expr[":"].jstree=O.expr.createPseudo(function(e){return function(e){return O(e).hasClass("jstree")&&O(e).data("jstree")!==A}}),O.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:O.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1},O.jstree.core.prototype={plugin:function(e,t){var i=O.jstree.plugins[e];return i?(this._data[e]={},i.prototype=this,new i(t,this)):this},init:function(e,t){this._model={data:{"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this.element=O(e).addClass("jstree jstree-"+this._id),this.settings=t,this.element.bind("destroyed",O.proxy(this.teardown,this)),this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().height()||24,this.trigger("loading"),this.load_node("#")},destroy:function(e){if(this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.element.unbind("destroyed",this.teardown),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var s="",n=null;this.element.on("dblclick.jstree",function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var e=window.getSelection();try{e.removeAllRanges(),e.collapse()}catch(e){}}}).on("click.jstree",".jstree-ocl",O.proxy(function(e){this.toggle_node(e.target)},this)).on("click.jstree",".jstree-anchor",O.proxy(function(e){e.preventDefault(),e.currentTarget!==document.activeElement&&O(e.currentTarget).focus(),this.activate_node(e.currentTarget,e)},this)).on("keydown.jstree",".jstree-anchor",O.proxy(function(e){if("INPUT"===e.target.tagName)return!0;var t=null;switch(this._data.core.rtl&&(37===e.which?e.which=39:39===e.which&&(e.which=37)),e.which){case 32:e.ctrlKey&&(e.type="click",O(e.currentTarget).trigger(e));break;case 13:e.type="click",O(e.currentTarget).trigger(e);break;case 37:e.preventDefault(),this.is_open(e.currentTarget)?this.close_node(e.currentTarget):(t=this.get_parent(e.currentTarget))&&"#"!==t.id&&this.get_node(t,!0).children(".jstree-anchor").focus();break;case 38:e.preventDefault(),(t=this.get_prev_dom(e.currentTarget))&&t.length&&t.children(".jstree-anchor").focus();break;case 39:e.preventDefault(),this.is_closed(e.currentTarget)?this.open_node(e.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):this.is_open(e.currentTarget)&&((t=this.get_node(e.currentTarget,!0).children(".jstree-children")[0])&&O(this._firstChild(t)).children(".jstree-anchor").focus());break;case 40:e.preventDefault(),(t=this.get_next_dom(e.currentTarget))&&t.length&&t.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:e.preventDefault(),(t=this._firstChild(this.get_container_ul()[0]))&&O(t).children(".jstree-anchor").filter(":visible").focus();break;case 35:e.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()}},this)).on("load_node.jstree",O.proxy(function(e,t){if(t.status&&("#"!==t.node.id||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),!this._data.core.ready&&!this.get_container_ul().find(".jstree-loading").length)){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){for(var i=[],r=0,s=this._data.core.selected.length;r<s;r++)i=i.concat(this._model.data[this._data.core.selected[r]].parents);for(r=0,s=(i=O.vakata.array_unique(i)).length;r<s;r++)this.open_node(i[r],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}setTimeout(O.proxy(function(){this.trigger("ready")},this),0)}},this)).on("keypress.jstree",O.proxy(function(e){if("INPUT"===e.target.tagName)return!0;n&&clearTimeout(n),n=setTimeout(function(){s=""},500);var i=String.fromCharCode(e.which).toLowerCase(),t=this.element.find(".jstree-anchor").filter(":visible"),e=t.index(document.activeElement)||0,r=!1;if(1<(s+=i).length){if(t.slice(e).each(O.proxy(function(e,t){return 0===O(t).text().toLowerCase().indexOf(s)?(O(t).focus(),!(r=!0)):A},this)),r)return;if(t.slice(0,e).each(O.proxy(function(e,t){return 0===O(t).text().toLowerCase().indexOf(s)?(O(t).focus(),!(r=!0)):A},this)),r)return}RegExp("^"+i+"+$").test(s)&&(t.slice(e+1).each(O.proxy(function(e,t){return O(t).text().toLowerCase().charAt(0)===i?(O(t).focus(),!(r=!0)):A},this)),r||t.slice(0,e+1).each(O.proxy(function(e,t){return O(t).text().toLowerCase().charAt(0)===i?(O(t).focus(),!(r=!0)):A},this)))},this)).on("init.jstree",O.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",O.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",O.proxy(function(e){this._data.core.focused=null,O(e.currentTarget).filter(".jstree-hovered").mouseleave()},this)).on("focus.jstree",".jstree-anchor",O.proxy(function(e){var t=this.get_node(e.currentTarget);t&&t.id&&(this._data.core.focused=t.id),this.element.find(".jstree-hovered").not(e.currentTarget).mouseleave(),O(e.currentTarget).mouseenter()},this)).on("focus.jstree",O.proxy(function(){this._data.core.focused||this.get_node(this.element.attr("aria-activedescendant"),!0).find("> .jstree-anchor").focus()},this)).on("mouseenter.jstree",".jstree-anchor",O.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",O.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),O(document).off(".jstree-"+this._id)},trigger:function(e,t){((t=t||{}).instance=this).element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(e){var t=this.settings.core.strings;return O.isFunction(t)?t.call(this,e):t&&t[e]?t[e]:e},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(e,t){var i;e&&e.id&&(e=e.id);try{if(this._model.data[e])e=this._model.data[e];else if("string"==typeof e&&this._model.data[e.replace(/^#/,"")])e=this._model.data[e.replace(/^#/,"")];else if("string"==typeof e&&(i=O("#"+e.replace(O.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])e=this._model.data[i.closest(".jstree-node").attr("id")];else if((i=O(e,this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])e=this._model.data[i.closest(".jstree-node").attr("id")];else{if(!(i=O(e,this.element)).length||!i.hasClass("jstree"))return!1;e=this._model.data["#"]}return t&&(e="#"===e.id?this.element:O("#"+e.id.replace(O.jstree.idregex,"\\$&"),this.element)),e}catch(e){return!1}},get_path:function(e,t,i){if(!(e=e.parents?e:this.get_node(e))||"#"===e.id||!e.parents)return!1;var r,s,n=[];for(n.push(i?e.id:e.text),r=0,s=e.parents.length;r<s;r++)n.push(i?e.parents[r]:this.get_text(e.parents[r]));return n=n.reverse().slice(1),t?n.join(t):n},get_next_dom:function(e,t){var i;if((e=this.get_node(e,!0))[0]===this.element[0]){for(i=this._firstChild(this.get_container_ul()[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);return!!i&&O(i)}if(!e||!e.length)return!1;if(t){for(i=e[0];i=this._nextSibling(i),i&&0===i.offsetHeight;);return!!i&&O(i)}if(e.hasClass("jstree-open")){for(i=this._firstChild(e.children(".jstree-children")[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);if(null!==i)return O(i)}for(i=e[0];i=this._nextSibling(i),i&&0===i.offsetHeight;);return null!==i?O(i):e.parentsUntil(".jstree",".jstree-node").next(".jstree-node:visible").first()},get_prev_dom:function(e,t){var i;if((e=this.get_node(e,!0))[0]===this.element[0]){for(i=this.get_container_ul()[0].lastChild;i&&0===i.offsetHeight;)i=this._previousSibling(i);return!!i&&O(i)}if(!e||!e.length)return!1;if(t){for(i=e[0];i=this._previousSibling(i),i&&0===i.offsetHeight;);return!!i&&O(i)}for(i=e[0];i=this._previousSibling(i),i&&0===i.offsetHeight;);if(null===i)return!(!(i=e[0].parentNode.parentNode)||!i.className||-1===i.className.indexOf("jstree-node"))&&O(i);for(e=O(i);e.hasClass("jstree-open");)e=e.children(".jstree-children").first().children(".jstree-node:visible:last");return e},get_parent:function(e){return!(!(e=this.get_node(e))||"#"===e.id)&&e.parent},get_children_dom:function(e){return(e=this.get_node(e,!0))[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return(e=this.get_node(e))&&(!1===e.state.loaded||0<e.children.length)},is_loaded:function(e){return(e=this.get_node(e))&&e.state.loaded},is_loading:function(e){return(e=this.get_node(e))&&e.state&&e.state.loading},is_open:function(e){return(e=this.get_node(e))&&e.state.opened},is_closed:function(e){return(e=this.get_node(e))&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(i,r){var e,t,s,n,a;if(O.isArray(i))return this._load_nodes(i.slice(),r),!0;if(!(i=this.get_node(i)))return r&&r.call(this,i,!1),!1;if(i.state.loaded){for(i.state.loaded=!1,e=0,t=i.children_d.length;e<t;e++){for(s=0,n=i.parents.length;s<n;s++)this._model.data[i.parents[s]].children_d=O.vakata.array_remove_item(this._model.data[i.parents[s]].children_d,i.children_d[e]);this._model.data[i.children_d[e]].state.selected&&(a=!0,this._data.core.selected=O.vakata.array_remove_item(this._data.core.selected,i.children_d[e])),delete this._model.data[i.children_d[e]]}i.children=[],i.children_d=[],a&&this.trigger("changed",{action:"load_node",node:i,selected:this._data.core.selected})}return i.state.loading=!0,this.get_node(i,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(i,O.proxy(function(e){(i=this._model.data[i.id]).state.loading=!1,i.state.loaded=e;var t=this.get_node(i,!0);i.state.loaded&&!i.children.length&&t&&t.length&&!t.hasClass("jstree-leaf")&&t.removeClass("jstree-closed jstree-open").addClass("jstree-leaf"),t.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:i,status:e}),r&&r.call(this,i,e)},this)),!0},_load_nodes:function(e,t,i){for(var r=!0,s=function(){this._load_nodes(e,t,!0)},n=this._model.data,a=0,o=e.length;a<o;a++)!n[e[a]]||n[e[a]].state.loaded&&i||(this.is_loading(e[a])||this.load_node(e[a],s),r=!1);r&&t&&!t.done&&(t.call(this,e),t.done=!0)},load_all:function(e,t){if(e=e||"#",!(e=this.get_node(e)))return!1;var i,r,s=[],n=this._model.data,a=n[e.id].children_d;for(e.state&&!e.state.loaded&&s.push(e.id),i=0,r=a.length;i<r;i++)n[a[i]]&&n[a[i]].state&&!n[a[i]].state.loaded&&s.push(a[i]);s.length?this._load_nodes(s,function(){this.load_all(e,t)}):(t&&t.call(this,e),this.trigger("load_all",{node:e}))},_load_node:function(s,n){var e,t=this.settings.core.data;return t?O.isFunction(t)?t.call(this,s,O.proxy(function(e){!1===e&&n.call(this,!1),this["string"==typeof e?"_append_html_data":"_append_json_data"](s,"string"==typeof e?O(e):e,function(e){n.call(this,e)})},this)):"object"==typeof t?t.url?(t=O.extend(!0,{},t),O.isFunction(t.url)&&(t.url=t.url.call(this,s)),O.isFunction(t.data)&&(t.data=t.data.call(this,s)),O.ajax(t).done(O.proxy(function(e,t,i){var r=i.getResponseHeader("Content-Type");return-1!==r.indexOf("json")||"object"==typeof e?this._append_json_data(s,e,function(e){n.call(this,e)}):-1!==r.indexOf("html")||"string"==typeof e?this._append_html_data(s,O(e),function(e){n.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:s.id,xhr:i})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))},this)).fail(O.proxy(function(e){n.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:s.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(e=O.isArray(t)||O.isPlainObject(t)?JSON.parse(JSON.stringify(t)):t,"#"===s.id?this._append_json_data(s,e,function(e){n.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:s.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))):"string"==typeof t?"#"===s.id?this._append_html_data(s,O(t),function(e){n.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:s.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1)):n.call(this,!1):"#"===s.id?this._append_html_data(s,this._data.core.original_container_html.clone(!0),function(e){n.call(this,e)}):n.call(this,!1)},_node_changed:function(e){(e=this.get_node(e))&&this._model.changed.push(e.id)},_append_html_data:function(e,t,i){(e=this.get_node(e)).children=[],e.children_d=[];var r,s,n,t=t.is("ul")?t.children():t,a=e.id,o=[],d=[],c=this._model.data,l=c[a],e=this._data.core.selected.length;for(t.each(O.proxy(function(e,t){(r=this._parse_model_from_html(O(t),a,l.parents.concat()))&&(o.push(r),d.push(r),c[r].children_d.length&&(d=d.concat(c[r].children_d)))},this)),l.children=o,l.children_d=d,s=0,n=l.parents.length;s<n;s++)c[l.parents[s]].children_d=c[l.parents[s]].children_d.concat(d);this.trigger("model",{nodes:d,parent:a}),"#"!==a?(this._node_changed(a),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==e&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)},_append_json_data:function(e,t,d,i){(e=this.get_node(e)).children=[],e.children_d=[],!t.d||"string"==typeof(t=t.d)&&(t=JSON.parse(t)),O.isArray(t)||(t=[t]);function r(e,c){e.data&&(e=e.data);var t,i,r,s,n=e.dat,a=e.par,o=[],d=[],l=[],h=e.df,_=e.t_id,u=e.t_cnt,g=e.m,f=g[a],e=e.sel,p=function(e,t,i){i=i?i.concat():[],t&&i.unshift(t);var r,s,n,a,o=""+e.id,d={id:o,text:e.text||"",icon:e.icon===c||e.icon,parent:t,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in h)h.hasOwnProperty(r)&&(d.state[r]=h[r]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),e&&e.data&&(d.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(d.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(d.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(d.li_attr[r]=e.li_attr[r]);if(d.li_attr.id||(d.li_attr.id=o),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(d.a_attr[r]=e.a_attr[r]);for(e&&e.children&&!0===e.children&&(d.state.loaded=!1,d.children=[],d.children_d=[]),r=0,s=(g[d.id]=d).children.length;r<s;r++)n=p(g[d.children[r]],d.id,i),a=g[n],d.children_d.push(n),a.children_d.length&&(d.children_d=d.children_d.concat(a.children_d));return delete e.data,delete e.children,g[d.id].original=e,d.state.selected&&l.push(d.id),d.id},m=function(e,t,i){i=i?i.concat():[],t&&i.unshift(t);for(var r,s,n,a,o,d=!1;d="j"+_+"_"+ ++u,g[d];);for(r in o={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===c||e.icon,parent:t,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},h)h.hasOwnProperty(r)&&(o.state[r]=h[r]);if(e&&e.id&&(o.id=""+e.id),e&&e.text&&(o.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(o.icon=e.data.jstree.icon),e&&e.data&&(o.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(o.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(o.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(o.li_attr[r]=e.li_attr[r]);if(o.li_attr.id&&!o.id&&(o.id=""+o.li_attr.id),o.id||(o.id=d),o.li_attr.id||(o.li_attr.id=o.id),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(o.a_attr[r]=e.a_attr[r]);if(e&&e.children&&e.children.length){for(r=0,s=e.children.length;r<s;r++)n=m(e.children[r],o.id,i),a=g[n],o.children.push(n),a.children_d.length&&(o.children_d=o.children_d.concat(a.children_d));o.children_d=o.children_d.concat(o.children)}return e&&e.children&&!0===e.children&&(o.state.loaded=!1,o.children=[],o.children_d=[]),delete e.data,delete e.children,o.original=e,(g[o.id]=o).state.selected&&l.push(o.id),o.id};if(n.length&&n[0].id!==c&&n[0].parent!==c){for(i=0,r=n.length;i<r;i++)n[i].children||(n[i].children=[]),g[""+n[i].id]=n[i];for(i=0,r=n.length;i<r;i++)g[""+n[i].parent].children.push(""+n[i].id),f.children_d.push(""+n[i].id);for(i=0,r=f.children.length;i<r;i++)t=p(g[f.children[i]],a,f.parents.concat()),d.push(t),g[t].children_d.length&&(d=d.concat(g[t].children_d));for(i=0,r=f.parents.length;i<r;i++)g[f.parents[i]].children_d=g[f.parents[i]].children_d.concat(d);s={cnt:u,mod:g,sel:e,par:a,dpc:d,add:l}}else{for(i=0,r=n.length;i<r;i++)(t=m(n[i],a,f.parents.concat()))&&(o.push(t),d.push(t),g[t].children_d.length&&(d=d.concat(g[t].children_d)));for(f.children=o,f.children_d=d,i=0,r=f.parents.length;i<r;i++)g[f.parents[i]].children_d=g[f.parents[i]].children_d.concat(d);s={cnt:u,mod:g,sel:e,par:a,dpc:d,add:l}}return"undefined"!=typeof window&&window.document!==c?s:(postMessage(s),c)}function s(e,t){if(this._cnt=e.cnt,this._model.data=e.mod,t){var i,r,s=e.add,n=e.sel,a=this._data.core.selected.slice(),o=this._model.data;if(n.length!==a.length||O.vakata.array_unique(n.concat(a)).length!==n.length){for(i=0,r=n.length;i<r;i++)-1===O.inArray(n[i],s)&&-1===O.inArray(n[i],a)&&(o[n[i]].state.selected=!1);for(i=0,r=a.length;i<r;i++)-1===O.inArray(a[i],n)&&(o[a[i]].state.selected=!0)}}e.add.length&&(this._data.core.selected=this._data.core.selected.concat(e.add)),this.trigger("model",{nodes:e.dpc,parent:e.par}),"#"!==e.par?(this._node_changed(e.par),this.redraw()):this.redraw(!0),e.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),d.call(this,!0)}var n=null,a={df:this._model.default_state,dat:t,par:e.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+r],{type:"text/javascript"}))),!this._data.core.working||i?(this._data.core.working=!0,(n=new window.Worker(this._wrk)).onmessage=O.proxy(function(e){s.call(this,e.data,!0);try{n.terminate(),n=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),a.par?n.postMessage(a):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([e,t,d,!0])}catch(e){s.call(this,r(a),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else s.call(this,r(a),!1)},_parse_model_from_html:function(e,t,i){i=i?[].concat(i):[],t&&i.unshift(t);var r,s,n,a,o=this._model.data,d={id:!1,text:!1,icon:!0,parent:t,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in this._model.default_state)this._model.default_state.hasOwnProperty(n)&&(d.state[n]=this._model.default_state[n]);if(t=O.vakata.attributes(e,!0),O.each(t,function(e,t){return!(t=O.trim(t)).length||(d.li_attr[e]=t,"id"===e&&(d.id=""+t),A)}),(t=e.children("a").first()).length&&(t=O.vakata.attributes(t,!0),O.each(t,function(e,t){(t=O.trim(t)).length&&(d.a_attr[e]=t)})),(t=(e.children("a").first().length?e.children("a").first():e).clone()).children("ins, i, ul").remove(),t=t.html(),t=O("<div />").html(t),d.text=this.settings.core.force_text?t.text():t.html(),t=e.data(),d.data=t?O.extend(!0,{},t):null,d.state.opened=e.hasClass("jstree-open"),d.state.selected=e.children("a").hasClass("jstree-clicked"),d.state.disabled=e.children("a").hasClass("jstree-disabled"),d.data&&d.data.jstree)for(n in d.data.jstree)d.data.jstree.hasOwnProperty(n)&&(d.state[n]=d.data.jstree[n]);for(t=e.children("a").children(".jstree-themeicon"),t.length&&(d.icon=!t.hasClass("jstree-themeicon-hidden")&&t.attr("rel")),d.state.icon&&(d.icon=d.state.icon),t=e.children("ul").children("li");a="j"+this._id+"_"+ ++this._cnt,o[a];);return d.id=d.li_attr.id?""+d.li_attr.id:a,t.length?(t.each(O.proxy(function(e,t){r=this._parse_model_from_html(O(t),d.id,i),s=this._model.data[r],d.children.push(r),s.children_d.length&&(d.children_d=d.children_d.concat(s.children_d))},this)),d.children_d=d.children_d.concat(d.children)):e.hasClass("jstree-closed")&&(d.state.loaded=!1),d.li_attr.class&&(d.li_attr.class=d.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),d.a_attr.class&&(d.a_attr.class=d.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),(o[d.id]=d).state.selected&&this._data.core.selected.push(d.id),d.id},_parse_model_from_flat_json:function(e,t,i){i=i?i.concat():[],t&&i.unshift(t);var r,s,n,a,o=""+e.id,d=this._model.data,c=this._model.default_state,l={id:o,text:e.text||"",icon:e.icon===A||e.icon,parent:t,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in c)c.hasOwnProperty(r)&&(l.state[r]=c[r]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),e&&e.data&&(l.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(l.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(l.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(l.li_attr[r]=e.li_attr[r]);if(l.li_attr.id||(l.li_attr.id=o),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(l.a_attr[r]=e.a_attr[r]);for(e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),r=0,s=(d[l.id]=l).children.length;r<s;r++)a=d[n=this._parse_model_from_flat_json(d[l.children[r]],l.id,i)],l.children_d.push(n),a.children_d.length&&(l.children_d=l.children_d.concat(a.children_d));return delete e.data,delete e.children,d[l.id].original=e,l.state.selected&&this._data.core.selected.push(l.id),l.id},_parse_model_from_json:function(e,t,i){i=i?i.concat():[],t&&i.unshift(t);for(var r,s,n,a,o,d=!1,c=this._model.data,l=this._model.default_state;d="j"+this._id+"_"+ ++this._cnt,c[d];);for(r in o={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===A||e.icon,parent:t,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},l)l.hasOwnProperty(r)&&(o.state[r]=l[r]);if(e&&e.id&&(o.id=""+e.id),e&&e.text&&(o.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(o.icon=e.data.jstree.icon),e&&e.data&&(o.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(o.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(o.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(o.li_attr[r]=e.li_attr[r]);if(o.li_attr.id&&!o.id&&(o.id=""+o.li_attr.id),o.id||(o.id=d),o.li_attr.id||(o.li_attr.id=o.id),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(o.a_attr[r]=e.a_attr[r]);if(e&&e.children&&e.children.length){for(r=0,s=e.children.length;r<s;r++)a=c[n=this._parse_model_from_json(e.children[r],o.id,i)],o.children.push(n),a.children_d.length&&(o.children_d=o.children_d.concat(a.children_d));o.children_d=o.children_d.concat(o.children)}return e&&e.children&&!0===e.children&&(o.state.loaded=!1,o.children=[],o.children_d=[]),delete e.data,delete e.children,o.original=e,(c[o.id]=o).state.selected&&this._data.core.selected.push(o.id),o.id},_redraw:function(){for(var e,t=(this._model.force_full_redraw?this._model.data["#"].children:this._model.changed).concat([]),i=document.createElement("UL"),r=this._data.core.focused,s=0,n=t.length;s<n;s++)(e=this.redraw_node(t[s],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&i.appendChild(e);this._model.force_full_redraw&&(i.className=this.get_container_ul()[0].className,i.setAttribute("role","group"),this.element.empty().append(i)),null!==r&&((e=this.get_node(r,!0))&&e.length&&e.children(".jstree-anchor")[0]!==document.activeElement?e.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:t})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},redraw_node:function(e,t,i,r){var s=this.get_node(e),n=!1,a=!1,o=!1,d=!1,c=!1,l=!1,h="",_=document,u=this._model.data,g=!1,f=null;if(!s)return!1;if("#"===s.id)return this.redraw(!0);if(t=t||0===s.children.length,e=document.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(s.id[0])?"\\3"+s.id[0]+" "+s.id.substr(1).replace(O.jstree.idregex,"\\$&"):s.id.replace(O.jstree.idregex,"\\$&"))):document.getElementById(s.id))e=O(e),i||((n=e.parent().parent()[0])===this.element[0]&&(n=null),a=e.index()),t||!s.children.length||e.children(".jstree-children").length||(t=!0),t||(o=e.children(".jstree-children")[0]),g=e.children(".jstree-anchor")[0]===document.activeElement,e.remove();else if(t=!0,!i){if(!(null===(n="#"!==s.parent?O("#"+s.parent.replace(O.jstree.idregex,"\\$&"),this.element)[0]:null)||n&&u[s.parent].state.opened))return!1;a=O.inArray(s.id,(null===n?u["#"]:u[s.parent]).children)}for(d in e=p.cloneNode(!0),h="jstree-node ",s.li_attr)if(s.li_attr.hasOwnProperty(d)){if("id"===d)continue;"class"!==d?e.setAttribute(d,s.li_attr[d]):h+=s.li_attr[d]}for(c in s.a_attr.id||(s.a_attr.id=s.id+"_anchor"),e.setAttribute("aria-selected",!!s.state.selected),e.setAttribute("aria-level",s.parents.length),e.setAttribute("aria-labelledby",s.a_attr.id),s.state.disabled&&e.setAttribute("aria-disabled",!0),s.state.loaded&&!s.children.length?h+=" jstree-leaf":(h+=s.state.opened&&s.state.loaded?" jstree-open":" jstree-closed",e.setAttribute("aria-expanded",s.state.opened&&s.state.loaded)),null!==s.parent&&u[s.parent].children[u[s.parent].children.length-1]===s.id&&(h+=" jstree-last"),e.id=s.id,e.className=h,h=(s.state.selected?" jstree-clicked":"")+(s.state.disabled?" jstree-disabled":""),s.a_attr)if(s.a_attr.hasOwnProperty(c)){if("href"===c&&"#"===s.a_attr[c])continue;"class"!==c?e.childNodes[1].setAttribute(c,s.a_attr[c]):h+=" "+s.a_attr[c]}if(h.length&&(e.childNodes[1].className="jstree-anchor "+h),(s.icon&&!0!==s.icon||!1===s.icon)&&(!1===s.icon?e.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===s.icon.indexOf("/")&&-1===s.icon.indexOf(".")?e.childNodes[1].childNodes[0].className+=" "+s.icon+" jstree-themeicon-custom":(e.childNodes[1].childNodes[0].style.backgroundImage="url("+s.icon+")",e.childNodes[1].childNodes[0].style.backgroundPosition="center center",e.childNodes[1].childNodes[0].style.backgroundSize="auto",e.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?e.childNodes[1].appendChild(_.createTextNode(s.text)):e.childNodes[1].innerHTML+=s.text,t&&s.children.length&&(s.state.opened||r)&&s.state.loaded){for((l=_.createElement("UL")).setAttribute("role","group"),l.className="jstree-children",d=0,c=s.children.length;d<c;d++)l.appendChild(this.redraw_node(s.children[d],t,!0));e.appendChild(l)}if(o&&e.appendChild(o),!i){for(d=0,c=(n=n||this.element[0]).childNodes.length;d<c;d++)if(n.childNodes[d]&&n.childNodes[d].className&&-1!==n.childNodes[d].className.indexOf("jstree-children")){f=n.childNodes[d];break}f||((f=_.createElement("UL")).setAttribute("role","group"),f.className="jstree-children",n.appendChild(f)),(n=f).childNodes.length>a?n.insertBefore(e,n.childNodes[a]):n.appendChild(e),g&&e.childNodes[1].focus()}return s.state.opened&&!s.state.loaded&&(s.state.opened=!1,setTimeout(O.proxy(function(){this.open_node(s.id,!1,0)},this),0)),e},open_node:function(e,i,r){var t,s,n,a;if(O.isArray(e)){for(t=0,s=(e=e.slice()).length;t<s;t++)this.open_node(e[t],i,r);return!0}if(!(e=this.get_node(e))||"#"===e.id)return!1;if(r=r===A?this.settings.core.animation:r,!this.is_closed(e))return i&&i.call(this,e,!1),!1;if(this.is_loaded(e))n=this.get_node(e,!0),a=this,n.length&&(e.children.length&&!this._firstChild(n.children(".jstree-children")[0])&&(this.redraw_node(e,!0,!1,!0),n=this.get_node(e,!0)),r?(this.trigger("before_open",{node:e}),n.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(r,function(){this.style.display="",a.trigger("after_open",{node:e})})):(this.trigger("before_open",{node:e}),n[0].className=n[0].className.replace("jstree-closed","jstree-open"),n[0].setAttribute("aria-expanded",!0))),e.state.opened=!0,i&&i.call(this,e,!0),n.length||this.trigger("before_open",{node:e}),this.trigger("open_node",{node:e}),r&&n.length||this.trigger("after_open",{node:e});else{if(this.is_loading(e))return setTimeout(O.proxy(function(){this.open_node(e,i,r)},this),500);this.load_node(e,function(e,t){return t?this.open_node(e,i,r):!!i&&i.call(this,e,!1)})}},_open_to:function(e){if(!(e=this.get_node(e))||"#"===e.id)return!1;for(var t=e.parents,i=0,r=t.length;i<r;i+=1)"#"!==i&&this.open_node(t[i],!1,0);return O("#"+e.id.replace(O.jstree.idregex,"\\$&"),this.element)},close_node:function(e,t){var i,r,s,n;if(O.isArray(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.close_node(e[i],t);return!0}return!(!(e=this.get_node(e))||"#"===e.id)&&(!this.is_closed(e)&&(t=t===A?this.settings.core.animation:t,(n=(s=this).get_node(e,!0)).length&&(t?n.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(t,function(){this.style.display="",n.children(".jstree-children").remove(),s.trigger("after_close",{node:e})}):(n[0].className=n[0].className.replace("jstree-open","jstree-closed"),n.attr("aria-expanded",!1).children(".jstree-children").remove())),e.state.opened=!1,this.trigger("close_node",{node:e}),t&&n.length||this.trigger("after_close",{node:e}),A))},toggle_node:function(e){var t,i;if(O.isArray(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.toggle_node(e[t]);return!0}return this.is_closed(e)?this.open_node(e):this.is_open(e)?this.close_node(e):A},open_all:function(e,i,r){if(e=e||"#",!(e=this.get_node(e)))return!1;var t,s,n,a="#"===e.id?this.get_container_ul():this.get_node(e,!0);if(!a.length){for(t=0,s=e.children_d.length;t<s;t++)this.is_closed(this._model.data[e.children_d[t]])&&(this._model.data[e.children_d[t]].state.opened=!0);return this.trigger("open_all",{node:e})}r=r||a,(a=(n=this).is_closed(e)?a.find(".jstree-closed").addBack():a.find(".jstree-closed")).each(function(){n.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,i,r)},i||0)}),0===r.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(r)})},close_all:function(e,t){if(e=e||"#",!(e=this.get_node(e)))return!1;var i,r,s="#"===e.id?this.get_container_ul():this.get_node(e,!0),n=this;if(!s.length){for(i=0,r=e.children_d.length;i<r;i++)this._model.data[e.children_d[i]].state.opened=!1;return this.trigger("close_all",{node:e})}s=this.is_open(e)?s.find(".jstree-open").addBack():s.find(".jstree-open"),O(s.get().reverse()).each(function(){n.close_node(this,t||0)}),this.trigger("close_all",{node:e})},is_disabled:function(e){return(e=this.get_node(e))&&e.state&&e.state.disabled},enable_node:function(e){var t,i;if(O.isArray(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.enable_node(e[t]);return!0}return!(!(e=this.get_node(e))||"#"===e.id)&&(e.state.disabled=!1,this.get_node(e,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),this.trigger("enable_node",{node:e}),A)},disable_node:function(e){var t,i;if(O.isArray(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.disable_node(e[t]);return!0}return!(!(e=this.get_node(e))||"#"===e.id)&&(e.state.disabled=!0,this.get_node(e,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),this.trigger("disable_node",{node:e}),A)},activate_node:function(e,t){if(this.is_disabled(e))return!1;if(this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==A?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&(!t.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(t.shiftKey){for(var i=this.get_node(e).id,r=this._data.core.last_clicked.id,s=this.get_node(this._data.core.last_clicked.parent).children,n=!1,a=0,o=s.length;a<o;a+=1)s[a]===i&&(n=!n),s[a]===r&&(n=!n),n||s[a]===i||s[a]===r?this.select_node(s[a],!0,!1,t):this.deselect_node(s[a],!0,t);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:t})}else this.is_selected(e)?this.deselect_node(e,!1,t):this.select_node(e,!1,!1,t);else!this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,t):(this.deselect_all(!0),this.select_node(e,!1,!1,t),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e)})},hover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),i=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){i.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){return!!((e=this.get_node(e,!0))&&e.length&&e.children(".jstree-hovered").length)&&(e.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(e)}),A)},select_node:function(e,t,i,r){var s,n,a;if(O.isArray(e)){for(n=0,a=(e=e.slice()).length;n<a;n++)this.select_node(e[n],t,i,r);return!0}return!(!(e=this.get_node(e))||"#"===e.id)&&(s=this.get_node(e,!0),e.state.selected||(e.state.selected=!0,this._data.core.selected.push(e.id),i||(s=this._open_to(e)),s&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:e,selected:this._data.core.selected,event:r}),t||this.trigger("changed",{action:"select_node",node:e,selected:this._data.core.selected,event:r})),A)},deselect_node:function(e,t,i){var r,s,n;if(O.isArray(e)){for(r=0,s=(e=e.slice()).length;r<s;r++)this.deselect_node(e[r],t,i);return!0}return!(!(e=this.get_node(e))||"#"===e.id)&&(n=this.get_node(e,!0),e.state.selected&&(e.state.selected=!1,this._data.core.selected=O.vakata.array_remove_item(this._data.core.selected,e.id),n.length&&n.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:e,selected:this._data.core.selected,event:i}),t||this.trigger("changed",{action:"deselect_node",node:e,selected:this._data.core.selected,event:i})),A)},select_all:function(e){var t,i,r=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data["#"].children_d.concat(),t=0,i=this._data.core.selected.length;t<i;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),e||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:r})},deselect_all:function(e){for(var t=this._data.core.selected.concat([]),i=0,r=this._data.core.selected.length;i<r;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:t}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:t})},is_selected:function(e){return!(!(e=this.get_node(e))||"#"===e.id)&&e.state.selected},get_selected:function(e){return e?O.map(this._data.core.selected,O.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(e){for(var t,i,r=this.get_selected(!0),s={},n=0,a=r.length;n<a;n++)s[r[n].id]=r[n];for(n=0,a=r.length;n<a;n++)for(t=0,i=r[n].children_d.length;t<i;t++)s[r[n].children_d[t]]&&delete s[r[n].children_d[t]];for(n in r=[],s)s.hasOwnProperty(n)&&r.push(n);return e?O.map(r,O.proxy(function(e){return this.get_node(e)},this)):r},get_bottom_selected:function(e){for(var t=this.get_selected(!0),i=[],r=0,s=t.length;r<s;r++)t[r].children.length||i.push(t[r].id);return e?O.map(i,O.proxy(function(e){return this.get_node(e)},this)):i},get_state:function(){var e,t={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(e in this._model.data)this._model.data.hasOwnProperty(e)&&"#"!==e&&(this._model.data[e].state.opened&&t.core.open.push(e),this._model.data[e].state.selected&&t.core.selected.push(e));return t},set_state:function(i,r){if(i){if(i.core){var s,n,a;if(i.core.open)return O.isArray(i.core.open)?(s=!0,n=this,O.each(i.core.open.concat([]),function(e,t){n.get_node(t)&&(n.is_loaded(t)?(n.is_closed(t)&&n.open_node(t,!1,0),i&&i.core&&i.core.open&&O.vakata.array_remove_item(i.core.open,t)):(n.is_loading(t)||n.open_node(t,O.proxy(function(e,t){!t&&i&&i.core&&i.core.open&&O.vakata.array_remove_item(i.core.open,e.id),this.set_state(i,r)},n),0),s=!1))}),s&&(delete i.core.open,this.set_state(i,r))):(delete i.core.open,this.set_state(i,r)),!1;if(i.core.scroll)return i.core.scroll&&i.core.scroll.left!==A&&this.element.scrollLeft(i.core.scroll.left),i.core.scroll&&i.core.scroll.top!==A&&this.element.scrollTop(i.core.scroll.top),delete i.core.scroll,this.set_state(i,r),!1;if(i.core.selected)return(a=this).deselect_all(),O.each(i.core.selected,function(e,t){a.select_node(t)}),delete i.core.selected,this.set_state(i,r),!1;if(O.isEmptyObject(i.core))return delete i.core,this.set_state(i,r),!1}return!O.isEmptyObject(i)||(i=null,r&&r.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(e,t){this._data.core.state=!0===t?{}:this.get_state(),t&&O.isFunction(t)&&(this._data.core.state=t.call(this,this._data.core.state)),this._cnt=0,this._model.data={"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}};var i=this.get_container_ul()[0].className;e||(this.element.html("<ul class='"+i+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node("#",function(e,t){t&&(this.get_container_ul()[0].className=i,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(O.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(!(t=this.get_node(t))||"#"===t.id)return!1;var i=[],e=[];this._data.core.selected.concat([]);e.push(t.id),!0===t.state.opened&&i.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id)}),this._load_nodes(e,O.proxy(function(e){this.open_node(i,!1,0),this.select_node(this._data.core.selected),this.trigger("refresh_node",{node:t,nodes:e})},this))},set_id:function(e,t){if(!(e=this.get_node(e))||"#"===e.id)return!1;var i,r,s=this._model.data;for(t=""+t,s[e.parent].children[O.inArray(e.id,s[e.parent].children)]=t,i=0,r=e.parents.length;i<r;i++)s[e.parents[i]].children_d[O.inArray(e.id,s[e.parents[i]].children_d)]=t;for(i=0,r=e.children.length;i<r;i++)s[e.children[i]].parent=t;for(i=0,r=e.children_d.length;i<r;i++)s[e.children_d[i]].parents[O.inArray(e.id,s[e.children_d[i]].parents)]=t;return-1!==(i=O.inArray(e.id,this._data.core.selected))&&(this._data.core.selected[i]=t),(i=this.get_node(e.id,!0))&&i.attr("id",t),delete s[e.id],s[e.id=t]=e,!0},get_text:function(e){return!(!(e=this.get_node(e))||"#"===e.id)&&e.text},set_text:function(e,t){var i,r;if(O.isArray(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.set_text(e[i],t);return!0}return!(!(e=this.get_node(e))||"#"===e.id)&&(e.text=t,this.get_node(e,!0).length&&this.redraw_node(e.id),this.trigger("set_text",{obj:e,text:t}),!0)},get_json:function(e,t,i){if(!(e=this.get_node(e||"#")))return!1;t&&t.flat&&!i&&(i=[]);var r,s,n={id:e.id,text:e.text,icon:this.get_icon(e),li_attr:O.extend(!0,{},e.li_attr),a_attr:O.extend(!0,{},e.a_attr),state:{},data:(!t||!t.no_data)&&O.extend(!0,{},e.data)};if(t&&t.flat?n.parent=e.parent:n.children=[],!t||!t.no_state)for(r in e.state)e.state.hasOwnProperty(r)&&(n.state[r]=e.state[r]);if(t&&t.no_id&&(delete n.id,n.li_attr&&n.li_attr.id&&delete n.li_attr.id,n.a_attr&&n.a_attr.id&&delete n.a_attr.id),t&&t.flat&&"#"!==e.id&&i.push(n),!t||!t.no_children)for(r=0,s=e.children.length;r<s;r++)t&&t.flat?this.get_json(e.children[r],t,i):n.children.push(this.get_json(e.children[r],t));return t&&t.flat?i:"#"===e.id?n.children:n},create_node:function(e,t,i,r,s){if(null===e&&(e="#"),!(e=this.get_node(e)))return!1;if(!(""+(i=i===A?"last":i)).match(/^(before|after)$/)&&!s&&!this.is_loaded(e))return this.load_node(e,function(){this.create_node(e,t,i,r,!0)});var n,a,o,d;switch((t=t||{text:this.get_string("New node")}).text===A&&(t.text=this.get_string("New node")),"#"===e.id&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":n=this.get_node(e.parent),i=O.inArray(e.id,n.children),e=n;break;case"after":n=this.get_node(e.parent),i=O.inArray(e.id,n.children)+1,e=n;break;case"inside":case"first":i=0;break;case"last":i=e.children.length;break;default:i=i||0}if(i>e.children.length&&(i=e.children.length),t.id||(t.id=!0),!this.check("create_node",t,e,i))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===t.id&&delete t.id,!(t=this._parse_model_from_json(t,e.id,e.parents.concat())))return!1;for(n=this.get_node(t),(a=[]).push(t),a=a.concat(n.children_d),this.trigger("model",{nodes:a,parent:e.id}),e.children_d=e.children_d.concat(a),o=0,d=e.parents.length;o<d;o++)this._model.data[e.parents[o]].children_d=this._model.data[e.parents[o]].children_d.concat(a);for(t=n,n=[],o=0,d=e.children.length;o<d;o++)n[i<=o?o+1:o]=e.children[o];return n[i]=t.id,e.children=n,this.redraw_node(e,!0),r&&r.call(this,this.get_node(t)),this.trigger("create_node",{node:this.get_node(t),parent:e.id,position:i}),t.id},rename_node:function(e,t){var i,r,s;if(O.isArray(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.rename_node(e[i],t);return!0}return!(!(e=this.get_node(e))||"#"===e.id)&&(s=e.text,this.check("rename_node",e,this.get_parent(e),t)?(this.set_text(e,t),this.trigger("rename_node",{node:e,text:t,old:s}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(e){var t,i,r,s,n,a,o,d,c,l;if(O.isArray(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.delete_node(e[t]);return!0}if(!(e=this.get_node(e))||"#"===e.id)return!1;if(r=this.get_node(e.parent),s=O.inArray(e.id,r.children),l=!1,!this.check("delete_node",e,r,s))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==s&&(r.children=O.vakata.array_remove(r.children,s)),(n=e.children_d.concat([])).push(e.id),d=0,c=n.length;d<c;d++){for(a=0,o=e.parents.length;a<o;a++)-1!==(s=O.inArray(n[d],this._model.data[e.parents[a]].children_d))&&(this._model.data[e.parents[a]].children_d=O.vakata.array_remove(this._model.data[e.parents[a]].children_d,s));this._model.data[n[d]].state.selected&&(l=!0,-1!==(s=O.inArray(n[d],this._data.core.selected))&&(this._data.core.selected=O.vakata.array_remove(this._data.core.selected,s)))}for(this.trigger("delete_node",{node:e,parent:r.id}),l&&this.trigger("changed",{action:"delete_node",node:e,selected:this._data.core.selected,parent:r.id}),d=0,c=n.length;d<c;d++)delete this._model.data[n[d]];return this.redraw_node(r,!0),!0},check:function(e,t,i,r,s){t=t&&t.id?t:this.get_node(t),i=i&&i.id?i:this.get_node(i);var n=e.match(/^move_node|copy_node|create_node$/i)?i:t,a=this.settings.core.check_callback;return"move_node"!==e&&"copy_node"!==e||s&&s.is_multi||t.id!==i.id&&O.inArray(t.id,i.children)!==r&&-1===O.inArray(i.id,t.children_d)?(n&&n.data&&(n=n.data),n&&n.functions&&(!1===n.functions[e]||!0===n.functions[e])?(!1===n.functions[e]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})}),n.functions[e]):!(!1===a||O.isFunction(a)&&!1===a.call(this,e,t,i,r,s)||a&&!1===a[e])||!(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})})):!(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})})},last_error:function(){return this._data.core.last_error},move_node:function(e,t,i,r,s,n){var a,o,d,c,l,h,_,u,g,f,p,m,v,j;if(t=this.get_node(t),i=i===A?0:i,!t)return!1;if(!(""+i).match(/^(before|after)$/)&&!s&&!this.is_loaded(t))return this.load_node(t,function(){this.move_node(e,t,i,r,!0)});if(O.isArray(e)){for(a=0,o=(e=e.slice()).length;a<o;a++)this.move_node(e[a],t,i,r,s,!0)&&(t=e[a],i="after");return this.redraw(),!0}if(!(e=e&&e.id?e:this.get_node(e))||"#"===e.id)return!1;if(d=""+(e.parent||"#"),l=(""+i).match(/^(before|after)$/)&&"#"!==t.id?this.get_node(t.parent):t,_=!(h=e.instance||(this._model.data[e.id]?this:O.jstree.reference(e.id)))||!h._id||this._id!==h._id,c=h&&h._id&&d&&h._model.data[d]&&h._model.data[d].children?O.inArray(e.id,h._model.data[d].children):-1,_)return!!this.copy_node(e,t,i,r,s)&&(h&&h.delete_node(e),!0);switch("#"===t.id&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":i=O.inArray(t.id,l.children);break;case"after":i=O.inArray(t.id,l.children)+1;break;case"inside":case"first":i=0;break;case"last":i=l.children.length;break;default:i=i||0}if(i>l.children.length&&(i=l.children.length),!this.check("move_node",e,l,i,{core:!0,is_multi:h&&h._id&&h._id!==this._id,is_foreign:!h||!h._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(e.parent===l.id){for(u=l.children.concat(),-1!==(g=O.inArray(e.id,u))&&(u=O.vakata.array_remove(u,g),g<i&&i--),g=[],f=0,p=u.length;f<p;f++)g[i<=f?f+1:f]=u[f];g[i]=e.id,l.children=g,this._node_changed(l.id),this.redraw("#"===l.id)}else{for((g=e.children_d.concat()).push(e.id),f=0,p=e.parents.length;f<p;f++){for(u=[],m=0,v=(j=h._model.data[e.parents[f]].children_d).length;m<v;m++)-1===O.inArray(j[m],g)&&u.push(j[m]);h._model.data[e.parents[f]].children_d=u}for(h._model.data[d].children=O.vakata.array_remove_item(h._model.data[d].children,e.id),f=0,p=l.parents.length;f<p;f++)this._model.data[l.parents[f]].children_d=this._model.data[l.parents[f]].children_d.concat(g);for(u=[],f=0,p=l.children.length;f<p;f++)u[i<=f?f+1:f]=l.children[f];for(u[i]=e.id,l.children=u,l.children_d.push(e.id),l.children_d=l.children_d.concat(e.children_d),e.parent=l.id,(g=l.parents.concat()).unshift(l.id),j=e.parents.length,g=(e.parents=g).concat(),f=0,p=e.children_d.length;f<p;f++)this._model.data[e.children_d[f]].parents=this._model.data[e.children_d[f]].parents.slice(0,-1*j),Array.prototype.push.apply(this._model.data[e.children_d[f]].parents,g);"#"!=d&&"#"!==l.id||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(d),this._node_changed(l.id)),n||this.redraw()}return r&&r.call(this,e,l,i),this.trigger("move_node",{node:e,parent:l.id,position:i,old_parent:d,old_position:c,is_multi:h&&h._id&&h._id!==this._id,is_foreign:!h||!h._id,old_instance:h,new_instance:this}),!0},copy_node:function(e,t,i,r,s,n){var a,o,d,c,l,h,_,u,g,f;if(t=this.get_node(t),i=i===A?0:i,!t)return!1;if(!(""+i).match(/^(before|after)$/)&&!s&&!this.is_loaded(t))return this.load_node(t,function(){this.copy_node(e,t,i,r,!0)});if(O.isArray(e)){for(a=0,o=(e=e.slice()).length;a<o;a++)(c=this.copy_node(e[a],t,i,r,s,!0))&&(t=c,i="after");return this.redraw(),!0}if(!(e=e&&e.id?e:this.get_node(e))||"#"===e.id)return!1;switch(u=""+(e.parent||"#"),g=(""+i).match(/^(before|after)$/)&&"#"!==t.id?this.get_node(t.parent):t,(f=e.instance||(this._model.data[e.id]?this:O.jstree.reference(e.id)))&&f._id&&(this._id,f._id),"#"===t.id&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":i=O.inArray(t.id,g.children);break;case"after":i=O.inArray(t.id,g.children)+1;break;case"inside":case"first":i=0;break;case"last":i=g.children.length;break;default:i=i||0}if(i>g.children.length&&(i=g.children.length),!this.check("copy_node",e,g,i,{core:!0,is_multi:f&&f._id&&f._id!==this._id,is_foreign:!f||!f._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(_=f?f.get_json(e,{no_id:!0,no_data:!0,no_state:!0}):e))return!1;if(!0===_.id&&delete _.id,!(_=this._parse_model_from_json(_,g.id,g.parents.concat())))return!1;for(c=this.get_node(_),e&&e.state&&!1===e.state.loaded&&(c.state.loaded=!1),(d=[]).push(_),d=d.concat(c.children_d),this.trigger("model",{nodes:d,parent:g.id}),l=0,h=g.parents.length;l<h;l++)this._model.data[g.parents[l]].children_d=this._model.data[g.parents[l]].children_d.concat(d);for(d=[],l=0,h=g.children.length;l<h;l++)d[i<=l?l+1:l]=g.children[l];return d[i]=c.id,g.children=d,g.children_d.push(c.id),g.children_d=g.children_d.concat(c.children_d),"#"===g.id&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(g.id),n||this.redraw("#"===g.id),r&&r.call(this,c,g,i),this.trigger("copy_node",{node:c,original:e,parent:g.id,position:i,old_parent:u,old_position:f&&f._id&&u&&f._model.data[u]&&f._model.data[u].children?O.inArray(e.id,f._model.data[u].children):-1,is_multi:f&&f._id&&f._id!==this._id,is_foreign:!f||!f._id,old_instance:f,new_instance:this}),c.id},cut:function(e){if(e=e||this._data.core.selected.concat(),O.isArray(e)||(e=[e]),!e.length)return!1;for(var t,i=[],r=0,s=e.length;r<s;r++)(t=this.get_node(e[r]))&&t.id&&"#"!==t.id&&i.push(t);return!!i.length&&(n=i,a="move_node",(o=this).trigger("cut",{node:e}),A)},copy:function(e){if(e=e||this._data.core.selected.concat(),O.isArray(e)||(e=[e]),!e.length)return!1;for(var t,i=[],r=0,s=e.length;r<s;r++)(t=this.get_node(e[r]))&&t.id&&"#"!==t.id&&i.push(t);return!!i.length&&(n=i,a="copy_node",(o=this).trigger("copy",{node:e}),A)},get_buffer:function(){return{mode:a,node:n,inst:o}},can_paste:function(){return!1!==a&&!1!==n},paste:function(e,t){return!!((e=this.get_node(e))&&a&&a.match(/^(copy_node|move_node)$/)&&n)&&(this[a](n,e,t)&&this.trigger("paste",{parent:e.id,node:n,mode:a}),o=a=n=!1,A)},clear_buffer:function(){o=a=n=!1,this.trigger("clear_buffer")},edit:function(t,e){if(!(t=this.get_node(t)))return!1;if(!1===this.settings.core.check_callback)return this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1;e="string"==typeof e?e:t.text,this.set_text(t,""),t=this._open_to(t);var i=this._data.core.rtl,r=this.element.width(),s=t.children(".jstree-anchor"),n=O("<span>"),a=e,o=O("<div />",{css:{position:"absolute",top:"-200px",left:i?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),d=O("<input />",{value:a,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:O.proxy(function(){var e=n.children(".jstree-rename-input").val();""===e&&(e=a),o.remove(),n.replaceWith(s),n.remove(),this.set_text(t,a),!1===this.rename_node(t,O("<div></div>").text(e)[this.settings.core.force_text?"text":"html"]())&&this.set_text(t,a)},this),keydown:function(e){var t=e.which;27===t&&(this.value=a),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){d.width(Math.min(o.text("pW"+this.value).width(),r))},keypress:function(e){return 13!==e.which&&A}}),i={fontFamily:s.css("fontFamily")||"",fontSize:s.css("fontSize")||"",fontWeight:s.css("fontWeight")||"",fontStyle:s.css("fontStyle")||"",fontStretch:s.css("fontStretch")||"",fontVariant:s.css("fontVariant")||"",letterSpacing:s.css("letterSpacing")||"",wordSpacing:s.css("wordSpacing")||""};n.attr("class",s.attr("class")).append(s.contents().clone()).append(d),s.replaceWith(n),o.css(i),d.css(i).width(Math.min(o.text("pW"+d[0].value).width(),r))[0].select()},set_theme:function(e,t){if(!e)return!1;!0===t&&(t=(this.settings.core.themes.dir||O.jstree.path+"/themes")+"/"+e+"/style.css"),t&&-1===O.inArray(t,i)&&(O("head").append('<link rel="stylesheet" href="'+t+'" type="text/css" />'),i.push(t)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=e,this.element.addClass("jstree-"+e),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+e+"-responsive"),this.trigger("set_theme",{theme:e})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),(this._data.core.themes.variant=e)&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(e,t){var i,r,s,n;if(O.isArray(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.set_icon(e[i],t);return!0}return!(!(e=this.get_node(e))||"#"===e.id)&&(n=e.icon,e.icon=t,s=this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===t?this.hide_icon(e):(!0===t?s.removeClass("jstree-themeicon-custom "+n).css("background","").removeAttr("rel"):-1===t.indexOf("/")&&-1===t.indexOf(".")?(s.removeClass(n).css("background",""),s.addClass(t+" jstree-themeicon-custom").attr("rel",t)):(s.removeClass(n).css("background",""),s.addClass("jstree-themeicon-custom").css("background","url('"+t+"') center center no-repeat").attr("rel",t)),!1===n&&this.show_icon(e)),!0)},get_icon:function(e){return!(!(e=this.get_node(e))||"#"===e.id)&&e.icon},hide_icon:function(e){var t,i;if(O.isArray(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.hide_icon(e[t]);return!0}return!(!(e=this.get_node(e))||"#"===e)&&(e.icon=!1,this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(e){var t,i,r;if(O.isArray(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.show_icon(e[t]);return!0}return!(!(e=this.get_node(e))||"#"===e)&&(r=this.get_node(e,!0),e.icon=!r.length||r.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),e.icon||(e.icon=!0),r.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},O.vakata={},O.vakata.attributes=function(e,i){e=O(e)[0];var r=i?{}:[];return e&&e.attributes&&O.each(e.attributes,function(e,t){-1===O.inArray(t.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==t.value&&""!==O.trim(t.value)&&(i?r[t.name]=t.value:r.push(t.name))}),r},O.vakata.array_unique=function(e){for(var t,i=[],r=0,s=e.length;r<s;r++){for(t=0;t<=r&&e[r]!==e[t];t++);t===r&&i.push(e[r])}return i},O.vakata.array_remove=function(e,t,i){i=e.slice((i||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,i),e},O.vakata.array_remove_item=function(e,t){t=O.inArray(t,e);return-1!==t?O.vakata.array_remove(e,t):e},(d=document.createElement("I")).className="jstree-icon jstree-checkbox",d.setAttribute("role","presentation"),O.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},O.jstree.plugins.checkbox=function(e,o){this.bind=function(){o.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",O.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",O.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",O.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(O.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",O.proxy(function(e,t){for(var i=this._model.data,r=(i[t.parent],t.nodes),s=0,n=r.length;s<n;s++)i[r[s]].state.checked=i[r[s]].original&&i[r[s]].original.state&&i[r[s]].original.state.checked,i[r[s]].state.checked&&this._data.checkbox.selected.push(r[s])},this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",O.proxy(function(e,t){var i,r,s,n,a,o,d=this._model.data,c=d[t.parent],l=t.nodes,h=[],t=this.settings.checkbox.cascade,_=this.settings.checkbox.tie_selection;if(-1!==t.indexOf("down"))if(c.state[_?"selected":"checked"]){for(r=0,s=l.length;r<s;r++)d[l[r]].state[_?"selected":"checked"]=!0;this._data[_?"core":"checkbox"].selected=this._data[_?"core":"checkbox"].selected.concat(l)}else for(r=0,s=l.length;r<s;r++)if(d[l[r]].state[_?"selected":"checked"]){for(n=0,a=d[l[r]].children_d.length;n<a;n++)d[d[l[r]].children_d[n]].state[_?"selected":"checked"]=!0;this._data[_?"core":"checkbox"].selected=this._data[_?"core":"checkbox"].selected.concat(d[l[r]].children_d)}if(-1!==t.indexOf("up")){for(r=0,s=c.children_d.length;r<s;r++)d[c.children_d[r]].children.length||h.push(d[c.children_d[r]].parent);for(n=0,a=(h=O.vakata.array_unique(h)).length;n<a;n++)for(c=d[h[n]];c&&"#"!==c.id;){for(r=i=0,s=c.children.length;r<s;r++)i+=d[c.children[r]].state[_?"selected":"checked"];if(i!==s)break;c.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(c.id),(o=this.get_node(c,!0))&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}}this._data[_?"core":"checkbox"].selected=O.vakata.array_unique(this._data[_?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",O.proxy(function(e,t){var i,r,s,n,a=t.node,o=this._model.data,d=this.get_node(a.parent),c=this.get_node(a,!0),t=this.settings.checkbox.cascade,l=this.settings.checkbox.tie_selection;if(-1!==t.indexOf("down"))for(this._data[l?"core":"checkbox"].selected=O.vakata.array_unique(this._data[l?"core":"checkbox"].selected.concat(a.children_d)),i=0,r=a.children_d.length;i<r;i++)(n=o[a.children_d[i]]).state[l?"selected":"checked"]=!0,n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1);if(-1!==t.indexOf("up"))for(;d&&"#"!==d.id;){for(i=s=0,r=d.children.length;i<r;i++)s+=o[d.children[i]].state[l?"selected":"checked"];if(s!==r)break;d.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(d.id),(n=this.get_node(d,!0))&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked"),d=this.get_node(d.parent)}-1!==t.indexOf("down")&&c.length&&c.find(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!0)},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",O.proxy(function(e,t){for(var i,r=this.get_node("#"),s=this._model.data,n=0,a=r.children_d.length;n<a;n++)(i=s[r.children_d[n]])&&i.original&&i.original.state&&i.original.state.undetermined&&(i.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",O.proxy(function(e,t){var i,r,s,n=t.node,t=this.get_node(n,!0),a=this.settings.checkbox.cascade,o=this.settings.checkbox.tie_selection;if(n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1),-1!==a.indexOf("down"))for(i=0,r=n.children_d.length;i<r;i++)(s=this._model.data[n.children_d[i]]).state[o?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1);if(-1!==a.indexOf("up"))for(i=0,r=n.parents.length;i<r;i++)(s=this._model.data[n.parents[i]]).state[o?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1),(s=this.get_node(n.parents[i],!0))&&s.length&&s.attr("aria-selected",!1).children(".jstree-anchor").removeClass(o?"jstree-clicked":"jstree-checked");for(s=[],i=0,r=this._data[o?"core":"checkbox"].selected.length;i<r;i++)-1!==a.indexOf("down")&&-1!==O.inArray(this._data[o?"core":"checkbox"].selected[i],n.children_d)||-1!==a.indexOf("up")&&-1!==O.inArray(this._data[o?"core":"checkbox"].selected[i],n.parents)||s.push(this._data[o?"core":"checkbox"].selected[i]);this._data[o?"core":"checkbox"].selected=O.vakata.array_unique(s),-1!==a.indexOf("down")&&t.length&&t.find(".jstree-anchor").removeClass(o?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!1)},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",O.proxy(function(e,t){for(var i,r,s,n,a=this.get_node(t.parent),o=this._model.data,d=this.settings.checkbox.tie_selection;a&&"#"!==a.id;){for(i=s=0,r=a.children.length;i<r;i++)s+=o[a.children[i]].state[d?"selected":"checked"];if(s!==r)break;a.state[d?"selected":"checked"]=!0,this._data[d?"core":"checkbox"].selected.push(a.id),(n=this.get_node(a,!0))&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass(d?"jstree-clicked":"jstree-checked"),a=this.get_node(a.parent)}},this)).on("move_node.jstree",O.proxy(function(e,t){var i,r,s,n,a,o=t.is_multi,d=t.old_parent,t=this.get_node(t.parent),c=this._model.data,l=this.settings.checkbox.tie_selection;if(!o)for(i=this.get_node(d);i&&"#"!==i.id;){for(s=r=0,n=i.children.length;s<n;s++)r+=c[i.children[s]].state[l?"selected":"checked"];if(r!==n)break;i.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(i.id),(a=this.get_node(i,!0))&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked"),i=this.get_node(i.parent)}for(i=t;i&&"#"!==i.id;){for(s=r=0,n=i.children.length;s<n;s++)r+=c[i.children[s]].state[l?"selected":"checked"];if(r===n)i.state[l?"selected":"checked"]||(i.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(i.id),(a=this.get_node(i,!0))&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked"));else{if(!i.state[l?"selected":"checked"])break;i.state[l?"selected":"checked"]=!1,this._data[l?"core":"checkbox"].selected=O.vakata.array_remove_item(this._data[l?"core":"checkbox"].selected,i.id),(a=this.get_node(i,!0))&&a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass(l?"jstree-clicked":"jstree-checked")}i=this.get_node(i.parent)}},this))},this._undetermined=function(){for(var i=this._model.data,e=this.settings.checkbox.tie_selection,t=this._data[e?"core":"checkbox"].selected,r=[],s=this,n=0,a=t.length;n<a;n++)i[t[n]]&&i[t[n]].parents&&(r=r.concat(i[t[n]].parents));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var e,t=s.get_node(this);if(t.state.loaded)for(n=0,a=t.children_d.length;n<a;n++)!(e=i[t.children_d[n]]).state.loaded&&e.original&&e.original.state&&e.original.state.undetermined&&!0===e.original.state.undetermined&&(r.push(e.id),r=r.concat(e.parents));else t.original&&t.original.state&&t.original.state.undetermined&&!0===t.original.state.undetermined&&(r.push(t.id),r=r.concat(t.parents))}),r=O.vakata.array_unique(r),r=O.vakata.array_remove_item(r,"#"),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),n=0,a=r.length;n<a;n++)i[r[n]].state[e?"selected":"checked"]||(t=this.get_node(r[n],!0))&&t.length&&t.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")},this.redraw_node=function(e,t,i,r){if(e=o.redraw_node.apply(this,arguments)){for(var s=null,n=0,a=e.childNodes.length;n<a;n++)if(e.childNodes[n]&&e.childNodes[n].className&&-1!==e.childNodes[n].className.indexOf("jstree-anchor")){s=e.childNodes[n];break}s&&(!this.settings.checkbox.tie_selection&&this._model.data[e.id].state.checked&&(s.className+=" jstree-checked"),s.insertBefore(d.cloneNode(!1),s.childNodes[0]))}return i||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(O.proxy(this._undetermined,this),50)),e},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(e){e=this.get_node(e);var t,i,r=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection,n=this._data[s?"core":"checkbox"].selected,a=this._model.data;if(!e||!0===e.state[s?"selected":"checked"]||-1===r.indexOf("undetermined")||-1===r.indexOf("down")&&-1===r.indexOf("up"))return!1;if(!e.state.loaded&&!0===e.original.state.undetermined)return!0;for(t=0,i=e.children_d.length;t<i;t++)if(-1!==O.inArray(e.children_d[t],n)||!a[e.children_d[t]].state.loaded&&a[e.children_d[t]].original.state.undetermined)return!0;return!1},this.activate_node=function(e,t){return this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||O(t.target).hasClass("jstree-checkbox"))&&(t.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!O(t.target).hasClass("jstree-checkbox")?o.activate_node.call(this,e,t):(this.is_checked(e)?this.uncheck_node(e,t):this.check_node(e,t),this.trigger("activate_node",{node:this.get_node(e)}),A)},this.check_node=function(e,t){if(this.settings.checkbox.tie_selection)return this.select_node(e,!1,!0,t);var i,r,s;if(O.isArray(e)){for(r=0,s=(e=e.slice()).length;r<s;r++)this.check_node(e[r],t);return!0}return!(!(e=this.get_node(e))||"#"===e.id)&&(i=this.get_node(e,!0),e.state.checked||(e.state.checked=!0,this._data.checkbox.selected.push(e.id),i&&i.length&&i.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:e,selected:this._data.checkbox.selected,event:t})),A)},this.uncheck_node=function(e,t){if(this.settings.checkbox.tie_selection)return this.deselect_node(e,!1,t);var i,r,s;if(O.isArray(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.uncheck_node(e[i],t);return!0}return!(!(e=this.get_node(e))||"#"===e.id)&&(s=this.get_node(e,!0),e.state.checked&&(e.state.checked=!1,this._data.checkbox.selected=O.vakata.array_remove_item(this._data.checkbox.selected,e.id),s.length&&s.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:e,selected:this._data.checkbox.selected,event:t})),A)},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var e,t;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data["#"].children_d.concat(),e=0,t=this._data.checkbox.selected.length;e<t;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();for(var e=this._data.checkbox.selected.concat([]),t=0,i=this._data.checkbox.selected.length;t<i;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:e})},this.is_checked=function(e){return this.settings.checkbox.tie_selection?this.is_selected(e):!(!(e=this.get_node(e))||"#"===e.id)&&e.state.checked},this.get_checked=function(e){return this.settings.checkbox.tie_selection?this.get_selected(e):e?O.map(this._data.checkbox.selected,O.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected},this.get_top_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_top_selected(e);for(var t,i,r=this.get_checked(!0),s={},n=0,a=r.length;n<a;n++)s[r[n].id]=r[n];for(n=0,a=r.length;n<a;n++)for(t=0,i=r[n].children_d.length;t<i;t++)s[r[n].children_d[t]]&&delete s[r[n].children_d[t]];for(n in r=[],s)s.hasOwnProperty(n)&&r.push(n);return e?O.map(r,O.proxy(function(e){return this.get_node(e)},this)):r},this.get_bottom_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(e);for(var t=this.get_checked(!0),i=[],r=0,s=t.length;r<s;r++)t[r].children.length||i.push(t[r].id);return e?O.map(i,O.proxy(function(e){return this.get_node(e)},this)):i}},O.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(e,t){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(e){var t=O.jstree.reference(e.reference),e=t.get_node(e.reference);t.create_node(e,{},"last",function(e){setTimeout(function(){t.edit(e)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(e){var t=O.jstree.reference(e.reference),e=t.get_node(e.reference);t.edit(e)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(e){var t=O.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.delete_node(t.get_selected()):t.delete_node(e)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(e){var t=O.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.cut(t.get_selected()):t.cut(e)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(e){var t=O.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.copy(t.get_selected()):t.copy(e)}},paste:{separator_before:!1,icon:!1,_disabled:function(e){return!O.jstree.reference(e.reference).can_paste()},separator_after:!1,label:"Paste",action:function(e){var t=O.jstree.reference(e.reference),e=t.get_node(e.reference);t.paste(e)}}}}}}},O.jstree.plugins.contextmenu=function(e,i){this.bind=function(){i.bind.call(this);var t=0;this.element.on("contextmenu.jstree",".jstree-anchor",O.proxy(function(e){e.preventDefault(),t=e.ctrlKey?e.timeStamp:0,this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e)},this)).on("click.jstree",".jstree-anchor",O.proxy(function(e){this._data.contextmenu.visible&&(!t||250<e.timeStamp-t)&&O.vakata.context.hide()},this)),O(document).on("context_hide.vakata.jstree",O.proxy(function(){this._data.contextmenu.visible=!1},this))},this.teardown=function(){this._data.contextmenu.visible&&O.vakata.context.hide(),i.teardown.call(this)},this.show_contextmenu=function(t,i,r,e){if(!(t=this.get_node(t))||"#"===t.id)return!1;var s,n=this.settings.contextmenu,a=this.get_node(t,!0).children(".jstree-anchor"),o=!1;!n.show_at_node&&i!==A&&r!==A||(s=a.offset(),i=s.left,r=s.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(t)&&this.activate_node(t,e),o=n.items,O.isFunction(o)&&(o=o.call(this,t,O.proxy(function(e){this._show_contextmenu(t,i,r,e)},this))),O.isPlainObject(o)&&this._show_contextmenu(t,i,r,o)},this._show_contextmenu=function(e,t,i,r){var s=this.get_node(e,!0).children(".jstree-anchor");O(document).one("context_show.vakata.jstree",O.proxy(function(e,t){var i="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";O(t.element).addClass(i)},this)),this._data.contextmenu.visible=!0,O.vakata.context.show(s,{x:t,y:i},r),this.trigger("show_contextmenu",{node:e,x:t,y:i})}},f={element:g=!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1},(u=O).vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(e){u(document).triggerHandler("context_"+e+".vakata",{reference:f.reference,element:f.element,position:{x:f.position_x,y:f.position_y}})},_execute:function(e){return!(!(e=f.items[e])||e._disabled&&(!u.isFunction(e._disabled)||e._disabled({item:e,reference:f.reference,element:f.element}))||!e.action)&&e.action.call(null,{item:e,reference:f.reference,element:f.element,position:{x:f.position_x,y:f.position_y}})},_parse:function(e,t){if(!e)return!1;t||(f.html="",f.items=[]);var i,r="",s=!1;return t&&(r+="<ul>"),u.each(e,function(e,t){return!t||(f.items.push(t),!s&&t.separator_before&&(r+="<li class='vakata-context-separator'><a href='#' "+(u.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),s=!1,r+="<li class='"+(t._class||"")+(!0===t._disabled||u.isFunction(t._disabled)&&t._disabled({item:t,reference:f.reference,element:f.element})?" vakata-contextmenu-disabled ":"")+"' "+(t.shortcut?" data-shortcut='"+t.shortcut+"' ":"")+">",r+="<a href='#' rel='"+(f.items.length-1)+"'>",u.vakata.context.settings.icons&&(r+="<i ",t.icon&&(r+=-1!==t.icon.indexOf("/")||-1!==t.icon.indexOf(".")?" style='background:url(\""+t.icon+"\") center center no-repeat' ":" class='"+t.icon+"' "),r+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),r+=(u.isFunction(t.label)?t.label({item:e,reference:f.reference,element:f.element}):t.label)+(t.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+t.shortcut+'">'+(t.shortcut_label||"")+"</span>":"")+"</a>",t.submenu&&((i=u.vakata.context._parse(t.submenu,!0))&&(r+=i)),r+="</li>",t.separator_after&&(r+="<li class='vakata-context-separator'><a href='#' "+(u.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",s=!0),A)}),r=r.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),t&&(r+="</ul>"),t||(f.html=r,u.vakata.context._trigger("parse")),10<r.length&&r},_show_submenu:function(e){var t,i,r,s,n,a,o;(e=u(e)).length&&e.children("ul").length&&(t=e.children("ul"),i=e.offset().left+e.outerWidth(),r=e.offset().top,s=t.width(),n=t.height(),a=u(window).width()+u(window).scrollLeft(),o=u(window).height()+u(window).scrollTop(),g?e[i-(s+10+e.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):e[a<i+s+10?"addClass":"removeClass"]("vakata-context-right"),o<r+n+10&&t.css("bottom","-1px"),t.show())},show:function(e,t,i){var r,s,n,a,o,d,c;switch(f.element&&f.element.length&&f.element.width(""),!0){case!t&&!e:return!1;case!!t&&!!e:f.reference=e,f.position_x=t.x,f.position_y=t.y;break;case!t&&!!e:r=(f.reference=e).offset(),f.position_x=r.left+e.outerHeight(),f.position_y=r.top;break;case!!t&&!e:f.position_x=t.x,f.position_y=t.y}e&&!i&&u(e).data("vakata_contextmenu")&&(i=u(e).data("vakata_contextmenu")),u.vakata.context._parse(i)&&f.element.html(f.html),f.items.length&&(f.element.appendTo("body"),s=f.element,n=f.position_x,a=f.position_y,o=s.width(),d=s.height(),c=u(window).width()+u(window).scrollLeft(),i=u(window).height()+u(window).scrollTop(),g&&(n-=s.outerWidth(),u(window).scrollLeft()+20>n&&(n=u(window).scrollLeft()+20)),c<n+o+20&&(n=c-(o+20)),i<a+d+20&&(a=i-(d+20)),f.element.css({left:n,top:a}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),f.is_visible=!0,u.vakata.context._trigger("show"))},hide:function(){f.is_visible&&(f.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),f.is_visible=!1,u.vakata.context._trigger("hide"))}},u(function(){g="rtl"===u("body").css("direction");var t=!1;f.element=u("<ul class='vakata-context'></ul>"),f.element.on("mouseenter","li",function(e){e.stopImmediatePropagation(),u.contains(this,e.relatedTarget)||(t&&clearTimeout(t),f.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),u(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),u.vakata.context._show_submenu(this))}).on("mouseleave","li",function(e){u.contains(this,e.relatedTarget)||u(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(e){u(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),u.vakata.context.settings.hide_onmouseleave&&(t=setTimeout(function(){u.vakata.context.hide()},u.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(e){e.preventDefault(),u(this).blur().parent().hasClass("vakata-context-disabled")||!1===u.vakata.context._execute(u(this).attr("rel"))||u.vakata.context.hide()}).on("keydown","a",function(e){var t=null;switch(e.which){case 13:case 32:e.type="mouseup",e.preventDefault(),u(e.currentTarget).trigger(e);break;case 37:f.is_visible&&(f.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 38:f.is_visible&&((t=f.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first()).length||(t=f.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),t.addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 39:f.is_visible&&(f.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 40:f.is_visible&&((t=f.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first()).length||(t=f.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),t.addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 27:u.vakata.context.hide(),e.preventDefault()}}).on("keydown",function(e){e.preventDefault();e=f.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();e.parent().not(".vakata-context-disabled")&&e.click()}),u(document).on("mousedown.vakata.jstree",function(e){f.is_visible&&!u.contains(f.element[0],e.target)&&u.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,t){f.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),g&&f.element.addClass("vakata-context-rtl").css("direction","rtl"),f.element.find("ul").hide().end()})}),O.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0},O.jstree.plugins.dnd=function(e,t){this.bind=function(){t.bind.call(this),this.element.on("mousedown.jstree touchstart.jstree",".jstree-anchor",O.proxy(function(e){var t=this.get_node(e.target),i=this.is_selected(t)?this.get_selected().length:1;return t&&t.id&&"#"!==t.id&&(1===e.which||"touchstart"===e.type)&&(!0===this.settings.dnd.is_draggable||O.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,1<i?this.get_selected(!0):[t]))?(this.element.trigger("mousedown.jstree"),O.vakata.dnd.start(e,{jstree:!0,origin:this,obj:this.get_node(t,!0),nodes:1<i?this.get_selected():[t.id]},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+(1<i?i+" "+this.get_string("nodes"):this.get_text(e.currentTarget,!0))+'<ins class="jstree-copy" style="display:none;">+</ins></div>')):A},this))}},O(function(){var x=!1,b=!1,w=!1,C=O('<div id="jstree-marker">&#160;</div>').hide();O(document).on("dnd_start.vakata.jstree",function(e,t){x=!1,t&&t.data&&t.data.jstree&&C.appendTo("body")}).on("dnd_move.vakata.jstree",function(e,s){if(w&&clearTimeout(w),s&&s.data&&s.data.jstree&&(!s.event.target.id||"jstree-marker"!==s.event.target.id)){var n,t,a,o,d,c,l,h,_,u,g,f,p,m,v,j,y=O.jstree.reference(s.event.target),k=!1;if(y&&y._data&&y._data.dnd)if(C.attr("class","jstree-"+y.get_theme()+(y.settings.core.themes.responsive?" jstree-dnd-responsive":"")),s.helper.children().attr("class","jstree-"+y.get_theme()+" jstree-"+y.get_theme()+"-"+y.get_theme_variant()+" "+(y.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey))?"show":"hide"](),s.event.target!==y.element[0]&&s.event.target!==y.get_container_ul()[0]||0!==y.get_container_ul().children().length){if((k=O(s.event.target).closest(".jstree-anchor"))&&k.length&&k.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(n=k.offset(),t=s.event.pageY-n.top,d=k.height(),h=t<d/3?["b","i","a"]:d-d/3<t?["a","i","b"]:d/2<t?["i","a","b"]:["i","b","a"],O.each(h,function(e,t){switch(t){case"b":a=n.left-6,o=n.top,c=y.get_parent(k),l=k.parent().index();break;case"i":v=y.settings.dnd.inside_pos,j=y.get_node(k.parent()),a=n.left-2,o=n.top+d/2+1,c=j.id,l="first"===v?0:"last"===v?j.children.length:Math.min(v,j.children.length);break;case"a":a=n.left-6,o=n.top+d,c=y.get_parent(k),l=k.parent().index()+1}for(_=!0,u=0,g=s.data.nodes.length;u<g;u++)if(f=s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey))?"copy_node":"move_node",p=l,"move_node"==f&&"a"===t&&s.data.origin&&s.data.origin===y&&c===y.get_parent(s.data.nodes[u])&&(m=y.get_node(c),p>O.inArray(s.data.nodes[u],m.children)&&--p),!(_=_&&(y&&y.settings&&y.settings.dnd&&!1===y.settings.dnd.check_while_dragging||y.check(f,s.data.origin&&s.data.origin!==y?s.data.origin.get_node(s.data.nodes[u]):s.data.nodes[u],c,p,{dnd:!0,ref:y.get_node(k.parent()),pos:t,is_multi:s.data.origin&&s.data.origin!==y,is_foreign:!s.data.origin})))){y&&y.last_error&&(b=y.last_error());break}return"i"===t&&k.parent().is(".jstree-closed")&&y.settings.dnd.open_timeout&&(w=setTimeout((r=k,function(){i.open_node(r)}),(i=y).settings.dnd.open_timeout)),_?(x={ins:y,par:c,pos:"i"!==t||"last"!==v||0!==l||y.is_loaded(j)?l:"last"},C.css({left:a+"px",top:o+"px"}).show(),s.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),b={},!(h=!0)):A;var i,r}),!0===h))return}else{for(_=!0,u=0,g=s.data.nodes.length;u<g&&(_=_&&y.check(s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey))?"copy_node":"move_node",s.data.origin&&s.data.origin!==y?s.data.origin.get_node(s.data.nodes[u]):s.data.nodes[u],"#","last",{dnd:!0,ref:y.get_node("#"),pos:"i",is_multi:s.data.origin&&s.data.origin!==y,is_foreign:!s.data.origin}));u++);if(_)return x={ins:y,par:"#",pos:"last"},C.hide(),s.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),A}x=!1,s.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),C.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(C.hide(),x=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(e,t){if(w&&clearTimeout(w),t&&t.data&&t.data.jstree){C.hide().detach();var i,r,s=[];if(x){for(i=0,r=t.data.nodes.length;i<r;i++)s[i]=t.data.origin?t.data.origin.get_node(t.data.nodes[i]):t.data.nodes[i],t.data.origin&&(s[i].instance=t.data.origin);for(x.ins[t.data.origin&&(t.data.origin.settings.dnd.always_copy||t.data.origin.settings.dnd.copy&&(t.event.metaKey||t.event.ctrlKey))?"copy_node":"move_node"](s,x.par,x.pos),i=0,r=s.length;i<r;i++)s[i].instance&&(s[i].instance=null)}else(i=O(t.event.target).closest(".jstree")).length&&b&&b.error&&"check"===b.error&&((i=i.jstree(!0))&&i.settings.core.error.call(this,b))}}).on("keyup.jstree keydown.jstree",function(e,t){(t=O.vakata.dnd._get())&&t.data&&t.data.jstree&&t.helper.find(".jstree-copy").first()[t.data.origin&&(t.data.origin.settings.dnd.always_copy||t.data.origin.settings.dnd.copy&&(e.metaKey||e.ctrlKey))?"show":"hide"]()})}),_={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},(h=O).vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(e,t){var i=h.vakata.dnd._get();i.event=t,h(document).triggerHandler("dnd_"+e+".vakata",i)},_get:function(){return{data:_.data,element:_.element,helper:_.helper}},_clean:function(){_.helper&&_.helper.remove(),_.scroll_i&&(clearInterval(_.scroll_i),_.scroll_i=!1),_={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},h(document).off("mousemove.vakata.jstree touchmove.vakata.jstree",h.vakata.dnd.drag),h(document).off("mouseup.vakata.jstree touchend.vakata.jstree",h.vakata.dnd.stop)},_scroll:function(e){if(!_.scroll_e||!_.scroll_l&&!_.scroll_t)return _.scroll_i&&(clearInterval(_.scroll_i),_.scroll_i=!1),!1;if(!_.scroll_i)return _.scroll_i=setInterval(h.vakata.dnd._scroll,100),!1;if(!0===e)return!1;var t=_.scroll_e.scrollTop(),e=_.scroll_e.scrollLeft();_.scroll_e.scrollTop(t+_.scroll_t*h.vakata.dnd.settings.scroll_speed),_.scroll_e.scrollLeft(e+_.scroll_l*h.vakata.dnd.settings.scroll_speed),t===_.scroll_e.scrollTop()&&e===_.scroll_e.scrollLeft()||h.vakata.dnd._trigger("scroll",_.scroll_e)},start:function(e,t,i){"touchstart"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=document.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),_.is_drag&&h.vakata.dnd.stop({});try{e.currentTarget.unselectable="on",e.currentTarget.onselectstart=function(){return!1},e.currentTarget.style&&(e.currentTarget.style.MozUserSelect="none")}catch(e){}return _.init_x=e.pageX,_.init_y=e.pageY,_.data=t,_.is_down=!0,_.element=e.currentTarget,_.target=e.target,_.is_touch="touchstart"===e.type,!1!==i&&(_.helper=h("<div id='vakata-dnd'></div>").html(i).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),h(document).on("mousemove.vakata.jstree touchmove.vakata.jstree",h.vakata.dnd.drag),h(document).on("mouseup.vakata.jstree touchend.vakata.jstree",h.vakata.dnd.stop),!1},drag:function(i){if("touchmove"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=document.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),_.is_down){if(!_.is_drag){if(!(Math.abs(i.pageX-_.init_x)>(_.is_touch?h.vakata.dnd.settings.threshold_touch:h.vakata.dnd.settings.threshold)||Math.abs(i.pageY-_.init_y)>(_.is_touch?h.vakata.dnd.settings.threshold_touch:h.vakata.dnd.settings.threshold)))return;_.helper&&(_.helper.appendTo("body"),_.helper_w=_.helper.outerWidth()),_.is_drag=!0,h.vakata.dnd._trigger("start",i)}var e,t,r,s,n=!1,a=!1,o=!1,d=!1,c=!1,l=!1;return _.scroll_t=0,_.scroll_l=0,_.scroll_e=!1,h(h(i.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(h(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var e=h(this),t=e.offset();return this.scrollHeight>this.offsetHeight&&(t.top+e.height()-i.pageY<h.vakata.dnd.settings.scroll_proximity&&(_.scroll_t=1),i.pageY-t.top<h.vakata.dnd.settings.scroll_proximity&&(_.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(t.left+e.width()-i.pageX<h.vakata.dnd.settings.scroll_proximity&&(_.scroll_l=1),i.pageX-t.left<h.vakata.dnd.settings.scroll_proximity&&(_.scroll_l=-1)),_.scroll_t||_.scroll_l?(_.scroll_e=h(this),!1):A}),_.scroll_e||(n=h(document),a=h(window),o=n.height(),e=a.height(),d=n.width(),t=a.width(),r=n.scrollTop(),s=n.scrollLeft(),e<o&&i.pageY-r<h.vakata.dnd.settings.scroll_proximity&&(_.scroll_t=-1),e<o&&e-(i.pageY-r)<h.vakata.dnd.settings.scroll_proximity&&(_.scroll_t=1),t<d&&i.pageX-s<h.vakata.dnd.settings.scroll_proximity&&(_.scroll_l=-1),t<d&&t-(i.pageX-s)<h.vakata.dnd.settings.scroll_proximity&&(_.scroll_l=1),(_.scroll_t||_.scroll_l)&&(_.scroll_e=n)),_.scroll_e&&h.vakata.dnd._scroll(!0),_.helper&&(c=parseInt(i.pageY+h.vakata.dnd.settings.helper_top,10),l=parseInt(i.pageX+h.vakata.dnd.settings.helper_left,10),o&&o<c+25&&(c=o-50),d&&l+_.helper_w>d&&(l=d-(_.helper_w+2)),_.helper.css({left:l+"px",top:c+"px"})),h.vakata.dnd._trigger("move",i),!1}},stop:function(e){var t;return"touchend"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=document.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),_.is_drag?h.vakata.dnd._trigger("stop",e):"touchend"===e.type&&e.target===_.target&&(t=setTimeout(function(){h(e.target).click()},100),h(e.target).one("click",function(){t&&clearTimeout(t)})),h.vakata.dnd._clean(),!1}},O.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},O.jstree.plugins.search=function(e,t){this.bind=function(){t.bind.call(this),this._data.search.str="",this._data.search.dom=O(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this.element.on("before_open.jstree",O.proxy(function(e,t){var i,r,s=this._data.search.res,n=[],a=O();if(s&&s.length&&(this._data.search.dom=O(this.element[0].querySelectorAll("#"+O.map(s,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(O.jstree.idregex,"\\$&"):e.replace(O.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search"),this._data.search.som&&this._data.search.res.length)){for(i=0,r=s.length;i<r;i++)n=n.concat(this.get_node(s[i]).parents);a=(n=O.vakata.array_remove_item(O.vakata.array_unique(n),"#")).length?O(this.element[0].querySelectorAll("#"+O.map(n,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(O.jstree.idregex,"\\$&"):e.replace(O.jstree.idregex,"\\$&")}).join(", #"))):O(),this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last"),(a=a.add(this._data.search.dom)).parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){O(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")})}},this)).on("search.jstree",O.proxy(function(e,t){this._data.search.som&&t.nodes.length&&(this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last"),t.nodes.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){O(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")}))},this)).on("clear_search.jstree",O.proxy(function(e,t){this._data.search.som&&t.nodes.length&&this.element.find(".jstree-node").css("display","").filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last")},this))},this.search=function(i,e,t){if(!1===i||""===O.trim(""+i))return this.clear_search();i=""+i;var r=this.settings.search,s=r.ajax||!1,n=null,a=[],o=[];return this._data.search.res.length&&this.clear_search(),t===A&&(t=r.show_only_matches),e||!1===s?(this._data.search.str=i,this._data.search.dom=O(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=t,n=new O.vakata.search(i,!0,{caseSensitive:r.case_sensitive,fuzzy:r.fuzzy}),O.each(this._model.data,function(e,t){t.text&&(r.search_callback&&r.search_callback.call(this,i,t)||!r.search_callback&&n.search(t.text).isMatch)&&(!r.search_leaves_only||t.state.loaded&&0===t.children.length)&&(a.push(e),o=o.concat(t.parents))}),a.length&&(o=O.vakata.array_unique(o),this._search_open(o),this._data.search.dom=O(this.element[0].querySelectorAll("#"+O.map(a,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(O.jstree.idregex,"\\$&"):e.replace(O.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=a,this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")),this.trigger("search",{nodes:this._data.search.dom,str:i,res:this._data.search.res,show_only_matches:t}),A):O.isFunction(s)?s.call(this,i,O.proxy(function(e){e&&e.d&&(e=e.d),this._load_nodes(O.isArray(e)?O.vakata.array_unique(e):[],function(){this.search(i,!0,t)},!0)},this)):((s=O.extend({},s)).data||(s.data={}),s.data.str=i,O.ajax(s).fail(O.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(s)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(O.proxy(function(e){e&&e.d&&(e=e.d),this._load_nodes(O.isArray(e)?O.vakata.array_unique(e):[],function(){this.search(i,!0,t)},!0)},this)))},this.clear_search=function(){this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search"),this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=O()},this._search_open=function(i){var r=this;O.each(i.concat([]),function(e,t){if("#"===t)return!0;try{t=O("#"+t.replace(O.jstree.idregex,"\\$&"),r.element)}catch(e){}t&&t.length&&r.is_closed(t)&&(r._data.search.opn.push(t[0].id),r.open_node(t,function(){r._search_open(i)},0))})}},O.vakata.search=function(p,e,m){!1!==(m=m||{}).fuzzy&&(m.fuzzy=!0),p=m.caseSensitive?p:p.toLowerCase();var v,j,y,t,k=m.location||0,i=m.distance||100,x=m.threshold||.6,b=p.length;return 32<b&&(m.fuzzy=!1),m.fuzzy&&(v=1<<b-1,j=function(){for(var e={},t=0,t=0;t<b;t++)e[p.charAt(t)]=0;for(t=0;t<b;t++)e[p.charAt(t)]|=1<<b-t-1;return e}(),y=function(e,t){e/=b,t=Math.abs(k-t);return i?e+t/i:t?1:e}),t=function(e){if(e=m.caseSensitive?e:e.toLowerCase(),p===e||-1!==e.indexOf(p))return{isMatch:!0,score:0};if(!m.fuzzy)return{isMatch:!1,score:1};var t,i,r,s,n,a,o,d,c,l=e.length,h=x,_=e.indexOf(p,k),u=b+l,g=1,f=[];for(-1!==_&&(h=Math.min(y(0,_),h),-1!==(_=e.lastIndexOf(p,k+b))&&(h=Math.min(y(0,_),h))),_=-1,t=0;t<b;t++){for(r=0,s=u;r<s;)h>=y(t,k+s)?r=s:u=s,s=Math.floor((u-r)/2+r);for(u=s,a=Math.max(1,k-s+1),o=Math.min(k+s,l)+b,(d=Array(o+2))[o+1]=(1<<t)-1,i=o;a<=i;i--)if(c=j[e.charAt(i-1)],d[i]=0===t?(1|d[i+1]<<1)&c:(1|d[i+1]<<1)&c|1|(n[i+1]|n[i])<<1|n[i+1],d[i]&v&&(g=y(t,i-1))<=h){if(h=g,_=i-1,f.push(_),!(k<_))break;a=Math.max(1,2*k-_)}if(y(t+1,k)>h)break;n=d}return{isMatch:0<=_,score:g}},!0===e?{search:t}:t(e)},O.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},c=!(O.jstree.plugins.sort=function(e,t){this.bind=function(){t.bind.call(this),this.element.on("model.jstree",O.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",O.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",O.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(e,t){var i,r;if((e=this.get_node(e))&&e.children&&e.children.length&&(e.children.sort(O.proxy(this.settings.sort,this)),t))for(i=0,r=e.children_d.length;i<r;i++)this.sort(e.children_d[i],!1)}}),O.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree",ttl:!1,filter:!1},O.jstree.plugins.state=function(e,t){this.bind=function(){t.bind.call(this);var i=O.proxy(function(){this.element.on(this.settings.state.events,O.proxy(function(){c&&clearTimeout(c),c=setTimeout(O.proxy(function(){this.save_state()},this),100)},this))},this);this.element.on("ready.jstree",O.proxy(function(e,t){this.element.one("restore_state.jstree",i),this.restore_state()||i()},this))},this.save_state=function(){var e={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};O.vakata.storage.set(this.settings.state.key,JSON.stringify(e))},this.restore_state=function(){var i=O.vakata.storage.get(this.settings.state.key);if(i)try{i=JSON.parse(i)}catch(e){return!1}return!(i&&i.ttl&&i.sec&&+new Date-i.sec>i.ttl)&&(i&&i.state&&(i=i.state),i&&O.isFunction(this.settings.state.filter)&&(i=this.settings.state.filter.call(this,i)),!!i&&(this.element.one("set_state.jstree",function(e,t){t.instance.trigger("restore_state",{state:O.extend(!0,{},i)})}),this.set_state(i),!0))},this.clear_state=function(){return O.vakata.storage.del(this.settings.state.key)}},O.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}},O.jstree.defaults.types={"#":{},default:{}},O.jstree.plugins.types=function(e,l){this.init=function(e,t){var i,r;if(t&&t.types&&t.types.default)for(i in t.types)if("default"!==i&&"#"!==i&&t.types.hasOwnProperty(i))for(r in t.types.default)t.types.default.hasOwnProperty(r)&&t.types[i][r]===A&&(t.types[i][r]=t.types.default[r]);l.init.call(this,e,t),this._model.data["#"].type="#"},this.refresh=function(e,t){l.refresh.call(this,e,t),this._model.data["#"].type="#"},this.bind=function(){this.element.on("model.jstree",O.proxy(function(e,t){for(var i=this._model.data,r=t.nodes,s=this.settings.types,n="default",a=0,o=r.length;a<o;a++)n="default",i[r[a]].original&&i[r[a]].original.type&&s[i[r[a]].original.type]&&(n=i[r[a]].original.type),i[r[a]].data&&i[r[a]].data.jstree&&i[r[a]].data.jstree.type&&s[i[r[a]].data.jstree.type]&&(n=i[r[a]].data.jstree.type),i[r[a]].type=n,!0===i[r[a]].icon&&s[n].icon!==A&&(i[r[a]].icon=s[n].icon);i["#"].type="#"},this)),l.bind.call(this)},this.get_json=function(e,t,i){var r,s,n=this._model.data,a=t?O.extend(!0,{},t,{no_id:!1}):{},o=l.get_json.call(this,e,a,i);if(!1===o)return!1;if(O.isArray(o))for(r=0,s=o.length;r<s;r++)o[r].type=o[r].id&&n[o[r].id]&&n[o[r].id].type?n[o[r].id].type:"default",t&&t.no_id&&(delete o[r].id,o[r].li_attr&&o[r].li_attr.id&&delete o[r].li_attr.id,o[r].a_attr&&o[r].a_attr.id&&delete o[r].a_attr.id);else o.type=o.id&&n[o.id]&&n[o.id].type?n[o.id].type:"default",t&&t.no_id&&(o=this._delete_ids(o));return o},this._delete_ids=function(e){if(O.isArray(e)){for(var t=0,i=e.length;t<i;t++)e[t]=this._delete_ids(e[t]);return e}return delete e.id,e.li_attr&&e.li_attr.id&&delete e.li_attr.id,e.a_attr&&e.a_attr.id&&delete e.a_attr.id,e.children&&O.isArray(e.children)&&(e.children=this._delete_ids(e.children)),e},this.check=function(e,t,i,r,s){if(!1===l.check.call(this,e,t,i,r,s))return!1;t=t&&t.id?t:this.get_node(t),i=i&&i.id?i:this.get_node(i);var n,a,o,d,c=(c=t&&t.id?O.jstree.reference(t.id):null)&&c._model&&c._model.data?c._model.data:null;switch(e){case"create_node":case"move_node":case"copy_node":if("move_node"!==e||-1===O.inArray(t.id,i.children)){if((n=this.get_rules(i)).max_children!==A&&-1!==n.max_children&&n.max_children===i.children.length)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})});if(n.valid_children!==A&&-1!==n.valid_children&&-1===O.inArray(t.type||"default",n.valid_children))return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})});if(c&&t.children_d&&t.parents){for(o=a=0,d=t.children_d.length;o<d;o++)a=Math.max(a,c[t.children_d[o]].parents.length);a=a-t.parents.length+1}(a<=0||a===A)&&(a=1);do{if(n.max_depth!==A&&-1!==n.max_depth&&a>n.max_depth)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})})}while(i=this.get_node(i.parent),n=this.get_rules(i),a++,i)}}return!0},this.get_rules=function(e){if(!(e=this.get_node(e)))return!1;e=this.get_type(e,!0);return e.max_depth===A&&(e.max_depth=-1),e.max_children===A&&(e.max_children=-1),e.valid_children===A&&(e.valid_children=-1),e},this.get_type=function(e,t){return!!(e=this.get_node(e))&&(t?O.extend({type:e.type},this.settings.types[e.type]):e.type)},this.set_type=function(e,t){var i,r,s,n,a;if(O.isArray(e)){for(r=0,s=(e=e.slice()).length;r<s;r++)this.set_type(e[r],t);return!0}return i=this.settings.types,e=this.get_node(e),!(!i[t]||!e)&&(n=e.type,a=this.get_icon(e),e.type=t,(!0===a||i[n]&&i[n].icon!==A&&a===i[n].icon)&&this.set_icon(e,i[t].icon===A||i[t].icon),!0)}},O.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},O.jstree.plugins.unique=function(e,u){this.check=function(e,t,i,r,s){if(!1===u.check.call(this,e,t,i,r,s))return!1;if(t=t&&t.id?t:this.get_node(t),!(i=i&&i.id?i:this.get_node(i))||!i.children)return!0;for(var n="rename_node"===e?r:t.text,a=[],o=this.settings.unique.case_sensitive,d=this._model.data,c=0,l=i.children.length;c<l;c++)a.push(o?d[i.children[c]].text:d[i.children[c]].text.toLowerCase());switch(o||(n=n.toLowerCase()),e){case"delete_node":return!0;case"rename_node":return(c=-1===O.inArray(n,a)||t.text&&t.text[o?"toString":"toLowerCase"]()===n)||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})}),c;case"create_node":return(c=-1===O.inArray(n,a))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})}),c;case"copy_node":return(c=-1===O.inArray(n,a))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})}),c;case"move_node":return(c=t.parent===i.id||-1===O.inArray(n,a))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})}),c}return!0},this.create_node=function(e,t,i,r,s){if(!t||t.text===A){if(null===e&&(e="#"),!(e=this.get_node(e)))return u.create_node.call(this,e,t,i,r,s);if(!(""+(i=i===A?"last":i)).match(/^(before|after)$/)&&!s&&!this.is_loaded(e))return u.create_node.call(this,e,t,i,r,s);t=t||{};for(var n,a=this._model.data,o=this.settings.unique.case_sensitive,d=this.settings.unique.duplicate,c=n=this.get_string("New node"),l=[],h=0,_=e.children.length;h<_;h++)l.push(o?a[e.children[h]].text:a[e.children[h]].text.toLowerCase());for(h=1;-1!==O.inArray(o?c:c.toLowerCase(),l);)c=""+d.call(this,n,++h);t.text=c}return u.create_node.call(this,e,t,i,r,s)}},(l=document.createElement("DIV")).setAttribute("unselectable","on"),l.setAttribute("role","presentation"),l.className="jstree-wholerow",l.innerHTML="&#160;",O.jstree.plugins.wholerow=function(e,n){this.bind=function(){n.bind.call(this),this.element.on("ready.jstree set_state.jstree",O.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",O.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",O.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",O.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");for(var i=!1,r=0,s=t.selected.length;r<s;r++)(i=this.get_node(t.selected[r],!0))&&i.length&&i.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",O.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",O.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",O.proxy(function(e){e.preventDefault();var t=O.Event("contextmenu",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,pageX:e.pageX,pageY:e.pageY});O(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t)},this)).on("click.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var t=O.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});O(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",O.proxy(function(e){e.stopImmediatePropagation();var t=O.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});O(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",O.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",O.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),n.teardown.call(this)},this.redraw_node=function(e,t,i,r){var s;return(e=n.redraw_node.apply(this,arguments))&&(s=l.cloneNode(!0),-1!==O.inArray(e.id,this._data.core.selected)&&(s.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===e.id&&(s.className+=" jstree-wholerow-hovered"),e.insertBefore(s,e.childNodes[0])),e}},function(i){if(document.registerElement&&Object&&Object.create){var e=Object.create(HTMLElement.prototype);e.createdCallback=function(){var e,t={core:{},plugins:[]};for(e in i.jstree.plugins)i.jstree.plugins.hasOwnProperty(e)&&this.attributes[e]&&(t.plugins.push(e),this.getAttribute(e)&&JSON.parse(this.getAttribute(e))&&(t[e]=JSON.parse(this.getAttribute(e))));for(e in i.jstree.defaults.core)i.jstree.defaults.core.hasOwnProperty(e)&&this.attributes[e]&&(t.core[e]=JSON.parse(this.getAttribute(e))||this.getAttribute(e));jQuery(this).jstree(t)};try{document.registerElement("vakata-jstree",{prototype:e})}catch(e){}}}(jQuery))})</script><script>var treelib={func:{},action:{},util:{}};treelib.func.storage=function(){var n=window.localStorage||null;return{set:function(e,t){return!(!n||!t)&&(n.setItem(e,t),!0)},get:function(e){return n?n.getItem(e):null},remove:function(e){n&&n.removeItem(e)}}}(),treelib.func.nl2br=function(e){return(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2")},treelib.action.hover_book=function(){$(document).on("mouseenter",".book-md",function(){$(this).children(".book-md-background-shade").animate({top:"-80px"},200);var e=$(this).children(".book-md-background-shade").children(".book-md-avatar"),t=e.attr("data-src");t&&e.attr("src",t)}).on("mouseleave",".book-md",function(){$(this).children(".book-md-background-shade").animate({top:"130px"},200)})},treelib.action.open_book=function(){$(document).on("click",".book-md",function(){var e=$(this).find(".book_link").attr("href");window.open(e)})},treelib.action.login_out=function(){$(".logout").click(function(){$.post($(this).attr("data-url"),function(e){e.status&&(window.location.href="/")},"json")})},treelib.action.change_verify=function(){var e=$(".verifyimg").attr("src");$(document).on("click",".reloadverify",function(){0<e.indexOf("?")?$(".verifyimg").attr("src",e+"&random="+Math.random()):$(".verifyimg").attr("src",e.replace(/\?.*$/,"")+"?"+Math.random())})},treelib.action.init_tab=function(){$(document).on("click",".tab_selecte",function(){$(this).addClass("tab_selected"),$(this).siblings().removeClass("tab_selected");var e="#"+$(this).attr("data-content-id");$(e).show(),$(e).siblings().hide()})},treelib.util.show_loading=function(){var e,t;$(document).ajaxStart(function(){e=setTimeout(function(){t=dialog({content:'<img class="loading_tree" src="/Public/Home/default/img/loading.gif">'}).showModal()},1e3)}).ajaxStop(function(){e&&clearTimeout(e),t&&t.close().remove()})},treelib.util.lib_tips=function(e){var t=dialog({title:"提示",content:e}).width(300).show();setTimeout(function(){t.close().remove()},2e3)},treelib.util.init_left_menu=function(i){var t=treelib.func.storage.get(i);function o(e){"none"==$(".left_menu_container").css("display")?e=0:(e>.3*$(window).width()&&(e=.3*$(window).width()),e<200&&(e=200),$(".left_menu_container").width(e),$(".left_menu_data_list").width(e-15),$(".left_menu_control input").width(e-90));e=$(window).width()-e-50;$(".right_book").width(e),$(".edui-editor,#container").width(e),$(".edui-editor-iframeholder").width(e-5)}!isNaN(t)&&t||(t=$(".left_menu_container").width()),$(".left_menu_selecte_list p").click(function(){$(this).addClass("left_menu_selected").removeClass("left_menu_selecte"),$(this).siblings().addClass("left_menu_selecte").removeClass("left_menu_selected")}),$(".left_menu_selecte_list p").first().click(function(){$(".left_menu_search").hide(),$(".left_menu_list").show()}),$(".left_menu_selecte_list p").last().click(function(){$(".left_menu_list").hide(),$(".left_menu_search").show()}),$(".left_menu_minimum").click(function(){$(".left_menu_container").hide(),$(".right_book").width("96%"),$(".left_menu_restore").show("normal"),$(".edui-editor,#container").width($(".right_book").width()-5),$(".edui-editor-iframeholder").width($(".right_book").width()-10),$(".right_book").css("margin-left","40px")}),$(".left_menu_restore").click(function(){$(".left_menu_restore").hide(),$(".left_menu_container").show(),o(t),$(".right_book").css("margin-left","20px")}),$(".drag_bar").bind("mousedown",function(e){var t='<div id="move_mask" style="opacity:0 !important;z-index:9999;background:gray;width:100%;height:'+$(window).height()+'px;position:absolute;top:0;left:0;cursor:ew-resize;"></div>';function n(e){o(e.clientX)}$(t).insertAfter("body"),$(window).bind("mousemove",n).bind("mouseup",function e(){$("#move_mask").remove(),$(window).unbind("mousemove",n).unbind("mouseup",e),treelib.func.storage.set(i,$(".left_menu_container").width())}),e.preventDefault()}),$(window).resize(function(){var e;e=(e=$(window).height()-100)<400?400:e,$(".left_menu_container").height(e),$(".left_menu_data_list").height(e-67),$(".drag_bar").height(e-45),$("#detail_page_content iframe").height(e-10),o(t)}).trigger("resize")},treelib.util.init_nav_member=function(){var e,t=$.cookie("nickname"),n=$.cookie("uid");isNaN(n)?($(".no_login").show(),$(".logined").hide()):($(".no_login").hide(),$(".nav_ucenter_dropdown_btn,.nickname").show(),$(".nickname").text(t)),$(".nav_ucenter_dropdown_btn,.nav_ucenter_dropdown_menu").hover(function(){e&&clearTimeout(e),$(".nav_ucenter_dropdown_menu").show("fast")}).mouseleave(function(){e=setTimeout(function(){$(".nav_ucenter_dropdown_menu").hide("fast")},500)}),treelib.action.login_out()},treelib.util.init_edit_tree=function(r){function e(){var e=$(r).jstree(!0),t=e.get_selected(),n=e.get_buffer();if(!t.length)return!0;if("粘贴"==arguments[0].item.label){if(!e.can_paste())return!0;for(var i=0;i<n.node.length;i++)if(n.node[i].id==t[0])return!0}for(i=0;i<t.length;i++)if("root"==e.get_type(t[i]))return!0;return!1}$(r).jstree({core:{animation:150,check_callback:function(e,t,n,i,o){return"copy_node"!==e&&"move_node"!==e||!o||!o.dnd||"root"!=o.ref.type||"a"!=o.pos&&"b"!=o.pos},strings:{"New node":"新建文档"}},types:{root:{icon:"book_index_tree_icon_root",valid_children:["default","folder","file"]},default:{icon:"jstree-folder"},folder:{icon:"jstree-folder"},file:{icon:"jstree-file"}},contextmenu:{show_at_node:!1,items:{create:{label:"新建子文档",separator_after:!0,action:function(){var t=$(r).jstree(!0),n=t.get_selected();if(!n.length)return!1;n=n[0],"file"==t.get_type(n)&&t.set_type(n,"folder"),$.post("/Ucenter-create_node",{pid:n},function(e){e.status?(n=t.create_node(n,{type:"file"}))&&(t.set_id(n,e.info),t.edit(e.info)):treelib.util.lib_tips(e.info)},"json")}},cut:{_disabled:e,label:"剪切",action:function(){var e=$(r).jstree(!0);if(!e.get_selected().length)return!1;e.cut(e.get_selected())}},copy:{_disabled:e,label:"复制",action:function(){var e=$(r).jstree(!0);if(!e.get_selected().length)return!1;e.copy(e.get_selected())}},paste:{_disabled:e,label:"粘贴",action:function(){var t=$(r).jstree(!0),n=t.get_selected();if(!n.length)return!1;for(var i=t.get_buffer(),e="",o=0;o<i.node.length;o++){if(i.node[o].id==n[0])return!0;e+=i.node[o].id+","}e=e.substring(0,e.length-1),$.post("/Ucenter-paste_node",{pid:n[0],ids:e,mode:i.mode},function(e){e.status?("file"==t.get_type(n[0])&&t.set_type(n[0],"folder"),"copy_node"==i.mode?t.move_node(e.info,t.get_selected()[0]):t.paste(n[0],"last")):treelib.util.lib_tips(e.info)},"json")}},rename:{_disabled:e,label:"重命名",action:function(){var e=$(r).jstree(!0),t=e.get_selected();if(!t.length)return!1;t=t[0],e.edit(t)}},remove:{_disabled:e,separator_before:!0,label:"删除",action:function(){var t=$(r).jstree(!0),n=t.get_selected(),e="";if(!n.length)return!1;for(var i="确定要删除选中的文章吗?",o=0;o<n.length;o++)t.is_parent(t.get_node(n[o]))&&(i="确定要删除选中的文章,以及子文章吗？"),e+=n[o]+",";e=e.substring(0,e.length-1),dialog({content:i,cancelValue:"取消",cancel:function(){},okValue:"确定",ok:function(){$.post("/Ucenter-delete_nodes",{ids:e},function(e){e.status?t.delete_node(n):treelib.util.lib_tips(e.info)},"json")}}).width(200).showModal()}}}},dnd:{copy:!1,inside_pos:"last"},plugins:["contextmenu","types","dnd"]}).on("rename_node.jstree",function(e,n){n.node.text&&$.post("/Ucenter-rename_node",{id:n.node.id,text:n.text},function(e){var t;e.status||((t=$(r).jstree(!0)).set_text(t.get_node(n.node.id),n.old),treelib.util.lib_tips(e.info))},"json")}).on("move_node.jstree",function(e,t){var n=$(r).jstree(!0);$.post("/Ucenter-sort_node",{id:t.node.id,new_pid:t.parent,new_position:t.position},function(e){e.status?(n.is_parent(t.old_parent)||n.set_type(n.get_node(t.old_parent),"file"),"file"==n.get_type(n.get_node(t.parent))&&n.set_type(n.get_node(t.parent),"folder")):treelib.util.lib_tips(e.info)},"json")}).on("delete_node.jstree",function(e,t){var n=$(r).jstree(!0);n.is_parent(t.parent)||"root"==n.get_type(t.parent)||n.set_type(n.get_node(t.parent),"file")}).on("select_node.jstree",function(e,t){var n=$(r).jstree(!0);return sel=n.get_selected(),sel=sel[0],window.node_article_conten||(window.node_article_conten=[]),"root"==t.node.type?($("input[name=aid]").val(""),$(".book_detail").hide(),void $(".ucenter_top_page").show()):($(".ucenter_top_page").hide(),$(".book_detail").show(),n.is_open(sel)?n.close_node(sel):n.open_node(sel),window.node_article_conten[t.node.id]?($("input[name=aid]").val(t.node.id),void window.Umeditor.setContent(window.node_article_conten[t.node.id])):($.post("/Ucenter-get_article_content",{id:t.node.id},function(e){e.status?(e.info=e.info||" ",$("input[name=aid]").val(t.node.id),window.node_article_conten[t.node.id]=e.info,window.Umeditor.setContent(e.info)):treelib.util.lib_tips(e.info)},"json"),$(".lib_plugin_save")[0]||($("#edui2").prepend('<div class="edui-box edui-button edui-default lib_plugin_save" title="保存 (快捷键:ctrl+s)" >保存</div>'),$(document.getElementById("ueditor_0").contentWindow.document).on("keydown",function(e){if(1==e.ctrlKey&&83==e.keyCode)return $(".lib_plugin_save").click(),e.preventDefault(),!1})),void $(".lib_plugin_save").click(function(){if(!window.saving){window.saving=!0;var n=$("input[name=aid]").val();if(!n)return treelib.util.lib_tips("请先选择左侧您要编辑的章节!"),!1;var i=window.Umeditor.getContent();window.node_article_conten||(window.node_article_conten=[]),$.post("/Ucenter-save_article_content",{aid:n,content:i},function(e){var t;e.status?(window.node_article_conten[n]=i||" ",(t=dialog({align:"left",content:"保存成功",quickClose:!0})).show($(".lib_plugin_save")[0]),setTimeout(function(){t.close().remove(),window.Umeditor.focus(!0)},1e3)):treelib.util.lib_tips(e.info),window.saving=!1},"json")}})))}),0==$("li[aria-level=2]").length&&dialog({align:"bottom",content:"右击我开始吧 ^_^",quickClose:!0}).show($(".jstree-anchor")[0])},$(function(){treelib.util.init_nav_member(),treelib.action.init_tab()})</script><script type="text/javascript">!function(){var e=window.UEDITOR_HOME_URL||t();function t(e,t){return function(e,t){var r=t;/^(\/|\\\\)/.test(t)?r=/^.+?\w(\/|\\\\)/.exec(e)[0]+t.replace(/^(\/|\\\\)/,""):/^[a-z]+:/i.test(t)||(e=e.split("#")[0].split("?")[0].replace(/[^\\\/]+$/,""),r=e+""+t);return function(e){var t=/^[a-z]+:\/\//.exec(e)[0],r=null,i=[];(e=(e=e.replace(t,"").split("?")[0].split("#")[0]).replace(/\\/g,"/").split(/\//))[e.length-1]="";for(;e.length;)".."===(r=e.shift())?i.pop():"."!==r&&i.push(r);return t+i.join("/")}(r)}(e||self.document.URL||self.location.href,t||(t=document.getElementsByTagName("script"))[t.length-1].src)}window.UEDITOR_CONFIG={UEDITOR_HOME_URL:e,initialFrameHeight:500,toolbars:[["fullscreen","source","|","undo","redo","|","bold","italic","underline","fontborder","strikethrough","superscript","subscript","removeformat","formatmatch","autotypeset","blockquote","pasteplain","|","forecolor","backcolor","insertorderedlist","insertunorderedlist","selectall","cleardoc","|","rowspacingtop","rowspacingbottom","lineheight","|","customstyle","paragraph","fontfamily","fontsize","|","directionalityltr","directionalityrtl","indent","|","justifyleft","justifycenter","justifyright","justifyjustify","|","touppercase","tolowercase","|","link","unlink","anchor","|","imagenone","imageleft","imageright","imagecenter","|","simpleupload","insertimage","emotion","scrawl","insertvideo","music","attachment","map","gmap","insertframe","insertcode","pagebreak","template","background","|","horizontal","date","time","spechars","snapscreen","wordimage","|","inserttable","deletetable","insertparagraphbeforetable","insertrow","deleterow","insertcol","deletecol","mergecells","mergeright","mergedown","splittocells","splittorows","splittocols","charts","|","print","preview","searchreplace","drafts"]],initialContent:"",maximumWords:1e5},window.UE={getUEBasePath:t}}()</script><script type="text/javascript">!function(){function W(e,t,n){return t=t.toLowerCase(),(e=e.__allListeners||n&&(e.__allListeners={}))&&(e[t]||n&&(e[t]=[]))}function X(e,t,n,i,o,r){var a;for((i=i&&e[t])||(i=e[n]);!i&&(a=(a||e).parentNode);){if("BODY"==a.tagName||r&&!r(a))return null;i=a[n]}return i&&o&&!o(i)?X(i,t,n,!1,o):i}UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var s=window.baidu||{};window.baidu=s,window.UE=s.editor=window.UE||{},UE.plugins={},UE.commands={},UE.instants={},UE.I18N={},UE._customizeUI={},UE.version="1.4.3";var L=UE.dom={},r=UE.browser=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,n={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(e),opera:!!t&&t.version,webkit:-1<e.indexOf(" applewebkit/"),mac:-1<e.indexOf("macintosh"),quirks:"BackCompat"==document.compatMode};n.gecko="Gecko"==navigator.product&&!n.webkit&&!n.opera&&!n.ie;var i,o=0;return n.ie&&(o=e.match(/(?:msie\s([\w.]+))/),i=e.match(/(?:trident.*rv:([\w.]+))/),o=o&&i&&o[1]&&i[1]?Math.max(+o[1],+i[1]):o&&o[1]?+o[1]:i&&i[1]?+i[1]:0,n.ie11Compat=11==document.documentMode,n.ie9Compat=9==document.documentMode,n.ie8=!!document.documentMode,n.ie8Compat=8==document.documentMode,n.ie7Compat=7==o&&!document.documentMode||7==document.documentMode,n.ie6Compat=o<7||n.quirks,n.ie9above=8<o,n.ie9below=o<9,n.ie11above=10<o,n.ie11below=o<11),n.gecko&&(i=e.match(/rv:([\d\.]+)/))&&(o=1e4*(i=i[1].split("."))[0]+100*(i[1]||0)+ +(i[2]||0)),/chrome\/(\d+\.\d)/i.test(e)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(o=parseFloat(t.version())),n.webkit&&(o=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=o,n.isCompatible=!n.mobile&&(n.ie&&6<=o||n.gecko&&10801<=o||n.opera&&9.5<=o||n.air&&1<=o||n.webkit&&522<=o||!1),n}(),I=r.ie,ma=r.opera,p=UE.utils={each:function(e,t,n){if(null!=e)if(e.length===+e.length){for(var i=0,o=e.length;i<o;i++)if(!1===t.call(n,e[i],i,e))return!1}else for(i in e)if(e.hasOwnProperty(i)&&!1===t.call(n,e[i],i,e))return!1},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},extend:function(e,t,n){if(t)for(var i in t)n&&e.hasOwnProperty(i)||(e[i]=t[i]);return e},extend2:function(e){for(var t=arguments,n=1;n<t.length;n++){var i,o=t[n];for(i in o)e.hasOwnProperty(i)||(e[i]=o[i])}return e},inherits:function(e,t){var n=e.prototype,t=p.makeInstance(t.prototype);return p.extend(t,n,!0),(e.prototype=t).constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var i;return function(){n&&clearTimeout(i),i=setTimeout(e,t)}},indexOf:function(e,n,i){var o=-1;return i=this.isNumber(i)?i:0,this.each(e,function(e,t){if(i<=t&&e===n)return o=t,!1}),o},removeItem:function(e,t){for(var n=0,i=e.length;n<i;n++)e[n]===t&&(e.splice(n,1),n--)},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=p.isArray(e)?e:e.split(",");for(var t,n=0,i={};t=e[n++];)i[t.toUpperCase()]=i[t]=1;return i},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[e]}):""},cssStyleToDomStyle:(Ma=document.createElement("div").style,Na={float:null!=Ma.cssFloat?"cssFloat":null!=Ma.styleFloat?"styleFloat":"float"},function(e){return Na[e]||(Na[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}),loadFile:(Ra=[],function(t,n,e){var i=Qa(t,n);if(i)i.ready?e&&e():i.funs.push(e);else if(Ra.push({doc:t,url:n.src||n.href,funs:[e]}),t.body){if(!n.id||!t.getElementById(n.id)){var o=t.createElement(n.tag);for(r in delete n.tag,n)o.setAttribute(r,n[r]);o.onload=o.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(0<(i=Qa(t,n)).funs.length){i.ready=1;for(var e;e=i.funs.pop();)e()}o.onload=o.onreadystatechange=null}},o.onerror=function(){throw Error("The load "+(n.href||n.src)+" fails,check the url settings of file ueditor.config.js ")},t.getElementsByTagName("head")[0].appendChild(o)}}else{for(var r in e=[],n)"tag"!=r&&e.push(r+'="'+n[r]+'"');t.write("<"+n.tag+" "+e.join(" ")+" ></"+n.tag+">")}}),isEmptyObject:function(e){if(null==e)return!0;if(this.isArray(e)||this.isString(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(3<n.length)return"";t="#";for(var i,o=0;i=n[o++];)t+=1==(i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16)).length?"0"+i:i;t=t.toUpperCase()}return t},optCss:function(e){function t(e,t){if(!e)return"";var n=e.top,i=e.bottom,o=e.left,r=e.right,a="";if(n&&o&&i&&r)a+=";"+t+":"+(n==i&&i==o&&o==r?n:n==i&&o==r?n+" "+o:o==r?n+" "+o+" "+i:n+" "+r+" "+i+" "+o)+";";else for(var s in e)a+=";"+t+"-"+s+":"+e[s]+";";return a}var o,r;return e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(e,t,n,i){if(1==i.split(" ").length)switch(t){case"padding":return o||(o={}),o[n]=i,"";case"margin":return r||(r={}),r[n]=i,"";case"border":return"initial"==i?"":e}return e}),(e+=t(o,"padding")+t(r,"margin")).replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(e,t){return t?t+";;":";"})},clone:function(e,t){var n,i;for(i in t=t||{},e)e.hasOwnProperty(i)&&(n=e[i],"object"==typeof n?(t[i]=p.isArray(n)?[]:{},p.clone(e[i],t[i])):t[i]=n);return t},transUnitToPx:function(i){if(!/(pt|cm)/.test(i))return i;var o;switch(i.replace(/([\d.]+)(\w+)/,function(e,t,n){i=t,o=n}),o){case"cm":i=25*parseFloat(i);break;case"pt":i=Math.round(96*parseFloat(i)/72)}return i+(i?"px":"")},domReady:(Lb=[],function(e,t){var n=(t=t||window).document;e&&Lb.push(e),"complete"===n.readyState?Kb(n):(n.isReady&&Kb(n),r.ie&&11!=r.version?(function(){if(!n.isReady){try{n.documentElement.doScroll("left")}catch(e){return setTimeout(arguments.callee,0)}Kb(n)}}(),t.attachEvent("onload",function(){Kb(n)})):(n.addEventListener("DOMContentLoaded",function(){n.removeEventListener("DOMContentLoaded",arguments.callee,!1),Kb(n)},!1),t.addEventListener("load",function(){Kb(n)},!1)))}),cssRule:r.ie&&11!=r.version?function(e,t,n){var i,o;if(void 0===t||t&&t.nodeType&&9==t.nodeType){if(void 0!==(o=(i=(n=t&&t.nodeType&&9==t.nodeType?t:n||document).indexList||(n.indexList={}))[e]))return n.styleSheets[o].cssText}else{if(o=(i=(n=n||document).indexList||(n.indexList={}))[e],""===t)return void 0!==o&&(n.styleSheets[o].cssText="",delete i[e],!0);void 0!==o?sheetStyle=n.styleSheets[o]:(sheetStyle=n.createStyleSheet("",o=n.styleSheets.length),i[e]=o),sheetStyle.cssText=t}}:function(e,t,n){var i;return void 0===t||t&&t.nodeType&&9==t.nodeType?(i=(n=t&&t.nodeType&&9==t.nodeType?t:n||document).getElementById(e))?i.innerHTML:void 0:(i=(n=n||document).getElementById(e),""===t?!!i&&(i.parentNode.removeChild(i),!0):void(i?i.innerHTML=t:((i=n.createElement("style")).id=e,i.innerHTML=t,n.getElementsByTagName("head")[0].appendChild(i))))},sort:function(e,t){t=t||function(e,t){return e.localeCompare(t)};for(var n,i=0,o=e.length;i<o;i++)for(var r=i,a=e.length;r<a;r++)0<t(e[i],e[r])&&(n=e[i],e[i]=e[r],e[r]=n);return e},serializeParam:function(e){var t,n=[];for(t in e)if("method"!=t&&"timeout"!=t&&"async"!=t)if("function"!=(typeof e[t]).toLowerCase()&&"object"!=(typeof e[t]).toLowerCase())n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));else if(p.isArray(e[t]))for(var i=0;i<e[t].length;i++)n.push(encodeURIComponent(t)+"[]="+encodeURIComponent(e[t][i]));return n.join("&")},formatUrl:function(e){return(e=(e=(e=(e=e.replace(/&&/g,"&")).replace(/\?&/g,"?")).replace(/&$/g,"")).replace(/&#/g,"#")).replace(/&+/g,"&")},isCrossDomainUrl:function(e){var t=document.createElement("a");return t.href=e,r.ie&&(t.href=t.href),!(t.protocol==location.protocol&&t.hostname==location.hostname&&(t.port==location.port||"80"==t.port&&""==location.port||""==t.port&&"80"==location.port))},clearEmptyAttrs:function(e){for(var t in e)""===e[t]&&delete e[t];return e},str2json:function(e){return p.isString(e)?window.JSON?JSON.parse(e):new Function("return "+p.trim(e||""))():null},json2str:function(){if(window.JSON)return JSON.stringify;function s(e){return e<10?"0"+e:e}var l={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return function(e){switch(typeof e){case"undefined":return"undefined";case"number":return isFinite(e)?String(e):"null";case"string":return/["\\\x00-\x1f]/.test(a=e)&&(a=a.replace(/["\\\x00-\x1f]/g,function(e){var t=l[e];return t||(t=e.charCodeAt(),"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16))})),'"'+a+'"';case"boolean":return String(e);default:if(null===e)return"null";if(p.isArray(e)){for(var t,n,i=["["],o=e.length,r=0;r<o;r++)switch(n=e[r],typeof n){case"undefined":case"function":case"unknown":break;default:t&&i.push(","),i.push(p.json2str(n)),t=1}return i.push("]"),i.join("")}if(p.isDate(e))return'"'+e.getFullYear()+"-"+s(e.getMonth()+1)+"-"+s(e.getDate())+"T"+s(e.getHours())+":"+s(e.getMinutes())+":"+s(e.getSeconds())+'"';for(o in t=["{"],r=p.json2str,e)if(Object.prototype.hasOwnProperty.call(e,o))switch(n=e[o],typeof n){case"undefined":case"unknown":case"function":break;default:i&&t.push(","),i=1,t.push(r(o)+":"+r(n))}return t.push("}"),t.join("")}var a}}()},Lb,Ra,Ma,Na;function Kb(e){for(e.isReady=!0;e=Lb.pop();e());}function Qa(e,t){try{for(var n,i=0;n=Ra[i++];)if(n.doc===e&&n.url==(t.src||t.href))return n}catch(e){return null}}p.each("String Function Array Number RegExp Object Date".split(" "),function(t){UE.utils["is"+t]=function(e){return Object.prototype.toString.apply(e)=="[object "+t+"]"}});var Z=UE.EventBase=function(){};Z.prototype={addListener:function(e,t){e=p.trim(e).split(/\s+/);for(var n,i=0;n=e[i++];)W(this,n,!0).push(t)},on:function(e,t){return this.addListener(e,t)},off:function(e,t){return this.removeListener(e,t)},trigger:function(){return this.fireEvent.apply(this,arguments)},removeListener:function(e,t){e=p.trim(e).split(/\s+/);for(var n,i=0;n=e[i++];)p.removeItem(W(this,n)||[],t)},fireEvent:function(){for(var e,t=arguments[0],t=p.trim(t).split(" "),n=0;e=t[n++];){var i,o,r,a=W(this,e);if(a)for(r=a.length;r--;)if(a[r]){if(!0===(o=a[r].apply(this,arguments)))return o;void 0!==o&&(i=o)}(o=this["on"+e.toLowerCase()])&&(i=o.apply(this,arguments))}return i}};var v=L.dtd=($c=p.extend2,_c=Zc({isindex:1,fieldset:1}),ad=Zc({input:1,button:1,select:1,textarea:1,label:1}),bd=$c(Zc({a:1}),ad),cd=$c({iframe:1},bd),dd=Zc({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),ed=Zc({ins:1,del:1,script:1,style:1}),fd=$c(Zc({b:1,acronym:1,bdo:1,var:1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),ed),gd=$c(Zc({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),fd),hd=$c(Zc({p:1}),gd),ad=$c(Zc({iframe:1}),gd,ad),gd=Zc({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,var:1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),id=$c(Zc({a:0}),ad),jd=Zc({tr:1}),kd=Zc({"#":1}),ld=$c(Zc({param:1}),gd),md=$c(Zc({form:1}),_c,cd,dd,hd),nd=Zc({li:1,ol:1,ul:1}),od=Zc({style:1,script:1}),pd=Zc({base:1,link:1,meta:1,title:1}),od=$c(pd,od),qd=Zc({head:1,body:1}),rd=Zc({html:1}),sd=Zc({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),td=Zc({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1}),Zc({$nonBodyContent:$c(rd,qd,pd),$block:sd,$inline:id,$inlineWithA:$c(Zc({a:1}),id),$body:$c(Zc({script:1,style:1}),sd),$cdata:Zc({script:1,style:1}),$empty:td,$nonChild:Zc({iframe:1,textarea:1}),$listItem:Zc({dd:1,dt:1,li:1}),$list:Zc({ul:1,ol:1,dl:1}),$isNotEmpty:Zc({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:Zc({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1}),$removeEmptyBlock:Zc({p:1,div:1}),$tableContent:Zc({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:Zc({pre:1,script:1,style:1,textarea:1}),html:qd,head:od,style:kd,script:kd,body:md,base:{},link:{},meta:{},title:kd,col:{},tr:Zc({td:1,th:1}),img:{},embed:{},colgroup:Zc({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:md,td:md,br:{},th:md,center:md,kbd:id,button:$c(hd,dd),basefont:{},h5:id,h4:id,samp:id,h6:id,ol:nd,h1:id,h3:id,option:kd,h2:id,form:$c(_c,cd,dd,hd),select:Zc({optgroup:1,option:1}),font:id,ins:id,menu:nd,abbr:id,label:id,table:Zc({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:id,tfoot:jd,cite:id,li:md,input:{},iframe:md,strong:id,textarea:kd,noframes:md,big:id,small:id,span:Zc({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:id,dt:id,sub:id,optgroup:Zc({option:1}),param:{},bdo:id,var:id,div:md,object:ld,sup:id,dd:md,strike:id,area:{},dir:nd,map:$c(Zc({area:1,form:1,p:1}),_c,ed,dd),applet:ld,dl:Zc({dt:1,dd:1}),del:id,isindex:{},fieldset:$c(Zc({legend:1}),gd),thead:jd,ul:nd,acronym:id,b:id,a:$c(Zc({a:1}),ad),blockquote:$c(Zc({td:1,tr:1,tbody:1,li:1}),md),caption:id,i:id,u:id,tbody:jd,s:id,address:$c(cd,hd),tt:id,legend:id,q:id,pre:$c(fd,bd),p:$c(Zc({a:1}),id),em:id,dfn:id})),ea=I&&r.version<9?{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},oa=p.listToMap("-webkit-box -moz-box block list-item table table-row-group table-header-group table-footer-group table-row table-column-group table-column table-cell table-caption".split(" ")),f=L.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:I&&"6"==r.version?"\ufeff":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(e,t){if(e===t)return 0;for(var n=[e],i=[t],o=e;o=o.parentNode;){if(o===t)return 10;n.push(o)}for(o=t;o=o.parentNode;){if(o===e)return 20;i.push(o)}if(n.reverse(),i.reverse(),n[0]!==i[0])return 1;for(o=-1;n[++o]===i[o];);for(e=n[o],t=i[o];e=e.nextSibling;)if(e===t)return 4;return 2},getNodeIndex:function(e,t){for(var n=e,i=0;n=n.previousSibling;)t&&3==n.nodeType&&n.nodeType==n.nextSibling.nodeType||i++;return i},inDoc:function(e,t){return 10==f.getPosition(e,t)},findParent:function(e,t,n){if(e&&!f.isBody(e))for(e=n?e:e.parentNode;e;){if(!t||t(e)||f.isBody(e))return t&&!t(e)&&f.isBody(e)?null:e;e=e.parentNode}return null},findParentByTagName:function(e,t,n,i){return t=p.listToMap(p.isArray(t)?t:[t]),f.findParent(e,function(e){return t[e.tagName]&&!(i&&i(e))},n)},findParents:function(e,t,n,i){for(t=t&&(n&&n(e)||!n)?[e]:[];e=f.findParent(e,n);)t.push(e);return i?t:t.reverse()},insertAfter:function(e,t){return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},remove:function(e,t){var n,i=e.parentNode;if(i){if(t&&e.hasChildNodes())for(;n=e.firstChild;)i.insertBefore(n,e);i.removeChild(e)}return e},getNextDomNode:function(e,t,n,i){return X(e,"firstChild","nextSibling",t,n,i)},getPreDomNode:function(e,t,n,i){return X(e,"lastChild","previousSibling",t,n,i)},isBookmarkNode:function(e){return 1==e.nodeType&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){return(e=e.ownerDocument||e).defaultView||e.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;for(var n=[e],i=[t],o=e,r=-1;o=o.parentNode;){if(o===t)return o;n.push(o)}for(o=t;o=o.parentNode;){if(o===e)return o;i.push(o)}for(n.reverse(),i.reverse();n[++r]===i[r];);return 0==r?null:n[r-1]},clearEmptySibling:function(e,t,n){function i(e,t){for(var n;e&&!f.isBookmarkNode(e)&&(f.isEmptyInlineElement(e)||!RegExp("[^\t\n\r"+f.fillChar+"]").test(e.nodeValue));)n=e[t],f.remove(e),e=n}t||i(e.nextSibling,"nextSibling"),n||i(e.previousSibling,"previousSibling")},split:function(e,t){var n=e.ownerDocument;if(r.ie&&t==e.nodeValue.length){var i=n.createTextNode("");return f.insertAfter(e,i)}return i=e.splitText(t),r.ie8&&(n=n.createTextNode(""),f.insertAfter(i,n),f.remove(n)),i},isWhitespace:function(e){return!RegExp("[^ \t\n\r"+f.fillChar+"]").test(e.nodeValue)},getXY:function(e){for(var t=0,n=0;e.offsetParent;)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return{x:t,y:n}},on:function(e,t,n){var i,o,r=p.isArray(t)?t:p.trim(t).split(/\s+/),a=r.length;if(a)for(;a--;)t=r[a],e.addEventListener?e.addEventListener(t,n,!1):(n._d||(n._d={els:[]}),i=t+n.toString(),o=p.indexOf(n._d.els,e),n._d[i]&&-1!=o||(-1==o&&n._d.els.push(e),n._d[i]||(n._d[i]=function(e){return n.call(e.srcElement,e||window.event)}),e.attachEvent("on"+t,n._d[i])));e=null},un:function(e,t,n){var i=p.isArray(t)?t:p.trim(t).split(/\s+/),o=i.length;if(o)for(;o--;)if(t=i[o],e.removeEventListener)e.removeEventListener(t,n,!1);else{var r=t+n.toString();try{e.detachEvent("on"+t,n._d?n._d[r]:n)}catch(e){}n._d&&n._d[r]&&(-1!=(t=p.indexOf(n._d.els,e))&&n._d.els.splice(t,1),0==n._d.els.length&&delete n._d[r])}},isSameElement:function(e,t){if(e.tagName!=t.tagName)return!1;var n=e.attributes,i=t.attributes;if(!I&&n.length!=i.length)return!1;for(var o,r,a=0,s=0,l=0;o=n[l++];){if("style"==o.nodeName){if(o.specified&&a++,f.isSameStyle(e,t))continue;return!1}if(I){if(!o.specified)continue;a++,r=i.getNamedItem(o.nodeName)}else r=t.attributes[o.nodeName];if(!r.specified||o.nodeValue!=r.nodeValue)return!1}if(I){for(l=0;r=i[l++];)r.specified&&s++;if(a!=s)return!1}return!0},isSameStyle:function(e,t){var n,i=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),o=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(r.opera){if(i=e.style,o=t.style,i.length!=o.length)return!1;for(var a in i)if(!/^(\d+|csstext)$/i.test(a)&&i[a]!=o[a])return!1;return!0}if(!i||!o)return i==o;if(i=i.split(";"),o=o.split(";"),i.length!=o.length)return!1;for(a=0;n=i[a++];)if(-1==p.indexOf(o,n))return!1;return!0},isBlockElm:function(e){return 1==e.nodeType&&(v.$block[e.tagName]||oa[f.getComputedStyle(e,"display")])&&!v.$nonChild[e.tagName]},isBody:function(e){return e&&1==e.nodeType&&"body"==e.tagName.toLowerCase()},breakParent:function(e,t){var n,i,o,r=e,a=e;do{for(r=r.parentNode,o=i?((n=r.cloneNode(!1)).appendChild(i),i=n,(n=r.cloneNode(!1)).appendChild(o),n):(i=r.cloneNode(!1)).cloneNode(!1);n=a.previousSibling;)i.insertBefore(n,i.firstChild);for(;n=a.nextSibling;)o.appendChild(n)}while(t!==(a=r));return(n=t.parentNode).insertBefore(i,t),n.insertBefore(o,t),n.insertBefore(e,o),f.remove(t),e},isEmptyInlineElement:function(e){if(1!=e.nodeType||!v.$removeEmpty[e.tagName])return 0;for(e=e.firstChild;e;){if(f.isBookmarkNode(e)||1==e.nodeType&&!f.isEmptyInlineElement(e)||3==e.nodeType&&!f.isWhitespace(e))return 0;e=e.nextSibling}return 1},trimWhiteTextNode:function(n){function e(e){for(var t;(t=n[e])&&3==t.nodeType&&f.isWhitespace(t);)n.removeChild(t)}e("firstChild"),e("lastChild")},mergeChild:function(e,t,n){t=f.getElementsByTagName(e,e.tagName.toLowerCase());for(var i,o=0;i=t[o++];)if(i.parentNode&&!f.isBookmarkNode(i))if("span"==i.tagName.toLowerCase()){if(e===i.parentNode&&(f.trimWhiteTextNode(e),1==e.childNodes.length)){e.style.cssText=i.style.cssText+";"+e.style.cssText,f.remove(i,!0);continue}if(i.style.cssText=e.style.cssText+";"+i.style.cssText,n)if(a=n.style)for(var r,a=a.split(";"),s=0;r=a[s++];)i.style[p.cssStyleToDomStyle(r.split(":")[0])]=r.split(":")[1];f.isSameStyle(i,e)&&f.remove(i,!0)}else f.isSameElement(e,i)&&f.remove(i,!0)},getElementsByTagName:function(e,t,n){var i;n&&p.isString(n)&&(i=n,n=function(e){return f.hasClass(e,i)}),t=p.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var o,r=[],a=0;o=t[a++];){o=e.getElementsByTagName(o);for(var s,l=0;s=o[l++];)n&&!n(s)||r.push(s)}return r},mergeToParent:function(e){for(var t=e.parentNode;t&&v.$removeEmpty[t.tagName];){if(t.tagName==e.tagName||"A"==t.tagName){if(f.trimWhiteTextNode(t),"SPAN"==t.tagName&&!f.isSameStyle(t,e)||"A"==t.tagName&&"SPAN"==e.tagName){if(1<t.childNodes.length||t!==e.parentNode){e.style.cssText=t.style.cssText+";"+e.style.cssText,t=t.parentNode;continue}t.style.cssText+=";"+e.style.cssText,"A"==t.tagName&&(t.style.textDecoration="underline")}if("A"!=t.tagName){t===e.parentNode&&f.remove(e,!0);break}}t=t.parentNode}},mergeSibling:function(e,t,n){function i(e,t,n){var i;if((i=n[e])&&!f.isBookmarkNode(i)&&1==i.nodeType&&f.isSameElement(n,i)){for(;i.firstChild;)"firstChild"==t?n.insertBefore(i.lastChild,n.firstChild):n.appendChild(i.firstChild);f.remove(i)}}t||i("previousSibling","firstChild",e),n||i("nextSibling","lastChild",e)},unSelectable:I&&r.ie9below||r.opera?function(e){e.onselectstart=function(){return!1},e.onclick=e.onkeyup=e.onkeydown=function(){return!1},e.unselectable="on",e.setAttribute("unselectable","on");for(var t,n=0;t=e.all[n++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on",e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.msUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){t=p.isArray(t)?t:p.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0;n=t[i++];){switch(n=ea[n]||n){case"className":e[n]="";break;case"style":e.style.cssText="";var o=e.getAttributeNode("style");!r.ie&&o&&e.removeAttributeNode(o)}e.removeAttribute(n)}},createElement:function(e,t,n){return f.setAttributes(e.createElement(t),n)},setAttributes:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];switch(n){case"class":e.className=i;break;case"style":e.style.cssText=e.style.cssText+";"+i;break;case"innerHTML":e[n]=i;break;case"value":e.value=i;break;default:e.setAttribute(ea[n]||n,i)}}return e},getComputedStyle:function(e,t){if(-1<"width height top left".indexOf(t))return e["offset"+t.replace(/^\w/,function(e){return e.toUpperCase()})]+"px";if(3==e.nodeType&&(e=e.parentNode),r.ie&&r.version<9&&"font-size"==t&&!e.style.fontSize&&!v.$empty[e.tagName]&&!v.$nonChild[e.tagName]){var n=e.ownerDocument.createElement("span");n.style.cssText="padding:0;border:0;font-family:simsun;",n.innerHTML=".",e.appendChild(n);var i=n.offsetHeight;return e.removeChild(n),n=null,i+"px"}try{n=f.getStyle(e,t)||(window.getComputedStyle?f.getWindow(e).getComputedStyle(e,"").getPropertyValue(t):(e.currentStyle||e.style)[p.cssStyleToDomStyle(t)])}catch(e){return""}return p.transUnitToPx(p.fixColor(t,n))},removeClasses:function(e,t){t=p.isArray(t)?t:p.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)o=o.replace(RegExp("\\b"+n+"\\b"),"");(o=p.trim(o).replace(/[ ]{2,}/g," "))?e.className=o:f.removeAttributes(e,["class"])},addClass:function(e,t){if(e){t=p.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)RegExp("\\b"+n+"\\b").test(o)||(o+=" "+n);e.className=p.trim(o)}},hasClass:function(e,t){if(p.isRegExp(t))return t.test(e.className);t=p.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)if(!RegExp("\\b"+n+"\\b","i").test(o))return!1;return i-1==t.length},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},removeStyle:function(e,t){r.ie?("color"==t&&(t="(^|;)"+t),e.style.cssText=e.style.cssText.replace(RegExp(t+"[^:]*:[^;]+;?","ig"),"")):e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(p.cssStyleToDomStyle(t)),e.style.cssText||f.removeAttributes(e,["style"])},getStyle:function(e,t){e=e.style[p.cssStyleToDomStyle(t)];return p.fixColor(t,e)},setStyle:function(e,t,n){e.style[p.cssStyleToDomStyle(t)]=n,p.trim(e.style.cssText)||this.removeAttributes(e,"style")},setStyles:function(e,t){for(var n in t)t.hasOwnProperty(n)&&f.setStyle(e,n,t[n])},removeDirtyAttr:function(e){for(var t,n=0,i=e.getElementsByTagName("*");t=i[n++];)t.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var n=0,i=e.firstChild;for(t=t||function(){return 1};i;)t(i)&&n++,i=i.nextSibling;return n},isEmptyNode:function(e){return!e.firstChild||0==f.getChildCount(e,function(e){return!f.isBr(e)&&!f.isBookmarkNode(e)&&!f.isWhitespace(e)})},clearSelectedArr:function(e){for(var t;t=e.pop();)f.removeAttributes(t,["class"])},scrollToView:function(e,t,n){var i,o,i=(o=t.document,((i="CSS1Compat"==o.compatMode)?o.documentElement:o.body).clientWidth,(i?o.documentElement:o.body).clientHeight||0);n=-1*i+n+(e.offsetHeight||0),n+=(e=f.getXY(e)).y,((e=("pageXOffset"in(o=t)?{x:o.pageXOffset||0,y:o.pageYOffset||0}:{x:(o=o.document).documentElement.scrollLeft||o.body.scrollLeft||0,y:o.documentElement.scrollTop||o.body.scrollTop||0}).y)<n||n<e-i)&&t.scrollTo(0,n+(n<0?-20:20))},isBr:function(e){return 1==e.nodeType&&"BR"==e.tagName},isFillChar:function(e,t){if(3!=e.nodeType)return!1;e=e.nodeValue;return t?RegExp("^"+f.fillChar).test(e):!e.replace(RegExp(f.fillChar,"g"),"").length},isStartInblock:function(e){var t,n,i=0,o=(e=e.cloneRange()).startContainer;if(1==o.nodeType&&o.childNodes[e.startOffset])for(var r=(o=o.childNodes[e.startOffset]).previousSibling;r&&f.isFillChar(r);)r=(o=r).previousSibling;for(this.isFillChar(o,!0)&&1==e.startOffset&&(e.setStartBefore(o),o=e.startContainer);o&&f.isFillChar(o);)o=(t=o).previousSibling;for(t&&(e.setStartBefore(t),o=e.startContainer),1==o.nodeType&&f.isEmptyNode(o)&&1==e.startOffset&&e.setStart(o,0).collapse(!0);!e.startOffset;){if(o=e.startContainer,f.isBlockElm(o)||f.isBody(o)){i=1;break}if(r=e.startContainer.previousSibling){for(;r&&f.isFillChar(r);)r=(n=r).previousSibling;n?e.setStartBefore(n):e.setStartBefore(e.startContainer)}else e.setStartBefore(e.startContainer)}return i&&!f.isBody(e.startContainer)?1:0},isEmptyBlock:function(e,t){if(1!=e.nodeType)return 0;if(t=t||RegExp("[  \t\r\n"+f.fillChar+"]","g"),0<e[r.ie?"innerText":"textContent"].replace(t,"").length)return 0;for(var n in v.$isNotEmpty)if(e.getElementsByTagName(n).length)return 0;return 1},setViewportOffset:function(e,t){var n=0|parseInt(e.style.left),i=0|parseInt(e.style.top),o=e.getBoundingClientRect(),r=t.left-o.left,o=t.top-o.top;r&&(e.style.left=n+r+"px"),o&&(e.style.top=i+o+"px")},fillNode:function(e,t){e=r.ie?e.createTextNode(f.fillChar):e.createElement("br");t.innerHTML="",t.appendChild(e)},moveChild:function(e,t,n){for(;e.firstChild;)n&&t.firstChild?t.insertBefore(e.lastChild,t.firstChild):t.appendChild(e.firstChild)},hasNoAttributes:function(e){return r.ie?/^<\w+\s*?>/.test(e.outerHTML):0==e.attributes.length},isCustomeNode:function(e){return 1==e.nodeType&&e.getAttribute("_ue_custom_node_")},isTagNode:function(e,t){return 1==e.nodeType&&RegExp("\\b"+e.tagName+"\\b","i").test(t)},filterNodeList:function(e,t,n){var i,o=[];return p.isFunction(t)||(i=t,t=function(e){return-1!=p.indexOf(p.isArray(i)?i:i.split(" "),e.tagName.toLowerCase())}),p.each(e,function(e){t(e)&&o.push(e)}),0==o.length?null:1!=o.length&&n?o:o[0]},isInNodeEndBoundary:function(e,t){var n=e.startContainer;if(3==n.nodeType&&e.startOffset!=n.nodeValue.length||1==n.nodeType&&e.startOffset!=n.childNodes.length)return 0;for(;n!==t;){if(n.nextSibling)return 0;n=n.parentNode}return 1},isBoundaryNode:function(e,t){for(;!f.isBody(e);)if(e!==(e=e.parentNode)[t])return!1;return!0},fillHtml:r.ie11below?"&nbsp;":"<br/>"},P=RegExp(f.fillChar,"g"),$c,_c,ad,bd,cd,dd,ed,fd,gd,hd,id,jd,kd,ld,md,nd,od,pd,qd,rd,sd,td,ci,ai,bi,di,lm,km,mm,vq,wq,xq,yq,zq,gt;function Zc(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}function Xh(e){return!e.collapsed&&1==e.startContainer.nodeType&&e.startContainer===e.endContainer&&1==e.endOffset-e.startOffset}function Yh(e,t,n,i){return 1==t.nodeType&&(v.$empty[t.tagName]||v.$nonChild[t.tagName])&&(n=f.getNodeIndex(t)+(e?0:1),t=t.parentNode),e?(i.startContainer=t,i.startOffset=n,i.endContainer||i.collapse(!0)):(i.endContainer=t,i.endOffset=n,i.startContainer||i.collapse(!1)),i.collapsed=i.startContainer&&i.endContainer&&i.startContainer===i.endContainer&&i.startOffset==i.endOffset,i}function Zh(e,t){var n,i,o=e.startContainer,r=e.endContainer,a=e.startOffset,s=e.endOffset,l=e.document,d=l.createDocumentFragment();if(1==o.nodeType&&(o=o.childNodes[a]||(n=o.appendChild(l.createTextNode("")))),1==r.nodeType&&(r=r.childNodes[s]||(i=r.appendChild(l.createTextNode("")))),o===r&&3==o.nodeType)return d.appendChild(l.createTextNode(o.substringData(a,s-a))),t&&(o.deleteData(a,s-a),e.collapse(!0)),d;for(var c,u,m=d,h=f.findParents(o,!0),p=f.findParents(r,!0),g=0;h[g]==p[g];)g++;for(var b,v=g;b=h[v];v++){for(c=b.nextSibling,b==o?n||(3==e.startContainer.nodeType?(m.appendChild(l.createTextNode(o.nodeValue.slice(a))),t&&o.deleteData(a,o.nodeValue.length-a)):m.appendChild(t?o:o.cloneNode(!0))):(u=b.cloneNode(!1),m.appendChild(u));c&&c!==r&&c!==p[v];)b=c.nextSibling,m.appendChild(t?c:c.cloneNode(!0)),c=b;m=u}for(m=d,h[g]||(m.appendChild(h[g-1].cloneNode(!1)),m=m.firstChild),v=g;a=p[v];v++){if(c=a.previousSibling,a==r?i||3!=e.endContainer.nodeType||(m.appendChild(l.createTextNode(r.substringData(0,s))),t&&r.deleteData(0,s)):(u=a.cloneNode(!1),m.appendChild(u)),v!=g||!h[g])for(;c&&c!==o;)a=c.previousSibling,m.insertBefore(t?c:c.cloneNode(!0),m.firstChild),c=a;m=u}return t&&e.setStartBefore(p[g]?h[g]?p[g]:h[g-1]:p[g-1]).collapse(!0),n&&f.remove(n),i&&f.remove(i),d}function $h(e,t){try{if(ci&&f.inDoc(ci,e))if(ci.nodeValue.replace(P,"").length)ci.nodeValue=ci.nodeValue.replace(P,"");else{var n=ci.parentNode;for(f.remove(ci);n&&f.isEmptyInlineElement(n)&&(r.safari?!(f.getPosition(n,t)&f.POSITION_CONTAINS):!n.contains(t));)ci=n.parentNode,f.remove(n),n=ci}}catch(e){}}function _h(e,t){var n;for(e=e[t];e&&f.isFillChar(e);)n=e[t],f.remove(e),e=n}function ol(e,t){var n=f.getNodeIndex;(e=e.duplicate()).collapse(t);var i=e.parentElement();if(!i.hasChildNodes())return{container:i,offset:0};for(var o,r=i.children,a=e.duplicate(),s=0,l=r.length-1,d=-1;s<=l;){o=r[d=Math.floor((s+l)/2)],a.moveToElementText(o);var c=a.compareEndPoints("StartToStart",e);if(0<c)l=d-1;else{if(!(c<0))return{container:i,offset:n(o)};s=d+1}}if(-1==d){if(a.moveToElementText(i),a.setEndPoint("StartToStart",e),a=a.text.replace(/(\r\n|\r)/g,"\n").length,r=i.childNodes,!a)return{container:o=r[r.length-1],offset:o.nodeValue.length};for(n=r.length;0<a;)a-=r[--n].nodeValue.length;return{container:r[n],offset:-a}}if(a.collapse(0<c),a.setEndPoint(0<c?"StartToStart":"EndToStart",e),!(a=a.text.replace(/(\r\n|\r)/g,"\n").length))return v.$empty[o.tagName]||v.$nonChild[o.tagName]?{container:i,offset:n(o)+(0<c?0:1)}:{container:o,offset:0<c?0:o.childNodes.length};for(;0<a;)try{a-=(o=(r=o)[0<c?"previousSibling":"nextSibling"]).nodeValue.length}catch(e){return{container:i,offset:n(r)}}return{container:o,offset:0<c?-a:o.nodeValue.length+a}}function ql(e){var t;try{t=e.getNative().createRange()}catch(e){return null}var n=t.item?t.item(0):t.parentElement();return(n.ownerDocument||n)===e.document?t:null}function hm(e,t){var n;if(t.textarea)if(p.isString(t.textarea)){for(var i,o=0,r=f.getElementsByTagName(e,"textarea");i=r[o++];)if(i.id=="ueditor_textarea_"+t.options.textarea){n=i;break}}else n=t.textarea;n||(e.appendChild(n=f.createElement(document,"textarea",{name:t.options.textarea,id:"ueditor_textarea_"+t.options.textarea,style:"display:none"})),t.textarea=n),n.getAttribute("name")||n.setAttribute("name",t.options.textarea),n.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0):""}function jm(e){e.langIsReady=!0,e.fireEvent("langReady")}function vo(){var e=this;e.document.getElementById("initContent")&&(e.body.innerHTML="<p>"+(I?"":"<br/>")+"</p>",e.removeListener("firstBeforeExecCommand focus",vo),setTimeout(function(){e.focus(),e._selectionChange()},0))}function Qp(e){return e.replace(/[\d.]+\w+/g,function(e){return p.transUnitToPx(e)})}function oq(e,t,n){return e.push(zq),t+(n?1:-1)}function pq(e,t){for(var n=0;n<t;n++)e.push(yq)}function qq(e,t,n,i){switch(e.type){case"root":for(var o,r=0;o=e.children[r++];)n&&"element"==o.type&&!v.$inlineWithA[o.tagName]&&1<r&&(oq(t,i,!0),pq(t,i)),qq(o,t,n,i);break;case"text":"pre"==e.parentNode.tagName?t.push(e.data):t.push(xq[e.parentNode.tagName]?p.html(e.data):e.data.replace(/[ ]{2}/g," &nbsp;"));break;case"element":!function(e,t,n,i){var o="";if(e.attrs){var r,o=[],a=e.attrs;for(r in a)o.push(r+(void 0!==a[r]?'="'+(wq[r]?p.html(a[r]).replace(/["]/g,function(e){return"&quot;"}):p.unhtml(a[r]))+'"':""));o=o.join(" ")}if(t.push("<"+e.tagName+(o?" "+o:"")+(v.$empty[e.tagName]?"/":"")+">"),n&&!v.$inlineWithA[e.tagName]&&"pre"!=e.tagName&&e.children&&e.children.length&&(i=oq(t,i,!0),pq(t,i)),e.children&&e.children.length)for(o=0;a=e.children[o++];)n&&"element"==a.type&&!v.$inlineWithA[a.tagName]&&1<o&&(oq(t,i),pq(t,i)),qq(a,t,n,i);v.$empty[e.tagName]||(n&&!v.$inlineWithA[e.tagName]&&"pre"!=e.tagName&&e.children&&e.children.length&&(i=oq(t,i),pq(t,i)),t.push("</"+e.tagName+">"))}(e,t,n,i);break;case"comment":t.push("\x3c!--"+e.data+"--\x3e")}return t}ai=0,bi=f.fillChar,di=L.Range=function(e){this.startContainer=this.startOffset=this.endContainer=this.endOffset=null,this.document=e,this.collapsed=!0},di.prototype={cloneContents:function(){return this.collapsed?null:Zh(this,0)},deleteContents:function(){var e;return this.collapsed||Zh(this,1),r.webkit&&(3!=(e=this.startContainer).nodeType||e.nodeValue.length||(this.setStartBefore(e).collapse(!0),f.remove(e))),this},extractContents:function(){return this.collapsed?null:Zh(this,2)},setStart:function(e,t){return Yh(!0,e,t,this)},setEnd:function(e,t){return Yh(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,f.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,f.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,f.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,f.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,(3==e.nodeType?e.nodeValue:e.childNodes).length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,(3==e.nodeType?e.nodeValue:e.childNodes).length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){return new di(this.document).setStart(this.startContainer,this.startOffset).setEnd(this.endContainer,this.endOffset)},collapse:function(e){return e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset):(this.startContainer=this.endContainer,this.startOffset=this.endOffset),this.collapsed=!0,this},shrinkBoundary:function(e){function t(e){return 1==e.nodeType&&!f.isBookmarkNode(e)&&!v.$empty[e.tagName]&&!v.$nonChild[e.tagName]}for(var n,i=this.collapsed;1==this.startContainer.nodeType&&(n=this.startContainer.childNodes[this.startOffset])&&t(n);)this.setStart(n,0);if(i)return this.collapse(!0);if(!e)for(;1==this.endContainer.nodeType&&0<this.endOffset&&(n=this.endContainer.childNodes[this.endOffset-1])&&t(n);)this.setEnd(n,n.childNodes.length);return this},getCommonAncestor:function(e,t){var n=this.startContainer,i=this.endContainer;return n===i?(!e||!Xh(this)||1!=(n=n.childNodes[this.startOffset]).nodeType)&&t&&3==n.nodeType?n.parentNode:n:f.getCommonAncestor(n,i)},trimBoundary:function(e){this.txtToElmBoundary();var t,n=this.startContainer,i=this.startOffset,o=this.collapsed,r=this.endContainer;if(3==n.nodeType&&(0==i?this.setStartBefore(n):i>=n.nodeValue.length?this.setStartAfter(n):(t=f.split(n,i),n===r?this.setEnd(t,this.endOffset-i):n.parentNode===r&&(this.endOffset+=1),this.setStartBefore(t)),o))return this.collapse(!0);return e||(i=this.endOffset,3==(r=this.endContainer).nodeType&&(0==i?this.setEndBefore(r):(i<r.nodeValue.length&&f.split(r,i),this.setEndAfter(r)))),this},txtToElmBoundary:function(e){function t(e,t){var n=e[t+"Container"],i=e[t+"Offset"];3==n.nodeType&&(i?i>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}return!e&&this.collapsed||(t(this,"start"),t(this,"end")),this},insertNode:function(e){var t=e,n=1;11==e.nodeType&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var i=this.startContainer,o=i.childNodes[this.startOffset];return o?i.insertBefore(e,o):i.appendChild(e),t.parentNode===this.endContainer&&(this.endOffset+=n),this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(e,t){var n,i=this.document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this.document.createTextNode("‍")),i.id="_baidu_bookmark_start_"+(t?"":ai++),this.collapsed||((n=i.cloneNode(!0)).id="_baidu_bookmark_end_"+(t?"":ai++)),this.insertNode(i),n&&this.collapse().insertNode(n).setEndBefore(n),this.setStartAfter(i),{start:e?i.id:i,end:n?e?n.id:n:null,id:e}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start;return e=e.end&&e.id?this.document.getElementById(e.end):e.end,this.setStartBefore(t),f.remove(t),e?(this.setEndBefore(e),f.remove(e)):this.collapse(!0),this},enlarge:function(e,t){var n,i,o=f.isBody,r=this.document.createTextNode("");if(e){for(n=1==(i=this.startContainer).nodeType?i=i.childNodes[this.startOffset]||(i.appendChild(r),r):i;;){if(f.isBlockElm(i)){for(i=n;(n=i.previousSibling)&&!f.isBlockElm(n);)i=n;this.setStartBefore(i);break}i=(n=i).parentNode}for(n=1==(i=this.endContainer).nodeType?((n=i.childNodes[this.endOffset])?i.insertBefore(r,n):i.appendChild(r),i=r):i;;){if(f.isBlockElm(i)){for(i=n;(n=i.nextSibling)&&!f.isBlockElm(n);)i=n;this.setEndAfter(i);break}i=(n=i).parentNode}r.parentNode===this.endContainer&&this.endOffset--,f.remove(r)}if(!this.collapsed){for(;!(0!=this.startOffset||t&&t(this.startContainer)||o(this.startContainer));)this.setStartBefore(this.startContainer);for(;!(this.endOffset!=(1==this.endContainer.nodeType?this.endContainer.childNodes:this.endContainer.nodeValue).length||t&&t(this.endContainer)||o(this.endContainer));)this.setEndAfter(this.endContainer)}return this},enlargeToBlockElm:function(e){for(;!f.isBlockElm(this.startContainer);)this.setStartBefore(this.startContainer);if(!e)for(;!f.isBlockElm(this.endContainer);)this.setEndAfter(this.endContainer);return this},adjustmentBoundary:function(){if(!this.collapsed){for(;!f.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length&&this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!f.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[3==this.endContainer.nodeType?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(t,e,n){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(e){return 1==e.nodeType&&f.isBlockElm(e)}).adjustmentBoundary();function i(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!f.isWhitespace(e)}for(var o,r,a=this.createBookmark(),s=a.end,l=f.getNextDomNode(a.start,!1,i),d=this.cloneRange();l&&f.getPosition(l,s)&f.POSITION_PRECEDING;)if(3==l.nodeType||v[t][l.tagName]){for(d.setStartBefore(l),o=l;o&&(3==o.nodeType||v[t][o.tagName])&&o!==s;)r=o,o=f.getNextDomNode(o,1==o.nodeType,null,function(e){return v[t][e.tagName]});var c,u,l=d.setEndAfter(r).extractContents();if(n&&0<n.length)for(var m,h=c=n[0].cloneNode(!1),p=1;m=n[p++];)c.appendChild(m.cloneNode(!1)),c=c.firstChild;else c=d.document.createElement(t);if(e&&f.setAttributes(c,e),c.appendChild(l),d.insertNode(n?h:c),"span"==t&&e.style&&/text\-decoration/.test(e.style)&&(u=f.findParentByTagName(c,"a",!0))?(f.setAttributes(u,e),f.remove(c,!0),c=u):(f.mergeSibling(c),f.clearEmptySibling(c)),f.mergeChild(c,e),l=f.getNextDomNode(c,!1,i),f.mergeToParent(c),o===s)break}else l=f.getNextDomNode(l,!0,i);return this.moveToBookmark(a)},removeInlineStyle:function(e){if(this.collapsed)return this;e=p.isArray(e)?e:[e],this.shrinkBoundary().adjustmentBoundary();for(var t=this.startContainer,n=this.endContainer;;){if(1==t.nodeType){if(-1<p.indexOf(e,t.tagName.toLowerCase()))break;if("body"==t.tagName.toLowerCase()){t=null;break}}t=t.parentNode}for(;;){if(1==n.nodeType){if(-1<p.indexOf(e,n.tagName.toLowerCase()))break;if("body"==n.tagName.toLowerCase()){n=null;break}}n=n.parentNode}var i,o,r=this.createBookmark();for(t&&(i=(o=this.cloneRange().setEndBefore(r.start).setStartBefore(t)).extractContents(),o.insertNode(i),f.clearEmptySibling(t,!0),t.parentNode.insertBefore(r.start,t)),n&&(i=(o=this.cloneRange().setStartAfter(r.end).setEndAfter(n)).extractContents(),o.insertNode(i),f.clearEmptySibling(n,!1,!0),n.parentNode.insertBefore(r.end,n.nextSibling)),t=f.getNextDomNode(r.start,!1,function(e){return 1==e.nodeType});t&&t!==r.end;)n=f.getNextDomNode(t,!0,function(e){return 1==e.nodeType}),-1<p.indexOf(e,t.tagName.toLowerCase())&&f.remove(t,!0),t=n;return this.moveToBookmark(r)},getClosedNode:function(){var e,t;return this.collapsed||Xh(t=this.cloneRange().adjustmentBoundary().shrinkBoundary())&&(t=t.startContainer.childNodes[t.startOffset])&&1==t.nodeType&&(v.$empty[t.tagName]||v.$nonChild[t.tagName])&&(e=t),e},select:r.ie?function(e,t){this.collapsed||this.shrinkBoundary();var n=this.getClosedNode();if(n&&!t){try{(r=this.document.body.createControlRange()).addElement(n),r.select()}catch(e){}return this}var i,o,r,t=(n=this.createBookmark()).start;(r=this.document.body.createTextRange()).moveToElementText(t),r.moveStart("character",1),this.collapsed?e||3==this.startContainer.nodeType||(o=this.document.createTextNode(bi),(i=this.document.createElement("span")).appendChild(this.document.createTextNode(bi)),t.parentNode.insertBefore(i,t),t.parentNode.insertBefore(o,t),$h(this.document,o),ci=o,_h(i,"previousSibling"),_h(t,"nextSibling"),r.moveStart("character",-1),r.collapse(!0)):(o=this.document.body.createTextRange(),t=n.end,o.moveToElementText(t),r.setEndPoint("EndToEnd",o)),this.moveToBookmark(n),i&&f.remove(i);try{r.select()}catch(e){}return this}:function(e){var i,t=f.getWindow(this.document),n=t.getSelection();if((r.gecko?this.document.body:t).focus(),n){if(n.removeAllRanges(),this.collapsed&&!e&&(e=t=this.startContainer,1==t.nodeType&&(e=t.childNodes[this.startOffset]),3==t.nodeType&&this.startOffset||(e?e.previousSibling&&3==e.previousSibling.nodeType:t.lastChild&&3==t.lastChild.nodeType)||(e=this.document.createTextNode(bi),this.insertNode(e),$h(this.document,e),_h(e,"previousSibling"),_h(e,"nextSibling"),ci=e,this.setStart(e,r.webkit?1:0).collapse(!0))),t=this.document.createRange(),this.collapsed&&r.opera&&1==this.startContainer.nodeType)if(e=this.startContainer.childNodes[this.startOffset]){for(;e&&f.isBlockElm(e)&&(1==e.nodeType&&e.childNodes[0]);)e=e.childNodes[0];e&&this.setStartBefore(e).collapse(!0)}else(e=this.startContainer.lastChild)&&f.isBr(e)&&this.setStartBefore(e).collapse(!0);o((i=this).startContainer,i.startOffset,"start"),o(i.endContainer,i.endOffset,"end"),t.setStart(this.startContainer,this.startOffset),t.setEnd(this.endContainer,this.endOffset),n.addRange(t)}function o(e,t,n){3==e.nodeType&&e.nodeValue.length<t&&(i[n+"Offset"]=e.nodeValue.length)}return this},scrollToView:function(e,t){e=e?window:f.getWindow(this.document);var n=this.document.createElement("span");return n.innerHTML="&nbsp;",this.cloneRange().insertNode(n),f.scrollToView(n,e,t),f.remove(n),this},inFillChar:function(){var e=this.startContainer;return!(!this.collapsed||3!=e.nodeType||e.nodeValue.replace(RegExp("^"+f.fillChar),"").length+1!=e.nodeValue.length)},createAddress:function(e,a){function t(e){for(var t,n=e?s.startContainer:s.endContainer,i=f.findParents(n,!0,function(e){return!f.isBody(e)}),o=[],r=0;t=i[r++];)o.push(f.getNodeIndex(t,a));if(i=0,a)if(3==n.nodeType){for(n=n.previousSibling;n&&3==n.nodeType;)i+=n.nodeValue.replace(P,"").length,n=n.previousSibling;i+=e?s.startOffset:s.endOffset}else if(n=n.childNodes[e?s.startOffset:s.endOffset])i=f.getNodeIndex(n,a);else for(e=(n=e?s.startContainer:s.endContainer).firstChild;e;)if(f.isFillChar(e))e=e.nextSibling;else if(i++,3==e.nodeType)for(;e&&3==e.nodeType;)e=e.nextSibling;else e=e.nextSibling;else i=e?f.isFillChar(n)?0:s.startOffset:s.endOffset;return i<0&&(i=0),o.push(i),o}var n={},s=this;return n.startAddress=t(!0),e||(n.endAddress=s.collapsed?[].concat(n.startAddress):t()),n},moveToAddress:function(e,t){function n(e,t){for(var n,i,o,r=l.document.body,a=0,s=e.length;a<s;a++)if(o=e[a],!(r=(n=r).childNodes[o])){i=o;break}t?r?l.setStartBefore(r):l.setStart(n,i):r?l.setEndBefore(r):l.setEnd(n,i)}var l=this;return n(e.startAddress,!0),!t&&e.endAddress&&n(e.endAddress),l},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0},traversal:function(e,t){if(this.collapsed)return this;for(var n=this.createBookmark(),i=n.end,o=f.getNextDomNode(n.start,!1,t);o&&o!==i&&f.getPosition(o,i)&f.POSITION_PRECEDING;){var r=f.getNextDomNode(o,!1,t);e(o),o=r}return this.moveToBookmark(n)}},(L.Selection=function(e){var t=this;t.document=e,r.ie9below&&(e=f.getWindow(e).frameElement,f.on(e,"beforedeactivate",function(){t._bakIERange=t.getIERange()}),f.on(e,"activate",function(){try{!ql(t)&&t._bakIERange&&t._bakIERange.select()}catch(e){}t._bakIERange=null})),e=null}).prototype={rangeInBody:function(e,t){e=r.ie9below||t?e.item?e.item():e.parentElement():e.startContainer;return e===this.document.body||f.inDoc(e,this.document)},getNative:function(){var e=this.document;try{return e?r.ie9below?e.selection:f.getWindow(e).getSelection():null}catch(e){return null}},getIERange:function(){var e=ql(this);return!e&&this._bakIERange?this._bakIERange:e},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?f.findParents(e,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{if(r.ie9below){var e=ql(this);return!(!e||!this.rangeInBody(e))}return!!this.getNative().rangeCount}catch(e){return!1}},getRange:function(){function t(e){for(var t=i.document.body.firstChild,n=e.collapsed;t&&t.firstChild;)e.setStart(t,0),t=t.firstChild;e.startContainer||e.setStart(i.document.body,0),n&&e.collapse(!0)}var i=this;if(null!=i._cachedRange)return this._cachedRange;var e,n,o,a=new s.editor.dom.Range(i.document);if(r.ie9below){var l=i.getIERange();if(l)try{n=a,(e=l).item?n.selectNode(e.item(0)):(o=ol(e,!0),n.setStart(o.container,o.offset),0!=e.compareEndPoints("StartToEnd",e)&&(o=ol(e,!1),n.setEnd(o.container,o.offset)))}catch(e){t(a)}else t(a)}else{var d=i.getNative();if(d&&d.rangeCount)l=d.getRangeAt(0),d=d.getRangeAt(d.rangeCount-1),a.setStart(l.startContainer,l.startOffset).setEnd(d.endContainer,d.endOffset),a.collapsed&&f.isBody(a.startContainer)&&!a.startOffset&&t(a);else{if(this._bakRange&&f.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;t(a)}}return this._bakRange=a},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var e,t,n=r.ie9below?this.getIERange():this.getRange();if(r.ie9below){if(!n)return this.document.body.firstChild;if(n.item)return n.item(0);for(0<(e=n.duplicate()).text.length&&e.moveStart("character",1),e.collapse(1),e=e.parentElement(),t=n=n.parentElement();n=n.parentNode;)if(n==e){e=t;break}}else if(n.shrinkBoundary(),1==(e=n.startContainer).nodeType&&e.hasChildNodes()&&(e=e.childNodes[Math.min(e.childNodes.length-1,n.startOffset)]),3==e.nodeType)return e.parentNode;return e},getText:function(){var e;return this.isFocus()&&(e=this.getNative())?(e=r.ie9below?e.createRange():e.getRangeAt(0),r.ie9below?e.text:e.toString()):""},clearRange:function(){this.getNative()[r.ie9below?"empty":"removeAllRanges"]()}},km=0,mm=UE.Editor=function(e){var t=this;t.uid=km++,Z.call(t),t.commands={},t.options=p.extend(p.clone(e||{}),UEDITOR_CONFIG,!0),t.shortcutkeys={},t.inputRules=[],t.outputRules=[],t.setOpt(mm.defaultOptions(t)),t.loadServerConfig(),p.isEmptyObject(UE.I18N)?p.loadFile(document,{src:t.options.langPath+t.options.lang+"/"+t.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){UE.plugin.load(t),jm(t)}):(t.options.lang=function(e){for(var t in e)return t}(UE.I18N),UE.plugin.load(t),jm(t)),UE.instants["ueditorInstant"+t.uid]=t},mm.prototype={registerCommand:function(e,t){this.commands[e]=t},ready:function(e){e&&(this.isReady?e.apply(this):this.addListener("ready",e))},setOpt:function(e,t){var n={};p.isString(e)?n[e]=t:n=e,p.extend(this.options,n,!0)},getOpt:function(e){return this.options[e]},destroy:function(){this.fireEvent("destroy");var e=this.container.parentNode,t=this.textarea;t?t.style.display="":(t=document.createElement("textarea"),e.parentNode.insertBefore(t,e)),t.style.width=this.iframe.offsetWidth+"px",t.style.height=this.iframe.offsetHeight+"px",t.value=this.getContent(),t.id=this.key,e.innerHTML="",f.remove(e);var n,e=this.key;for(n in this)this.hasOwnProperty(n)&&delete this[n];UE.delEditor(e)},render:function(e){var t,n=this.options;p.isString(e)&&(e=document.getElementById(e)),e&&(n.minFrameWidth=n.initialFrameWidth||(n.initialFrameWidth=e.offsetWidth),n.initialFrameHeight?n.minFrameHeight=n.initialFrameHeight:n.initialFrameHeight=n.minFrameHeight=e.offsetHeight,e.style.width=/%$/.test(n.initialFrameWidth)?"100%":n.initialFrameWidth-parseInt(f.getComputedStyle(e,"padding-left"))-parseInt(f.getComputedStyle(e,"padding-right"))+"px",e.style.height=/%$/.test(n.initialFrameHeight)?"100%":n.initialFrameHeight-parseInt(f.getComputedStyle(e,"padding-top"))-parseInt(f.getComputedStyle(e,"padding-bottom"))+"px",e.style.zIndex=n.zIndex,t=(I&&r.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' ><head><style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}</style>"+(n.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+p.unhtml(n.iframeCssUrl)+"'/>":"")+(n.initialStyle?"<style>"+n.initialStyle+"</style>":"")+"</head><body class='view' ></body><script type='text/javascript' "+(I?"defer='defer'":"")+" id='_initialScript'>setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant"+this.uid+"'];editor._setup(document);},0);var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);<\/script></html>",e.appendChild(f.createElement(document,"iframe",{id:"ueditor_"+this.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(n.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':"")+'document.write("'+t+'");document.close();}())'})),e.style.overflow="hidden",setTimeout(function(){/%$/.test(n.initialFrameWidth)&&(n.minFrameWidth=n.initialFrameWidth=e.offsetWidth),/%$/.test(n.initialFrameHeight)&&(n.minFrameHeight=n.initialFrameHeight=e.offsetHeight,e.style.height=n.initialFrameHeight+"px")}))},_setup:function(e){var t,n=this,i=n.options;I?(e.body.disabled=!0,e.body.contentEditable=!0,e.body.disabled=!1):e.body.contentEditable=!0,e.body.spellcheck=!1,n.document=e,n.window=e.defaultView||e.parentWindow,n.iframe=n.window.frameElement,n.body=e.body,n.selection=new L.Selection(e),r.gecko&&(t=this.selection.getNative())&&t.removeAllRanges(),this._initEvents();for(var o,a=this.iframe.parentNode;!f.isBody(a);a=a.parentNode)if("FORM"==a.tagName){n.form=a,n.options.autoSyncData?f.on(n.window,"blur",function(){hm(a,n)}):f.on(a,"submit",function(){hm(this,n)});break}i.initialContent&&(i.autoClearinitialContent?(o=n.execCommand,n.execCommand=function(){return n.fireEvent("firstBeforeExecCommand"),o.apply(n,arguments)},this._setDefaultContent(i.initialContent)):this.setContent(i.initialContent,!1,!0)),f.isEmptyNode(n.body)&&(n.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"</p>"),i.focus&&setTimeout(function(){n.focus(n.options.focusInEnd),n.options.autoClearinitialContent||n._selectionChange()},0),n.container||(n.container=this.iframe.parentNode),i.fullscreen&&n.ui&&n.ui.setFullScreen(!0);try{n.document.execCommand("2D-position",!1,!1)}catch(e){}try{n.document.execCommand("enableInlineTableEditing",!1,!1)}catch(e){}try{n.document.execCommand("enableObjectResizing",!1,!1)}catch(e){}n._bindshortcutKeys(),n.isReady=1,n.fireEvent("ready"),i.onready&&i.onready.call(n),r.ie9below||f.on(n.window,["blur","focus"],function(e){if("blur"==e.type){n._bakRange=n.selection.getRange();try{n._bakNativeRange=n.selection.getNative().getRangeAt(0),n.selection.getNative().removeAllRanges()}catch(e){n._bakNativeRange=null}}else try{n._bakRange&&n._bakRange.select()}catch(e){}}),r.gecko&&r.version<=10902&&(n.body.contentEditable=!1,setTimeout(function(){n.body.contentEditable=!0},100),setInterval(function(){n.body.style.height=n.iframe.offsetHeight-20+"px"},100)),i.isShow||n.setHide(),i.readonly&&n.setDisabled()},sync:function(e){(e=e?document.getElementById(e):f.findParent(this.iframe.parentNode,function(e){return"FORM"==e.tagName},!0))&&hm(e,this)},setHeight:function(e,t){e!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=e+"px"),t||(this.options.minFrameHeight=this.options.initialFrameHeight=e),this.body.style.height=e+"px",t||this.trigger("setHeight")},addshortcutkey:function(e,t){var n={};t?n[e]=t:n=e,p.extend(this.shortcutkeys,n)},_bindshortcutKeys:function(){var l=this,d=this.shortcutkeys;l.addListener("keydown",function(e,t){var n,i=t.keyCode||t.which;for(n in d)for(var o=d[n].split(","),r=0;s=o[r++];){var a=(s=s.split(":"))[0],s=s[1];(/^(ctrl)(\+shift)?\+(\d+)$/.test(a.toLowerCase())||/^(\d+)$/.test(a))&&(("ctrl"!=RegExp.$1||!t.ctrlKey&&!t.metaKey||""!=RegExp.$2&&!t[RegExp.$2.slice(1)+"Key"]||i!=RegExp.$3)&&i!=RegExp.$1||(-1!=l.queryCommandState(n,s)&&l.execCommand(n,s),f.preventDefault(t)))}})},getContent:function(e,t,n,i,o){return e&&p.isFunction(e)&&(t=e,e=""),(t?t():this.hasContents())?(this.fireEvent("beforegetcontent"),t=UE.htmlparser(this.body.innerHTML,i),this.filterOutputRule(t),this.fireEvent("aftergetcontent",e,t),t.toHtml(o)):""},getAllHtml:function(){var t,e=[];return this.fireEvent("getAllHtml",e),r.ie&&8<r.version&&(t="",p.each(this.document.styleSheets,function(e){t+=e.href?'<link rel="stylesheet" type="text/css" href="'+e.href+'" />':"<style>"+e.cssText+"</style>"}),p.each(this.document.getElementsByTagName("script"),function(e){t+=e.outerHTML})),"<html><head>"+(this.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+this.options.charset+'"/>':"")+(t||this.document.getElementsByTagName("head")[0].innerHTML)+e.join("\n")+"</head><body "+(I&&r.version<9?'class="view"':"")+">"+this.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=RegExp(f.fillChar,"g");return this.body.innerHTML.replace(/[\n\r]/g,"").replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,n){return v.$block[n]?"\n":t||""}).replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){return this.body[r.ie?"innerText":"textContent"].replace(RegExp(f.fillChar,"g"),"").replace(/\u00a0/g," ")},setContent:function(e,t,n){if(this.fireEvent("beforesetcontent",e),e=UE.htmlparser(e),this.filterInputRule(e),e=e.toHtml(),this.body.innerHTML=(t?this.body.innerHTML:"")+e,"p"==this.options.enterTag)if(!(t=this.body.firstChild)||1==t.nodeType&&(v.$cdata[t.tagName]||"DIV"==t.tagName&&t.getAttribute("cdata_tag")||f.isCustomeNode(t))&&t===this.body.lastChild)this.body.innerHTML="<p>"+(r.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else for(var i=this.document.createElement("p");t;){for(;t&&(3==t.nodeType||1==t.nodeType&&v.p[t.tagName]&&!v.$cdata[t.tagName]);)e=t.nextSibling,i.appendChild(t),t=e;if(i.firstChild){if(!t){this.body.appendChild(i);break}t.parentNode.insertBefore(i,t),i=this.document.createElement("p")}t=t.nextSibling}var o;this.fireEvent("aftersetcontent"),this.fireEvent("contentchange"),n||this._selectionChange(),this._bakRange=this._bakIERange=this._bakNativeRange=null,r.gecko&&(o=this.selection.getNative())&&o.removeAllRanges(),this.options.autoSyncData&&this.form&&hm(this.form,this)},focus:function(e){try{var t,n=this.selection.getRange();e?((t=this.body.lastChild)&&1==t.nodeType&&!v.$empty[t.tagName]&&(f.isEmptyBlock(t)?n.setStartAtFirst(t):n.setStartAtLast(t),n.collapse(!0)),n.setCursor(!0)):(!n.collapsed&&f.isBody(n.startContainer)&&0==n.startOffset&&(t=this.body.firstChild)&&1==t.nodeType&&!v.$empty[t.tagName]&&n.setStartAtFirst(t).collapse(!0),n.select(!0)),this.fireEvent("focus selectionchange")}catch(e){}},isFocus:function(){return this.selection.isFocus()},blur:function(){var e,t=this.selection.getNative();t.empty&&r.ie?((e=document.body.createTextRange()).moveToElementText(document.body),e.collapse(!0),e.select(),t.empty()):t.removeAllRanges()},_initEvents:function(){var t=this,e=t.document,n=t.window;t._proxyDomEvent=p.bind(t._proxyDomEvent,t),f.on(e,"click contextmenu mousedown keydown keyup keypress mouseup mouseover mouseout selectstart".split(" "),t._proxyDomEvent),f.on(n,["focus","blur"],t._proxyDomEvent),f.on(t.body,"drop",function(e){r.gecko&&e.stopPropagation&&e.stopPropagation(),t.fireEvent("contentchange")}),f.on(e,["mouseup","keydown"],function(e){"keydown"==e.type&&(e.ctrlKey||e.metaKey||e.shiftKey||e.altKey)||2!=e.button&&t._selectionChange(250,e)})},_proxyDomEvent:function(e){return!1!==this.fireEvent("before"+e.type.replace(/^on/,"").toLowerCase())&&!1!==this.fireEvent(e.type.replace(/^on/,""),e)&&this.fireEvent("after"+e.type.replace(/^on/,"").toLowerCase())},_selectionChange:function(e,n){var i,o,a=this,s=!1;r.ie&&r.version<9&&n&&"mouseup"==n.type&&!this.selection.getRange().collapsed&&(s=!0,i=n.clientX,o=n.clientY),clearTimeout(lm),lm=setTimeout(function(){if(a.selection&&a.selection.getNative()){var t,e;if(s&&"None"==a.selection.getNative().type){t=a.document.body.createTextRange();try{t.moveToPoint(i,o)}catch(e){t=null}}t&&(e=a.selection.getIERange,a.selection.getIERange=function(){return t}),a.selection.cache(),e&&(a.selection.getIERange=e),a.selection._cachedRange&&a.selection._cachedStartElement&&(a.fireEvent("beforeselectionchange"),a.fireEvent("selectionchange",!!n),a.fireEvent("afterselectionchange"),a.selection.clear())}},e||50)},_callCmdFn:function(e,t){var n=t[0].toLowerCase(),i=(n=this.commands[n]||UE.commands[n])&&n[e];return n&&i||"queryCommandState"!=e?i?i.apply(this,t):void 0:0},execCommand:function(e){e=e.toLowerCase();var t,n=this.commands[e]||UE.commands[e];return n&&n.execCommand?(n.notNeedUndo||this.__hasEnterExecCommand?(t=this._callCmdFn("execCommand",arguments),this.__hasEnterExecCommand||n.ignoreContentChange||this._ignoreContentChange||this.fireEvent("contentchange")):(this.__hasEnterExecCommand=!0,-1!=this.queryCommandState.apply(this,arguments)&&(this.fireEvent("saveScene"),this.fireEvent.apply(this,["beforeexeccommand",e].concat(arguments)),t=this._callCmdFn("execCommand",arguments),this.fireEvent.apply(this,["afterexeccommand",e].concat(arguments)),this.fireEvent("saveScene")),this.__hasEnterExecCommand=!1),this.__hasEnterExecCommand||n.ignoreContentChange||this._ignoreContentChange||this._selectionChange(),t):null},queryCommandState:function(e){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(e){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(e){if(e)for(var t,n=0;t=e[n++];)if(0<this.document.getElementsByTagName(t).length)return!0;if(!f.isEmptyBlock(this.body))return!0;for(e=["div"],n=0;t=e[n++];){t=f.getElementsByTagName(this.document,t);for(var i,o=0;i=t[o++];)if(f.isCustomeNode(i))return!0}return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var t;if("false"==this.body.contentEditable){this.body.contentEditable=!0,t=this.selection.getRange();try{t.moveToBookmark(this.lastBk),delete this.lastBk}catch(e){t.setStartAtFirst(this.body).collapse(!0)}t.select(!0),this.bkqueryCommandState&&(this.queryCommandState=this.bkqueryCommandState,delete this.bkqueryCommandState),this.bkqueryCommandValue&&(this.queryCommandValue=this.bkqueryCommandValue,delete this.bkqueryCommandValue),this.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(t){var n=this;t=t?p.isArray(t)?t:[t]:[],"true"==n.body.contentEditable&&(n.lastBk||(n.lastBk=n.selection.getRange().createBookmark(!0)),n.body.contentEditable=!1,n.bkqueryCommandState=n.queryCommandState,n.bkqueryCommandValue=n.queryCommandValue,n.queryCommandState=function(e){return-1!=p.indexOf(t,e)?n.bkqueryCommandState.apply(n,arguments):-1},n.queryCommandValue=function(e){return-1!=p.indexOf(t,e)?n.bkqueryCommandValue.apply(n,arguments):null},n.fireEvent("selectionchange"))},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(e){this.body.innerHTML='<p id="initContent">'+e+"</p>",this.addListener("firstBeforeExecCommand focus",vo)},setShow:function(){var t=this.selection.getRange();if("none"==this.container.style.display){try{t.moveToBookmark(this.lastBk),delete this.lastBk}catch(e){t.setStartAtFirst(this.body).collapse(!0)}setTimeout(function(){t.select(!0)},100),this.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){this.lastBk||(this.lastBk=this.selection.getRange().createBookmark(!0)),this.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t=UE.I18N[this.options.lang];if(!t)throw Error("not import language file");e=(e||"").split(".");for(var n,i=0;(n=e[i++])&&(t=t[n]););return t},getContentLength:function(e,t){var n=this.getContent(!1,!1,!0).length;if(e){t=(t||[]).concat(["hr","img","iframe"]);for(var i,n=this.getContentTxt().replace(/[\t\r\n]+/g,"").length,o=0;i=t[o++];)n+=this.document.getElementsByTagName(i).length}return n},addInputRule:function(e){this.inputRules.push(e)},filterInputRule:function(e){for(var t,n=0;t=this.inputRules[n++];)t.call(this,e)},addOutputRule:function(e){this.outputRules.push(e)},filterOutputRule:function(e){for(var t,n=0;t=this.outputRules[n++];)t.call(this,e)},getActionUrl:function(e){e=this.getOpt(e)||e;var t=this.getOpt("imageUrl"),n=this.getOpt("serverUrl");return!n&&t&&(n=t.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2")),n?(n=n+(-1==n.indexOf("?")?"?":"&")+"action="+(e||""),p.formatUrl(n)):""}},p.inherits(mm,Z),UE.Editor.defaultOptions=function(e){return{isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,iframeCssUrl:(e=e.options.UEDITOR_HOME_URL)+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:e+"lang/",theme:"default",themePath:e+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0,fileNameFormat:"{time}{rand:6}"}},function(){UE.Editor.prototype.loadServerConfig=function(){function d(e){console&&console.error(e)}var c=this;setTimeout(function(){try{c.options.imageUrl&&c.setOpt("serverUrl",c.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2"));var b=c.getActionUrl("config"),a=p.isCrossDomainUrl(b);c._serverConfigLoaded=!1,b&&UE.ajax.request(b,{method:"GET",dataType:a?"jsonp":"",onsuccess:function(b){try{var e=a?b:eval("("+b.responseText+")");p.extend(c.options,e),c.fireEvent("serverConfigLoaded"),c._serverConfigLoaded=!0}catch(l){d(c.getLang("loadconfigFormatError"))}},onerror:function(){d(c.getLang("loadconfigHttpError"))}})}catch(e){d(c.getLang("loadconfigError"))}})},UE.Editor.prototype.isServerConfigLoaded=function(){return this._serverConfigLoaded||!1},UE.Editor.prototype.afterConfigReady=function(e){var t,n;e&&p.isFunction(e)&&(n=function(){e.apply(t,arguments),t.removeListener("serverConfigLoaded",n)},(t=this).isServerConfigLoaded()?e.call(t,"serverConfigLoaded"):t.addListener("serverConfigLoaded",n))}}(),UE.ajax=function(){function m(e){var t,n=[];for(t in e)if("method"!=t&&"timeout"!=t&&"async"!=t&&"dataType"!=t&&"callback"!=t&&null!=e[t]&&null!=e[t])if("function"!=(typeof e[t]).toLowerCase()&&"object"!=(typeof e[t]).toLowerCase())n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));else if(p.isArray(e[t]))for(var i=0;i<e[t].length;i++)n.push(encodeURIComponent(t)+"[]="+encodeURIComponent(e[t][i]));return n.join("&")}function s(e,t){function n(e){return function(){try{if(e)l.onerror&&l.onerror();else try{clearTimeout(o),a.apply(window,arguments)}catch(e){}}catch(e){l.onerror&&l.onerror.call(window,e)}finally{l.oncomplete&&l.oncomplete.apply(window,arguments),s.parentNode&&s.parentNode.removeChild(s),window[i]=null;try{delete window[i]}catch(e){}}}}var i,o,r,a=t.onsuccess||function(){},s=document.createElement("SCRIPT"),l=t||{},d=l.charset,c=l.jsonp||"callback",u=l.timeOut||0,f=RegExp("(\\?|&)"+c+"=([^&]*)");p.isFunction(a)?(i="bd__editor__"+Math.floor(2147483648*Math.random()).toString(36),window[i]=n(0)):p.isString(a)?i=a:(r=f.exec(e))&&(i=r[2]),(e=e.replace(f,"$1"+c+"="+i)).search(f)<0&&(e+=(e.indexOf("?")<0?"?":"&")+c+"="+i),c=m(t),p.isEmptyObject(t.data)||(c+=(c?"&":"")+m(t.data)),c&&(e=e.replace(/\?/,"?"+c+"&")),s.onerror=n(1),u&&(o=setTimeout(n(1),u)),u=e,e=d,(d=s).setAttribute("type","text/javascript"),d.setAttribute("defer","defer"),e&&d.setAttribute("charset",e),d.setAttribute("src",u),document.getElementsByTagName("head")[0].appendChild(d)}var t="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP"),t="ActiveXObject('Msxml2.XMLHTTP')"}catch(e){try{new ActiveXObject("Microsoft.XMLHTTP"),t="ActiveXObject('Microsoft.XMLHTTP')"}catch(e){}}var l=new Function("return new "+t);return{request:function(e,t){var n,i,o,r,a;t&&"jsonp"==t.dataType?s(e,t):(n=e,e=t,r=l(),t={method:"POST",timeout:5e3,async:!(a=!1),data:{},onsuccess:function(){},onerror:function(){}},"object"==typeof n&&(n=(e=n).url),r&&n&&(t=m(i=e?p.extend(t,e):t),p.isEmptyObject(i.data)||(t+=(t?"&":"")+m(i.data)),o=setTimeout(function(){4!=r.readyState&&(a=!0,r.abort(),clearTimeout(o))},i.timeout),e=i.method.toUpperCase(),n=n+(-1==n.indexOf("?")?"?":"&")+("POST"==e?"":t+"&noCache="+ +new Date),r.open(e,n,i.async),r.onreadystatechange=function(){4==r.readyState&&(a||200!=r.status?i.onerror(r):i.onsuccess(r))},"POST"==e?(r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(t)):r.send(null)))},getJSONP:function(e,t,n){s(e,{data:t,oncomplete:n})}}}(),UE.filterWord=function(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/gi.test(e)?e.replace(/[\t\r\n]+/g," ").replace(/\x3c!--[\s\S]*?--\x3e/gi,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(r.opera)return"";try{if(/Bitmap/i.test(e))return"";var t=e.match(/width:([ \d.]*p[tx])/i)[1],n=e.match(/height:([ \d.]*p[tx])/i)[1],i=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+Qp(t)+'" height="'+Qp(n)+'" src="'+i+'" />'}catch(e){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/gi,function(e,t,n,i){return"class"==t&&"MsoListParagraph"==i?e:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(e,t,n){return n.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,t,n,i){e=[],i=i.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,function(e){return p.transUnitToPx(e)}).split(/;\s*/g),n=0;for(var o;o=i[n];n++){var r,a=o.split(":");if(2==a.length&&(o=a[0].toLowerCase(),r=a[1].toLowerCase(),!(/^(background)\w*/.test(o)&&0==r.replace(/(initial|\s)/g,"").length||/^(margin)\w*/.test(o)&&/^0\w+$/.test(r)))){switch(o){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(t)||(e[n]=o.replace(/^mso-|-alt$/g,"")+":"+Qp(r));continue;case"horiz-align":e[n]="text-align:"+r;continue;case"vert-align":e[n]="vertical-align:"+r;continue;case"font-color":case"mso-foreground":e[n]="color:"+r;continue;case"mso-background":case"mso-highlight":e[n]="background:"+r;continue;case"mso-default-height":e[n]="min-height:"+Qp(r);continue;case"mso-default-width":e[n]="min-width:"+Qp(r);continue;case"mso-padding-between-alt":e[n]="border-collapse:separate;border-spacing:"+Qp(r);continue;case"text-line-through":"single"!=r&&"double"!=r||(e[n]="text-decoration:line-through");continue;case"mso-zero-height":"yes"==r&&(e[n]="display:none");continue;case"margin":if(!/[1-9]/.test(r))continue}/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(o)||/text\-indent|padding|margin/.test(o)&&/\-[\d.]+/.test(r)||(e[n]=o+":"+a[1])}}return t+(e.length?' style="'+e.join(";").replace(/;{2,}/g,";")+'"':"")}):e},vq=UE.uNode=function(e){this.type=e.type,this.data=e.data,this.tagName=e.tagName,this.parentNode=e.parentNode,this.attrs=e.attrs||{},this.children=e.children},wq={href:1,src:1,_src:1,_href:1,cdata_data:1},xq={style:1,script:1},yq="    ",zq="\n",vq.createElement=function(e){return/[<>]/.test(e)?UE.htmlparser(e).children[0]:new vq({type:"element",children:[],tagName:e})},vq.createText=function(e,t){return new UE.uNode({type:"text",data:t?e:p.unhtml(e||"")})},vq.prototype={toHtml:function(e){var t=[];return qq(this,t,e,0),t.join("")},innerHTML:function(e){if("element"!=this.type||v.$empty[this.tagName])return this;if(p.isString(e)){if(this.children)for(var t,n=0;t=this.children[n++];)t.parentNode=null;for(this.children=[],e=UE.htmlparser(e),n=0;t=e.children[n++];)this.children.push(t),t.parentNode=this;return this}return(e=new UE.uNode({type:"root",children:this.children})).toHtml()},innerText:function(e,t){if("element"!=this.type||v.$empty[this.tagName])return this;if(e){if(this.children)for(var n,i=0;n=this.children[i++];)n.parentNode=null;return this.children=[],this.appendChild(vq.createText(e,t)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return"element"==this.type?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return 0==n?null:t.children[n-1]},nextSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n++];)if(e===this)return t.children[n]},replaceChild:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i,1,e),t.parentNode=null,e.parentNode=this,e}},appendChild:function(e){if("root"==this.type||"element"==this.type&&!v.$empty[this.tagName]){this.children||(this.children=[]),e.parentNode&&e.parentNode.removeChild(e);for(var t,n=0;t=this.children[n];n++)if(t===e){this.children.splice(n,1);break}return this.children.push(e),e.parentNode=this,e}},insertBefore:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i,0,e),e.parentNode=this,e}},insertAfter:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i+1,0,e),e.parentNode=this,e}},removeChild:function(e,t){if(this.children)for(var n,i=0;n=this.children[i];i++)if(n===e){if(this.children.splice(i,1),n.parentNode=null,t&&n.children&&n.children.length)for(var o,r=0;o=n.children[r];r++)this.children.splice(i+r,0,o),o.parentNode=this;return n}},getAttr:function(e){return this.attrs&&this.attrs[e.toLowerCase()]},setAttr:function(e,t){if(e)if(this.attrs||(this.attrs={}),p.isObject(e))for(var n in e)e[n]?this.attrs[n.toLowerCase()]=e[n]:delete this.attrs[n];else t?this.attrs[e.toLowerCase()]=t:delete this.attrs[e];else delete this.attrs},getIndex:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return n;return-1},getNodeById:function(e){var t;if(this.children&&this.children.length)for(var n=0;t=this.children[n++];)if(t=function e(t,n){var i;if("element"==t.type&&t.getAttr("id")==n)return t;if(t.children&&t.children.length)for(var o=0;i=t.children[o++];)if(i=e(i,n))return i}(t,e))return t},getNodesByTagName:function(e){e=p.trim(e).replace(/[ ]{2,}/g," ").split(" ");var i=[],o=this;return p.each(e,function(e){if(o.children&&o.children.length)for(var t,n=0;t=o.children[n++];)!function e(t,n,i){if("element"==t.type&&t.tagName==n&&i.push(t),t.children&&t.children.length)for(var o,r=0;o=t.children[r++];)e(o,n,i)}(t,e,i)}),i},getStyle:function(e){var t=this.getAttr("style");return t&&(e=t.match(RegExp("(^|;)\\s*"+e+":([^;]+)","i")))&&e[0]?e[2]:""},setStyle:function(e,t){function n(e,t){i=i.replace(RegExp("(^|;)\\s*"+e+":([^;]+;?)","gi"),"$1"),t&&(i=e+":"+p.unhtml(t)+";"+i)}var i=(i=this.getAttr("style"))||"";if(p.isObject(e))for(var o in e)n(o,e[o]);else n(e,t);this.setAttr("style",p.trim(i))},traversal:function(e){return this.children&&this.children.length&&function e(t,n){if(t.children&&t.children.length)for(var i,o=0;i=t.children[o];)e(i,n),i.parentNode&&(i.children&&i.children.length&&n(i),i.parentNode&&o++);else n(t)}(this,e),this}},UE.htmlparser=function(e,n){function t(e,t){var n;a[e.tagName]?(n=d.createElement(a[e.tagName]),e.appendChild(n),n.appendChild(d.createText(t))):e.appendChild(d.createText(t))}var i=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--\x3e)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,s=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,o={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};e=e.replace(RegExp(f.fillChar,"g"),""),n||(e=e.replace(RegExp("[\\r\\t\\n"+(n?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(n?"":" ")+"]*","g"),function(e,t){return t&&o[t.toLowerCase()]?e.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):e.replace(RegExp("^[\\r\\n"+(n?"":" ")+"]+"),"").replace(RegExp("[\\r\\n"+(n?"":" ")+"]+$"),"")}));for(var r,l={href:1,src:1},d=UE.uNode,c={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},a={ol:"li",ul:"li"},u=0,m=0,h=new d({type:"root",children:[]}),g=h;r=i.exec(e);){u=r.index;try{if(m<u&&t(g,e.slice(m,u)),r[3])v.$cdata[g.tagName]?t(g,r[0]):g=function e(t,n,i){var o;if(o=c[n]){for(var r,a=t;"root"!=a.type;){if(p.isArray(o)?-1!=p.indexOf(o,a.tagName):o==a.tagName){t=a,r=!0;break}a=a.parentNode}r||(t=e(t,p.isArray(o)?o[0]:o))}if(o=new d({parentNode:t,type:"element",tagName:n.toLowerCase(),children:v.$empty[n]?null:[]}),i){for(a={};r=s.exec(i);)a[r[1].toLowerCase()]=l[r[1].toLowerCase()]?r[2]||r[3]||r[4]:p.unhtml(r[2]||r[3]||r[4]);o.attrs=a}return t.children.push(o),v.$empty[n]?t:o}(g,r[3].toLowerCase(),r[4]);else if(r[1]){if("root"!=g.type)if(v.$cdata[g.tagName]&&!v.$cdata[r[1]])t(g,r[0]);else{for(u=g;"element"==g.type&&g.tagName!=r[1].toLowerCase();)if("root"==(g=g.parentNode).type)throw g=u,"break";g=g.parentNode}}else r[2]&&g.children.push(new d({type:"comment",data:r[2],parentNode:g}))}catch(e){}m=i.lastIndex}return m<e.length&&t(g,e.slice(m)),h},UE.filterNode=function(e,t){if(p.isEmptyObject(t))return e;var n,i;for((n=t["-"])&&p.each(n.split(" "),function(e){t[e]="-"}),n=0;i=e.children[n];)(function e(n,t){switch(n.type){case"element":var i;if(i=t[n.tagName])if("-"===i)n.parentNode.removeChild(n);else if(p.isFunction(i)){var o=n.parentNode,r=n.getIndex();if(i(n),n.parentNode){if(n.children)for(i=0;r=n.children[i];)e(r,t),r.parentNode&&i++}else for(i=r;r=o.children[i];)e(r,t),r.parentNode&&i++}else{if((i=i.$)&&n.attrs){for(o in r={},i){var a,s=n.getAttr(o);"style"==o&&p.isArray(i[o])&&(a=[],p.each(i[o],function(e){var t;(t=n.getStyle(e))&&a.push(e+":"+t)}),s=a.join(";")),s&&(r[o]=s)}n.attrs=r}if(n.children)for(i=0;r=n.children[i];)e(r,t),r.parentNode&&i++}else if(v.$cdata[n.tagName])n.parentNode.removeChild(n);else for(o=n.parentNode,r=n.getIndex(),n.parentNode.removeChild(n,!0),i=r;r=o.children[i];)e(r,t),r.parentNode&&i++;break;case"comment":n.parentNode.removeChild(n)}})(i,t),i.parentNode&&n++;return e},UE.plugin=(gt={},{register:function(e,t,n,i){n&&p.isFunction(n)&&(i=n,n=null),gt[e]={optionName:n||e,execFn:t,afterDisabled:i}},load:function(n){p.each(gt,function(e){var t=e.execFn.call(n);!1!==n.options[e.optionName]?t&&p.each(t,function(e,t){switch(t.toLowerCase()){case"shortcutkey":n.addshortcutkey(e);break;case"bindevents":p.each(e,function(e,t){n.addListener(t,e)});break;case"bindmultievents":p.each(p.isArray(e)?e:[e],function(t){var e=p.trim(t.type).split(/\s+/);p.each(e,function(e){n.addListener(e,t.handler)})});break;case"commands":p.each(e,function(e,t){n.commands[t]=e});break;case"outputrule":n.addOutputRule(e);break;case"inputrule":n.addInputRule(e);break;case"defaultoptions":n.setOpt(e)}}):e.afterDisabled&&e.afterDisabled.call(n)}),p.each(UE.plugins,function(e){e.call(n)})},run:function(e,t){e=gt[e];e&&e.exeFn.call(t)}});var $=UE.keymap={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,s:83,n:78},Y=UE.LocalStorage=(Dt=window.localStorage||((Ft=document.createElement("div")).style.display="none",Ft.addBehavior?(Ft.addBehavior("#default#userdata"),{getItem:function(e){var t=null;try{document.body.appendChild(Ft),Ft.load(Et),t=Ft.getAttribute(e),document.body.removeChild(Ft)}catch(e){}return t},setItem:function(e,t){document.body.appendChild(Ft),Ft.setAttribute(e,t),Ft.save(Et),document.body.removeChild(Ft)},removeItem:function(e){document.body.appendChild(Ft),Ft.removeAttribute(e),Ft.save(Et),document.body.removeChild(Ft)}}):null)||null,Et="localStorage",{saveLocalData:function(e,t){return!(!Dt||!t)&&(Dt.setItem(e,t),!0)},getLocalData:function(e){return Dt?Dt.getItem(e):null},removeItem:function(e){Dt&&Dt.removeItem(e)}}),Ft,Dt,Et,Sy,tG,CH,BH,XJ,JP,g5,h5,i5,j5,k5,j6,k6,l6,m6,A6,B6,C6,E6,F6,G6,H6,I6,L7,M7,N7,O7,e8,f8,g8,A8,B8,C8,D8,J8,K8,L8,M8,N8,U8,V8,W8,X8,Y8,Z8,h9,i9,j9,k9,l9,t9,u9,v9,E9,F9,G9,H9,I9,caa,daa,eaa,faa,gaa,raa,saa,taa,uaa,vaa,Caa,Daa,Eaa,Faa,xba,yba,zba,Aba,Bba,Wba,Xba,Yba,Pba,Qba,Rba,Sba,Tba,Uba,Vba,Qca,Rca,Sca,Tca,Yca,Zca,$ca,_ca,jda,dda,eda,fda,gda,hda,ida,kda,lda,_da,aea,bea,dea,eea,fea,gea;function Ty(e){return f.filterNodeList(e.selection.getStartElementPath(),function(e){return e&&1==e.nodeType&&e.getAttribute("dir")})}function Uy(e,t,n){function i(e){return 1==e.nodeType?!f.isBookmarkNode(e):!f.isWhitespace(e)}if((t=Ty(t))&&e.collapsed)return t.setAttribute("dir",n),e;t=e.createBookmark(),e.enlarge(!0);for(var o,r,a=e.createBookmark(),s=f.getNextDomNode(a.start,!1,i),l=e.cloneRange();s&&!(f.getPosition(s,a.end)&f.POSITION_FOLLOWING);)if(3!=s.nodeType&&Sy(s))s=f.getNextDomNode(s,!0,i);else{for(l.setStartBefore(s);s&&s!==a.end&&!Sy(s);)o=s,s=f.getNextDomNode(s,!1,null,function(e){return!Sy(e)});l.setEndAfter(o),s=l.getCommonAncestor(),!f.isBody(s)&&Sy(s)?s.setAttribute("dir",n):((s=e.document.createElement("p")).setAttribute("dir",n),r=l.extractContents(),s.appendChild(r),l.insertNode(s)),s=f.getNextDomNode(s,!1,i)}return e.moveToBookmark(a).moveToBookmark(t)}function AH(){this.cover=this.resizer=this.editor=null,this.doc=document,this.prePos={x:0,y:0},this.startPos={x:0,y:0}}function GP(e,t){var n,i,o=f.getElementsByTagName(e,"td th");p.each(o,function(e){e.removeAttribute("width")}),e.setAttribute("width",(n=t,i=!0,t=JP.getDefaultValue(t,e),(e=n.body).offsetWidth-(i?2*parseInt(f.getComputedStyle(e,"margin-left"),10):0)-2*t.tableBorder-(n.options.offsetWidth||0)));var r=[];setTimeout(function(){p.each(o,function(e){1==e.colSpan&&r.push(e.offsetWidth)}),p.each(o,function(e,t){1==e.colSpan&&e.setAttribute("width",r[t]+"")})},0)}function IP(e){if(e=KP(e).cell){var t=LP(e);return t.selectedTds.length?t.selectedTds:[e]}return[]}function KP(e){return JP.getTableItemsByRange(e)}function LP(e){return JP.getUETable(e)}function f5(){var e=document.getElementById("edui_fixedlayer");k5.setViewportOffset(e,{left:0,top:0})}function D9(e){for(var t,n,i={},o=e.getDom(),r=e.editor.uid,a=f.getElementsByTagName(o,"input"),s=a.length-1;n=a[s--];)if("checkbox"==n.getAttribute("type"))if(i[t=n.getAttribute("name")]&&delete i[t],n.checked)if(n=document.getElementById(t+"Value"+r)){if(/input/gi.test(n.tagName))i[t]=n.value;else for(var l,d=(n=n.getElementsByTagName("input")).length-1;l=n[d--];)if(l.checked){i[t]=l.value;break}}else i[t]=!0;else i[t]=!1;else i[n.getAttribute("value")]=n.checked;for(o=f.getElementsByTagName(o,"select"),s=0;r=o[s++];)i[a=r.getAttribute("name")]=i[a]?r.value:"";E9.extend(e.editor.options.autotypeset,i),e.editor.setPreferences("autotypeset",i)}function cda(e){if(!hda.findParent(e.target||e.srcElement,function(e){return hda.hasClass(e,"edui-shortcutmenu")||hda.hasClass(e,"edui-popup")},!0)){e=0;for(var t;t=ida[e++];)t.hide()}}UE.Editor.prototype.setPreferences=function(e,t){var n={};p.isString(e)?n[e]=t:n=e;e=Y.getLocalData("ueditor_preference");(e=e&&p.str2json(e))?p.extend(e,n):e=n,e&&Y.saveLocalData("ueditor_preference",p.json2str(e))},UE.Editor.prototype.getPreferences=function(e){var t=Y.getLocalData("ueditor_preference");return(t=t&&p.str2json(t))?e?t[e]:t:null},UE.Editor.prototype.removePreferences=function(e){var t=Y.getLocalData("ueditor_preference");(t=t&&p.str2json(t))&&(t[e]=void 0,delete t[e]),t&&Y.saveLocalData("ueditor_preference",p.json2str(t))},UE.plugins.defaultfilter=function(){var a=this;a.setOpt({allowDivTransToP:!0,disabledTableInTable:!0}),a.addInputRule(function(e){var n,o=this.options.allowDivTransToP;e.traversal(function(i){if("element"==i.type)if(v.$cdata[i.tagName]||!a.options.autoClearEmptyNode||!v.$inline[i.tagName]||v.$empty[i.tagName]||i.attrs&&!p.isEmptyObject(i.attrs))switch(i.tagName){case"style":case"script":i.setAttr({cdata_tag:i.tagName,cdata_data:i.innerHTML()||"",_ue_custom_node_:"true"}),i.tagName="div",i.innerHTML("");break;case"a":(n=i.getAttr("href"))&&i.setAttr("_href",n);break;case"img":if((n=i.getAttr("src"))&&/^data:/.test(n)){i.parentNode.removeChild(i);break}i.setAttr("_src",i.getAttr("src"));break;case"span":r.webkit&&(n=i.getStyle("white-space"))&&/nowrap|normal/.test(n)&&(i.setStyle("white-space",""),a.options.autoClearEmptyNode&&p.isEmptyObject(i.attrs)&&i.parentNode.removeChild(i,!0)),(n=i.getAttr("id"))&&/^_baidu_bookmark_/i.test(n)&&i.parentNode.removeChild(i);break;case"p":(n=i.getAttr("align"))&&(i.setAttr("align"),i.setStyle("text-align",n)),p.each(i.children,function(e){if("element"==e.type&&"p"==e.tagName){var t=e.nextSibling();for(i.parentNode.insertAfter(e,i);t;){var n=t.nextSibling();i.parentNode.insertAfter(t,e),e=t,t=n}return!1}}),i.firstChild()||i.innerHTML(r.ie?"&nbsp;":"<br/>");break;case"div":if(i.getAttr("cdata_tag"))break;if((n=i.getAttr("class"))&&/^line number\d+/.test(n))break;if(!o)break;for(var e,t=UE.uNode.createElement("p");e=i.firstChild();)"text"!=e.type&&UE.dom.dtd.$block[e.tagName]?t.firstChild()?(i.parentNode.insertBefore(t,i),t=UE.uNode.createElement("p")):i.parentNode.insertBefore(e,i):t.appendChild(e);t.firstChild()&&i.parentNode.insertBefore(t,i),i.parentNode.removeChild(i);break;case"dl":i.tagName="ul";break;case"dt":case"dd":i.tagName="li";break;case"li":(e=i.getAttr("class"))&&/list\-/.test(e)||i.setAttr(),e=i.getNodesByTagName("ol ul"),UE.utils.each(e,function(e){i.parentNode.insertAfter(e,i)});break;case"td":case"th":case"caption":i.children&&i.children.length||i.appendChild(r.ie11below?UE.uNode.createText(" "):UE.uNode.createElement("br"));break;case"table":a.options.disabledTableInTable&&function(e){for(;e&&"element"==e.type;){if("td"==e.tagName)return 1;e=e.parentNode}}(i)&&(i.parentNode.insertBefore(UE.uNode.createText(i.innerText()),i),i.parentNode.removeChild(i))}else i.firstChild()?"span"!=i.tagName||i.attrs&&!p.isEmptyObject(i.attrs)||i.parentNode.removeChild(i,!0):i.parentNode.removeChild(i)})}),a.addOutputRule(function(e){var t;e.traversal(function(e){if("element"==e.type)if(!a.options.autoClearEmptyNode||!v.$inline[e.tagName]||v.$empty[e.tagName]||e.attrs&&!p.isEmptyObject(e.attrs))switch(e.tagName){case"div":(t=e.getAttr("cdata_tag"))&&(e.tagName=t,e.appendChild(UE.uNode.createText(e.getAttr("cdata_data"))),e.setAttr({cdata_tag:"",cdata_data:"",_ue_custom_node_:""}));break;case"a":(t=e.getAttr("_href"))&&e.setAttr({href:p.html(t),_href:""});break;case"span":(t=e.getAttr("id"))&&/^_baidu_bookmark_/i.test(t)&&e.parentNode.removeChild(e);break;case"img":(t=e.getAttr("_src"))&&e.setAttr({src:e.getAttr("_src"),_src:""})}else e.firstChild()?"span"!=e.tagName||e.attrs&&!p.isEmptyObject(e.attrs)||e.parentNode.removeChild(e,!0):e.parentNode.removeChild(e)})})},UE.commands.inserthtml={execCommand:function(e,t,n){var i=this;if(t&&!0!==i.fireEvent("beforeinserthtml",t)){var o,a=i.selection.getRange();if(e=a.document.createElement("div"),e.style.display="inline",n||(n=UE.htmlparser(t),i.options.filterRules&&UE.filterNode(n,i.options.filterRules),i.filterInputRule(n),t=n.toHtml()),e.innerHTML=p.trim(t),!a.collapsed&&(n=a.startContainer,f.isFillChar(n)&&a.setStartBefore(n),n=a.endContainer,f.isFillChar(n)&&a.setEndAfter(n),a.txtToElmBoundary(),a.endContainer&&1==a.endContainer.nodeType&&(n=a.endContainer.childNodes[a.endOffset])&&f.isBr(n)&&a.setEndAfter(n),0==a.startOffset&&(n=a.startContainer,f.isBoundaryNode(n,"firstChild")&&(n=a.endContainer,a.endOffset==(3==n.nodeType?n.nodeValue:n.childNodes).length&&f.isBoundaryNode(n,"lastChild")&&(i.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"</p>",a.setStart(i.body.firstChild,0).collapse(!0)))),a.collapsed||a.deleteContents(),1==a.startContainer.nodeType))if((n=a.startContainer.childNodes[a.startOffset])&&f.isBlockElm(n)&&(o=n.previousSibling)&&f.isBlockElm(o)){for(a.setEnd(o,o.childNodes.length).collapse();n.firstChild;)o.appendChild(n.firstChild);f.remove(n)}var s,l,d,c=0;a.inFillChar()&&(n=a.startContainer,f.isFillChar(n)?(a.setStartBefore(n).collapse(!0),f.remove(n)):f.isFillChar(n,!0)&&(n.nodeValue=n.nodeValue.replace(P,""),a.startOffset--,a.collapsed&&a.collapse(!0)));var u,m=f.findParentByTagName(a.startContainer,"li",!0);if(m){for(;n=e.firstChild;){for(;n&&(3==n.nodeType||!f.isBlockElm(n)||"HR"==n.tagName);)u=n.nextSibling,a.insertNode(n).collapse(),s=n,n=u;if(n)if(/^(ol|ul)$/i.test(n.tagName)){for(;n.firstChild;)s=n.firstChild,f.insertAfter(m,n.firstChild),m=m.nextSibling;f.remove(n)}else u=n.nextSibling,o=i.document.createElement("li"),f.insertAfter(m,o),o.appendChild(n),s=n,n=u,m=o}m=f.findParentByTagName(a.startContainer,"li",!0),f.isEmptyBlock(m)&&f.remove(m),s&&a.setStartAfter(s).collapse(!0).select(!0)}else{for(;n=e.firstChild;){if(c){for(s=i.document.createElement("p");n&&(3==n.nodeType||!v.$block[n.tagName]);)d=n.nextSibling,s.appendChild(n),n=d;s.firstChild&&(n=s)}if(a.insertNode(n),d=n.nextSibling,!c&&n.nodeType==f.NODE_ELEMENT&&f.isBlockElm(n)&&(s=f.findParent(n,function(e){return f.isBlockElm(e)}))&&"body"!=s.tagName.toLowerCase()&&(!v[s.tagName][n.nodeName]||n.parentNode!==s)){if(v[s.tagName][n.nodeName])for(l=n.parentNode;l!==s;)l=(o=l).parentNode;else o=s;f.breakParent(n,o||l),o=n.previousSibling,f.trimWhiteTextNode(o),o.childNodes.length||f.remove(o),!r.ie&&(u=n.nextSibling)&&f.isBlockElm(u)&&u.lastChild&&!f.isBr(u.lastChild)&&u.appendChild(i.document.createElement("br")),c=1}if(u=n.nextSibling,!e.firstChild&&u&&f.isBlockElm(u)){a.setStart(u,0).collapse(!0);break}a.setEndAfter(n).collapse()}if(n=a.startContainer,d&&f.isBr(d)&&f.remove(d),f.isBlockElm(n)&&f.isEmptyNode(n))if(d=n.nextSibling)f.remove(n),1==d.nodeType&&v.$block[d.tagName]&&a.setStart(d,0).collapse(!0).shrinkBoundary();else try{n.innerHTML=r.ie?f.fillChar:"<br/>"}catch(e){a.setStartBefore(n),f.remove(n)}try{a.select(!0)}catch(e){}}setTimeout(function(){(a=i.selection.getRange()).scrollToView(i.autoHeightEnabled,i.autoHeightEnabled?f.getXY(i.iframe).y:0),i.fireEvent("afterinserthtml",t)},200)}}},UE.plugins.autotypeset=function(){function c(e,t){return e&&3!=e.nodeType&&(f.isBr(e)||e&&e.parentNode&&i[e.tagName.toLowerCase()]&&(!(m&&m.contains(e)||e.getAttribute("pagebreak"))&&(t?!f.isEmptyBlock(e):f.isEmptyBlock(e,RegExp("[\\s"+f.fillChar+"]","g")))))}function u(e){e.style.cssText||(f.removeAttributes(e,["style"]),"span"==e.tagName.toLowerCase()&&f.hasNoAttributes(e)&&f.remove(e,!0))}function e(e,t){var n;if(t){if(!h.pasteFilter)return;(n=this.document.createElement("div")).innerHTML=t.html}else n=this.document.body;for(var i,o=f.getElementsByTagName(n,"*"),r=0;i=o[r++];)if(!0!==this.fireEvent("excludeNodeinautotype",i)){if(h.clearFontSize&&i.style.fontSize&&(f.removeStyle(i,"font-size"),u(i)),h.clearFontFamily&&i.style.fontFamily&&(f.removeStyle(i,"font-family"),u(i)),c(i)){if(h.mergeEmptyline)for(var a,s=i.nextSibling,l=f.isBr(i);c(s)&&(s=(a=s).nextSibling,!l||s&&(!s||f.isBr(s)));)f.remove(a);if(h.removeEmptyline&&f.inDoc(i,n)&&!b[i.parentNode.tagName.toLowerCase()]){if(f.isBr(i)&&(s=i.nextSibling)&&!f.isBr(s))continue;f.remove(i);continue}}if(c(i,!0)&&"SPAN"!=i.tagName&&(h.indent&&(i.style.textIndent=h.indentValue),h.textAlign&&(i.style.textAlign=h.textAlign)),h.removeClass&&i.className&&!g[i.className.toLowerCase()]){if(m&&m.contains(i))continue;f.removeAttributes(i,["class"])}if(h.imageBlockLine&&"img"==i.tagName.toLowerCase()&&!i.getAttribute("emotion"))if(t)switch(l=i,h.imageBlockLine){case"left":case"right":case"none":for(var d,s=l.parentNode;v.$inline[s.tagName]||"A"==s.tagName;)s=s.parentNode;if("P"==(a=s).tagName&&"center"==f.getStyle(a,"text-align")&&!f.isBody(a)&&1==f.getChildCount(a,function(e){return!f.isBr(e)&&!f.isWhitespace(e)}))if(d=a.previousSibling,s=a.nextSibling,d&&s&&1==d.nodeType&&1==s.nodeType&&d.tagName==s.tagName&&f.isBlockElm(d)){for(d.appendChild(a.firstChild);s.firstChild;)d.appendChild(s.firstChild);f.remove(a),f.remove(s)}else f.setStyle(a,"text-align","");f.setStyle(l,"float",h.imageBlockLine);break;case"center":if("center"!=this.queryCommandValue("imagefloat")){for(s=l.parentNode,f.setStyle(l,"float","none"),a=l;s&&1==f.getChildCount(s,function(e){return!f.isBr(e)&&!f.isWhitespace(e)})&&(v.$inline[s.tagName]||"A"==s.tagName);)s=(a=s).parentNode;s=this.document.createElement("p"),f.setAttributes(s,{style:"text-align:center"}),a.parentNode.insertBefore(s,a),s.appendChild(a),f.setStyle(a,"float","")}}else this.selection.getRange().selectNode(i).select(),this.execCommand("imagefloat",h.imageBlockLine);h.removeEmptyNode&&h.removeTagNames[i.tagName.toLowerCase()]&&f.hasNoAttributes(i)&&f.isEmptyBlock(i)&&f.remove(i)}h.tobdc&&((o=UE.htmlparser(n.innerHTML)).traversal(function(e){if("text"==e.type){for(var t=e.data,t=p.html(t),n="",i=0;i<t.length;i++)n=32==t.charCodeAt(i)?n+String.fromCharCode(12288):t.charCodeAt(i)<127?n+String.fromCharCode(t.charCodeAt(i)+65248):n+t.charAt(i);e.data=n}}),n.innerHTML=o.toHtml()),h.bdc2sb&&((o=UE.htmlparser(n.innerHTML)).traversal(function(e){if("text"==e.type){for(var t=e.data,n="",i=0;i<t.length;i++)var o=t.charCodeAt(i),n=65281<=o&&o<=65373?n+String.fromCharCode(t.charCodeAt(i)-65248):12288==o?n+String.fromCharCode(t.charCodeAt(i)-12288+32):n+t.charAt(i);e.data=n}}),n.innerHTML=o.toHtml()),t&&(t.html=n.innerHTML)}this.setOpt({autotypeset:{mergeEmptyline:!0,removeClass:!0,removeEmptyline:!1,textAlign:"left",imageBlockLine:"center",pasteFilter:!1,clearFontSize:!1,clearFontFamily:!1,removeEmptyNode:!1,removeTagNames:p.extend({div:1},v.$removeEmpty),indent:!1,indentValue:"2em",bdc2sb:!1,tobdc:!1}});var m,t,n=this,h=n.options.autotypeset,g={selectTdClass:1,pagebreak:1,anchorclass:1},b={li:1},i={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1};h&&(t=n.getPreferences("autotypeset"),p.extend(n.options.autotypeset,t),h.pasteFilter&&n.addListener("beforepaste",e),n.commands.autotypeset={execCommand:function(){n.removeListener("beforepaste",e),h.pasteFilter&&n.addListener("beforepaste",e),e.call(n)}})},UE.plugin.register("autosubmit",function(){return{shortcutkey:{autosubmit:"ctrl+13"},commands:{autosubmit:{execCommand:function(){var e=f.findParentByTagName(this.iframe,"form",!1);e&&!1!==this.fireEvent("beforesubmit")&&(this.sync(),e.submit())}}}}}),UE.plugin.register("background",function(){function n(e){var i={};return e=e.split(";"),p.each(e,function(e){var t=e.indexOf(":"),n=p.trim(e.substr(0,t)).toLowerCase();n&&(i[n]=p.trim(e.substr(t+1)||""))}),i}function i(e){if(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t+":"+e[t]+"; ");p.cssRule(a,n.length?"body{"+n.join("")+"}":"",s.document)}else p.cssRule(a,"",s.document)}var o,s=this,a="editor_background",l=/body[\s]*\{(.+)\}/i,e=s.hasContents;return s.hasContents=function(){return!!s.queryCommandValue("background")||e.apply(s,arguments)},{bindEvents:{getAllHtml:function(e,t){var n,i=this.body,o=0<(a=f.getComputedStyle(i,"background-image")).indexOf(s.options.imagePath)?a.substring(a.indexOf(s.options.imagePath),a.length-1).replace(/"|\(|\)/gi,""):"none"!=a?a.replace(/url\("?|"?\)/gi,""):"",a='<style type="text/css">body{';for(n in i={"background-color":f.getComputedStyle(i,"background-color")||"#ffffff","background-image":o?"url("+o+")":"","background-repeat":f.getComputedStyle(i,"background-repeat")||"","background-position":r.ie?f.getComputedStyle(i,"background-position-x")+" "+f.getComputedStyle(i,"background-position-y"):f.getComputedStyle(i,"background-position"),height:f.getComputedStyle(i,"height")})i.hasOwnProperty(n)&&(a+=n+":"+i[n]+"; ");t.push(a+"}</style> ")},aftersetcontent:function(){0==o&&i()}},inputRule:function(e){o=!1,p.each(e.getNodesByTagName("p"),function(e){var t=e.getAttr("data-background");t&&(o=!0,i(n(t)),e.parentNode.removeChild(e))})},outputRule:function(e){var t=(p.cssRule(a,this.document)||"").replace(/[\n\r]+/g,"").match(l);t&&e.appendChild(UE.uNode.createElement('<p style="display:none;" data-background="'+p.trim(t[1].replace(/"/g,"").replace(/[\s]+/g," "))+'"><br/></p>'))},commands:{background:{execCommand:function(e,t){i(t)},queryCommandValue:function(){var e=(p.cssRule(a,this.document)||"").replace(/[\n\r]+/g,"").match(l);return e?n(e[1]):null},notNeedUndo:!0}}}}),UE.commands.imagefloat={execCommand:function(e,t){var n=this.selection.getRange();if(!n.collapsed){var i=n.getClosedNode();if(i&&"IMG"==i.tagName)switch(t){case"left":case"right":case"none":for(var o,r,a=i.parentNode;v.$inline[a.tagName]||"A"==a.tagName;)a=a.parentNode;if("P"==(o=a).tagName&&"center"==f.getStyle(o,"text-align")){if(!f.isBody(o)&&1==f.getChildCount(o,function(e){return!f.isBr(e)&&!f.isWhitespace(e)}))if(a=o.previousSibling,r=o.nextSibling,a&&r&&1==a.nodeType&&1==r.nodeType&&a.tagName==r.tagName&&f.isBlockElm(a)){for(a.appendChild(o.firstChild);r.firstChild;)a.appendChild(r.firstChild);f.remove(o),f.remove(r)}else f.setStyle(o,"text-align","");n.selectNode(i).select()}f.setStyle(i,"float","none"==t?"":t),"none"==t&&f.removeAttributes(i,"align");break;case"center":if("center"!=this.queryCommandValue("imagefloat")){for(a=i.parentNode,f.setStyle(i,"float",""),f.removeAttributes(i,"align"),o=i;a&&1==f.getChildCount(a,function(e){return!f.isBr(e)&&!f.isWhitespace(e)})&&(v.$inline[a.tagName]||"A"==a.tagName);)a=(o=a).parentNode;n.setStartBefore(o).setCursor(!1),(a=this.document.createElement("div")).appendChild(o),f.setStyle(o,"float",""),this.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+a.innerHTML+"</p>"),(o=this.document.getElementById("_img_parent_tmp")).removeAttribute("id"),o=o.firstChild,n.selectNode(o).select(),(r=o.parentNode.nextSibling)&&f.isEmptyNode(r)&&f.remove(r)}}}},queryCommandValue:function(){var e,t=this.selection.getRange();return!t.collapsed&&(t=t.getClosedNode())&&1==t.nodeType&&"IMG"==t.tagName?("none"==(e=f.getComputedStyle(t,"float")||t.getAttribute("align"))&&(e="center"==f.getComputedStyle(t.parentNode,"text-align")?"center":e),{left:1,right:1,center:1}[e]?e:"none"):"none"},queryCommandState:function(){var e=this.selection.getRange();return!e.collapsed&&(e=e.getClosedNode())&&1==e.nodeType&&"IMG"==e.tagName?0:-1}},UE.commands.insertimage={execCommand:function(e,t){if((t=p.isArray(t)?t:[t]).length){var n=(i=this.selection.getRange()).getClosedNode();if(!0!==this.fireEvent("beforeinsertimage",t)){if(!n||!/img/i.test(n.tagName)||"edui-faked-video"==n.className&&-1==n.className.indexOf("edui-upload-video")||n.getAttribute("word_img")){var i=[],n="",o=t[0];if(1==t.length)n='<img src="'+o.src+'" '+(o._src?' _src="'+o._src+'" ':"")+(o.width?'width="'+o.width+'" ':"")+(o.height?' height="'+o.height+'" ':"")+("left"==o.floatStyle||"right"==o.floatStyle?' style="float:'+o.floatStyle+';"':"")+(o.title&&""!=o.title?' title="'+o.title+'"':"")+(o.border&&"0"!=o.border?' border="'+o.border+'"':"")+(o.alt&&""!=o.alt?' alt="'+o.alt+'"':"")+(o.hspace&&"0"!=o.hspace?' hspace = "'+o.hspace+'"':"")+(o.vspace&&"0"!=o.vspace?' vspace = "'+o.vspace+'"':"")+"/>","center"==o.floatStyle&&(n='<p style="text-align: center">'+n+"</p>"),i.push(n);else for(var r=0;o=t[r++];)n="<p "+("center"==o.floatStyle?'style="text-align: center" ':"")+'><img src="'+o.src+'" '+(o.width?'width="'+o.width+'" ':"")+(o._src?' _src="'+o._src+'" ':"")+(o.height?' height="'+o.height+'" ':"")+' style="'+(o.floatStyle&&"center"!=o.floatStyle?"float:"+o.floatStyle+";":"")+(o.border||"")+'" '+(o.title?' title="'+o.title+'"':"")+" /></p>",i.push(n);this.execCommand("insertHtml",i.join(""))}else r=(o=t.shift()).floatStyle,delete o.floatStyle,f.setAttributes(n,o),this.execCommand("imagefloat",r),0<t.length&&(i.setStartAfter(n).setCursor(!1,!0),this.execCommand("insertimage",t));this.fireEvent("afterinsertimage",t)}}}},UE.plugins.justify=function(){function o(e,t){function n(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase()&&!f.isBookmarkNode(e):!f.isWhitespace(e)}var i=e.createBookmark();e.enlarge(!0);for(var o,r,a=e.createBookmark(),s=f.getNextDomNode(a.start,!1,n),l=e.cloneRange();s&&!(f.getPosition(s,a.end)&f.POSITION_FOLLOWING);)if(3!=s.nodeType&&d(s))s=f.getNextDomNode(s,!0,n);else{for(l.setStartBefore(s);s&&s!==a.end&&!d(s);)o=s,s=f.getNextDomNode(s,!1,null,function(e){return!d(e)});l.setEndAfter(o),s=l.getCommonAncestor(),!f.isBody(s)&&d(s)?f.setStyles(s,p.isString(t)?{"text-align":t}:t):(s=e.document.createElement("p"),f.setStyles(s,p.isString(t)?{"text-align":t}:t),r=l.extractContents(),s.appendChild(r),l.insertNode(s)),s=f.getNextDomNode(s,!1,n)}return e.moveToBookmark(a).moveToBookmark(i)}var d=f.isBlockElm,t={left:1,right:1,center:1,justify:1};UE.commands.justify={execCommand:function(e,t){var n,i=this.selection.getRange();return i.collapsed&&(n=this.document.createTextNode("p"),i.insertNode(n)),o(i,t),n&&(i.setStartBefore(n).collapse(!0),f.remove(n)),i.select(),!0},queryCommandValue:function(){var e=this.selection.getStart(),e=f.getComputedStyle(e,"text-align");return t[e]?e:"left"},queryCommandState:function(){var e=this.selection.getStart();return e&&f.findParentByTagName(e,["td","th","caption"],!0)?-1:0}}},UE.plugins.font=function(){function d(e,n,i){var t,o,a,s=e.collapsed,l=e.createBookmark();if(s)for(s=l.start.parentNode;v.$inline[s.tagName];)s=s.parentNode;else s=f.getCommonAncestor(l.start,l.end);p.each(f.getElementsByTagName(s,"span"),function(e){if(e.parentNode&&!f.isBookmarkNode(e))if(/\s*border\s*:\s*none;?\s*/i.test(e.style.cssText))/^\s*border\s*:\s*none;?\s*$/.test(e.style.cssText)?f.remove(e,!0):f.removeStyle(e,"border");else{if(/border/i.test(e.style.cssText)&&"SPAN"==e.parentNode.tagName&&/border/i.test(e.parentNode.style.cssText)&&(e.style.cssText=e.style.cssText.replace(/border[^:]*:[^;]+;?/gi,"")),"fontborder"!=n||"none"!=i)for(var t=e.nextSibling;t&&1==t.nodeType&&"SPAN"==t.tagName;){if(f.isBookmarkNode(t)&&"fontborder"==n)e.appendChild(t);else if(t.style.cssText==e.style.cssText&&(f.moveChild(t,e),f.remove(t)),e.nextSibling===t)break;t=e.nextSibling}!function(e){for(var t;(t=e.parentNode)&&("SPAN"==t.tagName&&1==f.getChildCount(t,function(e){return!f.isBookmarkNode(e)&&!f.isBr(e)}));)t.style.cssText+=e.style.cssText,f.remove(e,!0),e=t}(e),r.ie&&8<r.version&&(t=f.findParent(e,function(e){return"SPAN"==e.tagName&&/background-color/.test(e.style.cssText)}))&&!/background-color/.test(e.style.cssText)&&(e.style.backgroundColor=t.style.backgroundColor)}}),e.moveToBookmark(l),t=e,a=i,!u[o=n]||(t.adjustmentBoundary(),t.collapsed||1!=t.startContainer.nodeType)||(l=t.startContainer.childNodes[t.startOffset])&&f.isTagNode(l,"span")&&(e=t.createBookmark(),p.each(f.getElementsByTagName(l,"span"),function(e){!e.parentNode||f.isBookmarkNode(e)||"backcolor"==o&&f.getComputedStyle(e,"background-color").toLowerCase()===a||(f.removeStyle(e,u[o]),0==e.style.cssText.replace(/^\s+$/,"").length&&f.remove(e,!0))}),t.moveToBookmark(e))}var e,t={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},c={underline:1,strikethrough:1,fontborder:1},u={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"};for(e in this.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]}),this.addInputRule(function(e){p.each(e.getNodesByTagName("u s del font strike"),function(e){if("font"==e.tagName){var t,n=[];for(t in e.attrs)switch(t){case"size":n.push("font-size:"+({1:"10",2:"12",3:"16",4:"18",5:"24",6:"32",7:"48"}[e.attrs[t]]||e.attrs[t])+"px");break;case"color":n.push("color:"+e.attrs[t]);break;case"face":n.push("font-family:"+e.attrs[t]);break;case"style":n.push(e.attrs[t])}e.attrs={style:n.join(";")}}else n="u"==e.tagName?"underline":"line-through",e.attrs={style:(e.getAttr("style")||"")+"text-decoration:"+n+";"};e.tagName="span"})}),t)!function(s,l){UE.commands[s]={execCommand:function(e,t){t=t||(this.queryCommandState(e)?"none":"underline"==e?"underline":"fontborder"==e?"1px solid #000":"line-through");var n=this.selection.getRange();if("default"==t)n.collapsed&&(o=this.document.createTextNode("font"),n.insertNode(o).select()),this.execCommand("removeFormat","span,a",l),o&&(n.setStartBefore(o).collapse(!0),f.remove(o)),d(n,e,t),n.select();else if(n.collapsed){var i=f.findParentByTagName(n.startContainer,"span",!0),o=this.document.createTextNode("font");if(!i||i.children.length||i[r.ie?"innerText":"textContent"].replace(P,"").length){if(n.insertNode(o),n.selectNode(o).select(),i=n.document.createElement("span"),c[s]){if(f.findParentByTagName(o,"a",!0))return n.setStartBefore(o).setCursor(),void f.remove(o);this.execCommand("removeFormat","span,a",l)}if(i.style.cssText=l+":"+t,o.parentNode.insertBefore(i,o),!r.ie||r.ie&&9==r.version)for(var a=i.parentNode;!f.isBlockElm(a);)"SPAN"==a.tagName&&(i.style.cssText=a.style.cssText+";"+i.style.cssText),a=a.parentNode;ma?setTimeout(function(){n.setStart(i,0).collapse(!0),d(n,e,t),n.select()}):(n.setStart(i,0).collapse(!0),d(n,e,t),n.select())}else n.insertNode(o),c[s]&&(n.selectNode(o).select(),this.execCommand("removeFormat","span,a",l,null),i=f.findParentByTagName(o,"span",!0),n.setStartBefore(o)),i&&(i.style.cssText+=";"+l+":"+t),n.collapse(!0).select();f.remove(o)}else c[s]&&this.queryCommandValue(s)&&this.execCommand("removeFormat","span,a",l),(n=this.selection.getRange()).applyInlineStyle("span",{style:l+":"+t}),d(n,e,t),n.select();return!0},queryCommandValue:function(e){var t=this.selection.getStart();if("underline"==e||"strikethrough"==e){for(var n=t;n&&!f.isBlockElm(n)&&!f.isBody(n);){if(1==n.nodeType&&"none"!=(e=f.getComputedStyle(n,l)))return e;n=n.parentNode}return"none"}if("fontborder"!=e)return"FontSize"==e?(n=f.getComputedStyle(t,l),(e=/^([\d\.]+)(\w+)$/.exec(n))?Math.floor(e[1])+e[2]:n):f.getComputedStyle(t,l);for(e=t;e&&v.$inline[e.tagName];){if((n=f.getComputedStyle(e,"border"))&&/1px/.test(n)&&/solid/.test(n))return n;e=e.parentNode}return""},queryCommandState:function(e){if(!c[e])return 0;var t=this.queryCommandValue(e);return"fontborder"==e?/1px/.test(t)&&/solid/.test(t):("underline"==e?/underline/:/line\-through/).test(t)}}}(e,t[e])},UE.plugins.link=function(){function d(e){var t=e.startContainer,n=e.endContainer;(t=f.findParentByTagName(t,"a",!0))&&e.setStartBefore(t),(n=f.findParentByTagName(n,"a",!0))&&e.setEndAfter(n)}UE.commands.unlink={execCommand:function(){var e,t=this.selection.getRange();t.collapsed&&!f.findParentByTagName(t.startContainer,"a",!0)||(e=t.createBookmark(),d(t),t.removeInlineStyle("a").moveToBookmark(e).select())},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}},UE.commands.link={execCommand:function(e,t){var n;t._href&&(t._href=p.unhtml(t._href,/[<">]/g)),t.href&&(t.href=p.unhtml(t.href,/[<">]/g)),t.textValue&&(t.textValue=p.unhtml(t.textValue,/[<">]/g));var i=n=this.selection.getRange(),o=i.cloneRange(),a=this.queryCommandValue("link");d(i=i.adjustmentBoundary());var s,l=i.startContainer;1==l.nodeType&&a&&(l=l.childNodes[i.startOffset])&&1==l.nodeType&&"A"==l.tagName&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(l[r.ie?"innerText":"textContent"])&&(l[r.ie?"innerText":"textContent"]=p.html(t.textValue||t.href)),o.collapsed&&!a||(i.removeInlineStyle("a"),o=i.cloneRange()),o.collapsed?(a=i.document.createElement("a"),s="",t.textValue?(s=p.html(t.textValue),delete t.textValue):s=p.html(t.href),f.setAttributes(a,t),(l=f.findParentByTagName(o.startContainer,"a",!0))&&f.isInNodeEndBoundary(o,l)&&i.setStartAfter(l).collapse(!0),a[r.ie?"innerText":"textContent"]=s,i.insertNode(a).selectNode(a)):i.applyInlineStyle("a",t),n.collapse().select(!0)},queryCommandValue:function(){if(!(i=this.selection.getRange()).collapsed){i.shrinkBoundary();var e,t=3!=i.startContainer.nodeType&&i.startContainer.childNodes[i.startOffset]?i.startContainer.childNodes[i.startOffset]:i.startContainer,n=3==i.endContainer.nodeType||0==i.endOffset?i.endContainer:i.endContainer.childNodes[i.endOffset-1],i=i.getCommonAncestor();if(!(e=f.findParentByTagName(i,"a",!0))&&1==i.nodeType)for(var o,r,a,i=i.getElementsByTagName("a"),s=0;a=i[s++];)if(o=f.getPosition(a,t),r=f.getPosition(a,n),(o&f.POSITION_FOLLOWING||o&f.POSITION_CONTAINS)&&(r&f.POSITION_PRECEDING||r&f.POSITION_CONTAINS)){e=a;break}return e}if((e=1==(e=i.startContainer).nodeType?e:e.parentNode)&&(e=f.findParentByTagName(e,"a",!0))&&!f.isInNodeEndBoundary(i,e))return e},queryCommandState:function(){var e=this.selection.getRange().getClosedNode();return!e||"edui-faked-video"!=e.className&&-1==e.className.indexOf("edui-upload-video")?0:-1}}},UE.plugins.insertframe=function(){var e=this;e.addListener("selectionchange",function(){e._iframe&&delete e._iframe})},UE.commands.scrawl={queryCommandState:function(){return r.ie&&r.version<=8?-1:0}},UE.plugins.removeformat=function(){this.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"}),this.commands.removeformat={execCommand:function(e,t,o,n,a){function s(e){if(3!=e.nodeType&&"span"==e.tagName.toLowerCase()){if(r.ie){var t=e.attributes;if(t.length){e=0;for(var n=t.length;e<n;e++)if(t[e].specified)return;return 1}}return!e.attributes.length}}var l=RegExp("^(?:"+(t||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),d=o?[]:(n||this.options.removeFormatAttributes).split(",");e=new L.Range(this.document);function c(e){return 1==e.nodeType}var u,m;(function(e){var t=e.createBookmark();for(e.collapsed&&e.enlarge(!0),a||((i=f.findParentByTagName(e.startContainer,"a",!0))&&e.setStartBefore(i),(i=f.findParentByTagName(e.endContainer,"a",!0))&&e.setEndAfter(i)),i=(u=e.createBookmark()).start;(m=i.parentNode)&&!f.isBlockElm(m);)f.breakParent(i,m),f.clearEmptySibling(i);if(u.end){for(i=u.end;(m=i.parentNode)&&!f.isBlockElm(m);)f.breakParent(i,m),f.clearEmptySibling(i);for(var n,i=f.getNextDomNode(u.start,!1,c);i&&i!=u.end;)n=f.getNextDomNode(i,!0,c),v.$empty[i.tagName.toLowerCase()]||f.isBookmarkNode(i)||(l.test(i.tagName)?o?(f.removeStyle(i,o),s(i)&&"text-decoration"!=o&&f.remove(i,!0)):f.remove(i,!0):v.$tableContent[i.tagName]||v.$list[i.tagName]||(f.removeAttributes(i,d),s(i)&&f.remove(i,!0))),i=n}for(i=u.start.parentNode,!f.isBlockElm(i)||v.$tableContent[i.tagName]||v.$list[i.tagName]||f.removeAttributes(i,d),i=u.end.parentNode,u.end&&f.isBlockElm(i)&&!v.$tableContent[i.tagName]&&!v.$list[i.tagName]&&f.removeAttributes(i,d),e.moveToBookmark(u).moveToBookmark(t),i=e.startContainer,n=e.collapsed;1==i.nodeType&&f.isEmptyNode(i)&&v.$removeEmpty[i.tagName];)t=i.parentNode,e.setStartBefore(i),e.startContainer===e.endContainer&&e.endOffset--,f.remove(i),i=t;if(!n)for(i=e.endContainer;1==i.nodeType&&f.isEmptyNode(i)&&v.$removeEmpty[i.tagName];)t=i.parentNode,e.setEndBefore(i),f.remove(i),i=t})(e=this.selection.getRange()),e.select()}}},UE.plugins.blockquote=function(){this.commands.blockquote={execCommand:function(e,t){var n=this.selection.getRange(),i=f.filterNodeList(this.selection.getStartElementPath(),"blockquote"),o=v.blockquote,r=n.createBookmark();if(i){var o=n.startContainer,o=f.isBlockElm(o)?o:f.findParent(o,function(e){return f.isBlockElm(e)}),a=n.endContainer,a=f.isBlockElm(a)?a:f.findParent(a,function(e){return f.isBlockElm(e)}),o=f.findParentByTagName(o,"li",!0)||o,a=f.findParentByTagName(a,"li",!0)||a;"LI"==o.tagName||"TD"==o.tagName||o===i||f.isBody(o)?f.remove(i,!0):f.breakParent(o,i),o!==a&&(i=f.findParentByTagName(a,"blockquote"))&&("LI"==a.tagName||"TD"==a.tagName||f.isBody(a)?i.parentNode&&f.remove(i,!0):f.breakParent(a,i));for(var s,l=f.getElementsByTagName(this.document,"blockquote"),i=0;s=l[i++];)s.childNodes.length?f.getPosition(s,o)&f.POSITION_FOLLOWING&&f.getPosition(s,a)&f.POSITION_PRECEDING&&f.remove(s,!0):f.remove(s)}else{for(l=a=1==(i=n.cloneRange()).startContainer.nodeType?i.startContainer:i.startContainer.parentNode,s=1;;){if(f.isBody(a)){l!==a?n.collapsed?(i.selectNode(l),s=0):i.setStartBefore(l):i.setStart(a,0);break}if(!o[a.tagName]){n.collapsed?i.selectNode(l):i.setStartBefore(l);break}a=(l=a).parentNode}if(s)for(l=a=1==i.endContainer.nodeType?i.endContainer:i.endContainer.parentNode;;){if(f.isBody(a)){l!==a?i.setEndAfter(l):i.setEnd(a,a.childNodes.length);break}if(!o[a.tagName]){i.setEndAfter(l);break}a=(l=a).parentNode}for(a=n.document.createElement("blockquote"),f.setAttributes(a,t),a.appendChild(i.extractContents()),i.insertNode(a),o=f.getElementsByTagName(a,"blockquote"),i=0;a=o[i++];)a.parentNode&&f.remove(a,!0)}n.moveToBookmark(r).select()},queryCommandState:function(){return f.filterNodeList(this.selection.getStartElementPath(),"blockquote")?1:0}}},UE.commands.touppercase=UE.commands.tolowercase={execCommand:function(e){var t=this.selection.getRange();if(t.collapsed)return t;function n(e){return!f.isBr(e)&&!f.isWhitespace(e)}for(var i=t.createBookmark(),o=i.end,r=f.getNextDomNode(i.start,!1,n);r&&f.getPosition(r,o)&f.POSITION_PRECEDING&&(3==r.nodeType&&(r.nodeValue=r.nodeValue["touppercase"==e?"toUpperCase":"toLowerCase"]()),(r=f.getNextDomNode(r,!0,n))!==o););t.moveToBookmark(i).select()}},UE.commands.indent={execCommand:function(){var e=this.queryCommandState("indent")?"0em":this.options.indentValue||"2em";this.execCommand("Paragraph","p",{style:"text-indent:"+e})},queryCommandState:function(){var e=f.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e&&e.style.textIndent&&parseInt(e.style.textIndent)?1:0}},UE.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1},UE.commands.preview={execCommand:function(){var e=window.open("","_blank","").document;e.open(),e.write('<!DOCTYPE html><html><head><meta charset="utf-8"/><script src="'+this.options.UEDITOR_HOME_URL+"ueditor.parse.js\"><\/script><script>setTimeout(function(){uParse('div',{rootPath: '"+this.options.UEDITOR_HOME_URL+"'})},300)<\/script></head><body><div>"+this.getContent(null,null,!0)+"</div></body></html>"),e.close()},notNeedUndo:1},UE.plugins.selectall=function(){this.commands.selectall={execCommand:function(){var e=this.body,t=this.selection.getRange();t.selectNodeContents(e),f.isEmptyBlock(e)&&(r.opera&&e.firstChild&&1==e.firstChild.nodeType&&t.setStartAtFirst(e.firstChild),t.collapse(!0)),t.select(!0)},notNeedUndo:1},this.addshortcutkey({selectAll:"ctrl+65"})},UE.plugins.paragraph=function(){function s(e,t,n,i){function o(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase()&&!f.isBookmarkNode(e):!f.isWhitespace(e)}var r=e.createBookmark();e.enlarge(!0);for(var a,s=e.createBookmark(),l=f.getNextDomNode(s.start,!1,o),d=e.cloneRange();l&&!(f.getPosition(l,s.end)&f.POSITION_FOLLOWING);)if(3!=l.nodeType&&u(l))l=f.getNextDomNode(l,!0,o);else{for(d.setStartBefore(l);l&&l!==s.end&&!u(l);)a=l,l=f.getNextDomNode(l,!1,null,function(e){return!u(e)});d.setEndAfter(a),l=e.document.createElement(t),n&&(f.setAttributes(l,n),i&&"customstyle"==i&&n.style&&(l.style.cssText=n.style)),l.appendChild(d.extractContents()),f.isEmptyNode(l)&&f.fillChar(e.document,l),d.insertNode(l);var c=l.parentNode;u(c)&&!f.isBody(l.parentNode)&&-1==p.indexOf(m,c.tagName)&&(i&&"customstyle"==i||(c.getAttribute("dir")&&l.setAttribute("dir",c.getAttribute("dir")),c.style.cssText&&(l.style.cssText=c.style.cssText+";"+l.style.cssText),c.style.textAlign&&!l.style.textAlign&&(l.style.textAlign=c.style.textAlign),c.style.textIndent&&!l.style.textIndent&&(l.style.textIndent=c.style.textIndent),c.style.padding&&!l.style.padding&&(l.style.padding=c.style.padding)),n&&/h\d/i.test(c.tagName)&&!/h\d/i.test(l.tagName)?(f.setAttributes(c,n),i&&"customstyle"==i&&n.style&&(c.style.cssText=n.style),f.remove(l,!0),l=c):f.remove(l.parentNode,!0)),l=-1!=p.indexOf(m,c.tagName)?c:l,l=f.getNextDomNode(l,!1,o)}return e.moveToBookmark(s).moveToBookmark(r)}var u=f.isBlockElm,m=["TD","LI","PRE"];this.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""}),this.commands.paragraph={execCommand:function(e,t,n,i){var o,a;return(e=this.selection.getRange()).collapsed&&(o=this.document.createTextNode("p"),e.insertNode(o),r.ie&&((a=o.previousSibling)&&f.isWhitespace(a)&&f.remove(a),(a=o.nextSibling)&&f.isWhitespace(a)&&f.remove(a))),e=s(e,t,n,i),o&&(e.setStartBefore(o).collapse(!0),pN=o.parentNode,f.remove(o),f.isBlockElm(pN)&&f.isEmptyNode(pN)&&f.fillNode(this.document,pN)),r.gecko&&e.collapsed&&1==e.startContainer.nodeType&&(n=e.startContainer.childNodes[e.startOffset])&&1==n.nodeType&&n.tagName.toLowerCase()==t&&e.setStart(n,0).collapse(!0),e.select(),!0},queryCommandValue:function(){var e=f.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e?e.tagName.toLowerCase():""}}},Sy=f.isBlockElm,UE.commands.directionality={execCommand:function(e,t){var n,i=this.selection.getRange();return i.collapsed&&(n=this.document.createTextNode("d"),i.insertNode(n)),Uy(i,this,t),n&&(i.setStartBefore(n).collapse(!0),f.remove(n)),i.select(),!0},queryCommandValue:function(){var e=Ty(this);return e?e.getAttribute("dir"):"ltr"}},UE.plugins.horizontal=function(){this.commands.horizontal={execCommand:function(e){if(-1!==this.queryCommandState(e)){this.execCommand("insertHtml","<hr>");var t=(e=this.selection.getRange()).startContainer;return 1!=t.nodeType||t.childNodes[e.startOffset]||(t=t.childNodes[e.startOffset-1])&&1==t.nodeType&&"HR"==t.tagName&&("p"==this.options.enterTag?(t=this.document.createElement("p"),e.insertNode(t),e.setStart(t,0).setCursor()):(t=this.document.createElement("br"),e.insertNode(t),e.setStartBefore(t).setCursor())),!0}},queryCommandState:function(){return f.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}},this.addListener("delkeydown",function(e,t){var n=this.selection.getRange();if(n.txtToElmBoundary(!0),f.isStartInblock(n)){var i=n.startContainer.previousSibling;if(i&&f.isTagNode(i,"hr"))return f.remove(i),n.select(),f.preventDefault(t),!0}})},UE.commands.time=UE.commands.date={execCommand:function(e,t){var n,i,o,r,a,s,l,d,c,u=new Date;this.execCommand("insertHtml","time"==e?(l=t,d=("0"+(s=u).getHours()).slice(-2),c=("0"+s.getMinutes()).slice(-2),s=("0"+s.getSeconds()).slice(-2),(l||"hh:ii:ss").replace(/hh/gi,d).replace(/ii/gi,c).replace(/ss/gi,s)):(i=t,o=("000"+(n=u).getFullYear()).slice(-4),r=o.slice(-2),a=("0"+(n.getMonth()+1)).slice(-2),n=("0"+n.getDate()).slice(-2),(i||"yyyy-mm-dd").replace(/yyyy/gi,o).replace(/yy/gi,r).replace(/mm/gi,a).replace(/dd/gi,n)))}},UE.plugins.rowspacing=function(){this.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]}),this.commands.rowspacing={execCommand:function(e,t,n){return this.execCommand("paragraph","p",{style:"margin-"+n+":"+t+"px"}),!0},queryCommandValue:function(e,t){var n=f.filterNodeList(this.selection.getStartElementPath(),function(e){return f.isBlockElm(e)});return(n=n&&f.getComputedStyle(n,"margin-"+t).replace(/[^\d]/g,""))?n:0}}},UE.plugins.lineheight=function(){this.setOpt({lineheight:"1 1.5 1.75 2 3 4 5".split(" ")}),this.commands.lineheight={execCommand:function(e,t){return this.execCommand("paragraph","p",{style:"line-height:"+("1"==t?"normal":t+"em")}),!0},queryCommandValue:function(){var e=f.filterNodeList(this.selection.getStartElementPath(),function(e){return f.isBlockElm(e)});if(e)return"normal"==(e=f.getComputedStyle(e,"line-height"))?1:e.replace(/[^\d.]*/gi,"")}}},UE.plugins.insertcode=function(){var a=this;a.ready(function(){p.cssRule("pre","pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}",a.document)}),a.setOpt("insertcode",{as3:"ActionScript3",bash:"Bash/Shell",cpp:"C/C++",css:"Css",cf:"CodeFunction","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"Html",java:"Java",jfx:"JavaFx",js:"Javascript",pl:"Perl",php:"Php",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"}),a.commands.insertcode={execCommand:function(e,t){var n,i=this.selection.getRange(),o=f.findParentByTagName(i.startContainer,"pre",!0);o?o.className="brush:"+t+";toolbar:false;":(n="",i.collapsed?n=r.ie&&r.ie11below?r.version<=8?"&nbsp;":"":"<br/>":(o=i.extractContents(),(i=this.document.createElement("div")).appendChild(o),p.each(UE.filterNode(UE.htmlparser(i.innerHTML.replace(/[\r\t]/g,"")),this.options.filterTxtRules).children,function(t){r.ie&&r.ie11below&&8<r.version?("element"==t.type?"br"==t.tagName?n+="\n":v.$empty[t.tagName]||(p.each(t.children,function(e){"element"==e.type?"br"==e.tagName?n+="\n":v.$empty[t.tagName]||(n+=e.innerText()):n+=e.data}),/\n$/.test(n)||(n+="\n")):n+=t.data+"\n",!t.nextSibling()&&/\n$/.test(n)&&(n=n.replace(/\n$/,""))):r.ie&&r.ie11below?("element"==t.type?"br"==t.tagName?n+="<br>":v.$empty[t.tagName]||(p.each(t.children,function(e){"element"==e.type?"br"==e.tagName?n+="<br>":v.$empty[t.tagName]||(n+=e.innerText()):n+=e.data}),/br>$/.test(n)||(n+="<br>")):n+=t.data+"<br>",!t.nextSibling()&&/<br>$/.test(n)&&(n=n.replace(/<br>$/,""))):(n+="element"==t.type?v.$empty[t.tagName]?"":t.innerText():t.data,!/br\/?\s*>$/.test(n)&&t.nextSibling()&&(n+="<br>"))})),this.execCommand("inserthtml",'<pre id="coder"class="brush:'+t+';toolbar:false">'+n+"</pre>",!0),o=this.document.getElementById("coder"),f.removeAttributes(o,"id"),(i=o.previousSibling)&&(3==i.nodeType&&1==i.nodeValue.length&&r.ie&&6==r.version||f.isEmptyBlock(i))&&f.remove(i),i=this.selection.getRange(),f.isEmptyBlock(o)?i.setStart(o,0).setCursor(!1,!0):i.selectNodeContents(o).select())},queryCommandValue:function(){var e=this.selection.getStartElementPath(),t="";return p.each(e,function(e){if("PRE"==e.nodeName)return t=(e=e.className.match(/brush:([^;]+)/))&&e[1]?e[1]:"",!1}),t}},a.addInputRule(function(e){p.each(e.getNodesByTagName("pre"),function(t){var e=t.getNodesByTagName("br");e.length?r.ie&&r.ie11below&&8<r.version&&p.each(e,function(e){var t=UE.uNode.createText("\n");e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e)}):r.ie&&r.ie11below&&8<r.version||(e=t.innerText().split(/\n/),t.innerHTML(""),p.each(e,function(e){e.length&&t.appendChild(UE.uNode.createText(e)),t.appendChild(UE.uNode.createElement("br"))}))})}),a.addOutputRule(function(e){p.each(e.getNodesByTagName("pre"),function(e){var t="";p.each(e.children,function(e){t="text"==e.type?t+e.data.replace(/[ ]/g,"&nbsp;").replace(/\n$/,""):"br"==e.tagName?t+"\n":t+(v.$empty[e.tagName]?e.innerText():"")}),e.innerText(t.replace(/(&nbsp;|\n)+$/,""))})}),a.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,insertcode:1,inserthtml:1,selectall:1},a.queryCommandState=function(e){return!this.notNeedCodeQuery[e.toLowerCase()]&&this.selection&&this.queryCommandValue("insertcode")?-1:UE.Editor.prototype.queryCommandState.apply(this,arguments)},a.addListener("beforeenterkeydown",function(){var e,t=a.selection.getRange();if(i=f.findParentByTagName(t.startContainer,"pre",!0)){if(a.fireEvent("saveScene"),t.collapsed||t.deleteContents(),!r.ie||r.ie9above){i=a.document.createElement("br"),t.insertNode(i).setStartAfter(i).collapse(!0),i.nextSibling||r.ie&&!(10<r.version)?t.setStartAfter(i):t.insertNode(i.cloneNode(!1));for(var n,i=i.previousSibling;i;)if(!(i=(n=i).previousSibling)||"BR"==i.nodeName){i=n;break}if(i){for(n="";i&&"BR"!=i.nodeName&&RegExp("^[\\s"+f.fillChar+"]*$").test(i.nodeValue);)n+=i.nodeValue,i=i.nextSibling;"BR"!=i.nodeName&&(i=i.nodeValue.match(RegExp("^([\\s"+f.fillChar+"]+)")))&&i[1]&&(n+=i[1]),n&&(n=a.document.createTextNode(n),t.insertNode(n).setStartAfter(n))}t.collapse(!0).select(!0)}else if(8<r.version)i=a.document.createTextNode("\n"),n=t.startContainer,0==t.startOffset?n.previousSibling&&(t.insertNode(i),e=a.document.createTextNode(" "),t.setStartAfter(i).insertNode(e).setStart(e,0).collapse(!0).select(!0)):(t.insertNode(i).setStartAfter(i),e=a.document.createTextNode(" "),(n=t.startContainer.childNodes[t.startOffset])&&!/^\n/.test(n.nodeValue)&&t.setStartBefore(i),t.insertNode(e).setStart(e,0).collapse(!0).select(!0));else{for(i=a.document.createElement("br"),t.insertNode(i),t.insertNode(a.document.createTextNode(f.fillChar)),t.setStartAfter(i),i=i.previousSibling;i;)if(!(i=(n=i).previousSibling)||"BR"==i.nodeName){i=n;break}if(i){for(n="";i&&"BR"!=i.nodeName&&RegExp("^[ "+f.fillChar+"]*$").test(i.nodeValue);)n+=i.nodeValue,i=i.nextSibling;"BR"!=i.nodeName&&(i=i.nodeValue.match(RegExp("^([ "+f.fillChar+"]+)")))&&i[1]&&(n+=i[1]),n=a.document.createTextNode(n),t.insertNode(n).setStartAfter(n)}t.collapse(!0).select()}return a.fireEvent("saveScene"),!0}}),a.addListener("tabkeydown",function(e,t){var n=a.selection.getRange(),i=f.findParentByTagName(n.startContainer,"pre",!0);if(i){if(a.fireEvent("saveScene"),!t.shiftKey)if(n.collapsed)i=a.document.createTextNode("    "),n.insertNode(i).setStartAfter(i).collapse(!0).select(!0);else{for(var t=n.createBookmark(),o=t.start.previousSibling;o;){if(i.firstChild===o&&!f.isBr(o)){i.insertBefore(a.document.createTextNode("    "),o);break}if(f.isBr(o)){i.insertBefore(a.document.createTextNode("    "),o.nextSibling);break}o=o.previousSibling}var r=t.end,o=t.start.nextSibling;for(i.firstChild===t.start&&i.insertBefore(a.document.createTextNode("    "),o.nextSibling);o&&o!==r;){if(f.isBr(o)&&o.nextSibling){if(o.nextSibling===r)break;i.insertBefore(a.document.createTextNode("    "),o.nextSibling)}o=o.nextSibling}n.moveToBookmark(t).select()}return a.fireEvent("saveScene"),!0}}),a.addListener("beforeinserthtml",function(e,t){var n=this,i=n.selection.getRange();if(f.findParentByTagName(i.startContainer,"pre",!0)){i.collapsed||i.deleteContents();var o,a,s="";return r.ie&&8<r.version?(p.each(UE.filterNode(UE.htmlparser(t),n.options.filterTxtRules).children,function(t){"element"==t.type?"br"==t.tagName?s+="\n":v.$empty[t.tagName]||(p.each(t.children,function(e){"element"==e.type?"br"==e.tagName?s+="\n":v.$empty[t.tagName]||(s+=e.innerText()):s+=e.data}),/\n$/.test(s)||(s+="\n")):s+=t.data+"\n",!t.nextSibling()&&/\n$/.test(s)&&(s=s.replace(/\n$/,""))}),o=n.document.createTextNode(p.html(s.replace(/&nbsp;/g," "))),i.insertNode(o).selectNode(o).select()):(a=n.document.createDocumentFragment(),p.each(UE.filterNode(UE.htmlparser(t),n.options.filterTxtRules).children,function(t){"element"==t.type?"br"==t.tagName?a.appendChild(n.document.createElement("br")):v.$empty[t.tagName]||(p.each(t.children,function(e){"element"==e.type?"br"==e.tagName?a.appendChild(n.document.createElement("br")):v.$empty[t.tagName]||a.appendChild(n.document.createTextNode(p.html(e.innerText().replace(/&nbsp;/g," ")))):a.appendChild(n.document.createTextNode(p.html(e.data.replace(/&nbsp;/g," "))))}),"BR"!=a.lastChild.nodeName&&a.appendChild(n.document.createElement("br"))):a.appendChild(n.document.createTextNode(p.html(t.data.replace(/&nbsp;/g," ")))),t.nextSibling()||"BR"!=a.lastChild.nodeName||a.removeChild(a.lastChild)}),i.insertNode(a).select()),!0}}),a.addListener("keydown",function(e,t){if(40==(t.keyCode||t.which)){var n,i=this.selection.getRange(),o=i.startContainer;if(i.collapsed&&(n=f.findParentByTagName(i.startContainer,"pre",!0))&&!n.nextSibling){for(var r=n.lastChild;r&&"BR"==r.nodeName;)r=r.previousSibling;(r===o||i.startContainer===n&&i.startOffset==n.childNodes.length)&&(this.execCommand("insertparagraph"),f.preventDefault(t))}}}),a.addListener("delkeydown",function(e,t){var n=this.selection.getRange();n.txtToElmBoundary(!0);var i=n.startContainer;if(f.isTagNode(i,"pre")&&n.collapsed&&f.isStartInblock(n)){var o=a.document.createElement("p");return f.fillNode(a.document,o),i.parentNode.insertBefore(o,i),f.remove(i),n.setStart(o,0).setCursor(!1,!0),f.preventDefault(t),!0}})},UE.commands.cleardoc={execCommand:function(e){var t=this;e=t.options.enterTag;var n=t.selection.getRange();"br"==e?(t.body.innerHTML="<br/>",n.setStart(t.body,0).setCursor()):(t.body.innerHTML="<p>"+(I?"":"<br/>")+"</p>",n.setStart(t.body.firstChild,0).setCursor(!1,!0)),setTimeout(function(){t.fireEvent("clearDoc")},0)}},UE.plugin.register("anchor",function(){return{bindEvents:{ready:function(){p.cssRule("anchor",".anchorclass{background: url('"+this.options.themePath+this.options.theme+"/images/anchor.gif') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}",this.document)}},outputRule:function(e){p.each(e.getNodesByTagName("img"),function(e){var t;(t=e.getAttr("anchorname"))&&(e.tagName="a",e.setAttr({anchorname:"",name:t,class:""}))})},inputRule:function(e){p.each(e.getNodesByTagName("a"),function(e){e.getAttr("name")&&!e.getAttr("href")&&(e.tagName="img",e.setAttr({anchorname:e.getAttr("name"),class:"anchorclass"}),e.setAttr("name"))})},commands:{anchor:{execCommand:function(e,t){var n=this.selection.getRange(),i=n.getClosedNode();i&&i.getAttribute("anchorname")?t?i.setAttribute("anchorname",t):(n.setStartBefore(i).setCursor(),f.remove(i)):t&&(i=this.document.createElement("img"),n.collapse(!0),f.setAttributes(i,{anchorname:t,class:"anchorclass"}),n.insertNode(i).setStartAfter(i).setCursor(!1,!0))}}}}}),UE.plugins.wordcount=function(){var n,e=this;e.setOpt("wordCount",!0),e.addListener("contentchange",function(){e.fireEvent("wordcount")}),e.addListener("ready",function(){var t=this;f.on(t.body,"keyup",function(e){(e.keyCode||e.which)in{16:1,18:1,20:1,37:1,38:1,39:1,40:1}||(clearTimeout(n),n=setTimeout(function(){t.fireEvent("wordcount")},200))})})},UE.plugins.pagebreak=function(){function o(e){if(f.isEmptyBlock(e)){for(var t,n=e.firstChild;n&&1==n.nodeType&&f.isEmptyBlock(n);)n=(t=n).firstChild;t=t||e,f.fillNode(a.document,t)}}function r(e){return e&&1==e.nodeType&&"HR"==e.tagName&&"pagebreak"==e.className}var a=this,s=["td"];a.setOpt("pageBreakTag","_ueditor_page_break_tag_"),a.ready(function(){p.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",a.document)}),a.addInputRule(function(e){e.traversal(function(e){var t;"text"==e.type&&e.data==a.options.pageBreakTag&&(t=UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">'),e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e))})}),a.addOutputRule(function(e){p.each(e.getNodesByTagName("hr"),function(e){var t;"pagebreak"==e.getAttr("class")&&(t=UE.uNode.createText(a.options.pageBreakTag),e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e))})}),a.commands.pagebreak={execCommand:function(){var e=a.selection.getRange(),t=a.document.createElement("hr");f.setAttributes(t,{class:"pagebreak",noshade:"noshade",size:"5"}),f.unSelectable(t);var n=f.findParentByTagName(e.startContainer,s,!0),i=[];if(n)"TD"===n.tagName&&(t!==(n=(i=(n=n.parentNode).previousSibling?(n.parentNode.insertBefore(t,n),f.findParents(t)):((e=f.findParentByTagName(n,"table")).parentNode.insertBefore(t,e),f.findParents(t,!0)))[1])&&f.breakParent(t,n),a.fireEvent("afteradjusttable",a.document));else{if(!e.collapsed)for(e.deleteContents(),n=e.startContainer;!f.isBody(n)&&f.isBlockElm(n)&&f.isEmptyNode(n);)e.setStartBefore(n).collapse(!0),f.remove(n),n=e.startContainer;for(e.insertNode(t),n=t.parentNode;!f.isBody(n);)f.breakParent(t,n),(n=t.nextSibling)&&f.isEmptyBlock(n)&&f.remove(n),n=t.parentNode;n=t.nextSibling,r(i=t.previousSibling)?f.remove(i):i&&o(i),n?(r(n)?f.remove(n):o(n),e.setEndAfter(t).collapse(!1)):(n=a.document.createElement("p"),t.parentNode.appendChild(n),f.fillNode(a.document,n),e.setStart(n,0).collapse(!0)),e.select(!0)}}}},UE.plugin.register("wordimage",function(){var n,r=this;return{commands:{wordimage:{execCommand:function(){for(var e,t=f.getElementsByTagName(r.body,"img"),n=[],i=0;e=t[i++];)(e=e.getAttribute("word_img"))&&n.push(e);return n},queryCommandState:function(){n=f.getElementsByTagName(r.body,"img");for(var e,t=0;e=n[t++];)if(e.getAttribute("word_img"))return 1;return-1},notNeedUndo:!0}},inputRule:function(e){p.each(e.getNodesByTagName("img"),function(e){var t=e.attrs,n=parseInt(t.width)<128||parseInt(t.height)<43,i=r.options,o=i.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";t.src&&/^(?:(file:\/+))/.test(t.src)&&e.setAttr({width:t.width,height:t.height,alt:t.alt,word_img:t.src,src:o,style:"background:url("+(n?i.themePath+i.theme+"/images/word.gif":i.langPath+i.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd"})})}}}),UE.plugins.dragdrop=function(){var o=this;o.ready(function(){f.on(this.body,"dragend",function(){var e=o.selection.getRange(),t=e.getClosedNode()||o.selection.getStart();if(t&&"IMG"==t.tagName){for(var n,i=t.previousSibling;(n=t.nextSibling)&&1==n.nodeType&&"SPAN"==n.tagName&&!n.firstChild;)f.remove(n);(!i||1!=i.nodeType||f.isEmptyBlock(i))&&i||n&&(!n||f.isEmptyBlock(n))||(i&&"P"==i.tagName&&!f.isEmptyBlock(i)?(i.appendChild(t),f.moveChild(n,i),f.remove(n)):n&&"P"==n.tagName&&!f.isEmptyBlock(n)&&n.insertBefore(t,n.firstChild),i&&"P"==i.tagName&&f.isEmptyBlock(i)&&f.remove(i),n&&"P"==n.tagName&&f.isEmptyBlock(n)&&f.remove(n),e.selectNode(t).select(),o.fireEvent("saveScene"))}})}),o.addListener("keyup",function(e,t){13==(t.keyCode||t.which)&&(t=o.selection.getRange(),(t=f.findParentByTagName(t.startContainer,"p",!0))&&"center"==f.getComputedStyle(t,"text-align")&&f.removeStyle(t,"text-align"))})},UE.plugins.undo=function(){function o(e,t){if(e.length==t.length){for(var n=0,i=e.length;n<i;n++)if(e[n]!=t[n])return;return 1}}var a,s=this,l=s.options.maxUndoCount||20,d=s.options.maxInputCount||20,c=RegExp(f.fillChar+"|</hr>","gi"),u={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},m=s.options.autoClearEmptyNode;s.undoManger=new function(){this.list=[],this.index=0,this.hasRedo=this.hasUndo=!1,this.undo=function(){if(this.hasUndo)if(this.list[this.index-1]||1!=this.list.length){for(;this.list[this.index].content==this.list[this.index-1].content;)if(this.index--,0==this.index)return this.restore(0);this.restore(--this.index)}else this.reset()},this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}},this.restore=function(){var t=this.editor,e=this.list[this.index],n=UE.htmlparser(e.content.replace(c,""));t.options.autoClearEmptyNode=!1,t.filterInputRule(n),t.options.autoClearEmptyNode=m,t.document.body.innerHTML=n.toHtml(),t.fireEvent("afterscencerestore"),r.ie&&p.each(f.getElementsByTagName(t.document,"td th caption p"),function(e){f.isEmptyNode(e)&&f.fillNode(t.document,e)});try{var i=new L.Range(t.document).moveToAddress(e.address);i.select(u[i.startContainer.nodeName.toLowerCase()])}catch(e){}this.update(),this.clearKey(),t.fireEvent("reset",!0)},this.getScene=function(){var e=this.editor,t=e.selection.getRange().createAddress(!1,!0);e.fireEvent("beforegetscene");var n=UE.htmlparser(e.body.innerHTML);return e.options.autoClearEmptyNode=!1,e.filterOutputRule(n),e.options.autoClearEmptyNode=m,n=n.toHtml(),e.fireEvent("aftergetscene"),{address:t,content:n}},this.save=function(e,t){clearTimeout(a);var n=this.getScene(t),i=this.list[this.index];i&&i.content!=n.content&&s.trigger("contentchange"),(t=i)&&(t=i.content==n.content)&&(t=i=e?1:(i=i.address,t=n.address,i.collapsed==t.collapsed&&o(i.startAddress,t.startAddress)&&o(i.endAddress,t.endAddress)?1:0)),t||(this.list=this.list.slice(0,this.index+1),this.list.push(n),this.list.length>l&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update())},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasRedo=this.hasUndo=!1,this.clearKey()},this.clearKey=function(){g=0}},(s.undoManger.editor=s).addListener("saveScene",function(){var e=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,e)}),s.addListener("reset",function(e,t){t||this.undoManger.reset()}),s.commands.redo=s.commands.undo={execCommand:function(e){this.undoManger[e]()},queryCommandState:function(e){return this.undoManger["has"+("undo"==e.toLowerCase()?"Undo":"Redo")]?0:-1},notNeedUndo:1};var h={16:1,17:1,18:1,37:1,38:1,39:1,40:1},g=0,b=!1;s.addListener("ready",function(){f.on(this.body,"compositionstart",function(){b=!0}),f.on(this.body,"compositionend",function(){b=!1})}),s.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});var v=!0;s.addListener("keydown",function(e,t){var n,i=this;h[t.keyCode||t.which]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey||b||(i.selection.getRange().collapsed?(0==i.undoManger.list.length&&i.undoManger.save(!0),clearTimeout(a),n=function(e){e.undoManger.save(!1,!0),e.fireEvent("selectionchange")},a=setTimeout(function(){var e;b?e=setInterval(function(){b||(n(i),clearInterval(e))},300):n(i)},200),d<=++g&&n(i)):(i.undoManger.save(!1,!0),v=!1))}),s.addListener("keyup",function(e,t){h[t.keyCode||t.which]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey||b||v||(this.undoManger.save(!1,!0),v=!0)}),s.stopCmdUndo=function(){s.__hasEnterExecCommand=!0},s.startCmdUndo=function(){s.__hasEnterExecCommand=!1}},UE.plugin.register("copy",function(){function e(){ZeroClipboard.config({debug:!1,swfPath:i.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.swf"});var e=i.zeroclipboard=new ZeroClipboard;e.on("copy",function(e){e=e.client;var t=i.selection.getRange(),n=document.createElement("div");n.appendChild(t.cloneContents()),e.setText(n.innerText||n.textContent),e.setHtml(n.innerHTML),t.select()}),e.on("mouseover mouseout",function(e){var t=e.target;"mouseover"==e.type?f.addClass(t,"edui-state-hover"):"mouseout"==e.type&&f.removeClasses(t,"edui-state-hover")}),e.on("wrongflash noflash",function(){ZeroClipboard.destroy()})}var i=this;return{bindEvents:{ready:function(){r.ie||(window.ZeroClipboard?e():p.loadFile(document,{src:i.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.js",tag:"script",type:"text/javascript",defer:"defer"},function(){e()}))}},commands:{copy:{execCommand:function(e){i.document.execCommand("copy")||alert(i.getLang("copymsg"))}}}}}),UE.plugins.paste=function(){function t(i){var o,a,s,l=this.document;l.getElementById("baidu_pastebin")||(o=this.selection.getRange(),a=o.createBookmark(),(s=l.createElement("div")).id="baidu_pastebin",r.webkit&&s.appendChild(l.createTextNode(f.fillChar+f.fillChar)),l.body.appendChild(s),a.start.style.display="",s.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+f.getXY(a.start).y+"px",o.selectNodeContents(s).select(!0),setTimeout(function(){if(r.webkit)for(var e,t=0,n=l.querySelectorAll("#baidu_pastebin");e=n[t++];){if(!f.isEmptyNode(e)){s=e;break}f.remove(e)}try{s.parentNode.removeChild(s)}catch(e){}o.moveToBookmark(a).select(!0),i(s)},0))}function a(e){return e.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(e,t,n,i){return{img:1}[n=n.toLowerCase()]?e:(i=i.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(e,t,n){return{src:1,href:1,name:1}[t.toLowerCase()]?t+"="+n+" ":""}),{span:1,div:1}[n]?"":"<"+t+n+" "+p.trim(i)+">")})}function n(e){if(e.firstChild){for(var t,n=f.getElementsByTagName(e,"span"),i=0;t=n[i++];)"_baidu_cut_start"!=t.id&&"_baidu_cut_end"!=t.id||f.remove(t);if(r.webkit){for(t=e.querySelectorAll("div br"),i=0;n=t[i++];)"DIV"==(n=n.parentNode).tagName&&1==n.childNodes.length&&(n.innerHTML="<p><br/></p>",f.remove(n));for(n=e.querySelectorAll("#baidu_pastebin"),i=0;t=n[i++];){var o=c.document.createElement("p");for(t.parentNode.insertBefore(o,t);t.firstChild;)o.appendChild(t.firstChild);f.remove(t)}for(t=e.querySelectorAll("meta"),i=0;n=t[i++];)f.remove(n);for(t=e.querySelectorAll("br"),i=0;n=t[i++];)/^apple-/i.test(n.className)&&f.remove(n)}if(r.gecko)for(t=e.querySelectorAll("[_moz_dirty]"),i=0;n=t[i++];)n.removeAttribute("_moz_dirty");if(!r.ie)for(t=e.querySelectorAll("span.Apple-style-span"),i=0;n=t[i++];)f.remove(n,!0);i=e.innerHTML,i=UE.filterWord(i),e=UE.htmlparser(i),c.options.filterRules&&UE.filterNode(e,c.options.filterRules),c.filterInputRule(e),r.webkit&&((i=e.lastChild())&&"element"==i.type&&"br"==i.tagName&&e.removeChild(i),p.each(c.body.querySelectorAll("div"),function(e){f.isEmptyBlock(e)&&f.remove(e,!0)})),i={html:e.toHtml()},c.fireEvent("beforepaste",i,e),i.html&&(e=UE.htmlparser(i.html,!0),1===c.queryCommandState("pasteplain")?c.execCommand("insertHtml",UE.filterNode(e,c.options.filterTxtRules).toHtml(),!0):(UE.filterNode(e,c.options.filterTxtRules),s=e.toHtml(),l=i.html,d=c.selection.getRange().createAddress(!0),c.execCommand("insertHtml",!0===c.getOpt("retainOnlyLabelPasted")?a(l):l,!0)),c.fireEvent("afterpaste",i))}}var s,l,d,c=this;c.setOpt({retainOnlyLabelPasted:!1}),c.addListener("pasteTransfer",function(e,t){if(d&&s&&l&&s!=l){var n=c.selection.getRange();if(n.moveToAddress(d,!0),!n.collapsed){for(;!f.isBody(n.startContainer);){var i=n.startContainer;if(1==i.nodeType){if(!(i=i.childNodes[n.startOffset])){n.setStartBefore(n.startContainer);continue}(i=i.previousSibling)&&3==i.nodeType&&RegExp("^[\n\r\t "+f.fillChar+"]*$").test(i.nodeValue)&&n.setStartBefore(i)}if(0!=n.startOffset)break;n.setStartBefore(n.startContainer)}for(;!f.isBody(n.endContainer);){if(1==(i=n.endContainer).nodeType){if(!(i=i.childNodes[n.endOffset])){n.setEndAfter(n.endContainer);continue}(i=i.nextSibling)&&3==i.nodeType&&RegExp("^[\n\r\t"+f.fillChar+"]*$").test(i.nodeValue)&&n.setEndAfter(i)}if(n.endOffset!=n.endContainer[3==n.endContainer.nodeType?"nodeValue":"childNodes"].length)break;n.setEndAfter(n.endContainer)}}for(n.deleteContents(),n.select(!0),c.__hasEnterExecCommand=!0,n=l,2===t?n=a(n):t&&(n=s),c.execCommand("inserthtml",n,!0),c.__hasEnterExecCommand=!1,n=c.selection.getRange();!f.isBody(n.startContainer)&&!n.startOffset&&n.startContainer[3==n.startContainer.nodeType?"nodeValue":"childNodes"].length;)n.setStartBefore(n.startContainer);n=n.createAddress(!0),d.endAddress=n.startAddress}}),c.addListener("ready",function(){f.on(c.body,"cut",function(){!c.selection.getRange().collapsed&&c.undoManger&&c.undoManger.save()}),f.on(c.body,r.ie||r.opera?"keydown":"paste",function(e){(!r.ie&&!r.opera||(e.ctrlKey||e.metaKey)&&"86"==e.keyCode)&&t.call(c,function(e){n(e)})})}),c.commands.paste={execCommand:function(e){r.ie?(t.call(c,function(e){n(e)}),c.document.execCommand("paste")):alert(c.getLang("pastemsg"))}}},UE.plugins.pasteplain=function(){function e(e){e.tagName="p",e.setStyle()}function t(e){e.parentNode.removeChild(e,!0)}this.setOpt({pasteplain:!1,filterTxtRules:{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(e){for(var t,n=UE.uNode.createElement("p");t=e.firstChild();)"text"!=t.type&&UE.dom.dtd.$block[t.tagName]?n.firstChild()?(e.parentNode.insertBefore(n,e),n=UE.uNode.createElement("p")):e.parentNode.insertBefore(t,e):n.appendChild(t);n.firstChild()&&e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)},ol:t,ul:t,dl:t,dt:t,dd:t,li:t,caption:e,th:e,tr:e,h1:e,h2:e,h3:e,h4:e,h5:e,h6:e,td:function(e){e.innerText()&&e.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),e),e.parentNode.removeChild(e,e.innerText())}}});var n=this.options.pasteplain;this.commands.pasteplain={queryCommandState:function(){return n?1:0},execCommand:function(){n=0|!n},notNeedUndo:1}},UE.plugins.list=function(){function e(e){var t,n=[];for(t in e)n.push(t);return n}function b(e){var t=e.className;return f.hasClass(e,/custom_/)?t.match(/custom_(\w+)/)[1]:f.getStyle(e,"list-style-type")}function a(n,r){p.each(f.getElementsByTagName(n,"ol ul"),function(i){var e,o,t;f.inDoc(i,n)&&((e=i.parentNode).tagName==i.tagName&&(t=b(i)||("OL"==i.tagName?"decimal":"disc"))==(b(e)||("OL"==e.tagName?"decimal":"disc"))&&(t=(t=p.indexOf(d[i.tagName],t))+1==d[i.tagName].length?0:t+1,C(i,d[i.tagName][t])),o=0,t=2,f.hasClass(i,/custom_/)?/[ou]l/i.test(e.tagName)&&f.hasClass(e,/custom_/)||(t=1):/[ou]l/i.test(e.tagName)&&f.hasClass(e,/custom_/)&&(t=3),(e=f.getStyle(i,"list-style-type"))&&(i.style.cssText="list-style-type:"+e),i.className=p.trim(i.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+t,p.each(f.getElementsByTagName(i,"li"),function(e){if(e.style.cssText&&(e.style.cssText=""),e.firstChild){if(e.parentNode===i){if(o++,f.hasClass(i,/custom_/)){var t=1,n=b(i);if("OL"==i.tagName){if(n)switch(n){case"cn":case"cn1":case"cn2":10<o&&(0==o%10||10<o&&o<20)?t=2:20<o&&(t=3);break;case"num2":9<o&&(t=2)}e.className="list-"+h[n]+o+" list-"+n+"-paddingleft-"+t}else e.className="list-"+h[n]+" list-"+n+"-paddingleft"}else e.className=e.className.replace(/list-[\w\-]+/gi,"");null===(t=e.getAttribute("class"))||t.replace(/\s/g,"")||f.removeAttributes(e,"class")}}else f.remove(e)}),r||y(i,i.tagName.toLowerCase(),b(i)||f.getStyle(i,"list-style-type"),!0))})}function y(e,t,n,i){var o=e.nextSibling;o&&1==o.nodeType&&o.tagName.toLowerCase()==t&&(b(o)||f.getStyle(o,"list-style-type")||("ol"==t?"decimal":"disc"))==n&&(f.moveChild(o,e),0==o.childNodes.length&&f.remove(o)),o&&f.isFillChar(o)&&f.remove(o),(o=e.previousSibling)&&1==o.nodeType&&o.tagName.toLowerCase()==t&&(b(o)||f.getStyle(o,"list-style-type")||("ol"==t?"decimal":"disc"))==n&&f.moveChild(e,o),o&&f.isFillChar(o)&&f.remove(o),!i&&f.isEmptyBlock(e)&&f.remove(e),b(e)&&a(e.ownerDocument,!0)}function C(e,t){h[t]&&(e.className="custom_"+t);try{f.setStyle(e,"list-style-type",t)}catch(e){}}function u(e){var t=e.previousSibling;t&&f.isEmptyBlock(t)&&f.remove(t),(t=e.nextSibling)&&f.isEmptyBlock(t)&&f.remove(t)}function N(e){for(;e&&!f.isBody(e);){if("TABLE"==e.nodeName)return null;if("LI"==e.nodeName)return e;e=e.parentNode}}var m=this,x={TD:1,PRE:1,BLOCKQUOTE:1},h={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};m.setOpt({autoTransWordToList:!1,insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1,disablePInList:!1});var t,d={OL:e(m.options.insertorderedlist),UL:e(m.options.insertunorderedlist)},i=m.options.listiconpath;for(t in h)m.options.insertorderedlist.hasOwnProperty(t)||m.options.insertunorderedlist.hasOwnProperty(t)||delete h[t];m.ready(function(){var e,t=[];for(e in h){if("dash"==e||"dot"==e)t.push("li.list-"+h[e]+"{background-image:url("+i+h[e]+".gif)}"),t.push("ul.custom_"+e+"{list-style:none;}ul.custom_"+e+" li{background-position:0 3px;background-repeat:no-repeat}");else{for(var n=0;n<99;n++)t.push("li.list-"+h[e]+n+"{background-image:url("+i+"list-"+h[e]+n+".gif)}");t.push("ol.custom_"+e+"{list-style:none;}ol.custom_"+e+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(e){case"cn":t.push("li.list-"+e+"-paddingleft-1{padding-left:25px}"),t.push("li.list-"+e+"-paddingleft-2{padding-left:40px}"),t.push("li.list-"+e+"-paddingleft-3{padding-left:55px}");break;case"cn1":t.push("li.list-"+e+"-paddingleft-1{padding-left:30px}"),t.push("li.list-"+e+"-paddingleft-2{padding-left:40px}"),t.push("li.list-"+e+"-paddingleft-3{padding-left:55px}");break;case"cn2":t.push("li.list-"+e+"-paddingleft-1{padding-left:40px}"),t.push("li.list-"+e+"-paddingleft-2{padding-left:55px}"),t.push("li.list-"+e+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":t.push("li.list-"+e+"-paddingleft-1{padding-left:25px}");break;case"num2":t.push("li.list-"+e+"-paddingleft-1{padding-left:35px}"),t.push("li.list-"+e+"-paddingleft-2{padding-left:40px}");break;case"dash":t.push("li.list-"+e+"-paddingleft{padding-left:35px}");break;case"dot":t.push("li.list-"+e+"-paddingleft{padding-left:20px}")}}t.push(".list-paddingleft-1{padding-left:0}"),t.push(".list-paddingleft-2{padding-left:"+m.options.listDefaultPaddingLeft+"px}"),t.push(".list-paddingleft-3{padding-left:"+2*m.options.listDefaultPaddingLeft+"px}"),p.cssRule("list","ol,ul{margin:0;pading:0;"+(r.ie?"":"width:95%")+"}li{clear:both;}"+t.join("\n"),m.document)}),m.ready(function(){f.on(m.body,"cut",function(){setTimeout(function(){var e,t,n=m.selection.getRange();!n.collapsed&&(t=f.findParentByTagName(n.startContainer,"li",!0))&&!t.nextSibling&&f.isEmptyBlock(t)&&((e=(t=t.parentNode).previousSibling)?(f.remove(t),n.setStartAtLast(e).collapse(!0)):(e=t.nextSibling)?(f.remove(t),n.setStartAtFirst(e).collapse(!0)):(e=m.document.createElement("p"),f.fillNode(m.document,e),t.parentNode.insertBefore(e,t),f.remove(t),n.setStart(e,0).collapse(!0)),n.select(!0))})})}),m.addListener("beforepaste",function(n,e){var i,t=this.selection.getRange(),o=UE.htmlparser(e.html,!0);(t=f.findParentByTagName(t.startContainer,"li",!0))&&(i=t.parentNode,p.each(o.getNodesByTagName("OL"==i.tagName?"ul":"ol"),function(e){var t;e.tagName=i.tagName,e.setAttr(),e.parentNode===o?n=b(i)||("OL"==i.tagName?"decimal":"disc"):(t=e.parentNode.getAttr("class"),(n=t&&/custom_/.test(t)?t.match(/custom_(\w+)/)[1]:e.parentNode.getStyle("list-style-type"))||(n="OL"==i.tagName?"decimal":"disc")),t=p.indexOf(d[i.tagName],n),e.parentNode!==o&&(t=t+1==d[i.tagName].length?0:t+1),t=d[i.tagName][t],h[t]?e.setAttr("class","custom_"+t):e.setStyle("list-style-type",t)})),e.html=o.toHtml()}),!0===m.getOpt("disablePInList")&&m.addOutputRule(function(e){p.each(e.getNodesByTagName("li"),function(n){var i=[],o=0;p.each(n.children,function(e){if("p"==e.tagName){for(var t;t=e.children.pop();)i.splice(o,0,t),t.parentNode=n,lastNode=t;(t=i[i.length-1])&&"element"==t.type&&"br"==t.tagName||((e=UE.uNode.createElement("br")).parentNode=n,i.push(e)),o=i.length}}),i.length&&(n.children=i)})}),m.addInputRule(function(e){var d,o,c;p.each(e.getNodesByTagName("li"),function(e){for(var t,n=UE.uNode.createElement("p"),i=0;t=e.children[i];)"text"==t.type||v.p[t.tagName]?n.appendChild(t):n.firstChild()?(e.insertBefore(n,t),n=UE.uNode.createElement("p"),i+=2):i++;(!n.firstChild()||n.parentNode)&&e.firstChild()||e.appendChild(n),n.firstChild()||n.innerHTML(r.ie?"&nbsp;":"<br/>"),(n=(e=e.firstChild()).lastChild())&&"text"==n.type&&/^\s*$/.test(n.data)&&e.removeChild(n)}),m.options.autoTransWordToList&&(d={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,"upper-alpha":/^[A-Z]+\./,cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},o={square:"n"},c=function(e,t){var n=t.firstChild();if(n&&"element"==n.type&&"span"==n.tagName&&/Wingdings|Symbol/.test(n.getStyle("font-family"))){for(var i in o)if(o[i]==n.data)return i;return"disc"}for(i in d)if(d[i].test(e))return i},p.each(e.getNodesByTagName("p"),function(e){if("MsoListParagraph"==e.getAttr("class")){e.setStyle("margin",""),e.setStyle("margin-left",""),e.setAttr("class","");var t,n=e,i=e;if("li"!=e.parentNode.tagName&&(t=c(e.innerText(),e))){var o=UE.uNode.createElement(m.options.insertorderedlist.hasOwnProperty(t)?"ol":"ul");for(h[t]?o.setAttr("class","custom_"+t):o.setStyle("list-style-type",t);e&&"li"!=e.parentNode.tagName&&c(e.innerText(),e);){(n=e.nextSibling())||e.parentNode.insertBefore(o,e);var a,s=o,l=t;"ol"==s.tagName?r.ie?"element"==(a=e.firstChild()).type&&"span"==a.tagName&&d[l].test(a.innerText())&&e.removeChild(a):e.innerHTML(e.innerHTML().replace(d[l],"")):e.removeChild(e.firstChild()),(l=UE.uNode.createElement("li")).appendChild(e),s.appendChild(l),e=n}!o.parentNode&&e&&e.parentNode&&e.parentNode.insertBefore(o,e)}(n=i.firstChild())&&"element"==n.type&&"span"==n.tagName&&/^\s*(&nbsp;)+\s*$/.test(n.innerText())&&n.parentNode.removeChild(n)}}))}),m.addListener("contentchange",function(){a(m.document)}),m.addListener("keydown",function(e,t){function n(){t.preventDefault?t.preventDefault():t.returnValue=!1,m.fireEvent("contentchange"),m.undoManger&&m.undoManger.save()}function i(e,t){for(;e&&!f.isBody(e)&&!t(e);){if(1==e.nodeType&&/[ou]l/i.test(e.tagName))return e;e=e.parentNode}return null}var o=t.keyCode||t.which;if(13==o&&!t.shiftKey){var r=m.selection.getRange(),a=f.findParent(r.startContainer,function(e){return f.isBlockElm(e)},!0),s=f.findParentByTagName(r.startContainer,"li",!0);if(a&&"PRE"!=a.tagName&&!s&&(s=a.innerHTML.replace(RegExp(f.fillChar,"g"),""),/^\s*1\s*\.[^\d]/.test(s)&&(a.innerHTML=s.replace(/^\s*1\s*\./,""),r.setStartAtLast(a).collapse(!0).select(),m.__hasEnterExecCommand=!0,m.execCommand("insertorderedlist"),m.__hasEnterExecCommand=!1)),a=i((r=m.selection.getRange()).startContainer,function(e){return"TABLE"==e.tagName}),s=r.collapsed?a:i(r.endContainer,function(e){return"TABLE"==e.tagName}),a&&s&&a===s){if(!r.collapsed){if(a=f.findParentByTagName(r.startContainer,"li",!0),s=f.findParentByTagName(r.endContainer,"li",!0),!a||!s||a!==s){var l=(a=r.cloneRange()).collapse(!1).createBookmark();return r.deleteContents(),a.moveToBookmark(l),u(s=f.findParentByTagName(a.startContainer,"li",!0)),a.select(),void n()}if(r.deleteContents(),(s=f.findParentByTagName(r.startContainer,"li",!0))&&f.isEmptyBlock(s))return c=s.previousSibling,next=s.nextSibling,a=m.document.createElement("p"),f.fillNode(m.document,a),d=s.parentNode,c&&next?(r.setStart(next,0).collapse(!0).select(!0),f.remove(s)):((c||next)&&c?s.parentNode.parentNode.insertBefore(a,d.nextSibling):d.parentNode.insertBefore(a,d),f.remove(s),d.firstChild||f.remove(d),r.setStart(a,0).setCursor()),void n()}if(s=f.findParentByTagName(r.startContainer,"li",!0)){if(f.isEmptyBlock(s)){var l=r.createBookmark(),d=s.parentNode;if(s!==d.lastChild?(f.breakParent(s,d),u(s)):(d.parentNode.insertBefore(s,d.nextSibling),f.isEmptyNode(d)&&f.remove(d)),!v.$list[s.parentNode.tagName])if(f.isBlockElm(s.firstChild))f.remove(s,!0);else{for(a=m.document.createElement("p"),s.parentNode.insertBefore(a,s);s.firstChild;)a.appendChild(s.firstChild);f.remove(s)}r.moveToBookmark(l).select()}else{if(!(a=s.firstChild)||!f.isBlockElm(a)){for(a=m.document.createElement("p"),s.firstChild||f.fillNode(m.document,a);s.firstChild;)a.appendChild(s.firstChild);s.appendChild(a)}l=m.document.createElement("span"),r.insertNode(l),f.breakParent(l,s),(a=(c=l.nextSibling).firstChild)||(a=m.document.createElement("p"),f.fillNode(m.document,a),c.appendChild(a)),f.isEmptyNode(a)&&(a.innerHTML="",f.fillNode(m.document,a)),r.setStart(a,0).collapse(!0).shrinkBoundary().select(),f.remove(l);var c=c.previousSibling;c&&f.isEmptyBlock(c)&&(c.innerHTML="<p></p>",f.fillNode(m.document,c.firstChild))}n()}}}if(8==o&&((r=m.selection.getRange()).collapsed&&f.isStartInblock(r)&&(a=r.cloneRange().trimBoundary(),(s=f.findParentByTagName(r.startContainer,"li",!0))&&f.isStartInblock(a))))if((a=f.findParentByTagName(r.startContainer,"p",!0))&&a!==s.firstChild)d=f.findParentByTagName(a,["ol","ul"]),f.breakParent(a,d),u(a),m.fireEvent("contentchange"),r.setStart(a,0).setCursor(!1,!0),m.fireEvent("saveScene"),f.preventDefault(t);else if(s&&(c=s.previousSibling)){if(46!=o||!s.childNodes.length){if(v.$list[c.tagName]&&(c=c.lastChild),m.undoManger&&m.undoManger.save(),a=s.firstChild,f.isBlockElm(a))if(f.isEmptyNode(a))for(c.appendChild(a),r.setStart(a,0).setCursor(!1,!0);s.firstChild;)c.appendChild(s.firstChild);else l=m.document.createElement("span"),r.insertNode(l),f.isEmptyBlock(c)&&(c.innerHTML=""),f.moveChild(s,c),r.setStartBefore(l).collapse(!0).select(!0),f.remove(l);else if(f.isEmptyNode(s))a=m.document.createElement("p"),c.appendChild(a),r.setStart(a,0).setCursor();else for(r.setEnd(c,c.childNodes.length).collapse().select(!0);s.firstChild;)c.appendChild(s.firstChild);f.remove(s),m.fireEvent("contentchange"),m.fireEvent("saveScene"),f.preventDefault(t)}}else if(s&&!s.previousSibling){if(d=s.parentNode,l=r.createBookmark(),f.isTagNode(d.parentNode,"ol ul"))d.parentNode.insertBefore(s,d);else{for(;s.firstChild;)d.parentNode.insertBefore(s.firstChild,d);f.remove(s)}f.isEmptyNode(d)&&f.remove(d),r.moveToBookmark(l).setCursor(!1,!0),m.fireEvent("contentchange"),m.fireEvent("saveScene"),f.preventDefault(t)}}),m.addListener("keyup",function(e,t){8==(t.keyCode||t.which)&&(t=m.selection.getRange(),(t=f.findParentByTagName(t.startContainer,["ol","ul"],!0))&&y(t,t.tagName.toLowerCase(),b(t)||f.getComputedStyle(t,"list-style-type"),!0))}),m.addListener("tabkeydown",function(){function e(e){if(-1!=m.options.maxListLevel){e=e.parentNode;for(var t=0;/[ou]l/i.test(e.tagName);)t++,e=e.parentNode;return t>=m.options.maxListLevel?1:void 0}}var t,n=m.selection.getRange(),i=f.findParentByTagName(n.startContainer,"li",!0);if(i){if(n.collapsed){if(e(i))return!0;var o=i.parentNode,r=m.document.createElement(o.tagName),a=(a=p.indexOf(d[r.tagName],b(o)||f.getComputedStyle(o,"list-style-type")))+1==d[r.tagName].length?0:a+1;return C(r,a=d[r.tagName][a]),f.isStartInblock(n)?(m.fireEvent("saveScene"),t=n.createBookmark(),o.insertBefore(r,i),r.appendChild(i),y(r,r.tagName.toLowerCase(),a),m.fireEvent("contentchange"),n.moveToBookmark(t).select(!0),!0):void 0}m.fireEvent("saveScene"),t=n.createBookmark();for(var s,l,o=0,r=f.findParents(i);l=r[o++];)if(f.isTagNode(l,"ol ul")){s=l;break}if(l=i,t.end)for(;l&&!(f.getPosition(l,t.end)&f.POSITION_FOLLOWING);)if(e(l))l=f.getNextDomNode(l,!1,null,function(e){return e!==s});else{for(o=l.parentNode,r=m.document.createElement(o.tagName),a=p.indexOf(d[r.tagName],b(o)||f.getComputedStyle(o,"list-style-type")),C(r,a=d[r.tagName][a+1==d[r.tagName].length?0:a+1]),o.insertBefore(r,l);l&&!(f.getPosition(l,t.end)&f.POSITION_FOLLOWING);){if(i=l.nextSibling,r.appendChild(l),!i||f.isTagNode(i,"ol ul")){if(i)for(;(i=i.firstChild)&&"LI"!=i.tagName;);else i=f.getNextDomNode(l,!1,null,function(e){return e!==s});break}l=i}y(r,r.tagName.toLowerCase(),a),l=i}return m.fireEvent("contentchange"),n.moveToBookmark(t).select(),!0}}),m.commands.insertorderedlist=m.commands.insertunorderedlist={execCommand:function(e,t){t=t||("insertorderedlist"==e.toLowerCase()?"decimal":"disc");var n=this.selection.getRange(),i=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!f.isWhitespace(e)},o="insertorderedlist"==e.toLowerCase()?"ol":"ul",r=this.document.createDocumentFragment();n.adjustmentBoundary().shrinkBoundary();var a,s,l,d,c=n.createBookmark(!0),u=N(this.document.getElementById(c.start)),m=0,h=N(this.document.getElementById(c.end)),p=0;if(u||h){if(u&&(a=u.parentNode),c.end||(h=u),h&&(s=h.parentNode),a===s){for(;u!==h;){if(u=(d=u).nextSibling,!f.isBlockElm(d.firstChild)){for(i=this.document.createElement("p");d.firstChild;)i.appendChild(d.firstChild);d.appendChild(i)}r.appendChild(d)}if(d=this.document.createElement("span"),a.insertBefore(d,h),!f.isBlockElm(h.firstChild)){for(i=this.document.createElement("p");h.firstChild;)i.appendChild(h.firstChild);h.appendChild(i)}if(r.appendChild(h),f.breakParent(d,a),f.isEmptyNode(d.previousSibling)&&f.remove(d.previousSibling),f.isEmptyNode(d.nextSibling)&&f.remove(d.nextSibling),i=b(a)||f.getComputedStyle(a,"list-style-type")||("insertorderedlist"==e.toLowerCase()?"decimal":"disc"),a.tagName.toLowerCase()==o&&i==t){for(h=0,h=this.document.createDocumentFragment();i=r.firstChild;)if(f.isTagNode(i,"ol ul"))h.appendChild(i);else for(;i.firstChild;)h.appendChild(i.firstChild),f.remove(i);d.parentNode.insertBefore(h,d)}else C(l=this.document.createElement(o),t),l.appendChild(r),d.parentNode.insertBefore(l,d);return f.remove(d),l&&y(l,o,t),void n.moveToBookmark(c).select()}if(u){for(;u;){if(d=u.nextSibling,f.isTagNode(u,"ol ul"))r.appendChild(u);else{l=this.document.createDocumentFragment();for(var g=0;u.firstChild;)f.isBlockElm(u.firstChild)&&(g=1),l.appendChild(u.firstChild);g?r.appendChild(l):((g=this.document.createElement("p")).appendChild(l),r.appendChild(g)),f.remove(u)}u=d}a.parentNode.insertBefore(r,a.nextSibling),f.isEmptyNode(a)?(n.setStartBefore(a),f.remove(a)):n.setStartAfter(a),m=1}if(h&&f.inDoc(s,this.document)){for(u=s.firstChild;u&&u!==h;){if(d=u.nextSibling,f.isTagNode(u,"ol ul"))r.appendChild(u);else{for(l=this.document.createDocumentFragment(),g=0;u.firstChild;)f.isBlockElm(u.firstChild)&&(g=1),l.appendChild(u.firstChild);g?r.appendChild(l):((g=this.document.createElement("p")).appendChild(l),r.appendChild(g)),f.remove(u)}u=d}d=f.createElement(this.document,"div",{tmpDiv:1}),f.moveChild(h,d),r.appendChild(d),f.remove(h),s.parentNode.insertBefore(r,s),n.setEndBefore(s),f.isEmptyNode(s)&&f.remove(s),p=1}}for(m||n.setStartBefore(this.document.getElementById(c.start)),c.end&&!p&&n.setEndAfter(this.document.getElementById(c.end)),n.enlarge(!0,function(e){return x[e.tagName]}),r=this.document.createDocumentFragment(),h=n.createBookmark(),a=f.getNextDomNode(h.start,!1,i),l=n.cloneRange(),m=f.isBlockElm;a&&a!==h.end&&f.getPosition(a,h.end)&f.POSITION_PRECEDING;)if(3==a.nodeType||v.li[a.tagName])if(1==a.nodeType&&v.$list[a.tagName]){for(;a.firstChild;)r.appendChild(a.firstChild);u=f.getNextDomNode(a,!1,i),f.remove(a),a=u}else{for(u=a,l.setStartBefore(a);a&&a!==h.end&&(!m(a)||f.isBookmarkNode(a));)u=a,a=f.getNextDomNode(a,!1,null,function(e){return!x[e.tagName]});if(a&&m(a)&&(d=f.getNextDomNode(u,!1,i))&&f.isBookmarkNode(d)&&(a=f.getNextDomNode(d,!1,i),u=d),l.setEndAfter(u),a=f.getNextDomNode(u,!1,i),(d=n.document.createElement("li")).appendChild(l.extractContents()),f.isEmptyNode(d)){for(u=n.document.createElement("p");d.firstChild;)u.appendChild(d.firstChild);d.appendChild(u)}r.appendChild(d)}else a=f.getNextDomNode(a,!0,i);for(n.moveToBookmark(h).collapse(!0),C(l=this.document.createElement(o),t),l.appendChild(r),n.insertNode(l),y(l,o,t),h=0,o=f.getElementsByTagName(l,"div");i=o[h++];)i.getAttribute("tmpDiv")&&f.remove(i,!0);n.moveToBookmark(c).select()},queryCommandState:function(e){e="insertorderedlist"==e.toLowerCase()?"ol":"ul";for(var t,n=this.selection.getStartElementPath(),i=0;(t=n[i++])&&"TABLE"!=t.nodeName;)if(e==t.nodeName.toLowerCase())return 1;return 0},queryCommandValue:function(e){e="insertorderedlist"==e.toLowerCase()?"ol":"ul";for(var t,n,i=this.selection.getStartElementPath(),o=0;n=i[o++];){if("TABLE"==n.nodeName){t=null;break}if(e==n.nodeName.toLowerCase()){t=n;break}}return t?b(t)||f.getComputedStyle(t,"list-style-type"):null}}},tG={textarea:function(e,t){var n=t.ownerDocument.createElement("textarea");return n.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;",r.ie&&r.version<8&&(n.style.width=t.offsetWidth+"px",n.style.height=t.offsetHeight+"px",t.onresize=function(){n.style.width=t.offsetWidth+"px",n.style.height=t.offsetHeight+"px"}),t.appendChild(n),{setContent:function(e){n.value=e},getContent:function(){return n.value},select:function(){var e;r.ie?((e=n.createTextRange()).collapse(!0),e.select()):(n.setSelectionRange(0,0),n.focus())},dispose:function(){t.removeChild(n),t=n=t.onresize=null}}},codemirror:function(e,t){var n=window.CodeMirror(t,{mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0}),i=n.getWrapperElement();return i.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;',n.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;",n.refresh(),{getCodeMirror:function(){return n},setContent:function(e){n.setValue(e)},getContent:function(){return n.getValue()},select:function(){n.focus()},dispose:function(){t.removeChild(i),n=i=null}}}},UE.plugins.source=function(){var n,i,o,a,s,l=this,d=this.options,c=!1;d.sourceEditor=r.ie?"textarea":d.sourceEditor||"codemirror",l.setOpt({sourceEditorFirst:!1}),l.commands.source={execCommand:function(){if(c=!c){s=l.selection.getRange().createAddress(!1,!0),l.undoManger&&l.undoManger.save(!0),r.gecko&&(l.body.contentEditable=!1),o=l.iframe.style.cssText,l.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;",l.fireEvent("beforegetcontent");var e=UE.htmlparser(l.body.innerHTML);l.filterOutputRule(e),e.traversal(function(e){if("element"==e.type)switch(e.tagName){case"td":case"th":case"caption":e.children&&1==e.children.length&&"br"==e.firstChild().tagName&&e.removeChild(e.firstChild());break;case"pre":e.innerText(e.innerText().replace(/&nbsp;/g," "))}}),l.fireEvent("aftergetcontent"),e=e.toHtml(!0),(n=tG["codemirror"==d.sourceEditor&&window.CodeMirror?"codemirror":"textarea"](l,l.iframe.parentNode)).setContent(e),i=l.setContent,l.setContent=function(e){e=UE.htmlparser(e),l.filterInputRule(e),e=e.toHtml(),n.setContent(e)},setTimeout(function(){n.select(),l.addListener("fullscreenchanged",function(){try{n.getCodeMirror().refresh()}catch(e){}})}),a=l.getContent,l.getContent=function(){return n.getContent()||"<p>"+(r.ie?"":"<br/>")+"</p>"}}else if(l.iframe.style.cssText=o,e=(e=n.getContent()||"<p>"+(r.ie?"":"<br/>")+"</p>").replace(RegExp("[\\r\\t\\n ]*</?(\\w+)\\s*(?:[^>]*)>","g"),function(e,t){return t&&!v.$inlineWithA[t.toLowerCase()]?e.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,""):e.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,"")}),l.setContent=i,l.setContent(e),n.dispose(),n=null,l.getContent=a,(e=l.body.firstChild)||(l.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"</p>",e=l.body.firstChild),l.undoManger&&l.undoManger.save(!0),r.gecko){var t=document.createElement("input");t.style.cssText="position:absolute;left:0;top:-32768px",document.body.appendChild(t),l.body.contentEditable=!1,setTimeout(function(){f.setViewportOffset(t,{left:-32768,top:0}),t.focus(),setTimeout(function(){l.body.contentEditable=!0,l.selection.getRange().moveToAddress(s).select(!0),f.remove(t)})})}else try{l.selection.getRange().moveToAddress(s).select(!0)}catch(e){}this.fireEvent("sourcemodechanged",c)},queryCommandState:function(){return 0|c},notNeedUndo:1};var t=l.queryCommandState;l.queryCommandState=function(e){return e=e.toLowerCase(),c?e in{source:1,fullscreen:1}?1:-1:t.apply(this,arguments)},"codemirror"==d.sourceEditor&&l.addListener("ready",function(){p.loadFile(document,{src:d.codeMirrorJsUrl||d.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){d.sourceEditorFirst&&setTimeout(function(){l.execCommand("source")},0)}),p.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:d.codeMirrorCssUrl||d.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})},UE.plugins.enterkey=function(){var a,s=this,l=s.options.enterTag;s.addListener("keyup",function(e,t){if(13==(t.keyCode||t.which)){var n,i=s.selection.getRange(),t=i.startContainer;if(r.ie)s.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(a)){if(r.gecko)f.findParentByTagName(t,"h1 h2 h3 h4 h5 h6 blockquote caption table".split(" "),!0)||(s.document.execCommand("formatBlock",!1,"<p>"),n=1);else if(1==t.nodeType){var o,t=s.document.createTextNode("");if(i.insertNode(t),o=f.findParentByTagName(t,"div",!0)){for(n=s.document.createElement("p");o.firstChild;)n.appendChild(o.firstChild);o.parentNode.insertBefore(n,o),f.remove(o),i.setStartBefore(t).setCursor(),n=1}f.remove(t)}s.undoManger&&n&&s.undoManger.save()}r.opera&&i.select()}}}),s.addListener("keydown",function(e,t){if(13==(t.keyCode||t.which))if(s.fireEvent("beforeenterkeydown"))f.preventDefault(t);else{s.fireEvent("saveScene",!0,!0),a="";var n=s.selection.getRange();if(!n.collapsed){var i=n.startContainer,o=n.endContainer,i=f.findParentByTagName(i,"td",!0),o=f.findParentByTagName(o,"td",!0);if(i&&o&&i!==o||!i&&o||i&&!o)return void(t.preventDefault?t.preventDefault():t.returnValue=!1)}if("p"==l)r.ie||((i=f.findParentByTagName(n.startContainer,"ol ul p h1 h2 h3 h4 h5 h6 blockquote caption".split(" "),!0))||r.opera?(a=i.tagName,"p"==i.tagName.toLowerCase()&&r.gecko&&f.removeDirtyAttr(i)):(s.document.execCommand("formatBlock",!1,"<p>"),r.gecko&&(n=s.selection.getRange(),(i=f.findParentByTagName(n.startContainer,"p",!0))&&f.removeDirtyAttr(i))));else if(t.preventDefault?t.preventDefault():t.returnValue=!1,n.collapsed)o=n.document.createElement("br"),n.insertNode(o),o.parentNode.lastChild===o?(o.parentNode.insertBefore(o.cloneNode(!0),o),n.setStartBefore(o)):n.setStartAfter(o),n.setCursor();else if(n.deleteContents(),1==(i=n.startContainer).nodeType&&(i=i.childNodes[n.startOffset])){for(;1==i.nodeType;){if(v.$empty[i.tagName])return n.setStartBefore(i).setCursor(),s.undoManger&&s.undoManger.save(),!1;if(!i.firstChild)return o=n.document.createElement("br"),i.appendChild(o),n.setStart(i,0).setCursor(),s.undoManger&&s.undoManger.save(),!1;i=i.firstChild}i===n.startContainer.childNodes[n.startOffset]?(o=n.document.createElement("br"),n.insertNode(o).setCursor()):n.setStart(i,0).setCursor()}else o=n.document.createElement("br"),n.insertNode(o).setStartAfter(o).setCursor()}})},UE.plugins.keystrokes=function(){var u=this,m=!0;u.addListener("keydown",function(e,t){var n=t.keyCode||t.which,i=u.selection.getRange();if(!(i.collapsed||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)&&(65<=n&&n<=90||48<=n&&n<=57||96<=n&&n<=111||{13:1,8:1,46:1}[n])){var o=i.startContainer;if(f.isFillChar(o)&&i.setStartBefore(o),o=i.endContainer,f.isFillChar(o)&&i.setEndAfter(o),i.txtToElmBoundary(),i.endContainer&&1==i.endContainer.nodeType&&(o=i.endContainer.childNodes[i.endOffset])&&f.isBr(o)&&i.setEndAfter(o),0==i.startOffset&&(o=i.startContainer,f.isBoundaryNode(o,"firstChild")&&(o=i.endContainer,i.endOffset==(3==o.nodeType?o.nodeValue:o.childNodes).length&&f.isBoundaryNode(o,"lastChild"))))return u.fireEvent("saveScene"),u.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"</p>",i.setStart(u.body.firstChild,0).setCursor(!1,!0),void u._selectionChange()}if(n==$.Backspace){if(i=u.selection.getRange(),m=i.collapsed,u.fireEvent("delkeydown",t))return;if(i.collapsed&&i.inFillChar()&&(l=i.startContainer,f.isFillChar(l)?(i.setStartBefore(l).shrinkBoundary(!0).collapse(!0),f.remove(l)):(l.nodeValue=l.nodeValue.replace(RegExp("^"+f.fillChar),""),i.startOffset--,i.collapse(!0).select(!0))),l=i.getClosedNode())return u.fireEvent("saveScene"),i.setStartBefore(l),f.remove(l),i.setCursor(),u.fireEvent("saveScene"),void f.preventDefault(t);if(!r.ie&&(l=f.findParentByTagName(i.startContainer,"table",!0),d=f.findParentByTagName(i.endContainer,"table",!0),l&&!d||!l&&d||l!==d))return void t.preventDefault()}if(n==$.Tab){var a={ol:1,ul:1,table:1};if(u.fireEvent("tabkeydown",t))return void f.preventDefault(t);i=u.selection.getRange(),u.fireEvent("saveScene");for(var o=0,s="",l=u.options.tabSize||4,d=u.options.tabNode||"&nbsp;";o<l;o++)s+=d;if((o=u.document.createElement("span")).innerHTML=s+f.fillChar,i.collapsed)i.insertNode(o.cloneNode(!0).firstChild).setCursor(!0);else if(s=function(e){return f.isBlockElm(e)&&!a[e.tagName.toLowerCase()]},l=f.findParent(i.startContainer,s,!0),d=f.findParent(i.endContainer,s,!0),l&&d&&l===d)i.deleteContents(),i.insertNode(o.cloneNode(!0).firstChild).setCursor(!0);else{l=i.createBookmark(),i.enlarge(!0),d=i.createBookmark();for(var c=f.getNextDomNode(d.start,!1,s);c&&!(f.getPosition(c,d.end)&f.POSITION_FOLLOWING);)c.insertBefore(o.cloneNode(!0).firstChild,c.firstChild),c=f.getNextDomNode(c,!1,s);i.moveToBookmark(d).moveToBookmark(l).select()}f.preventDefault(t)}if(r.gecko&&46==n&&((i=u.selection.getRange()).collapsed&&(l=i.startContainer,f.isEmptyBlock(l)))){for(n=l.parentNode;1==f.getChildCount(n)&&!f.isBody(n);)n=(l=n).parentNode;l===n.lastChild&&t.preventDefault()}}),u.addListener("keyup",function(e,t){var n,i;if((t.keyCode||t.which)==$.Backspace&&!this.fireEvent("delkeyup")){if((n=this.selection.getRange()).collapsed){if((i=f.findParentByTagName(n.startContainer,"h1 h2 h3 h4 h5 h6".split(" "),!0))&&f.isEmptyBlock(i)){t=i.previousSibling;if(t&&"TABLE"!=t.nodeName)return f.remove(i),void n.setStartAtLast(t).setCursor(!1,!0);if((t=i.nextSibling)&&"TABLE"!=t.nodeName)return f.remove(i),void n.setStartAtFirst(t).setCursor(!1,!0)}f.isBody(n.startContainer)&&(i=f.createElement(this.document,"p",{innerHTML:r.ie?f.fillChar:"<br/>"}),n.insertNode(i).setStart(i,0).setCursor(!1,!0))}!m&&(3==n.startContainer.nodeType||1==n.startContainer.nodeType&&f.isEmptyBlock(n.startContainer))&&(r.ie?(i=n.document.createElement("span"),n.insertNode(i).setStartBefore(i).collapse(!0),n.select(),f.remove(i)):n.select())}})},UE.plugins.fiximgclick=(BH=!1,CH=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]],AH.prototype={init:function(e){var t=this;t.editor=e,t.startPos=this.prePos={x:0,y:0},t.dragId=-1,e=[];var n=t.cover=document.createElement("div"),o=t.resizer=document.createElement("div");for(n.id=t.editor.ui.id+"_imagescale_cover",n.style.cssText="position:absolute;display:none;z-index:"+t.editor.options.zIndex+";filter:alpha(opacity=0); opacity:0;background:#CCC;",f.on(n,"mousedown click",function(){t.hide()}),i=0;i<8;i++)e.push('<span class="edui-editor-imagescale-hand'+i+'"></span>');o.id=t.editor.ui.id+"_imagescale",o.className="edui-editor-imagescale",o.innerHTML=e.join(""),o.style.cssText+=";display:none;border:1px solid #3b77ff;z-index:"+t.editor.options.zIndex+";",t.editor.ui.getDom().appendChild(n),t.editor.ui.getDom().appendChild(o),t.initStyle(),t.initEvents()},initStyle:function(){p.cssRule("imagescale",".edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},initEvents:function(){this.startPos.x=this.startPos.y=0,this.isDraging=!1},_eventHandler:function(e){switch(e.type){case"mousedown":var t=e.target||e.srcElement;-1!=t.className.indexOf("edui-editor-imagescale-hand")&&-1==this.dragId&&(this.dragId=t.className.slice(-1),this.startPos.x=this.prePos.x=e.clientX,this.startPos.y=this.prePos.y=e.clientY,f.on(this.doc,"mousemove",this.proxy(this._eventHandler,this)));break;case"mousemove":-1!=this.dragId&&(this.updateContainerStyle(this.dragId,{x:e.clientX-this.prePos.x,y:e.clientY-this.prePos.y}),this.prePos.x=e.clientX,this.prePos.y=e.clientY,BH=!0,this.updateTargetElement());break;case"mouseup":-1!=this.dragId&&(this.updateContainerStyle(this.dragId,{x:e.clientX-this.prePos.x,y:e.clientY-this.prePos.y}),this.updateTargetElement(),this.target.parentNode&&this.attachTo(this.target),this.dragId=-1),f.un(this.doc,"mousemove",this.proxy(this._eventHandler,this)),BH&&(BH=!1,this.editor.fireEvent("contentchange"))}},updateTargetElement:function(){f.setStyles(this.target,{width:this.resizer.style.width,height:this.resizer.style.height}),this.target.width=parseInt(this.resizer.style.width),this.target.height=parseInt(this.resizer.style.height),this.attachTo(this.target)},updateContainerStyle:function(e,t){var n,i=this.resizer;0!=CH[e][0]&&(n=parseInt(i.style.left)+t.x,i.style.left=this._validScaledProp("left",n)+"px"),0!=CH[e][1]&&(n=parseInt(i.style.top)+t.y,i.style.top=this._validScaledProp("top",n)+"px"),0!=CH[e][2]&&(n=i.clientWidth+CH[e][2]*t.x,i.style.width=this._validScaledProp("width",n)+"px"),0!=CH[e][3]&&(n=i.clientHeight+CH[e][3]*t.y,i.style.height=this._validScaledProp("height",n)+"px")},_validScaledProp:function(e,t){var n=this.resizer,i=document;switch(t=isNaN(t)?0:t,e){case"left":return t<0?0:t+n.clientWidth>i.clientWidth?i.clientWidth-n.clientWidth:t;case"top":return t<0?0:t+n.clientHeight>i.clientHeight?i.clientHeight-n.clientHeight:t;case"width":return t<=0?1:t+n.offsetLeft>i.clientWidth?i.clientWidth-n.offsetLeft:t;case"height":return t<=0?1:t+n.offsetTop>i.clientHeight?i.clientHeight-n.offsetTop:t}},hideCover:function(){this.cover.style.display="none"},showCover:function(){var e=f.getXY(this.editor.ui.getDom()),t=f.getXY(this.editor.iframe);f.setStyles(this.cover,{width:this.editor.iframe.offsetWidth+"px",height:this.editor.iframe.offsetHeight+"px",top:t.y-e.y+"px",left:t.x-e.x+"px",position:"absolute",display:""})},show:function(e){this.resizer.style.display="block",e&&this.attachTo(e),f.on(this.resizer,"mousedown",this.proxy(this._eventHandler,this)),f.on(this.doc,"mouseup",this.proxy(this._eventHandler,this)),this.showCover(),this.editor.fireEvent("afterscaleshow",this),this.editor.fireEvent("saveScene")},hide:function(){this.hideCover(),this.resizer.style.display="none",f.un(this.resizer,"mousedown",this.proxy(this._eventHandler,this)),f.un(this.doc,"mouseup",this.proxy(this._eventHandler,this)),this.editor.fireEvent("afterscalehide",this)},proxy:function(t,n){return function(e){return t.apply(n||this,arguments)}},attachTo:function(e){e=this.target=e;var t=this.resizer,n=f.getXY(e),i=f.getXY(this.editor.iframe),o=f.getXY(t.parentNode);f.setStyles(t,{width:e.width+"px",height:e.height+"px",left:i.x+n.x-this.editor.document.body.scrollLeft-o.x-parseInt(t.style.borderLeftWidth)+"px",top:i.y+n.y-this.editor.document.body.scrollTop-o.y-parseInt(t.style.borderTopWidth)+"px"})}},function(){var a,s=this;s.setOpt("imageScaleEnabled",!0),!r.ie&&s.options.imageScaleEnabled&&s.addListener("click",function(e,t){var n,i,o,r=s.selection.getRange().getClosedNode();r&&"IMG"==r.tagName&&"false"!=s.body.contentEditable?-1!=r.className.indexOf("edui-faked-music")||r.getAttribute("anchorname")||f.hasClass(r,"loadingclass")||f.hasClass(r,"loaderrorclass")||(a||((a=new AH).init(s),s.ui.getDom().appendChild(a.resizer),n=function(e){a.hide(),a.target&&s.selection.getRange().selectNode(a.target).select()},i=function(e){e=e.target||e.srcElement;!e||void 0!==e.className&&-1!=e.className.indexOf("edui-editor-imagescale")||n()},s.addListener("afterscaleshow",function(e){s.addListener("beforekeydown",n),s.addListener("beforemousedown",i),f.on(document,"keydown",n),f.on(document,"mousedown",i),s.selection.getNative().removeAllRanges()}),s.addListener("afterscalehide",function(e){s.removeListener("beforekeydown",n),s.removeListener("beforemousedown",i),f.un(document,"keydown",n),f.un(document,"mousedown",i),(e=a.target).parentNode&&s.selection.getRange().selectNode(e).select()}),f.on(a.resizer,"mousedown",function(e){s.selection.getNative().removeAllRanges();var t=e.target||e.srcElement;t&&-1==t.className.indexOf("edui-editor-imagescale-hand")&&(o=setTimeout(function(){a.hide(),a.target&&s.selection.getRange().selectNode(t).select()},200))}),f.on(a.resizer,"mouseup",function(e){(e=e.target||e.srcElement)&&-1==e.className.indexOf("edui-editor-imagescale-hand")&&clearTimeout(o)})),a.show(r)):a&&"none"!=a.resizer.style.display&&a.hide()}),r.webkit&&s.addListener("click",function(e,t){"IMG"==t.target.tagName&&"false"!=s.body.contentEditable&&new L.Range(s.document).selectNode(t.target).select()})}),UE.plugin.register("autolink",function(){return r.ie?{}:{bindEvents:{reset:function(){},keydown:function(e,t){if(32==(n=t.keyCode||t.which)||13==n){for(var n,i,o=(n=this.selection.getNative()).getRangeAt(0).cloneRange(),r=o.startContainer;1==r.nodeType&&0<o.startOffset&&(r=o.startContainer.childNodes[o.startOffset-1]);)o.setStart(r,(1==r.nodeType?r.childNodes:r.nodeValue).length),o.collapse(!0),r=o.startContainer;do{if(0==o.startOffset){for(r=o.startContainer.previousSibling;r&&1==r.nodeType;)r=r.lastChild;if(!r||f.isFillChar(r))break;i=r.nodeValue.length}else r=o.startContainer,i=o.startOffset}while(o.setStart(r,i-1),160!=(i=o.toString().charCodeAt(0))&&32!=i);if(o.toString().replace(RegExp(f.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){for(;o.toString().length&&!/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(o.toString());)try{o.setStart(o.startContainer,o.startOffset+1)}catch(e){for(r=o.startContainer;!(next=r.nextSibling);){if(f.isBody(r))return;r=r.parentNode}o.setStart(next,0)}f.findParentByTagName(o.startContainer,"a",!0)||(i=this.document.createElement("a"),r=this.document.createTextNode(" "),this.undoManger&&this.undoManger.save(),i.appendChild(o.extractContents()),i.href=i.innerHTML=i.innerHTML.replace(/<[^>]+>/g,""),t=i.getAttribute("href").replace(RegExp(f.fillChar,"g"),""),t=/^(?:https?:\/\/)/gi.test(t)?t:"http://"+t,i.setAttribute("_src",p.html(t)),i.href=p.html(t),o.insertNode(i),i.parentNode.insertBefore(r,i.nextSibling),o.setStart(r,0),o.collapse(!0),n.removeAllRanges(),n.addRange(o),this.undoManger&&this.undoManger.save())}}}}}},function(){var o={37:1,38:1,39:1,40:1,13:1,32:1};r.ie&&this.addListener("keyup",function(e,t){var n=t.keyCode;if(o[n]){var t=this.selection.getRange(),i=t.startContainer;if(13==n){for(;i&&!f.isBody(i)&&!f.isBlockElm(i);)i=i.parentNode;i&&!f.isBody(i)&&"P"==i.nodeName&&(t=i.previousSibling)&&1==t.nodeType&&(t=function(e){if(3==e.nodeType)return null;if("A"==e.nodeName)return e;for(e=e.lastChild;e;){if("A"==e.nodeName)return e;if(3==e.nodeType){if(f.isWhitespace(e)){e=e.previousSibling;continue}return null}e=e.lastChild}}(t))&&!t.getAttribute("_href")&&f.remove(t,!0)}else 32==n?3==i.nodeType&&/^\s$/.test(i.nodeValue)&&(i=i.previousSibling)&&"A"==i.nodeName&&!i.getAttribute("_href")&&f.remove(i,!0):(i=f.findParentByTagName(i,"a",!0))&&!i.getAttribute("_href")&&(n=t.createBookmark(),f.remove(i,!0),t.moveToBookmark(n).select(!0))}})}),UE.plugins.autoheight=function(){function n(){var t=this;clearTimeout(e),l||t.queryCommandState&&(!t.queryCommandState||1==t.queryCommandState("source"))||(e=setTimeout(function(){for(var e=t.body.lastChild;e&&1!=e.nodeType;)e=e.previousSibling;e&&1==e.nodeType&&(e.style.clear="both",(s=Math.max(f.getXY(e).y+e.offsetHeight+25,Math.max(a.minFrameHeight,a.initialFrameHeight)))!=o&&(s!==parseInt(t.iframe.parentNode.style.height)&&(t.iframe.parentNode.style.height=s+"px"),t.body.style.height=s+"px",o=s),f.removeStyle(e,"clear"))},50))}var i,o,a,s,e,l,d=this;d.autoHeightEnabled=!1!==d.options.autoHeightEnabled,d.autoHeightEnabled&&(o=0,a=d.options,d.addListener("fullscreenchanged",function(e,t){l=t}),d.addListener("destroy",function(){d.removeListener("contentchange afterinserthtml keyup mouseup",n)}),d.enableAutoHeight=function(){var e,t=this;t.autoHeightEnabled&&(e=t.document,t.autoHeightEnabled=!0,i=e.body.style.overflowY,e.body.style.overflowY="hidden",t.addListener("contentchange afterinserthtml keyup mouseup",n),setTimeout(function(){n.call(t)},r.gecko?100:0),t.fireEvent("autoheightchanged",t.autoHeightEnabled))},d.disableAutoHeight=function(){d.body.style.overflowY=i||"",d.removeListener("contentchange",n),d.removeListener("keyup",n),d.removeListener("mouseup",n),d.autoHeightEnabled=!1,d.fireEvent("autoheightchanged",d.autoHeightEnabled)},d.on("setHeight",function(){d.disableAutoHeight()}),d.addListener("ready",function(){var e,t;d.enableAutoHeight(),f.on(r.ie?d.body:d.document,r.webkit?"dragover":"drop",function(){clearTimeout(e),e=setTimeout(function(){n.call(d)},100)}),window.onscroll=function(){null===t?t=this.scrollY:0==this.scrollY&&0!=t&&(d.window.scrollTo(0,0),t=null)}}))},UE.plugins.autofloat=function(){function i(){g=!0,c.parentNode&&c.parentNode.removeChild(c),u.style.cssText=d}function n(){var e,t=h(o.container),n=o.options.toolbarTopOffset||0;t.top<0&&t.bottom-u.offsetHeight>n?(t=f.getXY(u),n=f.getComputedStyle(u,"position"),e=f.getComputedStyle(u,"left"),u.style.width=u.offsetWidth+"px",u.style.zIndex=+o.options.zIndex+1,u.parentNode.insertBefore(c,u),s||l&&r.ie?("absolute"!=u.style.position&&(u.style.position="absolute"),u.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-m+v+"px"):(r.ie7Compat&&g&&(g=!1,u.style.left=f.getXY(u).x-document.documentElement.getBoundingClientRect().left+2+"px"),"fixed"!=u.style.position&&(u.style.position="fixed",u.style.top=v+"px","absolute"!=n&&"relative"!=n||!parseFloat(e)||(u.style.left=t.x+"px")))):i()}var o=this,t=o.getLang();o.setOpt({topOffset:0});var a,s,l,d,c,u,m,h,g,b,v=o.options.topOffset;!1!==o.options.autoFloatEnabled&&(a=UE.ui.uiUtils,s=r.ie&&r.version<=6,l=r.quirks,c=document.createElement("div"),g=!0,b=p.defer(function(){n()},r.ie?200:100,!0),o.addListener("destroy",function(){f.un(window,["scroll","resize"],n),o.removeListener("keydown",b)}),o.addListener("ready",function(){var e=UE.ui?1:(alert(t.autofloatMsg),0);e&&o.ui&&(h=a.getClientRect,u=o.ui.getDom("toolbarbox"),m=h(u).top,d=u.style.cssText,c.style.height=u.offsetHeight+"px",s&&((e=document.body.style).backgroundImage='url("about:blank")',e.backgroundAttachment="fixed"),f.on(window,["scroll","resize"],n),o.addListener("keydown",b),o.addListener("beforefullscreenchange",function(e,t){t&&i()}),o.addListener("fullscreenchanged",function(e,t){t||n()}),o.addListener("sourcemodechanged",function(e,t){setTimeout(function(){n()},0)}),o.addListener("clearDoc",function(){setTimeout(function(){n()},0)}))}))},UE.plugins.video=function(){function s(e,t,n,i,o,r,a){var s;switch(a){case"image":s="<img "+(i?'id="'+i+'"':"")+' width="'+t+'" height="'+n+'" _url="'+e+'" class="'+r.replace(/\bvideo-js\b/,"")+'" src="'+l.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+l.options.UEDITOR_HOME_URL+"themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;"+(o?"float:"+o+";":"")+'" />';break;case"embed":s='<embed type="application/x-shockwave-flash" class="'+r+'" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+p.html(e)+'" width="'+t+'" height="'+n+'"'+(o?' style="float:'+o+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >';break;case"video":"ogv"==(a=e.substr(e.lastIndexOf(".")+1))&&(a="ogg"),s="<video"+(i?' id="'+i+'"':"")+' class="'+r+' video-js" '+(o?' style="float:'+o+'"':"")+' controls preload="none" width="'+t+'" height="'+n+'" src="'+e+'" data-setup="{}"><source src="'+e+'" type="video/'+a+'" /></video>'}return s}function t(e,i){p.each(e.getNodesByTagName(i?"img":"embed video"),function(e){var t,n=e.getAttr("class");n&&-1!=n.indexOf("edui-faked-video")&&(t=s(i?e.getAttr("_url"):e.getAttr("src"),e.getAttr("width"),e.getAttr("height"),null,e.getStyle("float")||"",n,i?"embed":"image"),e.parentNode.replaceChild(UE.uNode.createElement(t),e)),n&&-1!=n.indexOf("edui-upload-video")&&(t=s(i?e.getAttr("_url"):e.getAttr("src"),e.getAttr("width"),e.getAttr("height"),null,e.getStyle("float")||"",n,i?"video":"image"),e.parentNode.replaceChild(UE.uNode.createElement(t),e))})}var l=this;l.addOutputRule(function(e){t(e,!0)}),l.addInputRule(function(e){t(e)}),l.commands.insertvideo={execCommand:function(e,t,n){var i,o=[];e=0;for(var r,a=(t=p.isArray(t)?t:[t]).length;e<a;e++)r=t[e],i="upload"==n?"edui-upload-video video-js vjs-default-skin":"edui-faked-video",o.push(s(r.url,r.width||420,r.height||280,"tmpVedio"+e,null,i,"image"));for(l.execCommand("inserthtml",o.join(""),!0),n=this.selection.getRange(),e=0,a=t.length;e<a;e++)o=this.document.getElementById("tmpVedio"+e),f.removeAttributes(o,"id"),n.selectNode(o).select(),l.execCommand("imagefloat",t[e].align)},queryCommandState:function(){var e=l.selection.getRange().getClosedNode();return!e||"edui-faked-video"!=e.className&&-1==e.className.indexOf("edui-upload-video")?0:1}}},XJ=UE.UETable=function(e){this.table=e,this.indexTable=[],this.selectedTds=[],this.cellsRange={},this.update(e)},XJ.removeSelectedClass=function(e){p.each(e,function(e){f.removeClasses(e,"selectTdClass")})},XJ.addSelectedClass=function(e){p.each(e,function(e){f.addClass(e,"selectTdClass")})},XJ.isEmptyBlock=function(e){var t,n=RegExp(f.fillChar,"g");if(0<e[r.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(n,"").length)return 0;for(t in v.$isNotEmpty)if(v.$isNotEmpty.hasOwnProperty(t)&&e.getElementsByTagName(t).length)return 0;return 1},XJ.getWidth=function(e){return e?parseInt(f.getComputedStyle(e,"width"),10):0},XJ.getTableCellAlignState=function(e){p.isArray(e)||(e=[e]);var n,i={},o=["align","valign"],r=!0;return p.each(e,function(t){return p.each(o,function(e){if(n=t.getAttribute(e),!i[e]&&n)i[e]=n;else if(!i[e]||n!==i[e])return r=!1}),r}),r?i:null},XJ.getTableItemsByRange=function(e){var t=e.selection.getStart();t&&t.id&&0===t.id.indexOf("_baidu_bookmark_start_")&&t.nextSibling&&(t=t.nextSibling);var n=(e=t&&f.findParentByTagName(t,["td","th"],!0))&&e.parentNode;return{cell:e,tr:n,table:(t=t&&f.findParentByTagName(t,"caption",!0))?t.parentNode:n&&n.parentNode.parentNode,caption:t}},XJ.getUETableBySelected=function(e){return(e=XJ.getTableItemsByRange(e).table)&&e.ueTable&&e.ueTable.selectedTds.length?e.ueTable:null},XJ.getDefaultValue=function(e,t){var n,i,o,r,a={thin:"0px",medium:"1px",thick:"2px"};return t?(i=t.getElementsByTagName("td")[0],o=f.getComputedStyle(t,"border-left-width"),r=parseInt(a[o]||o,10),o=f.getComputedStyle(i,"padding-left"),n=parseInt(a[o]||o,10),o=f.getComputedStyle(i,"border-left-width"),a=parseInt(a[o]||o,10)):((t=e.document.createElement("table")).insertRow(0).insertCell(0).innerHTML="xxx",e.body.appendChild(t),i=t.getElementsByTagName("td")[0],o=f.getComputedStyle(t,"border-left-width"),r=parseInt(a[o]||o,10),o=f.getComputedStyle(i,"padding-left"),n=parseInt(a[o]||o,10),o=f.getComputedStyle(i,"border-left-width"),a=parseInt(a[o]||o,10),f.remove(t)),{tableBorder:r,tdPadding:n,tdBorder:a}},XJ.getUETable=function(e){var t=e.tagName.toLowerCase();return(e="td"==t||"th"==t||"caption"==t?f.findParentByTagName(e,"table",!0):e).ueTable||(e.ueTable=new XJ(e)),e.ueTable},XJ.cloneCell=function(e,t,n){if(!e||p.isString(e))return this.table.ownerDocument.createElement(e||"td");var i=f.hasClass(e,"selectTdClass");i&&f.removeClasses(e,"selectTdClass");var o=e.cloneNode(!0);return t&&(o.rowSpan=o.colSpan=1),n||f.removeAttributes(o,"width height"),n||f.removeAttributes(o,"style"),o.style.borderLeftStyle="",o.style.borderTopStyle="",o.style.borderLeftColor=e.style.borderRightColor,o.style.borderLeftWidth=e.style.borderRightWidth,o.style.borderTopColor=e.style.borderBottomColor,o.style.borderTopWidth=e.style.borderBottomWidth,i&&f.addClass(e,"selectTdClass"),o},XJ.prototype={getMaxRows:function(){for(var e,t=this.table.rows,n=1,i=0;e=t[i];i++){for(var o,r=1,a=0;o=e.cells[a++];)r=Math.max(o.rowSpan||1,r);n=Math.max(r+i,n)}return n},getMaxCols:function(){for(var e,t=this.table.rows,n=0,i={},o=0;e=t[o];o++){for(var r,a=0,s=0;r=e.cells[s++];)if(a+=r.colSpan||1,r.rowSpan&&1<r.rowSpan)for(var l=1;l<r.rowSpan;l++)i["row_"+(o+l)]?i["row_"+(o+l)]++:i["row_"+(o+l)]=r.colSpan||1;a+=i["row_"+o]||0,n=Math.max(a,n)}return n},getCellColIndex:function(e){},getHSideCell:function(e,t){try{var n,i=this.getCellInfo(e),o=this.selectedTds.length,r=this.cellsRange;return!t&&(o?!r.beginColIndex:!i.colIndex)||t&&(o?r.endColIndex==this.colsNum-1:i.colIndex==this.colsNum-1)?null:(n=o?r.beginRowIndex:i.rowIndex,i=t?o?r.endColIndex+1:i.colIndex+1:o?r.beginColIndex-1:i.colIndex<1?0:i.colIndex-1,this.getCell(this.indexTable[n][i].rowIndex,this.indexTable[n][i].cellIndex))}catch(e){}},getTabNextCell:function(e,t){var n,i=this.getCellInfo(e),o=t||i.rowIndex,i=i.colIndex+1+(i.colSpan-1);try{n=this.getCell(this.indexTable[o][i].rowIndex,this.indexTable[o][i].cellIndex)}catch(e){try{o=+o+1,i=0,n=this.getCell(this.indexTable[o][i].rowIndex,this.indexTable[o][i].cellIndex)}catch(e){}}return n},getVSideCell:function(e,t,n){try{var i,o=this.getCellInfo(e),r=this.selectedTds.length&&!n,a=this.cellsRange;return!t&&0==o.rowIndex||t&&(r?a.endRowIndex==this.rowsNum-1:o.rowIndex+o.rowSpan>this.rowsNum-1)?null:(i=t?r?a.endRowIndex+1:o.rowIndex+o.rowSpan:r?a.beginRowIndex-1:o.rowIndex-1,o=r?a.beginColIndex:o.colIndex,this.getCell(this.indexTable[i][o].rowIndex,this.indexTable[i][o].cellIndex))}catch(e){}},getSameEndPosCells:function(e,t){try{for(var n="x"===t.toLowerCase(),i=f.getXY(e)[n?"x":"y"]+e["offset"+(n?"Width":"Height")],o=this.table.rows,r=[],a=0;a<this.rowsNum;a++)for(var s,l=o[a].cells,d=0;s=l[d++];){var c=f.getXY(s)[n?"x":"y"]+s["offset"+(n?"Width":"Height")];if(i<c&&n)break;if((e==s||i==c)&&(1==s[n?"colSpan":"rowSpan"]&&r.push(s),n))break}return r}catch(e){}},setCellContent:function(e,t){e.innerHTML=t||(r.ie?f.fillChar:"<br />")},cloneCell:XJ.cloneCell,getSameStartPosXCells:function(e){try{var t,n=f.getXY(e).x+e.offsetWidth,i=this.table.rows;e=[];for(var o=0;o<this.rowsNum;o++){t=i[o].cells;for(var r,a=0;r=t[a++];){var s=f.getXY(r).x;if(n<s)break;if(s==n&&1==r.colSpan){e.push(r);break}}}return e}catch(e){}},update:function(e){this.table=e||this.table,this.selectedTds=[],this.cellsRange={},this.indexTable=[],e=this.table.rows;for(var t=this.getMaxRows(),n=t-e.length,i=this.getMaxCols();n--;)this.table.insertRow(e.length);this.rowsNum=t,this.colsNum=i;for(var n=0,o=e.length;n<o;n++)this.indexTable[n]=Array(i);for(n=0;r=e[n];n++)for(var o=0,r=r.cells;l=r[o];o++){l.rowSpan>t&&(l.rowSpan=t);for(var a=o,s=l.rowSpan||1,l=l.colSpan||1;this.indexTable[n][a];)a++;for(var d=0;d<s;d++)for(var c=0;c<l;c++)this.indexTable[n+d][a+c]={rowIndex:n,cellIndex:o,colIndex:a,rowSpan:s,colSpan:l}}for(d=0;d<t;d++)for(c=0;c<i;c++)void 0===this.indexTable[d][c]&&(l=(l=(r=e[d]).cells[r.cells.length-1])?l.cloneNode(!0):this.table.ownerDocument.createElement("td"),this.setCellContent(l),1!==l.colSpan&&(l.colSpan=1),1!==l.rowSpan&&(l.rowSpan=1),r.appendChild(l),this.indexTable[d][c]={rowIndex:d,cellIndex:l.cellIndex,colIndex:c,rowSpan:1,colSpan:1});e=f.getElementsByTagName(this.table,"td");var u=[];if(p.each(e,function(e){f.hasClass(e,"selectTdClass")&&u.push(e)}),u.length&&(t=u[u.length-1],e=this.getCellInfo(u[0]),t=this.getCellInfo(t),this.selectedTds=u,this.cellsRange={beginRowIndex:e.rowIndex,beginColIndex:e.colIndex,endRowIndex:t.rowIndex+t.rowSpan-1,endColIndex:t.colIndex+t.colSpan-1}),!f.hasClass(this.table.rows[0],"firstRow"))for(f.addClass(this.table.rows[0],"firstRow"),n=1;n<this.table.rows.length;n++)f.removeClasses(this.table.rows[n],"firstRow")},getCellInfo:function(e){if(e){var t=e.cellIndex;e=e.parentNode.rowIndex;for(var n=this.indexTable[e],i=this.colsNum,o=t;o<i;o++){var r=n[o];if(r.rowIndex===e&&r.cellIndex===t)return r}}},getCell:function(e,t){return e<this.rowsNum&&this.table.rows[e].cells[t]||null},deleteCell:function(e,t){t="number"==typeof t?t:e.parentNode.rowIndex,this.table.rows[t].deleteCell(e.cellIndex)},getCellsRange:function(e,t){try{var f=this,n=f.getCellInfo(e);if(e===t)return{beginRowIndex:n.rowIndex,beginColIndex:n.colIndex,endRowIndex:n.rowIndex+n.rowSpan-1,endColIndex:n.colIndex+n.colSpan-1};var i=f.getCellInfo(t);return function e(t,n,i,o){var r,a,s,l=t,d=n,c=i,u=o;if(0<t)for(a=n;a<o;a++)(s=(r=f.indexTable[t][a]).rowIndex)<t&&(l=Math.min(s,l));if(o<f.colsNum)for(s=t;s<i;s++)o<(a=(r=f.indexTable[s][o]).colIndex+r.colSpan-1)&&(u=Math.max(a,u));if(i<f.rowsNum)for(a=n;a<o;a++)i<(s=(r=f.indexTable[i][a]).rowIndex+r.rowSpan-1)&&(c=Math.max(s,c));if(0<n)for(s=t;s<i;s++)(a=(r=f.indexTable[s][n]).colIndex)<n&&(d=Math.min(r.colIndex,d));return l!=t||d!=n||c!=i||u!=o?e(l,d,c,u):{beginRowIndex:t,beginColIndex:n,endRowIndex:i,endColIndex:o}}(Math.min(n.rowIndex,i.rowIndex),Math.min(n.colIndex,i.colIndex),Math.max(n.rowIndex+n.rowSpan-1,i.rowIndex+i.rowSpan-1),Math.max(n.colIndex+n.colSpan-1,i.colIndex+i.colSpan-1))}catch(e){}},getCells:function(e){this.clearSelected();for(var t,n,i=e.beginColIndex,o=e.endRowIndex,r=e.endColIndex,a={},s=[],l=e.beginRowIndex;l<=o;l++)for(var d=i;d<=r;d++){var c=(t=(e=this.indexTable[l][d]).rowIndex)+"|"+(n=e.colIndex);if(!a[c]){if(a[c]=1,t<l||n<d||t+e.rowSpan-1>o||n+e.colSpan-1>r)return null;s.push(this.getCell(t,e.cellIndex))}}return s},clearSelected:function(){XJ.removeSelectedClass(this.selectedTds),this.selectedTds=[],this.cellsRange={}},setSelected:function(e){var t=this.getCells(e);XJ.addSelectedClass(t),this.selectedTds=t,this.cellsRange=e},isFullRow:function(){var e=this.cellsRange;return e.endColIndex-e.beginColIndex+1==this.colsNum},isFullCol:function(){var e=this.cellsRange,t=this.table.getElementsByTagName("th"),e=e.endRowIndex-e.beginRowIndex+1;return t.length?e==this.rowsNum||e==this.rowsNum-1:e==this.rowsNum},getNextCell:function(e,t,n){try{var i,o=this.getCellInfo(e),r=this.selectedTds.length&&!n,a=this.cellsRange;return!t&&0==o.rowIndex||t&&(r?a.endRowIndex==this.rowsNum-1:o.rowIndex+o.rowSpan>this.rowsNum-1)?null:(i=t?r?a.endRowIndex+1:o.rowIndex+o.rowSpan:r?a.beginRowIndex-1:o.rowIndex-1,o=r?a.beginColIndex:o.colIndex,this.getCell(this.indexTable[i][o].rowIndex,this.indexTable[i][o].cellIndex))}catch(e){}},getPreviewCell:function(e,t){try{var n,i=this.getCellInfo(e),o=this.selectedTds.length,r=this.cellsRange;return!t&&(o?!r.beginColIndex:!i.colIndex)||t&&(o?r.endColIndex==this.colsNum-1:i.rowIndex>this.colsNum-1)?null:(n=t?o?r.beginRowIndex:i.rowIndex<1?0:i.rowIndex-1:o?r.beginRowIndex:i.rowIndex,i=t?o?r.endColIndex+1:i.colIndex:o?r.beginColIndex-1:i.colIndex<1?0:i.colIndex-1,this.getCell(this.indexTable[n][i].rowIndex,this.indexTable[n][i].cellIndex))}catch(e){}},moveContent:function(e,t){if(!XJ.isEmptyBlock(t))if(XJ.isEmptyBlock(e))e.innerHTML=t.innerHTML;else{var n=e.lastChild;for(3!=n.nodeType&&v.$block[n.tagName]||e.appendChild(e.ownerDocument.createElement("br"));n=t.firstChild;)e.appendChild(n)}},mergeRight:function(e){var t=this.getCellInfo(e),n=this.indexTable[t.rowIndex][t.colIndex+t.colSpan],i=this.getCell(n.rowIndex,n.cellIndex);e.colSpan=t.colSpan+n.colSpan,e.removeAttribute("width"),this.moveContent(e,i),this.deleteCell(i,n.rowIndex),this.update()},mergeDown:function(e){var t=this.getCellInfo(e),n=this.indexTable[t.rowIndex+t.rowSpan][t.colIndex],i=this.getCell(n.rowIndex,n.cellIndex);e.rowSpan=t.rowSpan+n.rowSpan,e.removeAttribute("height"),this.moveContent(e,i),this.deleteCell(i,n.rowIndex),this.update()},mergeRange:function(){var e=this.cellsRange,t=this.getCell(e.beginRowIndex,this.indexTable[e.beginRowIndex][e.beginColIndex].cellIndex);"TH"==t.tagName&&e.endRowIndex!==e.beginRowIndex&&(o=this.indexTable,e=this.getCellInfo(t),t=this.getCell(1,o[1][e.colIndex].cellIndex),e=this.getCellsRange(t,this.getCell(o[this.rowsNum-1][e.colIndex].rowIndex,o[this.rowsNum-1][e.colIndex].cellIndex)));for(var n,i=this.getCells(e),o=0;n=i[o++];)n!==t&&(this.moveContent(t,n),this.deleteCell(n));if(t.rowSpan=e.endRowIndex-e.beginRowIndex+1,1<t.rowSpan&&t.removeAttribute("height"),t.colSpan=e.endColIndex-e.beginColIndex+1,1<t.colSpan&&t.removeAttribute("width"),t.rowSpan==this.rowsNum&&1!=t.colSpan&&(t.colSpan=1),t.colSpan==this.colsNum&&1!=t.rowSpan){if(i=t.parentNode.rowIndex,this.table.deleteRow)for(o=i+1,i+=1,e=t.rowSpan;o<e;o++)this.table.deleteRow(i);else for(o=0,e=t.rowSpan-1;o<e;o++)(n=this.table.rows[i+1]).parentNode.removeChild(n);t.rowSpan=1}this.update()},insertRow:function(e,t){function n(e,t,n){0==e?"TH"==(e=(n.nextSibling||n.previousSibling).cells[e]).tagName&&((e=t.ownerDocument.createElement("th")).appendChild(t.firstChild),n.insertBefore(e,t),f.remove(t)):"TH"==t.tagName&&((e=t.ownerDocument.createElement("td")).appendChild(t.firstChild),n.insertBefore(e,t),f.remove(t))}var i,o=this.colsNum,r=this.table.insertRow(e),a="string"==typeof t&&"TH"==t.toUpperCase();if(0==e||e==this.rowsNum)for(var s=0;s<o;s++)i=this.cloneCell(t,!0),this.setCellContent(i),i.getAttribute("vAlign")&&i.setAttribute("vAlign",i.getAttribute("vAlign")),r.appendChild(i),a||n(s,i,r);else for(var l=this.indexTable[e],s=0;s<o;s++){var d=l[s];d.rowIndex<e?(i=this.getCell(d.rowIndex,d.cellIndex)).rowSpan=d.rowSpan+1:(i=this.cloneCell(t,!0),this.setCellContent(i),r.appendChild(i)),a||n(s,i,r)}return this.update(),r},deleteRow:function(e){for(var t=this.table.rows[e],n=this.indexTable[e],i=this.colsNum,o=0,r=0;r<i;){var a,s,l=n[r],d=this.getCell(l.rowIndex,l.cellIndex);1<d.rowSpan&&l.rowIndex==e&&((l=d.cloneNode(!0)).rowSpan=d.rowSpan-1,l.innerHTML="",s=e+(d.rowSpan=1),a=this.table.rows[s],(s=this.getPreviewMergedCellsNum(s,r)-o)<r?(s=r-s-1,f.insertAfter(a.cells[s],l)):a.cells.length&&a.insertBefore(l,a.cells[0]),o+=1),r+=d.colSpan||1}for(e=[],o={},r=0;r<i;r++)o[a=(d=n[r].rowIndex)+"_"+(l=n[r].cellIndex)]||(o[a]=1,d=this.getCell(d,l),e.push(d));var c=[];p.each(e,function(e){1==e.rowSpan?e.parentNode.removeChild(e):c.push(e)}),p.each(c,function(e){e.rowSpan--}),t.parentNode.removeChild(t),this.update()},insertCol:function(e,t,n){function i(e,t,n){0==e?"TH"==(e=t.nextSibling||t.previousSibling).tagName&&((e=t.ownerDocument.createElement("th")).appendChild(t.firstChild),n.insertBefore(e,t),f.remove(t)):"TH"==t.tagName&&((e=t.ownerDocument.createElement("td")).appendChild(t.firstChild),n.insertBefore(e,t),f.remove(t))}var o,r,a,s=this.rowsNum,l=0,d=parseInt((this.table.offsetWidth-20*(this.colsNum+1)-(this.colsNum+1))/(this.colsNum+1),10),c="string"==typeof t&&"TH"==t.toUpperCase();if(0==e||e==this.colsNum)for(;l<s;l++)a=(o=this.table.rows[l]).cells[0==e?e:o.cells.length],r=this.cloneCell(t,!0),this.setCellContent(r),r.setAttribute("vAlign",r.getAttribute("vAlign")),a&&r.setAttribute("width",a.getAttribute("width")),e?f.insertAfter(o.cells[o.cells.length-1],r):o.insertBefore(r,o.cells[0]),c||i(l,r,o);else for(;l<s;l++)(a=this.indexTable[l][e]).colIndex<e?(r=this.getCell(a.rowIndex,a.cellIndex)).colSpan=a.colSpan+1:(a=(o=this.table.rows[l]).cells[a.cellIndex],r=this.cloneCell(t,!0),this.setCellContent(r),r.setAttribute("vAlign",r.getAttribute("vAlign")),a&&r.setAttribute("width",a.getAttribute("width")),a?o.insertBefore(r,a):o.appendChild(r)),c||i(l,r,o);this.update(),this.updateWidth(d,n||{tdPadding:10,tdBorder:1})},updateWidth:function(t,e){var n=this.table,e=XJ.getWidth(n)-2*e.tdPadding-e.tdBorder+t;e<n.ownerDocument.body.offsetWidth?n.setAttribute("width",e):(n=f.getElementsByTagName(this.table,"td th"),p.each(n,function(e){e.setAttribute("width",t)}))},deleteCol:function(e){for(var t=this.indexTable,n=this.table.rows,i=this.table.getAttribute("width"),o=0,r=this.rowsNum,a={},s=0;s<r;){var l=t[s][e],d=l.rowIndex+"_"+l.colIndex;a[d]||(a[d]=1,d=this.getCell(l.rowIndex,l.cellIndex),o=o||d&&parseInt(d.offsetWidth/d.colSpan,10).toFixed(0),1<d.colSpan?d.colSpan--:n[s].deleteCell(l.cellIndex),s+=l.rowSpan||1)}this.table.setAttribute("width",i-o),this.update()},splitToCells:function(e){var t=this;e=this.splitToRows(e),p.each(e,function(e){t.splitToCols(e)})},splitToRows:function(e){var t=this.getCellInfo(e),n=t.rowIndex,i=t.colIndex,o=[];e.rowSpan=1,o.push(e);for(var r,a=n,s=n+t.rowSpan;a<s;a++)a!=n&&((r=this.table.rows[a].insertCell(i-this.getPreviewMergedCellsNum(a,i))).colSpan=t.colSpan,this.setCellContent(r),r.setAttribute("vAlign",e.getAttribute("vAlign")),r.setAttribute("align",e.getAttribute("align")),e.style.cssText&&(r.style.cssText=e.style.cssText),o.push(r));return this.update(),o},getPreviewMergedCellsNum:function(e,t){for(var n=this.indexTable[e],i=0,o=0;o<t;)var r=n[o].colSpan,i=i+(r-(n[o].rowIndex==e?1:0)),o=o+r;return i},splitToCols:function(e){var t=(e.offsetWidth/e.colSpan-22).toFixed(0),n=this.getCellInfo(e),i=n.rowIndex,o=n.colIndex,r=[];e.colSpan=1,e.setAttribute("width",t),r.push(e);for(var a,s,l,d=o,c=o+n.colSpan;d<c;d++)d!=o&&((s=(a=this.table.rows[i]).insertCell(this.indexTable[i][d].cellIndex+1)).rowSpan=n.rowSpan,this.setCellContent(s),s.setAttribute("vAlign",e.getAttribute("vAlign")),s.setAttribute("align",e.getAttribute("align")),s.setAttribute("width",t),e.style.cssText&&(s.style.cssText=e.style.cssText),"TH"==e.tagName&&((l=e.ownerDocument.createElement("th")).appendChild(s.firstChild),l.setAttribute("vAlign",e.getAttribute("vAlign")),l.rowSpan=s.rowSpan,a.insertBefore(l,s),f.remove(s)),r.push(s));return this.update(),r},isLastCell:function(e,t,n){return t=t||this.rowsNum,n=n||this.colsNum,(e=this.getCellInfo(e)).rowIndex+e.rowSpan==t&&e.colIndex+e.colSpan==n},getLastCell:function(e){e=e||this.table.getElementsByTagName("td"),this.getCellInfo(e[0]);var t,n=this,i=e[0],o=i.parentNode,r=0,a=0;return p.each(e,function(e){e.parentNode==o&&(a+=e.colSpan||1),r+=e.rowSpan*e.colSpan||1}),t=r/a,p.each(e,function(e){if(n.isLastCell(e,t,a))return i=e,!1}),i},selectRow:function(e){var t=this.indexTable[e];e=this.getCell(t[0].rowIndex,t[0].cellIndex),t=this.getCell(t[this.colsNum-1].rowIndex,t[this.colsNum-1].cellIndex),e=this.getCellsRange(e,t),this.setSelected(e)},selectTable:function(){var e=this.table.getElementsByTagName("td"),e=this.getCellsRange(e[0],e[e.length-1]);this.setSelected(e)},setBackground:function(e,t){if("string"==typeof t)p.each(e,function(e){e.style.backgroundColor=t});else if("object"==typeof t){t=p.extend({repeat:!0,colorList:["#ddd","#fff"]},t);for(var n,i=this.getCellInfo(e[0]).rowIndex,o=0,r=t.colorList,a=0;n=e[a++];){var s=this.getCellInfo(n);n.style.backgroundColor=(l=r,d=i+o==s.rowIndex?o:++o,c=t.repeat,l[d]||(c?l[d%l.length]:""))}}var l,d,c},removeBackground:function(e){p.each(e,function(e){e.style.backgroundColor=""})}},JP=UE.UETable,UE.commands.inserttable={queryCommandState:function(){return KP(this).table?-1:0},execCommand:function(e,t){t=t||p.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign});var n=this.selection.getRange().startContainer,n=f.findParent(n,function(e){return f.isBlockElm(e)},!0)||this.body,i=JP.getDefaultValue(this,void 0),n=Math.floor(n.offsetWidth/t.numCols-2*i.tdPadding-i.tdBorder);t.tdvalign||(t.tdvalign=this.options.tdvalign),this.execCommand("inserthtml",function(e,t){for(var n=[],i=e.numRows,o=e.numCols,a=0;a<i;a++){n.push("<tr"+(0==a?' class="firstRow"':"")+">");for(var s=0;s<o;s++)n.push('<td width="'+t+'"  vAlign="'+e.tdvalign+'" >'+(r.ie&&r.version<11?f.fillChar:"<br/>")+"</td>");n.push("</tr>")}return"<table><tbody>"+n.join("")+"</tbody></table>"}(t,n))}},UE.commands.insertparagraphbeforetable={queryCommandState:function(){return KP(this).cell?0:-1},execCommand:function(){var e,t=KP(this).table;t&&((e=this.document.createElement("p")).innerHTML=r.ie?"&nbsp;":"<br />",t.parentNode.insertBefore(e,t),this.selection.getRange().setStart(e,0).setCursor())}},UE.commands.deletetable={queryCommandState:function(){var e=this.selection.getRange();return f.findParentByTagName(e.startContainer,"table",!0)?0:-1},execCommand:function(e,t){var n,i=this.selection.getRange();(t=t||f.findParentByTagName(i.startContainer,"table",!0))&&((n=t.nextSibling)||(n=f.createElement(this.document,"p",{innerHTML:r.ie?f.fillChar:"<br/>"}),t.parentNode.insertBefore(n,t)),f.remove(t),i=this.selection.getRange(),3==n.nodeType?i.setStartBefore(n):i.setStart(n,0),i.setCursor(!1,!0),this.fireEvent("tablehasdeleted"))}},UE.commands.cellalign={queryCommandState:function(){return IP(this).length?0:-1},execCommand:function(e,t){var n=IP(this);if(n.length)for(var i,o=0;i=n[o++];)i.setAttribute("align",t)}},UE.commands.cellvalign={queryCommandState:function(){return IP(this).length?0:-1},execCommand:function(e,t){var n=IP(this);if(n.length)for(var i,o=0;i=n[o++];)i.setAttribute("vAlign",t)}},UE.commands.insertcaption={queryCommandState:function(){var e=KP(this).table;return e&&0==e.getElementsByTagName("caption").length?1:-1},execCommand:function(){var e,t=KP(this).table;t&&((e=this.document.createElement("caption")).innerHTML=r.ie?f.fillChar:"<br/>",t.insertBefore(e,t.firstChild),this.selection.getRange().setStart(e,0).setCursor())}},UE.commands.deletecaption={queryCommandState:function(){var e=this.selection.getRange();return!(e=f.findParentByTagName(e.startContainer,"table"))||0==e.getElementsByTagName("caption").length?-1:1},execCommand:function(){var e=this.selection.getRange();(e=f.findParentByTagName(e.startContainer,"table"))&&(f.remove(e.getElementsByTagName("caption")[0]),this.selection.getRange().setStart(e.rows[0].cells[0],0).setCursor())}},UE.commands.inserttitle={queryCommandState:function(){var e=KP(this).table;return e?"th"!=(e=e.rows[0]).cells[e.cells.length-1].tagName.toLowerCase()?0:-1:-1},execCommand:function(){var e=KP(this).table;e&&LP(e).insertRow(0,"th"),e=e.getElementsByTagName("th")[0],this.selection.getRange().setStart(e,0).setCursor(!1,!0)}},UE.commands.deletetitle={queryCommandState:function(){var e=KP(this).table;return e?"th"==(e=e.rows[0]).cells[e.cells.length-1].tagName.toLowerCase()?0:-1:-1},execCommand:function(){var e=KP(this).table;e&&f.remove(e.rows[0]),e=e.getElementsByTagName("td")[0],this.selection.getRange().setStart(e,0).setCursor(!1,!0)}},UE.commands.inserttitlecol={queryCommandState:function(){var e=KP(this).table;return!e||e.rows[e.rows.length-1].getElementsByTagName("th").length?-1:0},execCommand:function(e){(e=KP(this).table)&&LP(e).insertCol(0,"th"),GP(e,this),e=e.getElementsByTagName("th")[0],this.selection.getRange().setStart(e,0).setCursor(!1,!0)}},UE.commands.deletetitlecol={queryCommandState:function(){var e=KP(this).table;return e&&e.rows[e.rows.length-1].getElementsByTagName("th").length?0:-1},execCommand:function(){var e=KP(this).table;if(e)for(var t=0;t<e.rows.length;t++)f.remove(e.rows[t].children[0]);GP(e,this),e=e.getElementsByTagName("td")[0],this.selection.getRange().setStart(e,0).setCursor(!1,!0)}},UE.commands.mergeright={queryCommandState:function(e){var t=KP(this);if(e=t.table,t=t.cell,!e||!t)return-1;var n=LP(e);if(n.selectedTds.length)return-1;var i=n.getCellInfo(t),o=i.colIndex+i.colSpan;return o>=n.colsNum?-1:(n=n.indexTable[i.rowIndex][o],(e=e.rows[n.rowIndex].cells[n.cellIndex])&&t.tagName==e.tagName&&n.rowIndex==i.rowIndex&&n.rowSpan==i.rowSpan?0:-1)},execCommand:function(e){var t=(e=this.selection.getRange()).createBookmark(!0),n=KP(this).cell;LP(n).mergeRight(n),e.moveToBookmark(t).select()}},UE.commands.mergedown={queryCommandState:function(e){var t=KP(this);if(e=t.table,t=t.cell,!e||!t)return-1;var n=LP(e);if(n.selectedTds.length)return-1;var i=n.getCellInfo(t),o=i.rowIndex+i.rowSpan;return o>=n.rowsNum?-1:(n=n.indexTable[o][i.colIndex],(e=e.rows[n.rowIndex].cells[n.cellIndex])&&t.tagName==e.tagName&&n.colIndex==i.colIndex&&n.colSpan==i.colSpan?0:-1)},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=KP(this).cell;LP(n).mergeDown(n),e.moveToBookmark(t).select()}},UE.commands.mergecells={queryCommandState:function(){return JP.getUETableBySelected(this)?0:-1},execCommand:function(){var e,t=JP.getUETableBySelected(this);t&&t.selectedTds.length&&(e=t.selectedTds[0],t.mergeRange(),t=this.selection.getRange(),f.isEmptyBlock(e)?t.setStart(e,0).collapse(!0):t.selectNodeContents(e),t.select())}},UE.commands.insertrow={queryCommandState:function(){var e=KP(this),t=e.cell;return t&&("TD"==t.tagName||"TH"==t.tagName&&e.tr!==e.table.rows[0])&&LP(e.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=(i=KP(this)).cell,i=i.table,o=LP(i),r=o.getCellInfo(n);if(o.selectedTds.length)for(var a=0,s=(r=o.cellsRange).endRowIndex-r.beginRowIndex+1;a<s;a++)o.insertRow(r.beginRowIndex,n);else o.insertRow(r.rowIndex,n);e.moveToBookmark(t).select(),"enabled"===i.getAttribute("interlaced")&&this.fireEvent("interlacetable",i)}},UE.commands.insertrownext={queryCommandState:function(){var e=KP(this),t=e.cell;return t&&"TD"==t.tagName&&LP(e.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=(i=KP(this)).cell,i=i.table,o=LP(i),r=o.getCellInfo(n);if(o.selectedTds.length)for(var a=0,s=(r=o.cellsRange).endRowIndex-r.beginRowIndex+1;a<s;a++)o.insertRow(r.endRowIndex+1,n);else o.insertRow(r.rowIndex+r.rowSpan,n);e.moveToBookmark(t).select(),"enabled"===i.getAttribute("interlaced")&&this.fireEvent("interlacetable",i)}},UE.commands.deleterow={queryCommandState:function(){return KP(this).cell?0:-1},execCommand:function(){var e=KP(this).cell,t=LP(e),n=t.cellsRange,i=t.getCellInfo(e),o=t.getVSideCell(e),r=t.getVSideCell(e,!0),e=this.selection.getRange();if(p.isEmptyObject(n))t.deleteRow(i.rowIndex);else for(var a=n.beginRowIndex;a<n.endRowIndex+1;a++)t.deleteRow(n.beginRowIndex);(a=t.table).getElementsByTagName("td").length?1==i.rowSpan||i.rowSpan==n.endRowIndex-n.beginRowIndex+1?(r||o)&&e.selectNodeContents(r||o).setCursor(!1,!0):(t=t.getCell(i.rowIndex,t.indexTable[i.rowIndex][i.colIndex].cellIndex))&&e.selectNodeContents(t).setCursor(!1,!0):(t=a.nextSibling,f.remove(a),t&&e.setStart(t,0).setCursor(!1,!0)),"enabled"===a.getAttribute("interlaced")&&this.fireEvent("interlacetable",a)}},UE.commands.insertcol={queryCommandState:function(e){var t=(e=KP(this)).cell;return t&&("TD"==t.tagName||"TH"==t.tagName&&t!==e.tr.cells[0])&&LP(e.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(e){var t=this.selection.getRange(),n=t.createBookmark(!0);if(-1!=this.queryCommandState(e)){e=KP(this).cell;var i=LP(e),o=i.getCellInfo(e);if(i.selectedTds.length)for(var r=0,a=(o=i.cellsRange).endColIndex-o.beginColIndex+1;r<a;r++)i.insertCol(o.beginColIndex,e);else i.insertCol(o.colIndex,e);t.moveToBookmark(n).select(!0)}}},UE.commands.insertcolnext={queryCommandState:function(){var e=KP(this);return e.cell&&LP(e.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=KP(this).cell,i=LP(n),o=i.getCellInfo(n);if(i.selectedTds.length)for(var r=0,a=(o=i.cellsRange).endColIndex-o.beginColIndex+1;r<a;r++)i.insertCol(o.endColIndex+1,n);else i.insertCol(o.colIndex+o.colSpan,n);e.moveToBookmark(t).select()}},UE.commands.deletecol={queryCommandState:function(){return KP(this).cell?0:-1},execCommand:function(){var e=KP(this).cell,t=LP(e),n=t.cellsRange,i=t.getCellInfo(e),o=t.getHSideCell(e),r=t.getHSideCell(e,!0);if(p.isEmptyObject(n))t.deleteCol(i.colIndex);else for(i=n.beginColIndex;i<n.endColIndex+1;i++)t.deleteCol(n.beginColIndex);t=t.table,n=this.selection.getRange(),t.getElementsByTagName("td").length?f.inDoc(e,this.document)?n.setStart(e,0).setCursor(!1,!0):r&&f.inDoc(r,this.document)?n.selectNodeContents(r).setCursor(!1,!0):o&&f.inDoc(o,this.document)&&n.selectNodeContents(o).setCursor(!0,!0):(e=t.nextSibling,f.remove(t),e&&n.setStart(e,0).setCursor(!1,!0))}},UE.commands.splittocells={queryCommandState:function(){var e=KP(this),t=e.cell;return t&&!(0<LP(e.table).selectedTds.length)&&t&&(1<t.colSpan||1<t.rowSpan)?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=KP(this).cell;LP(n).splitToCells(n),e.moveToBookmark(t).select()}},UE.commands.splittorows={queryCommandState:function(){var e=KP(this),t=e.cell;return t&&!(0<LP(e.table).selectedTds.length)&&t&&1<t.rowSpan?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=KP(this).cell;LP(n).splitToRows(n),e.moveToBookmark(t).select()}},UE.commands.splittocols={queryCommandState:function(){var e=KP(this),t=e.cell;return t&&!(0<LP(e.table).selectedTds.length)&&t&&1<t.colSpan?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=KP(this).cell;LP(n).splitToCols(n),e.moveToBookmark(t).select()}},UE.commands.adaptbytext=UE.commands.adaptbywindow={queryCommandState:function(){return KP(this).table?0:-1},execCommand:function(e){var t=KP(this).table;t&&("adaptbywindow"==e?GP(t,this):(e=f.getElementsByTagName(t,"td th"),p.each(e,function(e){e.removeAttribute("width")}),t.removeAttribute("width")))}},UE.commands.averagedistributecol={queryCommandState:function(){var e=JP.getUETableBySelected(this);return e&&(e.isFullRow()||e.isFullCol())?0:-1},execCommand:function(e){var a=this,s=JP.getUETableBySelected(a);s&&s.selectedTds.length&&function(t){p.each(f.getElementsByTagName(s.table,"th"),function(e){e.setAttribute("width","")});var e=s.isFullRow()?f.getElementsByTagName(s.table,"td"):s.selectedTds;p.each(e,function(e){1==e.colSpan&&e.setAttribute("width",t)})}(function(){var e=s.table,t=0,n=0,i=JP.getDefaultValue(a,e);if(s.isFullRow())t=e.offsetWidth,n=s.colsNum;else for(var o,e=s.cellsRange.endColIndex,r=s.cellsRange.beginColIndex;r<=e;)t+=(o=s.selectedTds[r]).offsetWidth,r+=o.colSpan,n+=1;return Math.ceil(t/n)-2*i.tdBorder-2*i.tdPadding}())}},UE.commands.averagedistributerow={queryCommandState:function(){var e=JP.getUETableBySelected(this);return!(!e||e.selectedTds&&/th/gi.test(e.selectedTds[0].tagName))&&(e.isFullRow()||e.isFullCol())?0:-1},execCommand:function(e){var t,n,l=this,d=JP.getUETableBySelected(l);d&&d.selectedTds.length&&(t=function(){var e=0,t=d.table,n=JP.getDefaultValue(l,t),i=parseInt(f.getComputedStyle(t.getElementsByTagName("td")[0],"padding-top"));if(d.isFullCol()){var o,a,e=f.getElementsByTagName(t,"caption"),s=f.getElementsByTagName(t,"th");0<e.length&&(o=e[0].offsetHeight),0<s.length&&(a=s[0].offsetHeight),e=t.offsetHeight-(o||0)-(a||0),t=0==s.length?d.rowsNum:d.rowsNum-1}else{for(a=d.cellsRange.beginRowIndex,s=d.cellsRange.endRowIndex,o=0,t=f.getElementsByTagName(t,"tr");a<=s;a++)e+=t[a].offsetHeight,o+=1;t=o}return r.ie&&r.version<9?Math.ceil(e/t):Math.ceil(e/t)-2*n.tdBorder-2*i}(),n=d.isFullCol()?f.getElementsByTagName(d.table,"td"):d.selectedTds,p.each(n,function(e){1==e.rowSpan&&e.setAttribute("height",t)}))}},UE.commands.cellalignment={queryCommandState:function(){return KP(this).table?0:-1},execCommand:function(e,t){var n=JP.getUETableBySelected(this);n?p.each(n.selectedTds,function(e){f.setAttributes(e,t)}):(n=(n=this.selection.getStart())&&f.findParentByTagName(n,["td","th","caption"],!0),/caption/gi.test(n.tagName)?(n.style.textAlign=t.align,n.style.verticalAlign=t.vAlign):f.setAttributes(n,t),this.selection.getRange().setCursor(!0))},queryCommandValue:function(e){if((e=KP(this).cell)||(e=IP(this)[0]),e){var t=UE.UETable.getUETable(e).selectedTds;return t.length||(t=e),UE.UETable.getTableCellAlignState(t)}return null}},UE.commands.tablealignment={queryCommandState:function(){return!(r.ie&&r.version<8)&&KP(this).table?0:-1},execCommand:function(e,t){var n=this.selection.getStart();(n=n&&f.findParentByTagName(n,["table"],!0))&&n.setAttribute("align",t)}},UE.commands.edittable={queryCommandState:function(){return KP(this).table?0:-1},execCommand:function(e,t){var n=this.selection.getRange();(n=f.findParentByTagName(n.startContainer,"table"))&&(n=f.getElementsByTagName(n,"td").concat(f.getElementsByTagName(n,"th"),f.getElementsByTagName(n,"caption")),p.each(n,function(e){e.style.borderColor=t}))}},UE.commands.edittd={queryCommandState:function(){return KP(this).table?0:-1},execCommand:function(e,t){var n=JP.getUETableBySelected(this);n?p.each(n.selectedTds,function(e){e.style.backgroundColor=t}):(n=(n=this.selection.getStart())&&f.findParentByTagName(n,["td","th","caption"],!0))&&(n.style.backgroundColor=t)}},UE.commands.settablebackground={queryCommandState:function(){return 1<IP(this).length?0:-1},execCommand:function(e,t){var n=IP(this);LP(n[0]).setBackground(n,t)}},UE.commands.cleartablebackground={queryCommandState:function(){var e=IP(this);if(!e.length)return-1;for(var t,n=0;t=e[n++];)if(""!==t.style.backgroundColor)return 0;return-1},execCommand:function(){var e=IP(this);LP(e[0]).removeBackground(e)}},UE.commands.interlacetable=UE.commands.uninterlacetable={queryCommandState:function(e){var t=KP(this).table;return t?(t=t.getAttribute("interlaced"),"interlacetable"==e?"enabled"===t?-1:0:t&&"disabled"!==t?0:-1):-1},execCommand:function(e,t){var n=KP(this).table;"interlacetable"==e?(n.setAttribute("interlaced","enabled"),this.fireEvent("interlacetable",n,t)):(n.setAttribute("interlaced","disabled"),this.fireEvent("uninterlacetable",n))}},UE.commands.setbordervisible={queryCommandState:function(e){return KP(this).table?0:-1},execCommand:function(){var e=KP(this).table;p.each(f.getElementsByTagName(e,"td"),function(e){e.style.borderWidth="1px",e.style.borderStyle="solid"})}},UE.plugins.table=function(){function y(e){t(e,"width",!0),t(e,"height",!0)}function t(e,t,n){e.style[t]&&(n&&e.setAttribute(t,parseInt(e.style[t],10)),e.style[t]="")}function C(e){return"TD"==e.tagName||"TH"==e.tagName||(e=f.findParentByTagName(e,"td",!0)||f.findParentByTagName(e,"th",!0))?e:null}function N(e){var t=RegExp(f.fillChar,"g");if(!(0<e[r.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(t,"").length)){for(var n in v.$isNotEmpty)if(e.getElementsByTagName(n).length)return;return 1}}function g(e){return e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:{x:e.clientX+A.document.body.scrollLeft-A.document.body.clientLeft,y:e.clientY+A.document.body.scrollTop-A.document.body.clientTop}}function n(e){if(!k())try{var t,n,i=C(e.target||e.srcElement);if(D&&(A.body.style.webkitUserSelect="none",Math.abs(M.x-e.clientX)>U||Math.abs(M.y-e.clientY)>U)&&(T(),D=!1,O=0,S(e)),W&&Z){if(O=0,A.body.style.webkitUserSelect="none",A.selection.getNative()[r.ie9below?"empty":"removeAllRanges"](),t=g(e),E(A,!0,W,0,i),"h"==W){var o,a,s,l=Y.style,d=q(i=Z);s=d?(o=d.getSameEndPosCells(i,"x")[0],a=d.getSameStartPosXCells(i)[0],s=g(e).x,d=(o?f.getXY(o):f.getXY(d.table)).x+20,a=(a=a?f.getXY(a).x+a.offsetWidth-20:A.body.offsetWidth+5||parseInt(f.getComputedStyle(A.body,"width"),10))-P,s<(d=d+P)?d:a<s?a:s):void 0,l.left=s+"px"}else if("v"==W){var c=Y.style;e:{try{var u=f.getXY(Z).y,m=g(e).y,h=m<u?u:m;break e}catch(e){}h=void 0}c.top=h+"px"}}else i?!0!==A.fireEvent("excludetable",i)&&(c=b(i,t=g(e)),w(n=f.findParentByTagName(i,"table",!0),i,e,!0)?!0!==A.fireEvent("excludetable",n)&&(A.body.style.cursor="url("+A.options.cursorpath+"h.png),pointer"):w(n,i,e)?!0!==A.fireEvent("excludetable",n)&&(A.body.style.cursor="url("+A.options.cursorpath+"v.png),pointer"):(A.body.style.cursor="text",/\d/.test(c)&&(c=c.replace(/\d/,""),i=q(i).getPreviewCell(i,"v"==c)),E(A,!!i&&!!c,i?c:"",0,i))):x(!1,n,A)}catch(e){}}function x(e,t,n){var r,a,s;e?(r=t,a=n,t=f.getXY(r),n=r.ownerDocument,X&&X.parentNode||((X=n.createElement("div")).contentEditable=!1,X.innerHTML="",X.style.cssText="width:15px;height:15px;background-image:url("+a.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(t.y-15)+"px;left:"+t.x+"px;",f.unSelectable(X),X.onmouseover=function(e){K=!0},X.onmouseout=function(e){K=!1},f.on(X,"click",function(e,t){var n;n=this,clearTimeout(s),s=setTimeout(function(){a.fireEvent("tableClicked",r,n)},300)}),f.on(X,"dblclick",function(e,t){clearTimeout(s);var n=q(r),i=r.rows[0].cells[0],o=n.getLastCell(),o=n.getCellsRange(i,o);a.selection.getRange().setStart(i,0).setCursor(!1,!0),n.setSelected(o)}),f.on(X,"dragstart",function(e,t){f.preventDefault(t)}),n.body.appendChild(X))):K||setTimeout(function(){!K&&X&&X.parentNode&&X.parentNode.removeChild(X)},2e3)}function w(e,t,n,i){return t=b(t,n=g(n)),i?(i=(i=e.getElementsByTagName("caption")[0])?i.offsetHeight:0,"v1"==t&&n.y-f.getXY(e).y-i<8):"h1"==t&&n.x-f.getXY(e).x<8}function E(e,t,n,i,o){try{e.body.style.cursor="h"==n?"col-resize":"v"==n?"row-resize":"text",r.ie&&(!n||G||$.getUETableBySelected(e)?I(e):(s(e,e.document),l(n,o))),j=t}catch(e){}}function b(e,t){var n=f.getXY(e);return n?n.x+e.offsetWidth-t.x<o?"h":t.x-n.x<o?"h1":n.y+e.offsetHeight-t.y<o?"v":t.y-n.y<o?"v1":"":""}function i(e,t){var n,i,o;k()||(M={x:t.clientX,y:t.clientY},2==t.button?(o=$.getUETableBySelected(A),n=!1,o&&(i=_(A,t),p.each(o.selectedTds,function(e){e===i&&(n=!0)}),n?(i=o.selectedTds[0],setTimeout(function(){A.selection.getRange().setStart(i,0).setCursor(!1,!0)},0)):(F(f.getElementsByTagName(A.body,"th td")),o.clearSelected()))):(o=t,F(f.getElementsByTagName(A.body,"td th")),p.each(A.document.getElementsByTagName("table"),function(e){e.ueTable=null}),(V=_(A,o))&&(t=f.findParentByTagName(V,"table",!0),(ut=q(t))&&ut.clearSelected(),j?function(e){r.ie&&(e=function(e){var t="pageX pageY clientX clientY srcElement target".split(" "),n={};if(e)for(var i,o,r=0;i=t[r];r++)(o=e[i])&&(n[i]=o);return n}(e)),T(),D=!0,R=setTimeout(function(){S(e)},H)}(o):(A.document.body.style.webkitUserSelect="",G=!0,A.addListener("mouseover",u)))))}function c(e){O=0;var t,o,r,a,n=C((e=e||A.window.event).target||e.srcElement);n&&(t=b(n,g(e)))&&(I(A),"h1"==t&&(t="h",w(f.findParentByTagName(n,"table"),n,e)?A.execCommand("adaptbywindow"):(n=q(n).getPreviewCell(n))&&A.selection.getRange().selectNodeContents(n).setCursor(!0,!0)),"h"==t&&(e=q(n),o=function(e,t){for(var n=[],i=null,o=0,r=e.length;o<r;o++)(i=e[o][t])&&n.push(i);return n}(o=m(n,e.table,!0),"left"),e.width=e.offsetWidth,r=[],a=[],p.each(o,function(e){r.push(e.offsetWidth)}),p.each(o,function(e){e.removeAttribute("width")}),window.setTimeout(function(){var n=!0;p.each(o,function(e,t){e=e.offsetWidth;if(e>r[t])return n=!1;a.push(e)});var i=n?a:r;p.each(o,function(e,t){e.width=i[t]-B()})},0)))}function T(){R&&clearTimeout(R),R=null}function S(e){D=!1,(V=e.target||e.srcElement)&&(e=b(V,g(e)),/\d/.test(e)&&(e=e.replace(/\d/,""),V=q(V).getPreviewCell(V,"v"==e)),I(A),s(A,A.document),A.fireEvent("saveScene"),l(e,V),G=!0,W=e,Z=V)}function a(e,t){if(!k()){if(T(),D=!1,j&&(O=++O%3,M={x:t.clientX,y:t.clientY},setTimeout(function(){0<O&&O--},H),2===O))return O=0,void c(t);if(2!=t.button){var n=this.selection.getRange(),i=f.findParentByTagName(n.startContainer,"table",!0),o=f.findParentByTagName(n.endContainer,"table",!0);if((i||o)&&(i===o?(i=f.findParentByTagName(n.startContainer,["td","th","caption"],!0))!==(o=f.findParentByTagName(n.endContainer,["td","th","caption"],!0))&&this.selection.clearRange():this.selection.clearRange()),G=!1,this.document.body.style.webkitUserSelect="",W&&Z&&(this.selection.getNative()[r.ie9below?"empty":"removeAllRanges"](),O=0,Y=this.document.getElementById("ue_tableDragLine"))){switch(n=f.getXY(Z),i=f.getXY(Y),W){case"h":a=Z,s=i.x-n.x,!void((l=q(a))&&(l=l.table,d=m(a,l),l.style.width="",l.removeAttribute("width"),s=function(t,e,n){if((t-=B())<0)return 0;var i=(t-=h(e))<0?"left":"right";return t=Math.abs(t),p.each(n,function(e){(e=e[i])&&(t=Math.min(t,h(e)-P))}),t=t<0?0:t,"left"==i?-t:t}(s,a,d),a.nextSibling?p.each(d,function(e){e.left.width=+e.left.width+s,e.right&&(e.right.width=+e.right.width-s)}):p.each(d,function(e){e.left.width-=-s})));break;case"v":!function(e,t){if(!(Math.abs(t)<10)){var n=q(e);if(n)for(var i,o=(n=n.getSameEndPosCells(e,"y"))[0]?n[0].offsetHeight:0,r=0;i=n[r++];){var a=t,s=o,l=parseInt(f.getComputedStyle(i,"line-height"),10),a=(a=s+a)<l?l:a;i.style.height&&(i.style.height=""),1==i.rowSpan?i.setAttribute("height",a):i.removeAttribute&&i.removeAttribute("height")}}}(Z,i.y-n.y-Z.offsetHeight)}return W="",Z=null,I(this),void this.fireEvent("saveScene")}if(V)(i=(n=q(V))?n.selectedTds[0]:null)?(n=new L.Range(this.document),(f.isEmptyBlock(i)?n.setStart(i,0):n.selectNodeContents(i).shrinkBoundary()).setCursor(!1,!0)):(n=this.selection.getRange().shrinkBoundary()).collapsed||(i=f.findParentByTagName(n.startContainer,["td","th"],!0),o=f.findParentByTagName(n.endContainer,["td","th"],!0),(i&&!o||!i&&o||i&&o&&i!==o)&&n.setCursor(!1,!0)),V=null,this.removeListener("mouseover",u);else if((i=f.findParentByTagName(t.target||t.srcElement,"td",!0))||(i=f.findParentByTagName(t.target||t.srcElement,"th",!0)),i&&("TD"==i.tagName||"TH"==i.tagName)){if(!0===this.fireEvent("excludetable",i))return;(n=new L.Range(this.document)).setStart(i,0).setCursor(!1,!0)}this._selectionChange(250,t)}}var a,s,l,d}function u(e,t){var n,i;k()||(n=t.target||t.srcElement,z=f.findParentByTagName(n,"td",!0)||f.findParentByTagName(n,"th",!0),V&&z&&("TD"==V.tagName&&"TD"==z.tagName||"TH"==V.tagName&&"TH"==z.tagName)&&f.findParentByTagName(V,"table")==f.findParentByTagName(z,"table")&&(n=q(z),V!=z?(this.document.body.style.webkitUserSelect="none",this.selection.getNative()[r.ie9below?"empty":"removeAllRanges"](),i=n.getCellsRange(V,z),n.setSelected(i)):(this.document.body.style.webkitUserSelect="",n.clearSelected())),t.preventDefault?t.preventDefault():t.returnValue=!1)}function k(){return"false"===A.body.contentEditable}function m(e,t,n){if(!(t=t||f.findParentByTagName(e,"table")))return null;f.getNodeIndex(e),t=t.rows;for(var i=0;e;)1===e.nodeType&&(i+=e.colSpan||1),e=e.previousSibling;e=null;var o=[];return p.each(t,function(e){var t=0;p.each(e.cells,function(e){return(t+=e.colSpan||1)===i?(o.push({left:e,right:e.nextSibling||null}),!1):i<t?(n&&o.push({left:e}),!1):void 0})}),o}function h(e){var t,n=0,n=e.offsetWidth-B();e.nextSibling||(tab=f.findParentByTagName(e,"table",!1),void 0===tab.offsetVal&&(t=e.previousSibling,tab.offsetVal=t&&e.offsetWidth-t.offsetWidth===$.borderWidth?$.borderWidth:0),n-=tab.offsetVal),n=n<0?0:n;try{e.width=n}catch(e){}return n}function B(){var e,t,n,i,o;return void 0===$.tabcellSpace&&(e=A.document.createElement("table"),t=A.document.createElement("tbody"),n=A.document.createElement("tr"),o=null,(i=A.document.createElement("td")).style.cssText="border: 0;",i.width=1,n.appendChild(i),n.appendChild(o=i.cloneNode(!1)),t.appendChild(n),e.appendChild(t),e.style.cssText="visibility: hidden;",A.body.appendChild(e),$.paddingSpace=i.offsetWidth-1,t=e.offsetWidth,i.style.cssText="",o.style.cssText="",$.borderWidth=(e.offsetWidth-t)/3,$.tabcellSpace=$.paddingSpace+$.borderWidth,A.body.removeChild(e)),B=function(){return $.tabcellSpace},$.tabcellSpace}function s(e){G||(Y=e.document.createElement("div"),f.setAttributes(Y,{id:"ue_tableDragLine",unselectable:"on",contenteditable:!1,onresizestart:"return false",ondragstart:"return false",onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"}),e.body.appendChild(Y))}function I(e){if(!G)for(var t;t=e.document.getElementById("ue_tableDragLine");)f.remove(t)}function l(e,t){if(t){var n=(r=f.findParentByTagName(t,"table")).getElementsByTagName("caption"),i=r.offsetWidth,o=r.offsetHeight-(0<n.length?n[0].offsetHeight:0),r=f.getXY(r),a=f.getXY(t);switch(e){case"h":n="height:"+o+"px;top:"+(r.y+(0<n.length?n[0].offsetHeight:0))+"px;left:"+(a.x+t.offsetWidth),Y.style.cssText=n+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";break;case"v":n="width:"+i+"px;left:"+r.x+"px;top:"+(a.y+t.offsetHeight),Y.style.cssText=n+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)"}}}function d(e,t){for(var n,i,o=f.getElementsByTagName(e.body,"table"),r=0;i=o[r++];)(n=f.getElementsByTagName(i,"td"))[0]&&(t?(n=n[0].style.borderColor.replace(/\s/g,""),/(#ffffff)|(rgb\(255,255,255\))/gi.test(n)&&f.addClass(i,"noBorderTable")):f.removeClasses(i,"noBorderTable"))}function _(e,t){var n,i=f.findParentByTagName(t.target||t.srcElement,["td","th"],!0),o=null;return i?(o=b(i,g(t)),i?("h1"===o&&i.previousSibling?(o=f.getXY(i),n=i.offsetWidth,Math.abs(o.x+n-t.clientX)>n/3&&(i=i.previousSibling)):"v1"===o&&i.parentNode.previousSibling&&(o=f.getXY(i),n=i.offsetHeight,Math.abs(o.y+n-t.clientY)>n/3&&(i=i.parentNode.previousSibling.firstChild)),i&&!0!==e.fireEvent("excludetable",i)?i:null):null):null}var A=this,R=null,P=5,D=!1,o=5,U=10,O=0,M=null,H=360,$=UE.UETable,q=function(e){return $.getUETable(e)},F=function(e){return $.removeSelectedClass(e)};A.ready(function(){var n=this,i=n.selection.getText;n.selection.getText=function(){var e=$.getUETableBySelected(n);if(e){var t="";return p.each(e.selectedTds,function(e){t+=e[r.ie?"innerText":"textContent"]}),t}return i.call(n.selection)}});var V=null,z=null,W="",j=!1,X=null,K=!1,Y=null,Z=null,G=!1;A.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,defaultRows:5,tdvalign:"top",cursorpath:A.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:!1,classList:["ue-table-interlace-color-single","ue-table-interlace-color-double"]}),A.getUETable=q;var J={deletetable:1,inserttable:1,cellvalign:1,insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,insertparagraphbeforetable:1,averagedistributecol:1,averagedistributerow:1};A.ready(function(){var h,g,b,e;p.cssRule("table",".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:1px solid #BBB;background-color:#F7F7F7;}table tr.firstRow th{border-top-width:2px;}.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }td p{margin:0;padding:0;}",A.document),A.addListener("keydown",function(e,t){var n,i,o,r=t.keyCode||t.which;if(8==r&&((n=$.getUETableBySelected(this))&&n.selectedTds.length&&(n.isFullCol()?this.execCommand("deletecol"):n.isFullRow()?this.execCommand("deleterow"):this.fireEvent("delcells"),f.preventDefault(t)),i=f.findParentByTagName(this.selection.getStart(),"caption",!0),(o=this.selection.getRange()).collapsed&&i&&N(i)&&(this.fireEvent("saveScene"),n=i.parentNode,f.remove(i),n&&o.setStart(n.rows[0].cells[0],0).setCursor(!1,!0),this.fireEvent("saveScene"))),46==r&&(n=$.getUETableBySelected(this))){for(this.fireEvent("saveScene"),i=0;o=n.selectedTds[i++];)f.fillNode(this.document,o);this.fireEvent("saveScene"),f.preventDefault(t)}if(13==r){if(r=this.selection.getRange(),i=f.findParentByTagName(r.startContainer,"caption",!0))return n=f.findParentByTagName(i,"table"),r.collapsed?i&&r.setStart(n.rows[0].cells[0],0).setCursor(!1,!0):(r.deleteContents(),this.fireEvent("saveScene")),void f.preventDefault(t);r.collapsed&&(n=f.findParentByTagName(r.startContainer,"table"))&&(o=n.rows[0].cells[0],i=f.findParentByTagName(this.selection.getStart(),["td","th"],!0),n=n.previousSibling,o===i&&(!n||1==n.nodeType&&"TABLE"==n.tagName)&&f.isStartInblock(r)&&(r=f.findParent(this.selection.getStart(),function(e){return f.isBlockElm(e)},!0))&&(/t(h|d)/i.test(r.tagName)||r===i.firstChild)&&(this.execCommand("insertparagraphbeforetable"),f.preventDefault(t)))}if((t.ctrlKey||t.metaKey)&&"67"==t.keyCode&&(h=null,n=$.getUETableBySelected(this)))for(r=n.selectedTds,g=n.isFullCol(),b=n.isFullRow(),h=[[n.cloneCell(r[0],null,!0)]],i=1;o=r[i];i++)o.parentNode!==r[i-1].parentNode?h.push([n.cloneCell(o,null,!0)]):h[h.length-1].push(n.cloneCell(o,null,!0))}),A.addListener("tablehasdeleted",function(){E(this,!1,""),X&&f.remove(X)}),A.addListener("beforepaste",function(e,t){var n=this,i=n.selection.getRange();if(f.findParentByTagName(i.startContainer,"caption",!0))(i=n.document.createElement("div")).innerHTML=t.html,t.html=i[r.ie9below?"innerText":"textContent"];else{var o=$.getUETableBySelected(n);if(h){n.fireEvent("saveScene");var a,s,i=n.selection.getRange(),l=f.findParentByTagName(i.startContainer,["td","th"],!0);if(l){if(o=q(l),b){var d=o.getCellInfo(l).rowIndex;"TH"==l.tagName&&d++;for(var c,i=0;c=h[i++];){s=o.insertRow(d++,"td");for(var u,m=0;u=c[m];m++)(l=s.cells[m])||(l=s.insertCell(m)),l.innerHTML=u.innerHTML,u.getAttribute("width")&&l.setAttribute("width",u.getAttribute("width")),u.getAttribute("vAlign")&&l.setAttribute("vAlign",u.getAttribute("vAlign")),u.getAttribute("align")&&l.setAttribute("align",u.getAttribute("align")),u.style.cssText&&(l.style.cssText=u.style.cssText);for(m=0;(u=s.cells[m])&&c[m];m++)u.innerHTML=c[m].innerHTML,c[m].getAttribute("width")&&u.setAttribute("width",c[m].getAttribute("width")),c[m].getAttribute("vAlign")&&u.setAttribute("vAlign",c[m].getAttribute("vAlign")),c[m].getAttribute("align")&&u.setAttribute("align",c[m].getAttribute("align")),c[m].style.cssText&&(u.style.cssText=c[m].style.cssText)}}else{if(g){for(d=o.getCellInfo(l),m=l=0,c=h[0];u=c[m++];)l+=u.colSpan||1;for(n.__hasEnterExecCommand=!0,i=0;i<l;i++)n.execCommand("insertcol");n.__hasEnterExecCommand=!1,"TH"==(l=o.table.rows[0].cells[d.cellIndex]).tagName&&(l=o.table.rows[1].cells[d.cellIndex])}for(i=0;c=h[i++];){for(a=l,m=0;u=c[m++];)l?(l.innerHTML=u.innerHTML,u.getAttribute("width")&&l.setAttribute("width",u.getAttribute("width")),u.getAttribute("vAlign")&&l.setAttribute("vAlign",u.getAttribute("vAlign")),u.getAttribute("align")&&l.setAttribute("align",u.getAttribute("align")),u.style.cssText&&(l.style.cssText=u.style.cssText),l=(s=l).nextSibling):(d=u.cloneNode(!0),f.removeAttributes(d,["class","rowSpan","colSpan"]),s.parentNode.appendChild(d));if(l=o.getNextCell(a,!0,!0),!h[i])break;l||(d=o.getCellInfo(a),o.table.insertRow(o.table.rows.length),o.update(),l=o.getVSideCell(a,!0))}}o.update()}else{for(o=n.document.createElement("table"),i=0;c=h[i++];){for(s=o.insertRow(o.rows.length),m=0;u=c[m++];)d=$.cloneCell(u,null,!0),f.removeAttributes(d,["class"]),s.appendChild(d);2==m&&1<d.rowSpan&&(d.rowSpan=1)}i=$.getDefaultValue(n,void 0),i=n.body.offsetWidth-2*parseInt(f.getComputedStyle(n.body,"margin-left"),10)-2*i.tableBorder-(n.options.offsetWidth||0),n.execCommand("insertHTML","<table  "+(g&&b?'width="'+i+'"':"")+">"+o.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"</table>")}return n.fireEvent("contentchange"),n.fireEvent("saveScene"),!(t.html="")}(i=n.document.createElement("div")).innerHTML=t.html,c=i.getElementsByTagName("table"),f.findParentByTagName(n.selection.getStart(),"table")?(p.each(c,function(e){f.remove(e)}),f.findParentByTagName(n.selection.getStart(),"caption",!0)&&(i.innerHTML=i[r.ie?"innerText":"textContent"])):p.each(c,function(e){y(e),f.removeAttributes(e,["style","border"]),p.each(f.getElementsByTagName(e,"td"),function(e){N(e)&&f.fillNode(n.document,e),y(e)})}),t.html=i.innerHTML}}),A.addListener("afterpaste",function(){p.each(f.getElementsByTagName(A.body,"table"),function(e){var t;e.offsetWidth>A.body.offsetWidth&&(t=$.getDefaultValue(A,e),e.style.width=A.body.offsetWidth-2*parseInt(f.getComputedStyle(A.body,"margin-left"),10)-2*t.tableBorder-(A.options.offsetWidth||0)+"px")})}),A.addListener("blur",function(){h=null}),A.addListener("keydown",function(){clearTimeout(e),e=setTimeout(function(){var e,t=A.selection.getRange();!(t=f.findParentByTagName(t.startContainer,["th","td"],!0))||(e=t.parentNode.parentNode.parentNode).offsetWidth>e.getAttribute("width")&&(t.style.wordBreak="break-all")},100)}),A.addListener("selectionchange",function(){E(A,!1,"")}),A.addListener("contentchange",function(){var e,a=this;I(a),$.getUETableBySelected(a)||(e=a.selection.getRange().startContainer,e=f.findParentByTagName(e,["td","th"],!0),p.each(f.getElementsByTagName(a.document,"table"),function(e){!0!==a.fireEvent("excludetable",e)&&(e.ueTable=new $(e),e.onmouseover=function(){a.fireEvent("tablemouseover",e)},e.onmousemove=function(){a.fireEvent("tablemousemove",e),a.options.tableDragable&&x(!0,this,a),p.defer(function(){a.fireEvent("contentchange",50)},!0)},e.onmouseout=function(){a.fireEvent("tablemouseout",e),E(a,!1,""),I(a)},e.onclick=function(e){var t,n,i,o,r=C((e=a.window.event||e).target||e.srcElement);r&&(n=(t=q(r)).table,i=t.getCellInfo(r),o=a.selection.getRange(),w(n,r,e,!0)?(n=t.getCell(t.indexTable[t.rowsNum-1][i.colIndex].rowIndex,t.indexTable[t.rowsNum-1][i.colIndex].cellIndex),e.shiftKey&&t.selectedTds.length?t.selectedTds[0]!==n?(e=t.getCellsRange(t.selectedTds[0],n),t.setSelected(e)):o&&o.selectNodeContents(n).select():r!==n?(e=t.getCellsRange(r,n),t.setSelected(e)):o&&o.selectNodeContents(n).select()):w(n,r,e)&&(n=t.getCell(t.indexTable[i.rowIndex][t.colsNum-1].rowIndex,t.indexTable[i.rowIndex][t.colsNum-1].cellIndex),e.shiftKey&&t.selectedTds.length?t.selectedTds[0]!==n?(e=t.getCellsRange(t.selectedTds[0],n),t.setSelected(e)):o&&o.selectNodeContents(n).select():r!==n?(e=t.getCellsRange(r,n),t.setSelected(e)):o&&o.selectNodeContents(n).select()))})}),d(a,!0))}),f.on(A.document,"mousemove",n),f.on(A.document,"mouseout",function(e){"TABLE"==(e.target||e.srcElement).tagName&&E(A,!1,"")}),A.addListener("interlacetable",function(e,t,n){if(t){t=(e=t.rows).length;for(var i=0;i<t;i++){var o=n||this.options.classList;e[i].className=o[i]||o[i%o.length]}}}),A.addListener("uninterlacetable",function(e,t){if(t)for(var n=t.rows,i=this.options.classList,o=n.length,r=0;r<o;r++)f.removeClasses(n[r],i)}),A.addListener("mousedown",i),A.addListener("mouseup",a),f.on(A.body,"dragstart",function(e){a.call(A,"dragstart",e)}),A.addOutputRule(function(e){p.each(e.getNodesByTagName("div"),function(e){"ue_tableDragLine"==e.getAttr("id")&&e.parentNode.removeChild(e)})});var o=0;A.addListener("mousedown",function(){o=0}),A.addListener("tabkeydown",function(){var e,t=this.selection.getRange(),n=t.getCommonAncestor(!0,!0),i=f.findParentByTagName(n,"table");if(i)return f.findParentByTagName(n,"caption",!0)?(n=f.getElementsByTagName(i,"th td"))&&n.length&&t.setStart(n[0],0).setCursor(!1,!0):(n=f.findParentByTagName(n,["td","th"],!0),e=q(n),o=1<n.rowSpan?o:e.getCellInfo(n).rowIndex,(n=e.getTabNextCell(n,o))?N(n)?t.setStart(n,0).setCursor(!1,!0):t.selectNodeContents(n).select():(A.fireEvent("saveScene"),A.__hasEnterExecCommand=!0,this.execCommand("insertrownext"),A.__hasEnterExecCommand=!1,(t=this.selection.getRange()).setStart(i.rows[i.rows.length-1].cells[0],0).setCursor(),A.fireEvent("saveScene"))),!0}),r.ie&&A.addListener("selectionchange",function(){E(this,!1,"")}),A.addListener("keydown",function(e,t){var n=t.keyCode||t.which;8!=n&&46!=n&&((n=!(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey))&&F(f.getElementsByTagName(this.body,"td")),(t=$.getUETableBySelected(this))&&n&&t.clearSelected())}),A.addListener("beforegetcontent",function(){d(this,!1),r.ie&&p.each(this.document.getElementsByTagName("caption"),function(e){f.isEmptyNode(e)&&(e.innerHTML="&nbsp;")})}),A.addListener("aftergetcontent",function(){d(this,!0)}),A.addListener("getAllHtml",function(){F(A.document.getElementsByTagName("td"))}),A.addListener("fullscreenchanged",function(e,t){var l;t||(l=this.body.offsetWidth/document.body.offsetWidth,t=f.getElementsByTagName(this.body,"table"),p.each(t,function(e){if(e.offsetWidth<A.body.offsetWidth)return!1;var t=f.getElementsByTagName(e,"td"),n=[];p.each(t,function(e){n.push(e.offsetWidth)});for(var i,o,r,a,s=0;i=t[s];s++)i.setAttribute("width",Math.floor(n[s]*l));e.setAttribute("width",Math.floor((o=A,r=!0,a=$.getDefaultValue(A,void 0),(e=o.body).offsetWidth-(r?2*parseInt(f.getComputedStyle(e,"margin-left"),10):0)-2*a.tableBorder-(o.options.offsetWidth||0))))}))});var u=A.execCommand;A.execCommand=function(e,t){e=e.toLowerCase();var n,i=$.getUETableBySelected(this),o=new L.Range(this.document),r=this.commands[e]||UE.commands[e];if(r){if(!i||J[e]||r.notNeedUndo||this.__hasEnterExecCommand)n=u.apply(this,arguments);else{this.__hasEnterExecCommand=!0,this.fireEvent("beforeexeccommand",e);for(var a,s,l,i=i.selectedTds,d=r=-2,c=0;l=i[c];c++)N(l)?o.setStart(l,0).setCursor(!1,!0):o.selectNode(l).select(!0),s=this.queryCommandState(e),a=this.queryCommandValue(e),-1!=s&&(r===s&&d===a||(this._ignoreContentChange=!0,n=u.apply(this,arguments),this._ignoreContentChange=!1),r=this.queryCommandState(e),d=this.queryCommandValue(e),f.isEmptyBlock(l)&&f.fillNode(this.document,l));o.setStart(i[0],0).shrinkBoundary(!0).setCursor(!1,!0),this.fireEvent("contentchange"),this.fireEvent("afterexeccommand",e),this.__hasEnterExecCommand=!1,this._selectionChange()}return n}}})},UE.UETable.prototype.sortTable=function(n,i){var e=this.table,t=e.rows,o=[],a="TH"===t[0].cells[0].tagName,s=0;if(this.selectedTds.length){for(var l=this.cellsRange,d=l.endRowIndex+1,c=l.beginRowIndex;c<d;c++)o[c]=t[c];o.splice(0,l.beginRowIndex),s=l.endRowIndex+1===this.rowsNum?0:l.endRowIndex+1}else for(c=0,d=t.length;c<d;c++)o[c]=t[c];var u={reversecurrent:function(e,t){return 1},orderbyasc:function(e,t){return(e.innerText||e.textContent).localeCompare(t.innerText||t.textContent)},reversebyasc:function(e,t){return t.innerHTML.localeCompare(e.innerHTML)},orderbynum:function(e,t){e=e[r.ie?"innerText":"textContent"].match(/\d+/),t=t[r.ie?"innerText":"textContent"].match(/\d+/);return((e=e&&+e[0])||0)-((t=t&&+t[0])||0)},reversebynum:function(e,t){e=e[r.ie?"innerText":"textContent"].match(/\d+/),t=t[r.ie?"innerText":"textContent"].match(/\d+/),e=e&&+e[0];return((t=t&&+t[0])||0)-(e||0)}};for(e.setAttribute("data-sort-type",i&&"string"==typeof i&&u[i]?i:""),a&&o.splice(0,1),o=p.sort(o,function(e,t){return i&&"function"==typeof i?i.call(this,e.cells[n],t.cells[n]):i&&"number"==typeof i?1:(i&&"string"==typeof i&&u[i]?u[i]:u.orderbyasc).call(this,e.cells[n],t.cells[n])}),a=e.ownerDocument.createDocumentFragment(),c=0,d=o.length;c<d;c++)a.appendChild(o[c]);e=e.getElementsByTagName("tbody")[0],s?e.insertBefore(a,t[s-l.endRowIndex+l.beginRowIndex-1]):e.appendChild(a)},UE.plugins.tablesort=function(){var e=this,a=UE.UETable;e.ready(function(){p.cssRule("tablesort","table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;   background-image:url("+e.options.themePath+e.options.theme+"/images/sortable.png);}",e.document),e.addListener("afterexeccommand",function(e,t){"mergeright"!=t&&"mergedown"!=t&&"mergecells"!=t||this.execCommand("disablesort")})}),UE.commands.sorttable={queryCommandState:function(){if(!(t=a.getTableItemsByRange(this)).cell)return-1;for(var e,t=t.table.getElementsByTagName("td"),n=0;e=t[n++];)if(1!=e.rowSpan||1!=e.colSpan)return-1;return 0},execCommand:function(e,t){var n=this.selection.getRange(),i=n.createBookmark(!0),o=a.getTableItemsByRange(this),r=o.cell,r=(o=a.getUETable(o.table)).getCellInfo(r);o.sortTable(r.cellIndex,t),n.moveToBookmark(i);try{n.select()}catch(e){}}},UE.commands.enablesort=UE.commands.disablesort={queryCommandState:function(e){var t=a.getTableItemsByRange(this).table;if(t&&"enablesort"==e)for(var n=f.getElementsByTagName(t,"th td"),i=0;i<n.length;i++)if(1<n[i].getAttribute("colspan")||1<n[i].getAttribute("rowspan"))return-1;return!t||"enablesort"==e^"sortEnabled"!=t.getAttribute("data-sort")?-1:0},execCommand:function(e){var t=a.getTableItemsByRange(this).table;t.setAttribute("data-sort","enablesort"==e?"sortEnabled":"sortDisabled"),"enablesort"==e?f.addClass(t,"sortEnabled"):f.removeClasses(t,"sortEnabled")}}},UE.plugins.contextmenu=function(){var d,c,u,m,h=this;h.setOpt("enableContextMenu",!0),!1!==h.getOpt("enableContextMenu")&&(d=h.getLang("contextMenu"),(u=h.options.contextMenu||[{label:d.selectall,cmdName:"selectall"},{label:d.cleardoc,cmdName:"cleardoc",exec:function(){confirm(d.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:d.unlink,cmdName:"unlink"},"-",{group:d.paragraph,icon:"justifyjustify",subMenu:[{label:d.justifyleft,cmdName:"justify",value:"left"},{label:d.justifyright,cmdName:"justify",value:"right"},{label:d.justifycenter,cmdName:"justify",value:"center"},{label:d.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:d.table,icon:"table",subMenu:[{label:d.inserttable,cmdName:"inserttable"},{label:d.deletetable,cmdName:"deletetable"},"-",{label:d.deleterow,cmdName:"deleterow"},{label:d.deletecol,cmdName:"deletecol"},{label:d.insertcol,cmdName:"insertcol"},{label:d.insertcolnext,cmdName:"insertcolnext"},{label:d.insertrow,cmdName:"insertrow"},{label:d.insertrownext,cmdName:"insertrownext"},"-",{label:d.insertcaption,cmdName:"insertcaption"},{label:d.deletecaption,cmdName:"deletecaption"},{label:d.inserttitle,cmdName:"inserttitle"},{label:d.deletetitle,cmdName:"deletetitle"},{label:d.inserttitlecol,cmdName:"inserttitlecol"},{label:d.deletetitlecol,cmdName:"deletetitlecol"},"-",{label:d.mergecells,cmdName:"mergecells"},{label:d.mergeright,cmdName:"mergeright"},{label:d.mergedown,cmdName:"mergedown"},"-",{label:d.splittorows,cmdName:"splittorows"},{label:d.splittocols,cmdName:"splittocols"},{label:d.splittocells,cmdName:"splittocells"},"-",{label:d.averageDiseRow,cmdName:"averagedistributerow"},{label:d.averageDisCol,cmdName:"averagedistributecol"},"-",{label:d.edittd,cmdName:"edittd",exec:function(){UE.ui.edittd&&new UE.ui.edittd(this),this.getDialog("edittd").open()}},{label:d.edittable,cmdName:"edittable",exec:function(){UE.ui.edittable&&new UE.ui.edittable(this),this.getDialog("edittable").open()}},{label:d.setbordervisible,cmdName:"setbordervisible"}]},{group:d.tablesort,icon:"tablesort",subMenu:[{label:d.enablesort,cmdName:"enablesort"},{label:d.disablesort,cmdName:"disablesort"},"-",{label:d.reversecurrent,cmdName:"sorttable",value:"reversecurrent"},{label:d.orderbyasc,cmdName:"sorttable",value:"orderbyasc"},{label:d.reversebyasc,cmdName:"sorttable",value:"reversebyasc"},{label:d.orderbynum,cmdName:"sorttable",value:"orderbynum"},{label:d.reversebynum,cmdName:"sorttable",value:"reversebynum"}]},{group:d.borderbk,icon:"borderBack",subMenu:[{label:d.setcolor,cmdName:"interlacetable",exec:function(){this.execCommand("interlacetable")}},{label:d.unsetcolor,cmdName:"uninterlacetable",exec:function(){this.execCommand("uninterlacetable")}},{label:d.setbackground,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#bbb","#ccc"]})}},{label:d.unsetbackground,cmdName:"cleartablebackground",exec:function(){this.execCommand("cleartablebackground")}},{label:d.redandblue,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["red","blue"]})}},{label:d.threecolorgradient,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#aaa","#bbb","#ccc"]})}}]},{group:d.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:d.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",className:"left",label:d.tableleft,value:"left"},{cmdName:"tablealignment",className:"center",label:d.tablecenter,value:"center"},{cmdName:"tablealignment",className:"right",label:d.tableright,value:"right"}]},"-",{label:d.insertparagraphbefore,cmdName:"insertparagraph",value:!0},{label:d.insertparagraphafter,cmdName:"insertparagraph"},{label:d.copy,cmdName:"copy"},{label:d.paste,cmdName:"paste"}]).length&&(m=UE.ui.uiUtils,h.addListener("contextmenu",function(e,t){var n=m.getViewportOffsetByEvent(t);h.fireEvent("beforeselectionchange"),c&&c.destroy();for(var i,o,a,s=0,l=[];i=u[s];s++)!function(e){if("-"==e)(o=l[l.length-1])&&"-"!==o&&l.push("-");else if(e.hasOwnProperty("group")){for(var t,n=0,i=[];t=e.subMenu[n];n++)!function(e){"-"==e?(o=i[i.length-1])&&"-"!==o?i.push("-"):i.splice(i.length-1):(h.commands[e.cmdName]||UE.commands[e.cmdName]||e.query)&&-1<(e.query?e.query():h.queryCommandState(e.cmdName))&&i.push({label:e.label||h.getLang("contextMenu."+e.cmdName+(e.value||""))||"",className:"edui-for-"+e.cmdName+(e.className?" edui-for-"+e.cmdName+"-"+e.className:""),onclick:e.exec?function(){e.exec.call(h)}:function(){h.execCommand(e.cmdName,e.value)}})}(t);i.length&&l.push({label:function(){switch(e.icon){case"table":return h.getLang("contextMenu.table");case"justifyjustify":return h.getLang("contextMenu.paragraph");case"aligntd":return h.getLang("contextMenu.aligntd");case"aligntable":return h.getLang("contextMenu.aligntable");case"tablesort":return d.tablesort;case"borderBack":return d.borderbk;default:return""}}(),className:"edui-for-"+e.icon,subMenu:{items:i,editor:h}})}else(h.commands[e.cmdName]||UE.commands[e.cmdName]||e.query)&&-1<(e.query?e.query.call(h):h.queryCommandState(e.cmdName))&&l.push({label:e.label||h.getLang("contextMenu."+e.cmdName),className:"edui-for-"+(e.icon||e.cmdName+(e.value||"")),onclick:e.exec?function(){e.exec.call(h)}:function(){h.execCommand(e.cmdName,e.value)}})}(i);if("-"==l[l.length-1]&&l.pop(),(c=new UE.ui.Menu({items:l,className:"edui-contextmenu",editor:h})).render(),c.showAt(n),h.fireEvent("aftershowcontextmenu",c),f.preventDefault(t),r.ie){try{a=h.selection.getNative().createRange()}catch(e){return}a.item&&new L.Range(h.document).selectNode(a.item(0)).select(!0,!0)}}),h.addListener("aftershowcontextmenu",function(e,t){if(h.zeroclipboard){var n,i=t.items;for(n in i)"edui-for-copy"==i[n].className&&h.zeroclipboard.clip(i[n].getDom())}})))},UE.plugins.shortcutmenu=function(){var a,l=this.options.shortcutMenu||[];l.length&&(this.addListener("contextmenu mouseup",function(e,t){var n,i=this,o={type:e,target:t.target||t.srcElement,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY};if(setTimeout(function(){!1!==i.selection.getRange().collapsed&&"contextmenu"!=e||(a||((a=new s.editor.ui.ShortCutMenu({editor:i,items:l,theme:i.options.theme,className:"edui-shortcutmenu"})).render(),i.fireEvent("afterrendershortcutmenu",a)),a.show(o,!!UE.plugins.contextmenu))}),"contextmenu"==e&&(f.preventDefault(t),r.ie9below)){try{n=i.selection.getNative().createRange()}catch(e){return}n.item&&new L.Range(i.document).selectNode(n.item(0)).select(!0,!0)}}),this.addListener("keydown",function(e){"keydown"==e&&a&&!a.isHidden&&a.hide()}))},UE.plugins.basestyle=function(){function o(e,t){return f.filterNodeList(e.selection.getStartElementPath(),t)}var e,t={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},r=this;for(e in r.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"}),r.addInputRule(function(e){p.each(e.getNodesByTagName("b i"),function(e){switch(e.tagName){case"b":e.tagName="strong";break;case"i":e.tagName="em"}})}),t)!function(i){r.commands[e]={execCommand:function(e){var t=r.selection.getRange(),n=o(this,i);t.collapsed?(n?(e=r.document.createTextNode(""),t.insertNode(e).removeInlineStyle(i),t.setStartBefore(e),f.remove(e)):(n=t.document.createElement(i[0]),"superscript"!=e&&"subscript"!=e||(e=r.document.createTextNode(""),t.insertNode(e).removeInlineStyle(["sub","sup"]).setStartBefore(e).collapse(!0)),t.insertNode(n).setStart(n,0)),t.collapse(!0)):("superscript"!=e&&"subscript"!=e||n&&n.tagName.toLowerCase()==e||t.removeInlineStyle(["sub","sup"]),n?t.removeInlineStyle(i):t.applyInlineStyle(i[0])),t.select()},queryCommandState:function(){return o(this,i)?1:0}}}(t[e])},UE.plugins.elementpath=function(){var r,a,o=this;o.setOpt("elementPathEnabled",!0),o.options.elementPathEnabled&&(o.commands.elementpath={execCommand:function(e,t){var n=a[t],i=o.selection.getRange();r=+t,i.selectNode(n).select()},queryCommandValue:function(){var e=[].concat(this.selection.getStartElementPath()).reverse(),t=[];a=e;for(var n,i=0;n=e[i];i++)if(3!=n.nodeType){var o=n.tagName.toLowerCase();if("img"==o&&n.getAttribute("anchorname")&&(o="anchor"),t[i]=o,r==i){r=-1;break}}return t}})},UE.plugins.formatmatch=function(){function o(e,t){r.webkit&&(i="IMG"==t.target.tagName?t.target:null),s.undoManger&&s.undoManger.save();var n,t=s.selection.getRange(),i=i||t.getClosedNode();a&&i&&"IMG"==i.tagName?(i.style.cssText+=";float:"+(a.style.cssFloat||a.style.styleFloat||"none")+";display:"+(a.style.display||"inline"),a=null):a||(t.collapsed&&(n=s.document.createTextNode("match"),t.insertNode(n).select()),s.__hasEnterExecCommand=!0,t=s.options.removeFormatAttributes,s.options.removeFormatAttributes="",s.execCommand("removeformat"),s.options.removeFormatAttributes=t,s.__hasEnterExecCommand=!1,t=s.selection.getRange(),l.length&&(i=t,n&&i.selectNode(n),i.applyInlineStyle(l[l.length-1].tagName,null,l)),n&&t.setStartBefore(n).collapse(!0),t.select(),n&&f.remove(n)),s.undoManger&&s.undoManger.save(),s.removeListener("mouseup",o),d=0}var a,s=this,l=[],d=0;s.addListener("reset",function(){l=[],d=0}),s.commands.formatmatch={execCommand:function(e){if(d)d=0,l=[],s.removeListener("mouseup",o);else{if(e=s.selection.getRange(),!(a=e.getClosedNode())||"IMG"!=a.tagName){e.collapse(!0).shrinkBoundary(),l=f.findParents(e.startContainer,!0,function(e){return!f.isBlockElm(e)&&1==e.nodeType}),e=0;for(var t;t=l[e];e++)if("A"==t.tagName){l.splice(e,1);break}}s.addListener("mouseup",o),d=1}},queryCommandState:function(){return d},notNeedUndo:1}},UE.plugin.register("searchreplace",function(){function h(e,t,n){var i=0;e=e.firstChild;for(var o=0;e;){if(3==e.nodeType){if(t<=(i+=o=e.nodeValue.replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length))return{node:e,index:o-(i-t)}}else if(!v.$empty[e.tagName]&&(t<=(i+=o=e[r.ie?"innerText":"textContent"].replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length)&&(o=h(e,o-(i-t),n))))return o;e=f.getNextDomNode(e)}}function a(e,t){var n=e.selection.getRange(),i=t.searchStr;if((s=e.document.createElement("span")).innerHTML="$$ueditor_searchreplace_key$$",n.shrinkBoundary(!0),!n.collapsed){n.select();var o=e.selection.getText();if(RegExp("^"+t.searchStr+"$",t.casesensitive?"":"i").test(o)){if(null!=t.replaceStr)return i=t.replaceStr,i=g.document.createTextNode(i),n.deleteContents().insertNode(i),n.select(),1;n.collapse(-1==t.dir)}}n.insertNode(s),n.enlargeToBlockElm(!0),o=(l=n.startContainer)[r.ie?"innerText":"textContent"].indexOf("$$ueditor_searchreplace_key$$"),n.setStartBefore(s),f.remove(s);e:{var a,s=l,l=t.all||1==t.dir?"getNextDomNode":"getPreDomNode";for(f.isBody(s)&&(s=s.firstChild);s;){a=3==s.nodeType?s.nodeValue:s[r.ie?"innerText":"textContent"];t:{var d=t,c=o,u=d.searchStr;-1==d.dir&&(a=a.split("").reverse().join(""),u=u.split("").reverse().join(""),c=a.length-c);for(var m,u=RegExp(u,"g"+(d.casesensitive?"":"i"));m=u.exec(a);)if(m.index>=c){a=-1==d.dir?a.length-m.index-d.searchStr.length:m.index;break t}a=-1}if(-1!=a){o={node:s,index:a};break e}for(s=f[l](s);s&&b[s.nodeName.toLowerCase()];)s=f[l](s,!0);s&&(o=-1==t.dir?(3==s.nodeType?s.nodeValue:s[r.ie?"innerText":"textContent"]).length:0)}o=void 0}if(o)return s=h(o.node,o.index,i),i=h(o.node,o.index+i.length,i),n.setStart(s.node,s.index).setEnd(i.node,i.index),void 0!==t.replaceStr&&(i=t.replaceStr,i=g.document.createTextNode(i),n.deleteContents().insertNode(i)),n.select(),1;n.setCursor()}var g=this,b={table:1,tbody:1,tr:1,ol:1,ul:1};return{commands:{searchreplace:{execCommand:function(e,t){p.extend(t,{all:!1,casesensitive:!1,dir:1},!0);var n=0;if(t.all){var i=g.selection.getRange(),o=g.body.firstChild;for(o&&1==o.nodeType?(i.setStart(o,0),i.shrinkBoundary(!0)):3==o.nodeType&&i.setStartBefore(o),i.collapse(!0).select(!0),void 0!==t.replaceStr&&g.fireEvent("saveScene");a(this,t);)n++}else void 0!==t.replaceStr&&g.fireEvent("saveScene"),a(this,t)&&n++;return n&&g.fireEvent("saveScene"),n},notNeedUndo:1}}}}),UE.plugins.customstyle=function(){var o=this;o.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]}),o.commands.customstyle={execCommand:function(e,t){var n,i,o=t.tag,r=f.findParent(this.selection.getStart(),function(e){return e.getAttribute("label")},!0),a={};for(n in t)void 0!==t[n]&&(a[n]=t[n]);if(delete a.tag,r&&r.getAttribute("label")==t.label){if(i=(n=this.selection.getRange()).createBookmark(),n.collapsed)v.$block[r.tagName]?(l=this.document.createElement("p"),f.moveChild(r,l),r.parentNode.insertBefore(l,r),f.remove(r)):f.remove(r,!0);else{r=f.getCommonAncestor(i.start,i.end),a=f.getElementsByTagName(r,o),RegExp(o,"i").test(r.tagName)&&a.push(r);for(var s,l,d,c=0;s=a[c++];)s.getAttribute("label")==t.label&&(l=f.getPosition(s,i.start),d=f.getPosition(s,i.end),(l&f.POSITION_FOLLOWING||l&f.POSITION_CONTAINS)&&(d&f.POSITION_PRECEDING||d&f.POSITION_CONTAINS)&&v.$block[o]&&(l=this.document.createElement("p"),f.moveChild(s,l),s.parentNode.insertBefore(l,s)),f.remove(s,!0));(r=f.findParent(r,function(e){return e.getAttribute("label")==t.label},!0))&&f.remove(r,!0)}n.moveToBookmark(i).select()}else v.$block[o]?(this.execCommand("paragraph",o,a,"customstyle"),(n=this.selection.getRange()).collapsed||(n.collapse(),r=f.findParent(this.selection.getStart(),function(e){return e.getAttribute("label")==t.label},!0),o=this.document.createElement("p"),f.insertAfter(r,o),f.fillNode(this.document,o),n.setStart(o,0).setCursor())):(n=this.selection.getRange()).collapsed?(r=this.document.createElement(o),f.setAttributes(r,a),n.insertNode(r).setStart(r,0).setCursor()):(i=n.createBookmark(),n.applyInlineStyle(o,a).moveToBookmark(i).select())},queryCommandValue:function(){var e=f.filterNodeList(this.selection.getStartElementPath(),function(e){return e.getAttribute("label")});return e?e.getAttribute("label"):""}},o.addListener("keyup",function(e,t){var n,i=t.keyCode||t.which;32!=i&&13!=i||(i=o.selection.getRange()).collapsed&&(n=f.findParent(o.selection.getStart(),function(e){return e.getAttribute("label")},!0))&&v.$block[n.tagName]&&f.isEmptyNode(n)&&(t=o.document.createElement("p"),f.insertAfter(n,t),f.fillNode(o.document,t),f.remove(n),i.setStart(t,0).setCursor())})},UE.plugins.catchremoteimage=function(){var d=this,c=UE.ajax;!1!==d.options.catchRemoteImageEnable&&(d.setOpt({catchRemoteImageEnable:!1}),d.addListener("afterpaste",function(){d.fireEvent("catchRemoteImage")}),d.addListener("catchRemoteImage",function(){function b(t,n){var i=p.serializeParam(d.queryCommandValue("serverparam"))||"",i=p.formatUrl(e+(-1==e.indexOf("?")?"?":"&")+i),n={method:"POST",dataType:p.isCrossDomainUrl(i)?"jsonp":"",timeout:6e4,onsuccess:n.success,onerror:n.error};n[g]=t,c.request(i,n)}for(var a=d.getOpt("catcherLocalDomain"),e=d.getActionUrl(d.getOpt("catcherActionName")),h=d.getOpt("catcherUrlPrefix"),g=d.getOpt("catcherFieldName"),l=[],k=f.getElementsByTagName(d.document,"img"),m=function(e,t){if(-1!=e.indexOf(location.host)||/(^\.)|(^\/)/.test(e))return!0;if(t)for(var n,i=0;n=t[i++];)if(-1!==e.indexOf(n))return!0;return!1},n=0,q;q=k[n++];)q.getAttribute("word_img")||(q=q.getAttribute("_src")||q.src||"",/^(https?|ftp):/i.test(q)&&!m(q,a)&&l.push(q));l.length&&b(l,{success:function(a){try{var b=void 0!==a.state?a:eval("("+a.responseText+")")}catch(c){return}var e,g,n,l=b.list;for(a=0;b=k[a++];)for(n=b.getAttribute("_src")||b.src||"",e=0;g=l[e++];)if(n==g.source&&"SUCCESS"==g.state){e=h+g.url,f.setAttributes(b,{src:e,_src:e});break}d.fireEvent("catchremotesuccess")},error:function(){d.fireEvent("catchremoteerror")}})}))},UE.plugin.register("snapscreen",function(){function d(e){var t=document.createElement("a"),n=p.serializeParam(c.queryCommandValue("serverparam"))||"";return t.href=e,r.ie&&(t.href=t.href),e=t.search,n&&(e=(e=e+(-1==e.indexOf("?")?"?":"&")+n).replace(/[&]+/gi,"&")),{port:t.port,hostname:t.hostname,path:t.pathname+e||+t.hash}}var c=this,b;return{commands:{snapscreen:{execCommand:function(a){function e(a){try{var b;a=eval("("+a+")"),"SUCCESS"==a.state?(b=c.options,c.execCommand("insertimage",{src:b.snapscreenUrlPrefix+a.url,_src:b.snapscreenUrlPrefix+a.url,alt:a.title||"",floatStyle:b.snapscreenImgAlign})):alert(a.state)}catch(e){alert(l.callBackErrorMsg)}}var f,g,l=c.getLang("snapScreen_plugin");if(!b){a=c.container,b=(c.container.ownerDocument||c.container.document).createElement("object");try{b.type="application/x-pluginbaidusnap"}catch(k){return}b.style.cssText="position:absolute;left:-9999px;width:0;height:0;",b.setAttribute("width","0"),b.setAttribute("height","0"),a.appendChild(b)}a=c.getActionUrl(c.getOpt("snapscreenActionName")),f=d(a),setTimeout(function(){try{g=b.saveSnapshot(f.hostname,f.path,f.port)}catch(e){return void c.ui._dialogs.snapscreenDialog.open()}e(g)},50)},queryCommandState:function(){return-1!=navigator.userAgent.indexOf("Windows",0)?0:-1}}}}}),UE.commands.insertparagraph={execCommand:function(e,t){for(var n,i=this.selection.getRange(),o=i.startContainer;o&&!f.isBody(o);)o=(n=o).parentNode;n&&(o=this.document.createElement("p"),t?n.parentNode.insertBefore(o,n):n.parentNode.insertBefore(o,n.nextSibling),f.fillNode(this.document,o),i.setStart(o,0).setCursor(!1,!0))}},UE.plugin.register("webapp",function(){function n(e,t){return t?'<iframe class="edui-faked-webapp" title="'+e.title+'" '+(e.align&&!e.cssfloat?'align="'+e.align+'"':"")+(e.cssfloat?'style="float:'+e.cssfloat+'"':"")+'width="'+e.width+'" height="'+e.height+'"  scrolling="no" frameborder="0" src="'+e.url+'" logo_url = "'+e.logo+'"></iframe>':'<img title="'+e.title+'" width="'+e.width+'" height="'+e.height+'" src="'+i.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" _logo_url="'+e.logo+'" style="background:url('+e.logo+') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+e.url+'" '+(e.align&&!e.cssfloat?'align="'+e.align+'"':"")+(e.cssfloat?'style="float:'+e.cssfloat+'"':"")+"/>"}var i=this;return{outputRule:function(e){p.each(e.getNodesByTagName("img"),function(e){var t;"edui-faked-webapp"==e.getAttr("class")&&(t=n({title:e.getAttr("title"),width:e.getAttr("width"),height:e.getAttr("height"),align:e.getAttr("align"),cssfloat:e.getStyle("float"),url:e.getAttr("_url"),logo:e.getAttr("_logo_url")},!0),t=UE.uNode.createElement(t),e.parentNode.replaceChild(t,e))})},inputRule:function(e){p.each(e.getNodesByTagName("iframe"),function(e){var t;"edui-faked-webapp"==e.getAttr("class")&&(t=UE.uNode.createElement(n({title:e.getAttr("title"),width:e.getAttr("width"),height:e.getAttr("height"),align:e.getAttr("align"),cssfloat:e.getStyle("float"),url:e.getAttr("src"),logo:e.getAttr("logo_url")})),e.parentNode.replaceChild(t,e))})},commands:{webapp:{execCommand:function(e,t){t=n(p.extend(t,{align:"none"}),!1);this.execCommand("inserthtml",t)},queryCommandState:function(){var e=this.selection.getRange().getClosedNode();return e&&"edui-faked-webapp"==e.className?1:0}}}}}),UE.plugins.template=function(){UE.commands.template={execCommand:function(e,t){t.html&&this.execCommand("inserthtml",t.html)}},this.addListener("click",function(e,t){var n=t.target||t.srcElement,t=this.selection.getRange();(n=f.findParent(n,function(e){if(e.className&&f.hasClass(e,"ue_t"))return e},!0))&&t.selectNode(n).shrinkBoundary().select()}),this.addListener("keydown",function(e,t){var n=this.selection.getRange();n.collapsed||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey||(n=f.findParent(n.startContainer,function(e){if(e.className&&f.hasClass(e,"ue_t"))return e},!0))&&f.removeClasses(n,["ue_t"])})},UE.plugin.register("music",function(){function i(e,t,n,i,o,r){return r?'<embed type="application/x-shockwave-flash" class="edui-faked-music" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+e+'" width="'+t+'" height="'+n+'" '+(i&&!o?'align="'+i+'"':"")+(o?'style="float:'+o+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':"<img "+(i&&!o?'align="'+i+'"':"")+(o?'style="float:'+o+'"':"")+' width="'+t+'" height="'+n+'" _url="'+e+'" class="edui-faked-music" src="'+a.options.langPath+a.options.lang+'/images/music.png" />'}var a=this;return{outputRule:function(e){p.each(e.getNodesByTagName("img"),function(e){var t,n;"edui-faked-music"==e.getAttr("class")&&(n=e.getStyle("float"),t=e.getAttr("align"),n=i(e.getAttr("_url"),e.getAttr("width"),e.getAttr("height"),t,n,!0),n=UE.uNode.createElement(n),e.parentNode.replaceChild(n,e))})},inputRule:function(e){p.each(e.getNodesByTagName("embed"),function(e){var t,n;"edui-faked-music"==e.getAttr("class")&&(t=e.getStyle("float"),n=e.getAttr("align"),html=i(e.getAttr("src"),e.getAttr("width"),e.getAttr("height"),n,t,!1),t=UE.uNode.createElement(html),e.parentNode.replaceChild(t,e))})},commands:{music:{execCommand:function(e,t){t=i(t.url,t.width||400,t.height||95,"none",!1);this.execCommand("inserthtml",t)},queryCommandState:function(){var e=this.selection.getRange().getClosedNode();return e&&"edui-faked-music"==e.className?1:0}}}}}),UE.plugin.register("autoupload",function(){return{outputRule:function(e){p.each(e.getNodesByTagName("img"),function(e){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(e.getAttr("class"))&&e.parentNode.removeChild(e)}),p.each(e.getNodesByTagName("p"),function(e){/\bloadpara\b/.test(e.getAttr("class"))&&e.parentNode.removeChild(e)})},bindEvents:{ready:function(e){var r=this;window.FormData&&window.FileReader&&(f.on(r.body,"paste drop",function(e){var t,n=!1;if(t="paste"==e.type?e.clipboardData&&e.clipboardData.items&&1==e.clipboardData.items.length&&/^image\//.test(e.clipboardData.items[0].type)?e.clipboardData.items:null:e.dataTransfer&&e.dataTransfer.files?e.dataTransfer.files:null){for(var i,o=t.length;o--;)(i=t[o]).getAsFile&&(i=i.getAsFile()),i&&0<i.size&&(function(e,o){var t,n=/image\/\w+/i.test(e.type)?"image":"file",r="loading_"+(+new Date).toString(36),i=o.getOpt(n+"FieldName"),a=o.getOpt(n+"UrlPrefix"),s=o.getOpt(n+"MaxSize"),l=o.getOpt(n+"AllowFiles"),d=o.getActionUrl(o.getOpt(n+"ActionName")),c=function(e){var t=o.document.getElementById(r);t&&f.remove(t),o.fireEvent("showmessage",{id:r,content:e,type:"error",timeout:4e3})},u="image"==n?(t='<img class="loadingclass" id="'+r+'" src="'+o.options.themePath+o.options.theme+'/images/spacer.gif" title="'+(o.getLang("autoupload.loading")||"")+'" >',function(e){var t=a+e.url,n=o.document.getElementById(r);n&&(n.setAttribute("src",t),n.setAttribute("_src",t),n.setAttribute("title",e.title||""),n.setAttribute("alt",e.original||""),n.removeAttribute("id"),f.removeClasses(n,"loadingclass"))}):(t='<p><img class="loadingclass" id="'+r+'" src="'+o.options.themePath+o.options.theme+'/images/spacer.gif" title="'+(o.getLang("autoupload.loading")||"")+'" ></p>',function(e){e=a+e.url;var t=o.document.getElementById(r),n=o.selection.getRange(),i=n.createBookmark();n.selectNode(t).select(),o.execCommand("insertfile",{url:e}),n.moveToBookmark(i).select()});o.execCommand("inserthtml",t),o.getOpt(n+"ActionName")?e.size>s?c(o.getLang("autoupload.exceedSizeError")):(s=e.name?e.name.substr(e.name.lastIndexOf(".")):"")&&"image"!=n||l&&-1==(l.join("")+".").indexOf(s.toLowerCase()+".")?c(o.getLang("autoupload.exceedTypeError")):(l=new XMLHttpRequest,n=new FormData,s=p.serializeParam(o.queryCommandValue("serverparam"))||"",d=p.formatUrl(d+(-1==d.indexOf("?")?"?":"&")+s),n.append(i,e,e.name||"blob."+e.type.substr(6)),n.append("type","ajax"),l.open("post",d,!0),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.addEventListener("load",function(e){try{var t=new Function("return "+p.trim(e.target.response))();"SUCCESS"==t.state&&t.url?u(t):c(t.state)}catch(e){c(o.getLang("autoupload.loadError"))}}),l.send(n)):c(o.getLang("autoupload.errorLoadConfig"))}(i,r),n=!0);n&&e.preventDefault()}}),f.on(r.body,"dragover",function(e){"Files"==e.dataTransfer.types[0]&&e.preventDefault()}),p.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document))}}}}),UE.plugin.register("autosave",function(){function e(e){var t;new Date-i<o||(e.hasContents()?(i=new Date,e._saveFlag=null,t=n.body.innerHTML,!1!==e.fireEvent("beforeautosave",{content:t})&&(n.setPreferences(r,t),e.fireEvent("afterautosave",{content:t}))):r&&n.removePreferences(r))}var n=this,i=new Date,o=20,r=null;return{defaultOptions:{saveInterval:500},bindEvents:{ready:function(){var e=n.key?n.key+"-drafts-data":(n.container.parentNode.id||"ue-common")+"-drafts-data";r=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_")+e},contentchange:function(){r&&(n._saveFlag&&window.clearTimeout(n._saveFlag),0<n.options.saveInterval?n._saveFlag=window.setTimeout(function(){e(n)},n.options.saveInterval):e(n))}},commands:{clearlocaldata:{execCommand:function(e,t){r&&n.getPreferences(r)&&n.removePreferences(r)},notNeedUndo:!0,ignoreContentChange:!0},getlocaldata:{execCommand:function(e,t){return r&&n.getPreferences(r)||""},notNeedUndo:!0,ignoreContentChange:!0},drafts:{execCommand:function(e,t){r&&(n.body.innerHTML=n.getPreferences(r)||"<p>"+f.fillHtml+"</p>",n.focus(!0))},queryCommandState:function(){return!r||null===n.getPreferences(r)?-1:0},notNeedUndo:!0,ignoreContentChange:!0}}}}),UE.plugin.register("charts",function(){function a(e){var t=null;if(!(e.rows.length<2||e.rows[0].cells.length<2)){for(var n,i=(t=e.rows[0].cells).length,o=0;n=t[o];o++)if("th"!==n.tagName.toLowerCase())return;for(o=1;t=e.rows[o];o++){if(t.cells.length!=i||"th"!==t.cells[0].tagName.toLowerCase())return;for(var r=1;n=t.cells[r];r++)if(n=(n=p.trim(n.innerText||n.textContent||"")).replace(RegExp(UE.dom.domUtils.fillChar,"g"),"").replace(/^\s+|\s+$/g,""),!/^\d*\.?\d+$/.test(n))return}return 1}}var s=this;return{bindEvents:{chartserror:function(){}},commands:{charts:{execCommand:function(e,t){var n,i=f.findParentByTagName(this.selection.getRange().startContainer,"table",!0),o=[],r={};if(!i)return!1;if(!a(i))return s.fireEvent("chartserror"),!1;for(n in r.title=t.title||"",r.subTitle=t.subTitle||"",r.xTitle=t.xTitle||"",r.yTitle=t.yTitle||"",r.suffix=t.suffix||"",r.tip=t.tip||"",r.dataFormat=t.tableDataFormat||"",r.chartType=t.chartType||0,r)r.hasOwnProperty(n)&&o.push(n+":"+r[n]);i.setAttribute("data-chart",o.join(";")),f.addClass(i,"edui-charts-table")},queryCommandState:function(e,t){var n=f.findParentByTagName(this.selection.getRange().startContainer,"table",!0);return n&&a(n)?0:-1}}},inputRule:function(e){p.each(e.getNodesByTagName("table"),function(e){void 0!==e.getAttr("data-chart")&&e.setAttr("style")})},outputRule:function(e){p.each(e.getNodesByTagName("table"),function(e){void 0!==e.getAttr("data-chart")&&e.setAttr("style","display: none;")})}}}),UE.plugin.register("section",function(){function n(e){this.tag="",this.level=-1,this.parentSection=this.previousSection=this.nextSection=this.dom=null,this.startAddress=[],this.endAddress=[],this.children=[]}function m(e){var t=new n;return p.extend(t,e)}function l(e,t){for(var n=t,i=0;i<e.length;i++){if(!n.childNodes)return null;n=n.childNodes[e[i]]}return n}var i=this;return{bindMultiEvents:{type:"aftersetcontent afterscencerestore",handler:function(){i.fireEvent("updateSections")}},bindEvents:{ready:function(){i.fireEvent("updateSections"),f.on(i.body,"drop paste",function(){i.fireEvent("updateSections")})},afterexeccommand:function(e,t){"paragraph"==t&&i.fireEvent("updateSections")},keyup:function(e,t){var n;1==this.selection.getRange().collapsed&&13!=(n=t.keyCode||t.which)&&8!=n&&46!=n||this.fireEvent("updateSections")}},commands:{getsections:{execCommand:function(e,t){for(var c=t||"h1 h2 h3 h4 h5 h6".split(" "),n=0;n<c.length;n++)"string"==typeof c[n]?c[n]=function(t){return function(e){return e.tagName==t.toUpperCase()}}(c[n]):"function"!=typeof c[n]&&(c[n]=function(e){return null});var u=this,f=n=m({level:-1,title:"root"});return function e(t,n){for(var i,o,r=null,a=t.childNodes,s=0,l=a.length;s<l;s++){e:{i=o=a[s];for(var d=0;d<c.length;d++)if(c[d](i)){i=d;break e}i=-1}if(0<=i){for(r=u.selection.getRange().selectNode(o).createAddress(!0).startAddress,r=m({tag:o.tagName,title:o.innerText||o.textContent||"",level:i,dom:o,startAddress:p.clone(r,[]),endAddress:p.clone(r,[]),children:[]}),o=(f.nextSection=r).previousSection=f;i<=o.level;)o=o.parentSection;(r.parentSection=o).children.push(r),r=f=r}else 1===o.nodeType&&e(o,n),r&&r.endAddress[r.endAddress.length-1]++}}(u.body,n),n},notNeedUndo:!0},movesection:{execCommand:function(e,t,n,i){if(t&&n&&-1!=n.level){var o;if(e=l(n=i?n.endAddress:n.startAddress,this.body),!(o=!n)&&!(o=!e)){o=t.startAddress;for(var r=!1,a=!1,s=0;s<o.length&&!(s>=n.length);s++){if(n[s]>o[s]){r=!0;break}if(n[s]<o[s])break}for(s=0;s<t.endAddress.length&&!(s>=n.length);s++){if(n[s]<o[s]){a=!0;break}if(n[s]>o[s])break}o=r&&a}if(!o){if(n=l(t.startAddress,this.body),t=l(t.endAddress,this.body),i)for(i=t;i&&!(f.getPosition(n,i)&f.POSITION_FOLLOWING)&&(o=i.previousSibling,f.insertAfter(e,i),i!=n);)i=o;else for(i=n;i&&!(f.getPosition(i,t)&f.POSITION_FOLLOWING)&&(o=i.nextSibling,e.parentNode.insertBefore(i,e),i!=t);)i=o;this.fireEvent("updateSections")}}}},deletesection:{execCommand:function(e,t,n){function i(e){for(var t=o.body,n=0;n<e.length;n++){if(!t.childNodes)return null;t=t.childNodes[e[n]]}return t}var o=this;if(t){if(e=i(t.startAddress),t=i(t.endAddress),n)f.remove(e);else for(;e&&f.inDoc(t,o.document)&&!(f.getPosition(e,t)&f.POSITION_FOLLOWING);)n=e.nextSibling,f.remove(e),e=n;o.fireEvent("updateSections")}}},selectsection:{execCommand:function(e,t){if(!t&&!t.dom)return!1;var n=this.selection.getRange(),t={startAddress:p.clone(t.startAddress,[]),endAddress:p.clone(t.endAddress,[])};return t.endAddress[t.endAddress.length-1]++,n.moveToAddress(t).select().scrollToView(),!0},notNeedUndo:!0},scrolltosection:{execCommand:function(e,t){if(!t&&!t.dom)return!1;var n=this.selection.getRange(),t={startAddress:t.startAddress,endAddress:t.endAddress};return t.endAddress[t.endAddress.length-1]++,n.moveToAddress(t).scrollToView(),!0},notNeedUndo:!0}}}}),UE.plugin.register("simpleupload",function(){function n(){var r=i.offsetWidth||20,d=i.offsetHeight||20,c=document.createElement("iframe"),u="display:block;width:"+r+"px;height:"+d+"px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;";f.on(c,"load",function(){var e=(+new Date).toString(36),t=c.contentDocument||c.contentWindow.document,n=t.body,i=t.createElement("div");i.innerHTML='<form id="edui_form_'+e+'" target="edui_iframe_'+e+'" method="POST" enctype="multipart/form-data" action="'+m.getOpt("serverUrl")+'" style="'+u+'"><input id="edui_input_'+e+'" type="file" accept="image/*" name="'+m.options.imageFieldName+'" style="'+u+'"></form><iframe id="edui_iframe_'+e+'" name="edui_iframe_'+e+'" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>',i.className="edui-"+m.options.theme,i.id=m.ui.id+"_iframeupload",n.style.cssText=u,n.style.width=r+"px",n.style.height=d+"px",n.appendChild(i),n.parentNode&&(n.parentNode.style.width=r+"px",n.parentNode.style.height=r+"px");var o,a=t.getElementById("edui_form_"+e),s=t.getElementById("edui_input_"+e),l=t.getElementById("edui_iframe_"+e);f.on(s,"change",function(){function o(e){var t;r&&((t=m.document.getElementById(r))&&f.remove(t),m.fireEvent("showmessage",{id:r,content:e,type:"error",timeout:4e3}))}var r,e,t,n,i;s.value&&(r="loading_"+(+new Date).toString(36),e=p.serializeParam(m.queryCommandValue("serverparam"))||"",t=m.getActionUrl(m.getOpt("imageActionName")),n=m.getOpt("imageAllowFiles"),m.focus(),m.execCommand("inserthtml",'<img class="loadingclass" id="'+r+'" src="'+m.options.themePath+m.options.theme+'/images/spacer.gif" title="'+(m.getLang("simpleupload.loading")||"")+'" >'),m.getOpt("imageActionName")?!(i=(i=s.value)?i.substr(i.lastIndexOf(".")):"")||n&&-1==(n.join("")+".").indexOf(i.toLowerCase()+".")?o(m.getLang("simpleupload.exceedTypeError")):(f.on(l,"load",function e(){try{var t=(l.contentDocument||l.contentWindow.document).body,n=new Function("return "+(t.innerText||t.textContent||""))(),i=m.options.imageUrlPrefix+n.url;"SUCCESS"==n.state&&n.url?((t=m.document.getElementById(r)).setAttribute("src",i),t.setAttribute("_src",i),t.setAttribute("title",n.title||""),t.setAttribute("alt",n.original||""),t.removeAttribute("id"),f.removeClasses(t,"loadingclass")):o(n.state)}catch(e){o(m.getLang("simpleupload.loadError"))}a.reset(),f.un(l,"load",e)}),a.action=p.formatUrl(t+(-1==t.indexOf("?")?"?":"&")+e),a.submit()):errorHandler(m.getLang("autoupload.errorLoadConfig")))}),m.addListener("selectionchange",function(){clearTimeout(o),o=setTimeout(function(){-1==m.queryCommandState("simpleupload")?s.disabled="disabled":s.disabled=!1},400)}),h=!0}),c.style.cssText=u,i.appendChild(c)}var i,m=this,h=!1;return{bindEvents:{ready:function(){p.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)},simpleuploadbtnready:function(e,t){i=t,m.afterConfigReady(n)}},outputRule:function(e){p.each(e.getNodesByTagName("img"),function(e){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(e.getAttr("class"))&&e.parentNode.removeChild(e)})},commands:{simpleupload:{queryCommandState:function(){return h?0:-1}}}}}),UE.plugin.register("serverparam",function(){var i={};return{commands:{serverparam:{execCommand:function(e,t,n){null==t?i={}:p.isString(t)?null==n?delete i[t]:i[t]=n:p.isObject(t)?p.extend(i,t,!0):p.isFunction(t)&&p.extend(i,t(),!0)},queryCommandValue:function(){return i||{}}}}}}),UE.plugin.register("insertfile",function(){var d=this;return{commands:{insertfile:{execCommand:function(e,t){t=p.isArray(t)?t:[t];var n,i,o,r="",a=d.getOpt("UEDITOR_HOME_URL"),s=a+("/"==a.substr(a.length-1)?"":"/")+"dialogs/attachment/fileTypeImages/";for(a=0;a<t.length;a++){i=s;var l={rar:"icon_rar.gif",zip:"icon_rar.gif",tar:"icon_rar.gif",gz:"icon_rar.gif",bz2:"icon_rar.gif",doc:"icon_doc.gif",docx:"icon_doc.gif",pdf:"icon_pdf.gif",mp3:"icon_mp3.gif",xls:"icon_xls.gif",chm:"icon_chm.gif",ppt:"icon_ppt.gif",pptx:"icon_ppt.gif",avi:"icon_mv.gif",rmvb:"icon_mv.gif",wmv:"icon_mv.gif",flv:"icon_mv.gif",swf:"icon_mv.gif",rm:"icon_mv.gif",exe:"icon_exe.gif",psd:"icon_psd.gif",txt:"icon_txt.gif",jpg:"icon_jpg.gif",png:"icon_jpg.gif",jpeg:"icon_jpg.gif",gif:"icon_jpg.gif",ico:"icon_jpg.gif",bmp:"icon_jpg.gif"};i+=l[o=(o=(n=t[a]).url).substr(o.lastIndexOf(".")+1).toLowerCase()]||l.txt,o=n.title||n.url.substr(n.url.lastIndexOf("/")+1),r+='<p style="line-height: 16px;"><img style="vertical-align: middle; margin-right: 2px;" src="'+i+'" _src="'+i+'" /><a style="font-size:12px; color:#0066cc;" href="'+n.url+'" title="'+o+'">'+o+"</a></p>"}d.execCommand("insertHtml",r)}}}}}),s=s||{},s.editor=s.editor||{},UE.ui=s.editor.ui={},g5=s.editor.browser,h5=s.editor.dom.domUtils,i5=window.$EDITORUI={},j5=0,k5=s.editor.ui.uiUtils={uid:function(e){return e?e.ID$EDITORUI||(e.ID$EDITORUI=++j5):++j5},hook:function(o,e){var r;return o&&o._callbacks?r=o:(r=function(){var e;o&&(e=o.apply(this,arguments));for(var t=r._callbacks,n=t.length;n--;){var i=t[n].apply(this,arguments);void 0===e&&(e=i)}return e})._callbacks=[],r._callbacks.push(e),r},createElementByHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,(t=t.firstChild).parentNode.removeChild(t),t},getViewportElement:function(){return g5.ie&&g5.quirks?document.body:document.documentElement},getClientRect:function(e){var t;try{t=e.getBoundingClientRect()}catch(e){t={left:0,top:0,height:0,width:0}}for(var n,i={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};(n=e.ownerDocument)!==document&&(e=h5.getWindow(n).frameElement);)t=e.getBoundingClientRect(),i.left+=t.left,i.top+=t.top;return i.bottom=i.top+i.height,i.right=i.left+i.width,i},getViewportRect:function(){var e=k5.getViewportElement(),t=0|(window.innerWidth||e.clientWidth);return{left:0,top:0,height:e=0|(window.innerHeight||e.clientHeight),width:t,bottom:e,right:t}},setViewportOffset:function(e,t){var n=k5.getFixedLayer();e.parentNode===n?(e.style.left=t.left+"px",e.style.top=t.top+"px"):h5.setViewportOffset(e,t)},getEventOffset:function(e){var t=k5.getClientRect(e.target||e.srcElement);return{left:(e=k5.getViewportOffsetByEvent(e)).left-t.left,top:e.top-t.top}},getViewportOffsetByEvent:function(e){var t=e.target||e.srcElement,n=h5.getWindow(t).frameElement;return e={left:e.clientX,top:e.clientY},n&&t.ownerDocument!==document&&(t=k5.getClientRect(n),e.left+=t.left,e.top+=t.top),e},setGlobal:function(e,t){return i5[e]=t,'$EDITORUI["'+e+'"]'},unsetGlobal:function(e){delete i5[e]},copyAttributes:function(e,t){for(var n=t.attributes,i=n.length;i--;){var o=n[i];"style"==o.nodeName||"class"==o.nodeName||g5.ie&&!o.specified||e.setAttribute(o.nodeName,o.nodeValue)}t.className&&h5.addClass(e,t.className),t.style.cssText&&(e.style.cssText+=";"+t.style.cssText)},removeStyle:function(e,t){if(e.style.removeProperty)e.style.removeProperty(t);else{if(!e.style.removeAttribute)throw"";e.style.removeAttribute(t)}},contains:function(e,t){return e&&t&&e!==t&&(e.contains?e.contains(t):16&e.compareDocumentPosition(t))},startDrag:function(e,t,n){function i(e){t.ondragmove(e.clientX-s,e.clientY-l,e),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}n=n||document;var o,r,a,s=e.clientX,l=e.clientY;n.addEventListener?(o=function(e){n.removeEventListener("mousemove",i,!0),n.removeEventListener("mouseup",o,!0),window.removeEventListener("mouseup",o,!0),t.ondragstop()},n.addEventListener("mousemove",i,!0),n.addEventListener("mouseup",o,!0),window.addEventListener("mouseup",o,!0),e.preventDefault()):((r=e.srcElement).setCapture(),a=function(){r.releaseCapture(),r.detachEvent("onmousemove",i),r.detachEvent("onmouseup",a),r.detachEvent("onlosecaptrue",a),t.ondragstop()},r.attachEvent("onmousemove",i),r.attachEvent("onmouseup",a),r.attachEvent("onlosecaptrue",a),e.returnValue=!1),t.ondragstart()},getFixedLayer:function(){var e=document.getElementById("edui_fixedlayer");return null==e&&((e=document.createElement("div")).id="edui_fixedlayer",document.body.appendChild(e),g5.ie&&g5.version<=8?(e.style.position="absolute",h5.on(window,"scroll",f5),h5.on(window,"resize",s.editor.utils.defer(f5,0,!0)),setTimeout(f5)):e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.width="0",e.style.height="0"),e},makeUnselectable:function(e){if(g5.opera||g5.ie&&g5.version<9){if(e.unselectable="on",e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++)1==e.childNodes[t].nodeType&&k5.makeUnselectable(e.childNodes[t])}else void 0!==e.style.MozUserSelect?e.style.MozUserSelect="none":void 0!==e.style.WebkitUserSelect?e.style.WebkitUserSelect="none":void 0!==e.style.KhtmlUserSelect&&(e.style.KhtmlUserSelect="none")}},j6=s.editor.utils,k6=s.editor.ui.uiUtils,l6=s.editor.EventBase,m6=s.editor.ui.UIBase=function(){},m6.prototype={className:"",uiName:"",initOptions:function(e){for(var t in e)this[t]=e[t];this.id=this.id||"edui"+k6.uid()},initUIBase:function(){this._globalKey=j6.unhtml(k6.setGlobal(this.id,this))},render:function(e){for(var t,n=this.renderHtml(),n=k6.createElementByHtml(n),i=f.getElementsByTagName(n,"*"),o="edui-"+(this.theme||this.editor.options.theme),r=document.getElementById("edui_fixedlayer"),a=0;t=i[a++];)f.addClass(t,o);f.addClass(n,o),r&&(r.className="",f.addClass(r,o)),null!=(i=this.getDom())?(i.parentNode.replaceChild(n,i),k6.copyAttributes(n,i)):("string"==typeof e&&(e=document.getElementById(e)),e=e||k6.getFixedLayer(),f.addClass(e,o),e.appendChild(n)),this.postRender()},getDom:function(e){return e?document.getElementById(this.id+"_"+e):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var t="edui-"+this.uiName;return e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();e&&s.editor.dom.domUtils.remove(e),k6.unsetGlobal(this.id)}},j6.inherits(m6,l6),A6=s.editor.utils,B6=s.editor.ui.UIBase,C6=s.editor.ui.Separator=function(e){this.initOptions(e),this.initSeparator()},C6.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}},A6.inherits(C6,B6),E6=s.editor.utils,F6=s.editor.dom.domUtils,G6=s.editor.ui.UIBase,H6=s.editor.ui.uiUtils,I6=s.editor.ui.Mask=function(e){this.initOptions(e),this.initUIBase()},I6.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var e=this;F6.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e._fill()})})},show:function(e){this._fill(),this.getDom().style.display="",this.getDom().style.zIndex=e},hide:function(){this.getDom().style.display="none",this.getDom().style.zIndex=""},isHidden:function(){return"none"==this.getDom().style.display},_onMouseDown:function(){return!1},_onClick:function(e,t){this.fireEvent("click",e,t)},_fill:function(){var e=this.getDom(),t=H6.getViewportRect();e.style.width=t.width+"px",e.style.height=t.height+"px"}},E6.inherits(I6,G6),function(){function n(e,t){for(var n=0;n<o.length;n++){var i=o[n];if(!i.isHidden()&&!1!==i.queryAutoHide(t)){if(e&&/scroll/gi.test(e.type)&&"edui-wordpastepop"==i.className)return;i.hide()}}o.length&&i.editor.fireEvent("afterhidepop")}var e=s.editor.utils,a=s.editor.ui.uiUtils,l=s.editor.dom.domUtils,d=s.editor.ui.UIBase,t=s.editor.ui.Popup=function(e){this.initOptions(e),this.initPopup()},o=[];t.postHide=n;var r=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];t.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase(),o.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" onmousedown="return false;"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){return this.content?"string"==typeof this.content?this.content:this.content.renderHtml():""},_UIBase_postRender:d.prototype.postRender,postRender:function(){if(this.content instanceof d&&this.content.postRender(),this.captureWheel&&!this.captured){this.captured=!0;var e=(document.documentElement.clientHeight||document.body.clientHeight)-80,t=this.getDom().offsetHeight,n=a.getClientRect(this.combox.getDom()).top,i=this.getDom("content"),o=this.getDom("body").getElementsByTagName("iframe"),r=this;for(o.length&&(o=o[0]);e<n+t;)t-=30;i.style.height=t+"px",o&&(o.style.height=t+"px"),window.XMLHttpRequest?l.on(i,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,i.scrollTop=e.wheelDelta?i.scrollTop-e.wheelDelta/120*60:i.scrollTop-e.detail/-3*60}):l.on(this.getDom(),"mousewheel",function(e){e.returnValue=!1,r.getDom("content").scrollTop-=e.wheelDelta/120*60})}this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var e=this.getDom("content");return a.getClientRect(e)},fitSize:function(){if(this.captureWheel&&this.sized)return this.__size;this.sized=!0;var e=this.getDom("body");e.style.width="",e.style.height="";var t,n=this.mesureSize();return this.captureWheel?(e.style.width=-(-20-n.width)+"px",t=parseInt(this.getDom("content").style.height,10),window.isNaN(t)||(n.height=t)):e.style.width=n.width+"px",e.style.height=n.height+"px",this.__size=n,this.captureWheel&&(this.getDom("content").style.overflow="auto"),n},showAnchor:function(e,t){this.showAnchorRect(a.getClientRect(e),t)},showAnchorRect:function(e,t,n){this._doAutoRender();var i,o=a.getViewportRect();this.getDom().style.visibility="hidden",this._show(),n=this.fitSize(),e=t?(t=this.canSideLeft&&e.right+n.width>o.right&&e.left>n.width,o=this.canSideUp&&e.top+n.height>o.bottom&&e.bottom>n.height,i=t?e.left-n.width:e.right,o?e.bottom-n.height:e.top):(t=this.canSideLeft&&e.right+n.width>o.right&&e.left>n.width,o=this.canSideUp&&e.top+n.height>o.bottom&&e.bottom>n.height,i=t?e.right-n.width:e.left,o?e.top-n.height:e.bottom),n=this.getDom(),a.setViewportOffset(n,{left:i,top:e}),l.removeClasses(n,r),n.className+=" "+r[2*(o?1:0)+(t?1:0)],this.editor&&(n.style.zIndex=+this.editor.container.style.zIndex+10,s.editor.ui.uiUtils.getFixedLayer().style.zIndex=n.style.zIndex-1),this.getDom().style.visibility="visible"},showAt:function(e){var t=e.left;e=e.top,this.showAnchorRect({left:t,top:e,right:t,bottom:e,height:0,width:0},!1,!0)},_show:function(){this._hidden&&(this.getDom().style.display="",this._hidden=!1,this.fireEvent("show"))},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(e){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,e||this.fireEvent("hide"))},queryAutoHide:function(e){return!e||!a.contains(this.getDom(),e)}},e.inherits(t,d),l.on(document,"mousedown",function(e){n(e,e.target||e.srcElement)}),l.on(window,"scroll",function(e,t){n(e,t)})}(),function(){var e=s.editor.utils,t=s.editor.ui.UIBase,n=s.editor.ui.ColorPicker=function(e){this.initOptions(e),this.noColorText=this.noColorText||this.editor.getLang("clearColor"),this.initUIBase()};n.prototype={getHtmlTpl:function(){for(var e=this.editor,t='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+this.noColorText+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+e.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >',n=0;n<i.length;n++)n&&0==n%10&&(t+="</tr>"+(60==n?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+e.getLang("standardColor")+"</td></tr>":"")+"<tr"+(60==n?' class="edui-colorpicker-tablefirstrow"':"")+">"),t+=n<70?'<td style="padding: 0 2px;"><a hidefocus title="'+i[n]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+i[n]+'" style="background-color:#'+i[n]+";border:solid #ccc;"+(n<10||60<=n?"border-width:1px;":10<=n&&n<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':"";return t+"</tr></table></div>"},_onTableClick:function(e){(e=(e.target||e.srcElement).getAttribute("data-color"))&&this.fireEvent("pickcolor",e)},_onTableOver:function(e){(e=(e.target||e.srcElement).getAttribute("data-color"))&&(this.getDom("preview").style.backgroundColor=e)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}},e.inherits(n,t);var i="ffffff 000000 eeece1 1f497d 4f81bd c0504d 9bbb59 8064a2 4bacc6 f79646 f2f2f2 7f7f7f ddd9c3 c6d9f0 dbe5f1 f2dcdb ebf1dd e5e0ec dbeef3 fdeada d8d8d8 595959 c4bd97 8db3e2 b8cce4 e5b9b7 d7e3bc ccc1d9 b7dde8 fbd5b5 bfbfbf 3f3f3f 938953 548dd4 95b3d7 d99694 c3d69b b2a2c7 92cddc fac08f a5a5a5 262626 494429 17365d 366092 953734 76923c 5f497a 31859b e36c09 7f7f7f 0c0c0c 1d1b10 0f243e 244061 632423 4f6128 3f3151 205867 974806 c00000 ff0000 ffc000 ffff00 92d050 00b050 00b0f0 0070c0 002060 7030a0 ".split(" ")}(),L7=s.editor.utils,M7=s.editor.ui.uiUtils,N7=s.editor.ui.UIBase,O7=s.editor.ui.TablePicker=function(e){this.initOptions(e),this.initTablePicker()},O7.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:N7.prototype.render,render:function(e){this._UIBase_render(e),this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(e,t){var n=this.getDom("overlay").style,i=this.lengthOfCellSide;n.width=e*i+"px",n.height=t*i+"px",this.getDom("label").innerHTML=e+this.editor.getLang("t_col")+" x "+t+this.editor.getLang("t_row"),this.numCols=e,this.numRows=t},_onMouseOver:function(e,t){e=e.relatedTarget||e.fromElement;M7.contains(t,e)||t===e||(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="")},_onMouseOut:function(e,t){e=e.relatedTarget||e.toElement;M7.contains(t,e)||t===e||(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="hidden")},_onMouseMove:function(e,t){this.getDom("overlay");var n=M7.getEventOffset(e),i=this.lengthOfCellSide,e=Math.ceil(n.left/i),n=Math.ceil(n.top/i);this._track(e,n)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}},L7.inherits(O7,N7),e8=s.editor.dom.domUtils,f8=s.editor.ui.uiUtils,g8='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(s.editor.browser.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"'),s.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){return this._Stateful_dGetHtmlTpl().replace(/stateful/g,function(){return g8})},Stateful_onMouseEnter:function(e,t){this.target=t,this.isDisabled()&&!this.alwalysHoverable||(this.addState("hover"),this.fireEvent("over"))},Stateful_onMouseLeave:function(e,t){this.isDisabled()&&!this.alwalysHoverable||(this.removeState("hover"),this.removeState("active"),this.fireEvent("out"))},Stateful_onMouseOver:function(e,t){var n=e.relatedTarget;f8.contains(t,n)||t===n||this.Stateful_onMouseEnter(e,t)},Stateful_onMouseOut:function(e,t){var n=e.relatedTarget;f8.contains(t,n)||t===n||this.Stateful_onMouseLeave(e,t)},Stateful_onMouseDown:function(e,t){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(e,t){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(e){return e8.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){this.hasState(e)||(this.getStateDom().className+=" edui-state-"+e)},removeState:function(e){this.hasState(e)&&e8.removeClasses(this.getStateDom(),["edui-state-"+e])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){!this.isDisabled()&&e?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){e?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}},A8=s.editor.utils,B8=s.editor.ui.UIBase,C8=s.editor.ui.Stateful,D8=s.editor.ui.Button=function(e){var t,n;e.name&&(t=e.name,n=e.cssRules,e.className||(e.className="edui-for-"+t),e.cssRules=".edui-default  .edui-for-"+t+" .edui-icon {"+n+"}"),this.initOptions(e),this.initButton()},D8.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,cssRules:"",initButton:function(){this.initUIBase(),this.Stateful_init(),this.cssRules&&A8.cssRule("edui-customize-"+this.name+"-style",this.cssRules)},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender(),this.setDisabled(this.disabled)},_onMouseDown:function(e){if("input"==(e=(e=e.target||e.srcElement)&&e.tagName&&e.tagName.toLowerCase())||"object"==e||"object"==e)return!1},_onClick:function(){this.isDisabled()||this.fireEvent("click")},setTitle:function(e){this.getDom("label").innerHTML=e}},A8.inherits(D8,B8),A8.extend(D8.prototype,C8),J8=s.editor.utils,K8=s.editor.ui.uiUtils,L8=s.editor.ui.UIBase,M8=s.editor.ui.Stateful,N8=s.editor.ui.SplitButton=function(e){this.initOptions(e),this.initSplitButton()},N8.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){var e;this.initUIBase(),this.Stateful_init(),null!=this.popup&&(e=this.popup,this.popup=null,this.setPopup(e))},_UIBase_postRender:L8.prototype.postRender,postRender:function(){this.Stateful_postRender(),this._UIBase_postRender()},setPopup:function(e){this.popup!==e&&(null!=this.popup&&this.popup.dispose(),e.addListener("show",J8.bind(this._onPopupShow,this)),e.addListener("hide",J8.bind(this._onPopupHide,this)),e.addListener("postrender",J8.bind(function(){e.getDom("body").appendChild(K8.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(K8.getClientRect(this.getDom()).width+20)+'px"></div>')),e.getDom().className+=" "+this.className},this)),this.popup=e)},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var e=K8.getClientRect(this.getDom());e.top-=this.popup.SHADOW_RADIUS,e.height+=this.popup.SHADOW_RADIUS,this.popup.showAnchorRect(e)},_onArrowClick:function(e,t){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}},J8.inherits(N8,L8),J8.extend(N8.prototype,M8,!0),U8=s.editor.utils,V8=s.editor.ui.uiUtils,W8=s.editor.ui.ColorPicker,X8=s.editor.ui.Popup,Y8=s.editor.ui.SplitButton,Z8=s.editor.ui.ColorButton=function(e){this.initOptions(e),this.initColorButton()},Z8.prototype={initColorButton:function(){var n=this;this.popup=new X8({content:new W8({noColorText:n.editor.getLang("clearColor"),editor:n.editor,onpickcolor:function(e,t){n._onPickColor(t)},onpicknocolor:function(e,t){n._onPickNoColor(t)}}),editor:n.editor}),this.initSplitButton()},_SplitButton_postRender:Y8.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.getDom("button_body").appendChild(V8.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>')),this.getDom().className+=" edui-colorbutton"},setColor:function(e){this.color=this.getDom("colorlump").style.backgroundColor=e},_onPickColor:function(e){!1!==this.fireEvent("pickcolor",e)&&(this.setColor(e),this.popup.hide())},_onPickNoColor:function(e){!1!==this.fireEvent("picknocolor")&&this.popup.hide()}},U8.inherits(Z8,Y8),h9=s.editor.utils,i9=s.editor.ui.Popup,j9=s.editor.ui.TablePicker,k9=s.editor.ui.SplitButton,l9=s.editor.ui.TableButton=function(e){this.initOptions(e),this.initTableButton()},l9.prototype={initTableButton:function(){var i=this;this.popup=new i9({content:new j9({editor:i.editor,onpicktable:function(e,t,n){i._onPickTable(t,n)}}),editor:i.editor}),this.initSplitButton()},_onPickTable:function(e,t){!1!==this.fireEvent("picktable",e,t)&&this.popup.hide()}},h9.inherits(l9,k9),t9=s.editor.utils,u9=s.editor.ui.UIBase,v9=s.editor.ui.AutoTypeSetPicker=function(e){this.initOptions(e),this.initAutoTypeSetPicker()},v9.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this.editor,t=e.options.autotypeset,n=e.getLang("autoTypeSet"),i="textAlignValue"+e.uid,o="imageBlockLineValue"+e.uid,r="symbolConverValue"+e.uid;return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap><input type="checkbox" name="mergeEmptyline" '+(t.mergeEmptyline?"checked":"")+">"+n.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(t.removeEmptyline?"checked":"")+">"+n.delLine+'</td></tr><tr><td nowrap><input type="checkbox" name="removeClass" '+(t.removeClass?"checked":"")+">"+n.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(t.indent?"checked":"")+">"+n.indent+'</td></tr><tr><td nowrap><input type="checkbox" name="textAlign" '+(t.textAlign?"checked":"")+">"+n.alignment+'</td><td colspan="2" id="'+i+'"><input type="radio" name="'+i+'" value="left" '+(t.textAlign&&"left"==t.textAlign?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="'+i+'" value="center" '+(t.textAlign&&"center"==t.textAlign?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="'+i+'" value="right" '+(t.textAlign&&"right"==t.textAlign?"checked":"")+">"+e.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="imageBlockLine" '+(t.imageBlockLine?"checked":"")+">"+n.imageFloat+'</td><td nowrap id="'+o+'"><input type="radio" name="'+o+'" value="none" '+(t.imageBlockLine&&"none"==t.imageBlockLine?"checked":"")+">"+e.getLang("default")+'<input type="radio" name="'+o+'" value="left" '+(t.imageBlockLine&&"left"==t.imageBlockLine?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="'+o+'" value="center" '+(t.imageBlockLine&&"center"==t.imageBlockLine?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="'+o+'" value="right" '+(t.imageBlockLine&&"right"==t.imageBlockLine?"checked":"")+">"+e.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="clearFontSize" '+(t.clearFontSize?"checked":"")+">"+n.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(t.clearFontFamily?"checked":"")+">"+n.removeFontFamily+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="removeEmptyNode" '+(t.removeEmptyNode?"checked":"")+">"+n.removeHtml+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="pasteFilter" '+(t.pasteFilter?"checked":"")+">"+n.pasteFilter+'</td></tr><tr><td nowrap><input type="checkbox" name="symbolConver" '+(t.bdc2sb||t.tobdc?"checked":"")+">"+n.symbol+'</td><td id="'+r+'"><input type="radio" name="bdc" value="bdc2sb" '+(t.bdc2sb?"checked":"")+">"+n.bdc2sb+'<input type="radio" name="bdc" value="tobdc" '+(t.tobdc?"checked":"")+">"+n.tobdc+'</td><td nowrap align="right"><button >'+n.run+"</button></td></tr></table></div></div>"},_UIBase_render:u9.prototype.render},t9.inherits(v9,u9),E9=s.editor.utils,F9=s.editor.ui.Popup,G9=s.editor.ui.AutoTypeSetPicker,H9=s.editor.ui.SplitButton,I9=s.editor.ui.AutoTypeSetButton=function(e){this.initOptions(e),this.initAutoTypeSetButton()},I9.prototype={initAutoTypeSetButton:function(){var s=this;this.popup=new F9({content:new G9({editor:s.editor}),editor:s.editor,hide:function(){!this._hidden&&this.getDom()&&(D9(this),this.getDom().style.display="none",this._hidden=!0,this.fireEvent("hide"))}});var t=0;this.popup.addListener("postRenderAfter",function(){var e,a=this;t||((e=this.getDom()).getElementsByTagName("button")[0].onclick=function(){D9(a),s.editor.execCommand("autotypeset"),a.hide()},f.on(e,"click",function(e){e=e.target||e.srcElement;var t=s.editor.uid;if(e&&"INPUT"==e.tagName){if("imageBlockLine"==e.name||"textAlign"==e.name||"symbolConver"==e.name)for(var n=e.checked,i=document.getElementById(e.name+"Value"+t).getElementsByTagName("input"),o={imageBlockLine:"none",textAlign:"left",symbolConver:"tobdc"},r=0;r<i.length;r++)n?i[r].value==o[e.name]&&(i[r].checked="checked"):i[r].checked=!1;e.name!="imageBlockLineValue"+t&&e.name!="textAlignValue"+t&&"bdc"!=e.name||!(e=e.parentNode.previousSibling.getElementsByTagName("input"))||(e[0].checked=!0),D9(a)}}),t=1)}),this.initSplitButton()}},E9.inherits(I9,H9),caa=s.editor.utils,daa=s.editor.ui.Popup,eaa=s.editor.ui.Stateful,faa=s.editor.ui.UIBase,gaa=s.editor.ui.CellAlignPicker=function(e){this.initOptions(e),this.initSelected(),this.initCellAlignPicker()},gaa.prototype={initSelected:function(){this.selected&&(this.selectedIndex=3*{top:0,middle:1,bottom:2}[this.selected.valign]+{left:0,center:1,right:2}[this.selected.align])},initCellAlignPicker:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){for(var e,t,n=["left","center","right"],i=[],o=0;o<9;o++)e=this.selectedIndex===o?' class="edui-cellalign-selected" ':"",0==(t=o%3)&&i.push("<tr>"),i.push('<td index="'+o+'" '+e+' stateful><div class="edui-icon edui-'+n[t]+'"></div></td>'),2==t&&i.push("</tr>");return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);">'+i.join("")+"</table></div></div>"},getStateDom:function(){return this.target},_onClick:function(e){var t=e.target||e.srcElement;/icon/.test(t.className)&&(this.items[t.parentNode.getAttribute("index")].onclick(),daa.postHide(e))},_UIBase_render:faa.prototype.render},caa.inherits(gaa,faa),caa.extend(gaa.prototype,eaa,!0),raa=s.editor.utils,saa=s.editor.ui.Stateful,taa=s.editor.ui.uiUtils,uaa=s.editor.ui.UIBase,vaa=s.editor.ui.PastePicker=function(e){this.initOptions(e),this.initPastePicker()},vaa.prototype={initPastePicker:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div><div class="edui-button"><div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>'},getStateDom:function(){return this.target},format:function(e){this.editor.ui._isTransfer=!0,this.editor.fireEvent("pasteTransfer",e)},_onClick:function(e){var t=f.getNextDomNode(e),n=taa.getViewportRect().height,i=taa.getClientRect(t);t.style.top=i.top+i.height>n?-i.height-e.offsetHeight+"px":"",/hidden/gi.test(f.getComputedStyle(t,"visibility"))?(t.style.visibility="visible",f.addClass(e,"edui-state-opened")):(t.style.visibility="hidden",f.removeClasses(e,"edui-state-opened"))},_UIBase_render:uaa.prototype.render},raa.inherits(vaa,uaa),raa.extend(vaa.prototype,saa,!0),Caa=s.editor.utils,Daa=s.editor.ui.uiUtils,Eaa=s.editor.ui.UIBase,Faa=s.editor.ui.Toolbar=function(e){this.initOptions(e),this.initToolbar()},Faa.prototype={items:null,initToolbar:function(){this.items=this.items||[],this.initUIBase()},add:function(e,t){void 0===t?this.items.push(e):this.items.splice(t,0,e)},getHtmlTpl:function(){for(var e=[],t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+e.join("")+"</div>"},postRender:function(){for(var e=this.getDom(),t=0;t<this.items.length;t++)this.items[t].postRender();Daa.makeUnselectable(e)},_onMouseDown:function(e){if("input"==(e=(e=e.target||e.srcElement)&&e.tagName&&e.tagName.toLowerCase())||"object"==e||"object"==e)return!1}},Caa.inherits(Faa,Eaa),function(){var e=s.editor.utils,i=s.editor.dom.domUtils,o=s.editor.ui.uiUtils,t=s.editor.ui.UIBase,n=s.editor.ui.Popup,r=s.editor.ui.Stateful,a=s.editor.ui.CellAlignPicker,l=s.editor.ui.Menu=function(e){this.initOptions(e),this.initMenu()},d={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};l.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[],this.initPopup(),this.initItems()},initItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];"-"==t?this.items[e]=this.getSeparator():t instanceof c||(t.editor=this.editor,t.theme=this.editor.options.theme,this.items[e]=this.createItem(t))}},getSeparator:function(){return d},createItem:function(e){return e.menu=this,new c(e)},_Popup_getContentHtmlTpl:n.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(0==this.items.length)return this._Popup_getContentHtmlTpl();for(var e=[],t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();return'<div class="%%-body">'+e.join("")+"</div>"},_Popup_postRender:n.prototype.postRender,postRender:function(){for(var n=this,e=0;e<this.items.length;e++){var t=this.items[e];t.ownerMenu=this,t.postRender()}i.on(this.getDom(),"mouseover",function(e){e=(e=e||event).relatedTarget||e.fromElement;var t=n.getDom();o.contains(t,e)||t===e||n.fireEvent("over")}),this._Popup_postRender()},queryAutoHide:function(e){if(e){if(o.contains(this.getDom(),e))return!1;for(var t=0;t<this.items.length;t++)if(!1===this.items[t].queryAutoHide(e))return!1}},clearItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];clearTimeout(t._showingTimer),clearTimeout(t._closingTimer),t.subMenu&&t.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&i.remove(this.getDom()),this.clearItems()},dispose:function(){this.destroy()}},e.inherits(l,n);var c=s.editor.ui.MenuItem=function(e){var t;this.initOptions(e),this.initUIBase(),this.Stateful_init(),!this.subMenu||this.subMenu instanceof l||(e.className&&-1!=e.className.indexOf("aligntd")?((t=this).subMenu.selected=this.editor.queryCommandValue("cellalignment"),this.subMenu=new n({content:new a(this.subMenu),parentMenu:t,editor:t.editor,destroy:function(){this.getDom()&&i.remove(this.getDom())}}),this.subMenu.addListener("postRenderAfter",function(){i.on(this.getDom(),"mouseover",function(){t.addState("opened")})})):this.subMenu=new l(this.subMenu))};c.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var n=this;this.addListener("over",function(){n.ownerMenu.fireEvent("submenuover",n),n.subMenu&&n.delayShowSubMenu()}),this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",function(){n.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(n._closingTimer),n._closingTimer=null,n.addState("opened")}),this.ownerMenu.addListener("hide",function(){n.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(e,t){t!==n&&n.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(e){return(!e||!o.contains(n.getDom(),e))&&this._bakQueryAutoHide(e)}),this.getDom().style.tabIndex="-1",o.makeUnselectable(this.getDom()),this.Stateful_postRender()},delayShowSubMenu:function(){var e=this;e.isDisabled()||(e.addState("opened"),clearTimeout(e._showingTimer),clearTimeout(e._closingTimer),e._closingTimer=null,e._showingTimer=setTimeout(function(){e.showSubMenu()},250))},delayHideSubMenu:function(){var e=this;e.isDisabled()||(e.removeState("opened"),clearTimeout(e._showingTimer),e._closingTimer||(e._closingTimer=setTimeout(function(){e.hasState("opened")||e.hideSubMenu(),e._closingTimer=null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(e){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(e)},_onClick:function(e,t){this.hasState("disabled")||!1!==this.fireEvent("click",e,t)&&(this.subMenu?this.showSubMenu():n.postHide(e))},showSubMenu:function(){var e=o.getClientRect(this.getDom());e.right-=5,e.left+=2,e.width-=7,e.top-=4,e.bottom+=4,e.height+=8,this.subMenu.showAnchorRect(e,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}},e.inherits(c,t),e.extend(c.prototype,r,!0)}(),xba=s.editor.utils,yba=s.editor.ui.uiUtils,zba=s.editor.ui.Menu,Aba=s.editor.ui.SplitButton,Bba=s.editor.ui.Combox=function(e){this.initOptions(e),this.initCombox()},Bba.prototype={uiName:"combox",onbuttonclick:function(){this.showPopup()},initCombox:function(){var e=this;this.items=this.items||[];for(var t=0;t<this.items.length;t++){var n=this.items[t];n.uiName="listitem",n.index=t,n.onclick=function(){e.selectByIndex(this.index)}}this.popup=new zba({items:this.items,uiName:"list",editor:this.editor,captureWheel:!0,combox:this}),this.initSplitButton()},_SplitButton_postRender:Aba.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.setLabel(this.label||""),this.setValue(this.initValue||"")},showPopup:function(){var e=yba.getClientRect(this.getDom());e.top+=1,--e.bottom,e.height-=2,this.popup.showAnchorRect(e)},getValue:function(){return this.value},setValue:function(e){var t=this.indexByValue(e);-1!=t?(this.selectedIndex=t,this.setLabel(this.items[t].label),this.value=this.items[t].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(e)),this.value=e)},setLabel:function(e){this.label=this.getDom("button_body").innerHTML=e},getLabelForUnknowValue:function(e){return e},indexByValue:function(e){for(var t=0;t<this.items.length;t++)if(e==this.items[t].value)return t;return-1},getItem:function(e){return this.items[e]},selectByIndex:function(e){e<this.items.length&&!1!==this.fireEvent("select",e)&&(this.selectedIndex=e,this.value=this.items[e].value,this.setLabel(this.items[e].label))}},xba.inherits(Bba,Aba),Pba=s.editor.utils,Qba=s.editor.dom.domUtils,Rba=s.editor.ui.uiUtils,Sba=s.editor.ui.Mask,Tba=s.editor.ui.UIBase,Uba=s.editor.ui.Button,Vba=s.editor.ui.Dialog=function(e){var t,n;e.name&&(t=e.name,n=e.cssRules,e.className||(e.className="edui-for-"+t),n&&(e.cssRules=".edui-default .edui-for-"+t+" .edui-dialog-content  {"+n+"}")),this.initOptions(Pba.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(e,t){return t?this.onok():this.oncancel()},holdScroll:!1},e)),this.initDialog()},Vba.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var e=this,t=this.editor.options.theme;if(this.cssRules&&Pba.cssRule("edui-customize-"+this.name+"-style",this.cssRules),this.initUIBase(),this.modalMask=Wba=Wba||new Sba({className:"edui-dialog-modalmask",theme:t,onclick:function(){Yba&&Yba.close(!1)}}),this.dragMask=Xba=Xba||new Sba({className:"edui-dialog-dragmask",theme:t}),this.closeButton=new Uba({className:"edui-dialog-closebutton",title:e.closeDialog,theme:t,onclick:function(){e.close(!1)}}),this.fullscreen&&this.initResizeEvent(),this.buttons)for(t=0;t<this.buttons.length;t++)this.buttons[t]instanceof Uba||(this.buttons[t]=new Uba(Pba.extend(this.buttons[t],{editor:this.editor},!0)))},initResizeEvent:function(){var r=this;Qba.on(window,"resize",function(){r._hidden||void 0===r._hidden||(r.__resizeTimer&&window.clearTimeout(r.__resizeTimer),r.__resizeTimer=window.setTimeout(function(){r.__resizeTimer=null;var e=r.getDom(),t=r.getDom("content"),n=UE.ui.uiUtils.getClientRect(e),i=UE.ui.uiUtils.getClientRect(t),o=Rba.getViewportRect();t.style.width=o.width-n.width+i.width+"px",t.style.height=o.height-n.height+i.height+"px",e.style.width=o.width+"px",e.style.height=o.height+"px",r.fireEvent("resize")},100))})},fitSize:function(){var e=this.getDom("body"),t=this.mesureSize();return e.style.width=t.width+"px",e.style.height=t.height+"px",t},safeSetOffset:function(e){var t=this.getDom(),n=Rba.getViewportRect(),i=Rba.getClientRect(t),o=e.left;o+i.width>n.right&&(o=n.right-i.width),(e=e.top)+i.height>n.bottom&&(e=n.bottom-i.height),t.style.left=Math.max(o,0)+"px",t.style.top=Math.max(e,0)+"px"},showAtCenter:function(){var e,t,n,i,o=Rba.getViewportRect();this.fullscreen?(e=this.getDom(),t=this.getDom("content"),e.style.display="block",n=UE.ui.uiUtils.getClientRect(e),i=UE.ui.uiUtils.getClientRect(t),e.style.left="-100000px",t.style.width=o.width-n.width+i.width+"px",t.style.height=o.height-n.height+i.height+"px",e.style.width=o.width+"px",e.style.height=o.height+"px",e.style.left=0,this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY}},document.documentElement.style.overflowX="hidden",document.documentElement.style.overflowY="hidden",document.body.style.overflowX="hidden",document.body.style.overflowY="hidden"):(this.getDom().style.display="",t=this.fitSize(),n=0|this.getDom("titlebar").offsetHeight,e=o.width/2-t.width/2,o=o.height/2-(t.height-n)/2-n,t=this.getDom(),this.safeSetOffset({left:Math.max(0|e,0),top:Math.max(0|o,0)}),Qba.hasClass(t,"edui-state-centered")||(t.className+=" edui-state-centered")),this._show()},getContentHtml:function(){var e="";return"string"==typeof this.content?e=this.content:this.iframeUrl&&(e='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'),e},getHtmlTpl:function(){var e="";if(this.buttons){for(var e=[],t=0;t<this.buttons.length;t++)e[t]=this.buttons[t].renderHtml();e='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+e.join("")+"</div></div>"}return'<div id="##" class="%%"><div '+(this.fullscreen?'class="%%-wrap edui-dialog-fullscreen-flag"':'class="%%"')+'><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+e+"</div></div></div>"},postRender:function(){this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide());var e=this;if(this.addListener("show",function(){e.modalMask.show(this.getDom().style.zIndex-2)}),this.addListener("hide",function(){e.modalMask.hide()}),this.buttons)for(var t=0;t<this.buttons.length;t++)this.buttons[t].postRender();Qba.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e.safeSetOffset(Rba.getClientRect(e.getDom()))})}),this._hide()},mesureSize:function(){var e=this.getDom("body"),t=Rba.getClientRect(this.getDom("content")).width;return e.style.width=t,Rba.getClientRect(e)},_onTitlebarMouseDown:function(e,t){var n,i;this.draggable&&(Rba.getViewportRect(),i=this,Rba.startDrag(e,{ondragstart:function(){n=Rba.getClientRect(i.getDom()),i.getDom("contmask").style.visibility="visible",i.dragMask.show(i.getDom().style.zIndex-1)},ondragmove:function(e,t){i.safeSetOffset({left:n.left+e,top:n.top+t})},ondragstop:function(){i.getDom("contmask").style.visibility="hidden",Qba.removeClasses(i.getDom(),["edui-state-centered"]),i.dragMask.hide()}}))},reset:function(){this.getDom("content").innerHTML=this.getContentHtml(),this.fireEvent("dialogafterreset")},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=+this.editor.container.style.zIndex+10),this._hidden=!1,this.fireEvent("show"),s.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){var e;this._hidden||((e=this.getDom()).style.display="none",e.style.zIndex="",e.style.width="",e.style.height="",this._hidden=!0,this.fireEvent("hide"))},open:function(){if(this.autoReset)try{this.reset()}catch(e){this.render(),this.open()}if(this.showAtCenter(),this.iframeUrl)try{this.getDom("iframe").focus()}catch(e){}Yba=this},_onCloseButtonClick:function(e,t){this.close(!1)},close:function(e){var t;!1!==this.fireEvent("close",e)&&(this.fullscreen&&(document.documentElement.style.overflowX=this._originalContext.html.overflowX,document.documentElement.style.overflowY=this._originalContext.html.overflowY,document.body.style.overflowX=this._originalContext.body.overflowX,document.body.style.overflowY=this._originalContext.body.overflowY,delete this._originalContext),this._hide(),e=this.getDom("content"),t=this.getDom("iframe"),e&&t&&((t=t.contentDocument||t.contentWindow.document)&&(t.body.innerHTML=""),Qba.remove(e)))}},Pba.inherits(Vba,Tba),Qca=s.editor.utils,Rca=s.editor.ui.Menu,Sca=s.editor.ui.SplitButton,Tca=s.editor.ui.MenuButton=function(e){this.initOptions(e),this.initMenuButton()},Tca.prototype={initMenuButton:function(){var t=this;this.uiName="menubutton",this.popup=new Rca({items:t.items,className:t.className,editor:t.editor}),this.popup.addListener("show",function(){for(var e=0;e<this.items.length;e++)this.items[e].removeState("checked"),this.items[e].value==t._value&&(this.items[e].addState("checked"),this.value=t._value)}),this.initSplitButton()},setValue:function(e){this._value=e}},Qca.inherits(Tca,Sca),Yca=s.editor.utils,Zca=s.editor.ui.Popup,$ca=s.editor.ui.SplitButton,_ca=s.editor.ui.MultiMenuPop=function(e){this.initOptions(e),this.initMultiMenu()},_ca.prototype={initMultiMenu:function(){var e=this;this.popup=new Zca({content:"",editor:e.editor,iframe_rendered:!1,onshow:function(){this.iframe_rendered||(this.iframe_rendered=!0,this.getDom("content").innerHTML='<iframe id="'+e.id+'_iframe" src="'+e.iframeUrl+'" frameborder="0"></iframe>',e.editor.container.style.zIndex&&(this.getDom().style.zIndex=+e.editor.container.style.zIndex+1))}}),this.onbuttonclick=function(){this.showPopup()},this.initSplitButton()}},Yca.inherits(_ca,$ca),dda=s.editor.ui,eda=dda.UIBase,fda=dda.uiUtils,gda=s.editor.utils,hda=s.editor.dom.domUtils,ida=[],kda=!1,lda=dda.ShortCutMenu=function(e){this.initOptions(e),this.initShortCutMenu()},lda.postHide=cda,lda.prototype={isHidden:!0,SPACE:5,initShortCutMenu:function(){this.items=this.items||[],this.initUIBase(),this.initItems(),this.initEvent(),ida.push(this)},initEvent:function(){var s=this,e=s.editor.document;hda.on(e,"mousemove",function(e){var t,n,i,o,r,a;!1!==s.isHidden||s.getSubMenuMark()||"contextmenu"==s.eventType||(t=!0,n=s.getDom(),i=n.offsetWidth/2+s.SPACE,o=n.offsetHeight/2,r=Math.abs(e.screenX-s.left),a=Math.abs(e.screenY-s.top),clearTimeout(jda),jda=setTimeout(function(){0<a&&a<o?s.setOpacity(n,"1"):o<a&&a<70+o?(s.setOpacity(n,"0.5"),t=!1):70+o<a&&a<140+o&&s.hide(),t&&0<r&&r<i?s.setOpacity(n,"1"):i<r&&r<i+70?s.setOpacity(n,"0.5"):i+70<r&&r<i+140&&s.hide()}))}),r.chrome&&hda.on(e,"mouseout",function(e){null!=(e=e.relatedTarget||e.toElement)&&"HTML"!=e.tagName||s.hide()}),s.editor.addListener("afterhidepop",function(){s.isHidden||(kda=!0)})},initItems:function(){if(gda.isArray(this.items))for(var e=0,t=this.items.length;e<t;e++){var n=this.items[e].toLowerCase();dda[n]&&(this.items[e]=new dda[n](this.editor),this.items[e].className+=" edui-shortcutsubmenu ")}},setOpacity:function(e,t){r.ie&&r.version<9?e.style.filter="alpha(opacity = "+100*parseFloat(t)+");":e.style.opacity=t},getSubMenuMark:function(){kda=!1;for(var e,t=fda.getFixedLayer(),t=hda.getElementsByTagName(t,"div",function(e){return hda.hasClass(e,"edui-shortcutsubmenu edui-popup")}),n=0;e=t[n++];)"none"!=e.style.display&&(kda=!0);return kda},show:function(e,t){function n(e){e.left<0&&(e.left=0),e.top<0&&(e.top=0),r.style.cssText="position:absolute;left:"+e.left+"px;top:"+e.top+"px;"}function i(e){e.tagName||(e=e.getDom()),o.left=parseInt(e.style.left),o.top=parseInt(e.style.top),o.top-=r.offsetHeight+15,n(o)}var o={},r=this.getDom(),a=fda.getFixedLayer();this.eventType=e.type,r.style.cssText="display:block;left:-9999px","contextmenu"==e.type&&t?(t=hda.getElementsByTagName(a,"div","edui-contextmenu")[0])?i(t):this.editor.addListener("aftershowcontextmenu",function(e,t){i(t)}):((o=fda.getViewportOffsetByEvent(e)).top-=r.offsetHeight+this.SPACE,o.left+=this.SPACE+20,n(o),this.setOpacity(r,.2)),this.isHidden=!1,this.left=e.screenX+r.offsetWidth/2-this.SPACE,this.top=e.screenY-r.offsetHeight/2-this.SPACE,this.editor&&(r.style.zIndex=+this.editor.container.style.zIndex+10,a.style.zIndex=r.style.zIndex-1)},hide:function(){this.getDom()&&(this.getDom().style.display="none"),this.isHidden=!0},postRender:function(){if(gda.isArray(this.items))for(var e,t=0;e=this.items[t++];)e.postRender()},getHtmlTpl:function(){var e;if(gda.isArray(this.items)){e=[];for(var t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();e=e.join("")}else e=this.items;return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+e+"</div>"}},gda.inherits(lda,eda),hda.on(document,"mousedown",function(e){cda(e)}),hda.on(window,"scroll",function(e){cda(e)}),_da=s.editor.utils,aea=s.editor.ui.UIBase,bea=s.editor.ui.Breakline=function(e){this.initOptions(e),this.initSeparator()},bea.prototype={uiName:"Breakline",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return"<br/>"}},_da.inherits(bea,aea),dea=s.editor.utils,eea=s.editor.dom.domUtils,fea=s.editor.ui.UIBase,gea=s.editor.ui.Message=function(e){this.initOptions(e),this.initMessage()},gea.prototype={initMessage:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-message %%"> <div id="##_closer" class="edui-message-closer">×</div> <div id="##_body" class="edui-message-body edui-message-type-info"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-message-content">  </div> </div></div>'},reset:function(e){var t=this;e.keepshow||(clearTimeout(this.timer),t.timer=setTimeout(function(){t.hide()},e.timeout||4e3)),void 0!==e.content&&t.setContent(e.content),void 0!==e.type&&t.setType(e.type),t.show()},postRender:function(){var e=this,t=this.getDom("closer");t&&eea.on(t,"click",function(){e.hide()})},setContent:function(e){this.getDom("content").innerHTML=e},setType:function(e){e=e||"info";var t=this.getDom("body");t.className=t.className.replace(/edui-message-type-[\w-]+/,"edui-message-type-"+e)},getContent:function(){return this.getDom("content").innerHTML},getType:function(){var e=this.getDom("body").match(/edui-message-type-([\w-]+)/);return e?e[1]:""},show:function(){this.getDom().style.display="block"},hide:function(){var e=this.getDom();e&&(e.style.display="none",e.parentNode&&e.parentNode.removeChild(e))}},dea.inherits(gea,fea),function(){var l=s.editor.utils,d=s.editor.ui,t=d.Dialog;d.buttons={},d.Dialog=function(e){var i=new t(e);return i.addListener("hide",function(){if(i.editor){var e,t,n=i.editor;try{r.gecko?(e=n.window.scrollY,t=n.window.scrollX,n.body.focus(),n.window.scrollTo(t,e)):n.focus()}catch(e){}}}),i};for(var e,n,c={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",preview:"~/dialogs/preview/preview.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html",charts:"~/dialogs/charts/charts.html"},i="undo redo formatmatch bold italic underline fontborder touppercase tolowercase strikethrough subscript superscript source indent outdent blockquote pasteplain pagebreak selectall print horizontal removeformat time date unlink insertparagraphbeforetable insertrow insertcol mergeright mergedown deleterow deletecol splittorows splittocols splittocells mergecells deletetable drafts".split(" "),o=0;e=i[o++];)e=e.toLowerCase(),d[e]=function(r){return function(i){var o=new d.Button({className:"edui-for-"+r,title:i.options.labelMap[r]||i.getLang("labelMap."+r)||"",onclick:function(){i.execCommand(r)},theme:i.options.theme,showText:!1});return d.buttons[r]=o,i.addListener("selectionchange",function(e,t,n){-1==(e=i.queryCommandState(r))?(o.setDisabled(!0),o.setChecked(!1)):n||(o.setDisabled(!1),o.setChecked(e))}),o}}(e);for(n in d.cleardoc=function(e){var t=new d.Button({className:"edui-for-cleardoc",title:e.options.labelMap.cleardoc||e.getLang("labelMap.cleardoc")||"",theme:e.options.theme,onclick:function(){confirm(e.getLang("confirmClear"))&&e.execCommand("cleardoc")}});return d.buttons.cleardoc=t,e.addListener("selectionchange",function(){t.setDisabled(-1==e.queryCommandState("cleardoc"))}),t},i={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]})!function(a,e){for(var t,n=0;t=e[n++];)!function(r){d[a.replace("float","")+r]=function(i){var o=new d.Button({className:"edui-for-"+a.replace("float","")+r,title:i.options.labelMap[a.replace("float","")+r]||i.getLang("labelMap."+a.replace("float","")+r)||"",theme:i.options.theme,onclick:function(){i.execCommand(a,r)}});return d.buttons[a]=o,i.addListener("selectionchange",function(e,t,n){o.setDisabled(-1==i.queryCommandState(a)),o.setChecked(i.queryCommandValue(a)==r&&!n)}),o}}(t)}(n,i[n]);for(o=0;e=["backcolor","forecolor"][o++];)d[e]=function(i){return function(n){var e=new d.ColorButton({className:"edui-for-"+i,color:"default",title:n.options.labelMap[i]||n.getLang("labelMap."+i)||"",editor:n,onpickcolor:function(e,t){n.execCommand(i,t)},onpicknocolor:function(){n.execCommand(i,"default"),this.setColor("transparent"),this.color="default"},onbuttonclick:function(){n.execCommand(i,this.color)}});return d.buttons[i]=e,n.addListener("selectionchange",function(){e.setDisabled(-1==n.queryCommandState(i))}),e}}(e);for(n in i={noOk:["searchreplace","help","spechars","webapp","preview"],ok:"attachment anchor link insertimage map gmap insertframe wordimage insertvideo insertframe edittip edittable edittd scrawl template music background charts".split(" ")})!function(a,e){for(var t,n=0;t=e[n++];)r.opera&&"searchreplace"===t||function(r){d[r]=function(t,e,n){var i;e=e||(t.options.iframeUrlMap||{})[r]||c[r],n=t.options.labelMap[r]||t.getLang("labelMap."+r)||"",e&&(i=new d.Dialog(l.extend({iframeUrl:t.ui.mapUrl(e),editor:t,className:"edui-for-"+r,title:n,holdScroll:"insertimage"===r,fullscreen:/charts|preview/.test(r),closeDialog:t.getLang("closeDialog")},"ok"==a?{buttons:[{className:"edui-okbutton",label:t.getLang("ok"),editor:t,onclick:function(){i.close(!0)}},{className:"edui-cancelbutton",label:t.getLang("cancel"),editor:t,onclick:function(){i.close(!1)}}]}:{})),t.ui._dialogs[r+"Dialog"]=i);var o=new d.Button({className:"edui-for-"+r,title:n,onclick:function(){if(i)switch(r){case"wordimage":var e=t.execCommand("wordimage");e&&e.length&&(i.render(),i.open());break;case"scrawl":-1!=t.queryCommandState("scrawl")&&(i.render(),i.open());break;default:i.render(),i.open()}},theme:t.options.theme,disabled:"scrawl"==r&&-1==t.queryCommandState("scrawl")||"charts"==r});return d.buttons[r]=o,t.addListener("selectionchange",function(){var e;r in{edittable:1}||(e=t.queryCommandState(r),o.getDom()&&(o.setDisabled(-1==e),o.setChecked(e)))}),o}}(t.toLowerCase())}(n,i[n]);for(d.snapscreen=function(e,t,n){n=e.options.labelMap.snapscreen||e.getLang("labelMap.snapscreen")||"";var i,o=new d.Button({className:"edui-for-snapscreen",title:n,onclick:function(){e.execCommand("snapscreen")},theme:e.options.theme});return d.buttons.snapscreen=o,(t=t||(e.options.iframeUrlMap||{}).snapscreen||c.snapscreen)&&((i=new d.Dialog({iframeUrl:e.ui.mapUrl(t),editor:e,className:"edui-for-snapscreen",title:n,buttons:[{className:"edui-okbutton",label:e.getLang("ok"),editor:e,onclick:function(){i.close(!0)}},{className:"edui-cancelbutton",label:e.getLang("cancel"),editor:e,onclick:function(){i.close(!1)}}]})).render(),e.ui._dialogs.snapscreenDialog=i),e.addListener("selectionchange",function(){o.setDisabled(-1==e.queryCommandState("snapscreen"))}),o},d.insertcode=function(i,e,o){e=i.options.insertcode||[],o=i.options.labelMap.insertcode||i.getLang("labelMap.insertcode")||"";var n=[];l.each(e,function(e,t){n.push({label:e,value:t,theme:i.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"</div>"}})});var r=new d.Combox({editor:i,items:n,onselect:function(e,t){i.execCommand("insertcode",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:o,initValue:o,className:"edui-for-insertcode",indexByValue:function(e){if(e)for(var t,n=0;t=this.items[n];n++)if(-1!=t.value.indexOf(e))return n;return-1}});return d.buttons.insertcode=r,i.addListener("selectionchange",function(e,t,n){n||(-1==i.queryCommandState("insertcode")?r.setDisabled(!0):(r.setDisabled(!1),(e=i.queryCommandValue("insertcode"))?(e=e&&e.replace(/['"]/g,"").split(",")[0],r.setValue(e)):r.setValue(o)))}),r},d.fontfamily=function(i,e,t){if(e=i.options.fontfamily||[],t=i.options.labelMap.fontfamily||i.getLang("labelMap.fontfamily")||"",e.length){for(var n=0,o=[];s=e[n];n++){var r=i.getLang("fontfamily")[s.name]||"";r=s.label||r,s=s.val,o.push({label:r,value:s,theme:i.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+l.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}var a=new d.Combox({editor:i,items:o,onselect:function(e,t){i.execCommand("FontFamily",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:t,initValue:t,className:"edui-for-fontfamily",indexByValue:function(e){if(e)for(var t,n=0;t=this.items[n];n++)if(-1!=t.value.indexOf(e))return n;return-1}});return d.buttons.fontfamily=a,i.addListener("selectionchange",function(e,t,n){n||(-1==i.queryCommandState("FontFamily")?a.setDisabled(!0):(a.setDisabled(!1),(e=i.queryCommandValue("FontFamily"))&&(e=e.replace(/['"]/g,"").split(",")[0]),a.setValue(e)))}),a}var s},d.fontsize=function(i,e,t){if(t=i.options.labelMap.fontsize||i.getLang("labelMap.fontsize")||"",(e=e||i.options.fontsize||[]).length){for(var n=[],o=0;o<e.length;o++){var r=e[o]+"px";n.push({label:r,value:r,theme:i.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var a=new d.Combox({editor:i,items:n,title:t,initValue:t,onselect:function(e,t){i.execCommand("FontSize",this.items[t].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});return d.buttons.fontsize=a,i.addListener("selectionchange",function(e,t,n){n||(-1==i.queryCommandState("FontSize")?a.setDisabled(!0):(a.setDisabled(!1),a.setValue(i.queryCommandValue("FontSize"))))}),a}},d.paragraph=function(i,e,t){if(t=i.options.labelMap.paragraph||i.getLang("labelMap.paragraph")||"",e=i.options.paragraph||[],!l.isEmptyObject(e)){var n,o=[];for(n in e)o.push({value:n,label:e[n]||i.getLang("paragraph")[n],theme:i.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});var r=new d.Combox({editor:i,items:o,title:t,initValue:t,className:"edui-for-paragraph",onselect:function(e,t){i.execCommand("Paragraph",this.items[t].value)},onbuttonclick:function(){this.showPopup()}});return d.buttons.paragraph=r,i.addListener("selectionchange",function(e,t,n){n||(-1==i.queryCommandState("Paragraph")?r.setDisabled(!0):(r.setDisabled(!1),e=i.queryCommandValue("Paragraph"),-1!=r.indexByValue(e)?r.setValue(e):r.setValue(r.initValue)))}),r}},d.customstyle=function(i){var e=i.options.customstyle||[],t=i.options.labelMap.customstyle||i.getLang("labelMap.customstyle")||"";if(e.length){for(var n,o=i.getLang("customstyle"),r=0,a=[];n=e[r++];)!function(e){var t={};t.label=e.label||o[e.name],t.style=e.style,t.className=e.className,t.tag=e.tag,a.push({label:t.label,value:t,theme:i.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+t.tag+" "+(t.className?' class="'+t.className+'"':"")+(t.style?' style="'+t.style+'"':"")+">"+t.label+"</"+t.tag+"></div>"}})}(n);var s=new d.Combox({editor:i,items:a,title:t,initValue:t,className:"edui-for-customstyle",onselect:function(e,t){i.execCommand("customstyle",this.items[t].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(e){for(var t,n=0;t=this.items[n++];)if(t.label==e)return n-1;return-1}});return d.buttons.customstyle=s,i.addListener("selectionchange",function(e,t,n){n||(-1==i.queryCommandState("customstyle")?s.setDisabled(!0):(s.setDisabled(!1),e=i.queryCommandValue("customstyle"),-1!=s.indexByValue(e)?s.setValue(e):s.setValue(s.initValue)))}),s}},d.inserttable=function(i,e,t){t=i.options.labelMap.inserttable||i.getLang("labelMap.inserttable")||"";var n=new d.TableButton({editor:i,title:t,className:"edui-for-inserttable",onpicktable:function(e,t,n){i.execCommand("InsertTable",{numRows:n,numCols:t,border:1})},onbuttonclick:function(){this.showPopup()}});return d.buttons.inserttable=n,i.addListener("selectionchange",function(){n.setDisabled(-1==i.queryCommandState("inserttable"))}),n},d.lineheight=function(n){var e=n.options.lineheight||[];if(e.length){for(var t,i=0,o=[];t=e[i++];)o.push({label:t,value:t,theme:n.options.theme,onclick:function(){n.execCommand("lineheight",this.value)}});var r=new d.MenuButton({editor:n,className:"edui-for-lineheight",title:n.options.labelMap.lineheight||n.getLang("labelMap.lineheight")||"",items:o,onbuttonclick:function(){var e=n.queryCommandValue("LineHeight")||this.value;n.execCommand("LineHeight",e)}});return d.buttons.lineheight=r,n.addListener("selectionchange",function(){var e,t=n.queryCommandState("LineHeight");-1==t?r.setDisabled(!0):(r.setDisabled(!1),(e=n.queryCommandValue("LineHeight"))&&r.setValue((e+"").replace(/cm/,"")),r.setChecked(t))}),r}},n=["top","bottom"],i=0;o=n[i++];)!function(a){d["rowspacing"+a]=function(n){var e=n.options["rowspacing"+a]||[];if(!e.length)return null;for(var t,i=0,o=[];t=e[i++];)o.push({label:t,value:t,theme:n.options.theme,onclick:function(){n.execCommand("rowspacing",this.value,a)}});var r=new d.MenuButton({editor:n,className:"edui-for-rowspacing"+a,title:n.options.labelMap["rowspacing"+a]||n.getLang("labelMap.rowspacing"+a)||"",items:o,onbuttonclick:function(){var e=n.queryCommandValue("rowspacing",a)||this.value;n.execCommand("rowspacing",e,a)}});return d.buttons[a]=r,n.addListener("selectionchange",function(){var e,t=n.queryCommandState("rowspacing",a);-1==t?r.setDisabled(!0):(r.setDisabled(!1),(e=n.queryCommandValue("rowspacing",a))&&r.setValue((e+"").replace(/%/,"")),r.setChecked(t))}),r}}(o);for(n=["insertorderedlist","insertunorderedlist"],i=0;o=n[i++];)!function(a){d[a]=function(n){function e(){n.execCommand(a,this.value)}var t,i=n.options[a],o=[];for(t in i)o.push({label:i[t]||n.getLang()[a][t]||"",value:t,theme:n.options.theme,onclick:e});var r=new d.MenuButton({editor:n,className:"edui-for-"+a,title:n.getLang("labelMap."+a)||"",items:o,onbuttonclick:function(){var e=n.queryCommandValue(a)||this.value;n.execCommand(a,e)}});return d.buttons[a]=r,n.addListener("selectionchange",function(){var e,t=n.queryCommandState(a);-1==t?r.setDisabled(!0):(r.setDisabled(!1),e=n.queryCommandValue(a),r.setValue(e),r.setChecked(t))}),r}}(o);d.fullscreen=function(t,e){e=t.options.labelMap.fullscreen||t.getLang("labelMap.fullscreen")||"";var n=new d.Button({className:"edui-for-fullscreen",title:e,theme:t.options.theme,onclick:function(){t.ui&&t.ui.setFullScreen(!t.ui.isFullScreen()),this.setChecked(t.ui.isFullScreen())}});return d.buttons.fullscreen=n,t.addListener("selectionchange",function(){var e=t.queryCommandState("fullscreen");n.setDisabled(-1==e),n.setChecked(t.ui.isFullScreen())}),n},d.emotion=function(e,t){var n=new d.MultiMenuPop({title:e.options.labelMap.emotion||e.getLang("labelMap.emotion")||"",editor:e,className:"edui-for-emotion",iframeUrl:e.ui.mapUrl(t||(e.options.iframeUrlMap||{}).emotion||c.emotion)});return d.buttons.emotion=n,e.addListener("selectionchange",function(){n.setDisabled(-1==e.queryCommandState("emotion"))}),n},d.autotypeset=function(e){var t=new d.AutoTypeSetButton({editor:e,title:e.options.labelMap.autotypeset||e.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){e.execCommand("autotypeset")}});return d.buttons.autotypeset=t,e.addListener("selectionchange",function(){t.setDisabled(-1==e.queryCommandState("autotypeset"))}),t},d.simpleupload=function(i){var o=new d.Button({className:"edui-for-simpleupload",title:i.options.labelMap.simpleupload||i.getLang("labelMap.simpleupload")||"",onclick:function(){},theme:i.options.theme,showText:!1});return d.buttons.simpleupload=o,i.addListener("ready",function(){var e=o.getDom("body").children[0];i.fireEvent("simpleuploadbtnready",e)}),i.addListener("selectionchange",function(e,t,n){-1==(e=i.queryCommandState("simpleupload"))?(o.setDisabled(!0),o.setChecked(!1)):n||(o.setDisabled(!1),o.setChecked(e))}),o}}(),function(){function l(e){this.initOptions(e),this.initEditorUI()}var c=s.editor.utils,t=s.editor.ui.uiUtils,a=s.editor.ui.UIBase,x=s.editor.dom.domUtils,d=[];l.prototype={uiName:"editor",initEditorUI:function(){function t(e,t){e.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:e.options.wordCountMsg||e.getLang("wordCountMsg"),wordOverFlowMsg:e.options.wordOverFlowMsg||e.getLang("wordOverFlowMsg")});var n=e.options,i=n.maximumWords,o=n.wordCountMsg,r=n.wordOverFlowMsg,t=t.getDom("wordcount");n.wordCount&&(i<(n=e.getContentLength(!0))?(t.innerHTML=r,e.fireEvent("wordcountoverflow")):t.innerHTML=o.replace("{#leave}",i-n).replace("{#count}",n))}(this.editor.ui=this)._dialogs={},this.initUIBase(),this._initToolbars();var l=this.editor,n=this;l.addListener("ready",function(){l.getDialog=function(e){return l.ui._dialogs[e+"Dialog"]},x.on(l.window,"scroll",function(e){s.editor.ui.Popup.postHide(e)}),l.ui._actualFrameWidth=l.options.initialFrameWidth,UE.browser.ie&&6===UE.browser.version&&l.container.ownerDocument.execCommand("BackgroundImageCache",!1,!0),l.options.elementPathEnabled&&(l.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+l.getLang("elementPathTip")+":</div>"),l.options.wordCount&&(x.on(l.document,"click",function(){t(l,n),x.un(l.document,"click",arguments.callee)}),l.ui.getDom("wordcount").innerHTML=l.getLang("wordCountTip")),l.ui._scale(),l.options.scaleEnabled?(l.autoHeightEnabled&&l.disableAutoHeight(),n.enableScale()):n.disableScale(),l.options.elementPathEnabled||l.options.wordCount||l.options.scaleEnabled||(l.ui.getDom("elementpath").style.display="none",l.ui.getDom("wordcount").style.display="none",l.ui.getDom("scale").style.display="none"),l.selection.isFocus()&&l.fireEvent("selectionchange",!1,!0)}),l.addListener("mousedown",function(e,t){s.editor.ui.Popup.postHide(t,t.target||t.srcElement),s.editor.ui.ShortCutMenu.postHide(t)}),l.addListener("delcells",function(){UE.ui.edittip&&new UE.ui.edittip(l),l.getDialog("edittip").open()});var i,e,o=!1;l.addListener("afterpaste",function(){l.queryCommandState("pasteplain")||(s.editor.ui.PastePicker&&(i=new s.editor.ui.Popup({content:new s.editor.ui.PastePicker({editor:l}),editor:l,className:"edui-wordpastepop"})).render(),o=!0)}),l.addListener("afterinserthtml",function(){clearTimeout(e),e=setTimeout(function(){var e,t;i&&(o||l.ui._isTransfer)&&(i.isHidden()?(e=x.createElement(l.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"}),l.selection.getRange().insertNode(e),(t=X(e,"firstChild","previousSibling"))&&i.showAnchor(3==t.nodeType?t.parentNode:t),x.remove(e)):i.show(),delete l.ui._isTransfer,o=!1)},200)}),l.addListener("contextmenu",function(e,t){s.editor.ui.Popup.postHide(t)}),l.addListener("keydown",function(e,t){i&&i.dispose(t);var n=t.keyCode||t.which;t.altKey&&90==n&&UE.ui.buttons.fullscreen.onclick()}),l.addListener("wordcount",function(e){t(this,n)}),l.addListener("selectionchange",function(){l.options.elementPathEnabled&&n[(-1==l.queryCommandState("elementpath")?"dis":"en")+"ableElementPath"](),l.options.scaleEnabled&&n[(-1==l.queryCommandState("scale")?"dis":"en")+"ableScale"]()});var d=new s.editor.ui.Popup({editor:l,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide(),l.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(e){this.hide(),l.ui._dialogs[e]&&l.ui._dialogs[e].open()},_onImgSetFloat:function(e){this.hide(),l.execCommand("imagefloat",e)},_setIframeAlign:function(e){var t=d.anchorEl,n=t.cloneNode(!0);switch(e){case-2:n.setAttribute("align","");break;case-1:n.setAttribute("align","left");break;case 1:n.setAttribute("align","right")}t.parentNode.insertBefore(n,t),x.remove(t),d.anchorEl=n,d.showAnchor(d.anchorEl)},_updateIframe:function(){var e=l._iframe=d.anchorEl;x.hasClass(e,"ueditor_baidumap")?(l.selection.getRange().selectNode(e).select(),l.ui._dialogs.mapDialog.open()):l.ui._dialogs.insertframeDialog.open(),d.hide()},_onRemoveButtonClick:function(e){l.execCommand(e),this.hide()},queryAutoHide:function(e){return e&&e.ownerDocument==l.document&&("img"==e.tagName.toLowerCase()||x.findParentByTagName(e,"a",!0))?e!==d.anchorEl:s.editor.ui.Popup.prototype.queryAutoHide.call(this,e)}});d.render(),l.options.imagePopup&&(l.addListener("mouseover",function(e,t){var n=(t=t||window.event).target||t.srcElement;l.ui._dialogs.insertframeDialog&&/iframe/gi.test(n.tagName)&&((t=d.formatHtml("<nobr>"+l.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+l.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+l.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+l.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+l.getLang("modify")+"</span></nobr>"))?(d.getDom("content").innerHTML=t,d.anchorEl=n,d.showAnchor(d.anchorEl)):d.hide())}),l.addListener("selectionchange",function(e,t){if(t){var n,i,o="",r="",a=l.selection.getRange().getClosedNode(),r=l.ui._dialogs;if(a&&"IMG"==a.tagName){t="insertimageDialog";if(-1==a.className.indexOf("edui-faked-video")&&-1==a.className.indexOf("edui-upload-video")||(t="insertvideoDialog"),-1!=a.className.indexOf("edui-faked-webapp")&&(t="webappDialog"),-1!=a.src.indexOf("http://api.map.baidu.com")&&(t="mapDialog"),-1!=a.className.indexOf("edui-faked-music")&&(t="musicDialog"),-1!=a.src.indexOf("http://maps.google.com/maps/api/staticmap")&&(t="gmapDialog"),a.getAttribute("anchorname")&&(t="anchorDialog",o=d.formatHtml("<nobr>"+l.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+l.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+l.getLang("delete")+"</span></nobr>")),a.getAttribute("word_img")&&(l.word_img=[a.getAttribute("word_img")],t="wordimageDialog"),(x.hasClass(a,"loadingclass")||x.hasClass(a,"loaderrorclass"))&&(t=""),!r[t])return;r="<nobr>"+l.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+l.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+l.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+l.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+l.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+t+'\');" class="edui-clickable">'+l.getLang("modify")+"</span></nobr>",o=o||d.formatHtml(r)}!l.ui._dialogs.linkDialog||(n=l.queryCommandValue("link"))&&(i=n.getAttribute("_href")||n.getAttribute("href",2))&&(30<(r=i).length&&(r=i.substring(0,20)+"..."),o&&(o+='<div style="height:5px;"></div>'),o+=d.formatHtml("<nobr>"+l.getLang("anthorMsg")+': <a target="_blank" href="'+i+'" title="'+i+'" >'+r+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+l.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+l.getLang("clear")+"</span></nobr>"),d.showAnchor(n)),o?(d.getDom("content").innerHTML=o,d.anchorEl=a||n,d.showAnchor(d.anchorEl)):d.hide()}}))},_initToolbars:function(){for(var n=this.editor,e=this.toolbars||[],t=[],i=0;i<e.length;i++){for(var o=e[i],r=new s.editor.ui.Toolbar({theme:n.options.theme}),a=0;a<o.length;a++){var l=o[a],d=null;if("string"==typeof l){if("|"==(l=l.toLowerCase())&&(l="Separator"),"||"==l&&(l="Breakline"),s.editor.ui[l]&&(d=new s.editor.ui[l](n)),"fullscreen"==l){t&&t[0]?t[0].items.splice(0,0,d):d&&r.items.splice(0,0,d);continue}}else d=l;d&&d.id&&r.add(d)}t[i]=r}c.each(UE._customizeUI,function(e,t){return(!e.id||e.id==n.key)&&void((t=e.execFn.call(n,n,t))&&(void 0===(e=e.index)&&(e=r.items.length),r.add(t,e)))}),this.toolbars=t},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div><div id="##_message_holder" class="%%-messageholder"></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},showWordImageDialog:function(){this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){for(var e=[],t=0;t<this.toolbars.length;t++)e.push(this.toolbars[t].renderHtml());return e.join("")},setFullScreen:function(e){var t,n,i=this.editor,o=i.container.parentNode.parentNode;if(this._fullscreen!=e){if(this._fullscreen=e,this.editor.fireEvent("beforefullscreenchange",e),s.editor.browser.gecko&&(t=i.selection.getRange().createBookmark()),e){for(;"BODY"!=o.tagName;){var a=s.editor.dom.domUtils.getComputedStyle(o,"position");d.push(a),o.style.position="static",o=o.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.autoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakEditorContaninerWidth=i.iframe.parentNode.offsetWidth,this._bakAutoHeight&&(i.autoHeightEnabled=!1,this.editor.disableAutoHeight()),document.documentElement.style.overflow="hidden",window.scrollTo(0,window.scrollY),this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,i.iframe.parentNode.style.width="",this._updateFullScreen()}else{for(;"BODY"!=o.tagName;)o.style.position=d.shift(),o=o.parentNode;this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&(i.autoHeightEnabled=!0,this.editor.enableAutoHeight()),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,i.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px",window.scrollTo(0,this._bakScrollTop)}r.gecko&&"true"===i.body.contentEditable&&(n=document.createElement("input"),document.body.appendChild(n),i.body.contentEditable=!1,setTimeout(function(){n.focus(),setTimeout(function(){i.body.contentEditable=!0,i.fireEvent("fullscreenchanged",e),i.selection.getRange().moveToBookmark(t).select(!0),s.editor.dom.domUtils.remove(n),e&&window.scroll(0,0)},0)},0)),"true"===i.body.contentEditable&&(this.editor.fireEvent("fullscreenchanged",e),this.triggerLayout())}},_updateFullScreen:function(){if(this._fullscreen){var e=t.getViewportRect();if(this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+e.width+"px;height:"+e.height+"px;z-index:"+(+this.getDom().style.zIndex+100),t.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0}),this.editor.setHeight(e.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0),!0),r.gecko)try{window.onresize()}catch(e){}}},_updateElementPath:function(){var e,t=this.getDom("elementpath");if(this.elementPathEnabled&&(e=this.editor.queryCommandValue("elementpath"))){for(var n,i=[],o=0;n=e[o];o++)i[o]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+o+'&quot;);">'+n+"</span>");t.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+i.join(" &gt; ")+"</div>"}else t.style.display="none"},disableElementPath:function(){var e=this.getDom("elementpath");e.innerHTML="",e.style.display="none",this.elementPathEnabled=!1},enableElementPath:function(){this.getDom("elementpath").style.display="",this.elementPathEnabled=!0,this._updateElementPath()},_scale:function(){function e(){h=x.getXY(s),p=p||a.options.minFrameHeight+d.offsetHeight+c.offsetHeight,f.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+s.offsetWidth+"px;height:"+s.offsetHeight+"px;z-index:"+(a.options.zIndex+1),x.on(o,"mousemove",t),x.on(l,"mouseup",n),x.on(o,"mouseup",n)}function t(e){i(),e=e||window.event,b=e.pageX||o.documentElement.scrollLeft+e.clientX,v=e.pageY||o.documentElement.scrollTop+e.clientY,y=b-h.x,C=v-h.y,g<=y&&(m=!0,f.style.width=y+"px"),p<=C&&(m=!0,f.style.height=C+"px")}function n(){m&&(m=!1,a.ui._actualFrameWidth=f.offsetWidth-2,s.style.width=a.ui._actualFrameWidth+"px",a.setHeight(f.offsetHeight-c.offsetHeight-d.offsetHeight-2,!0)),f&&(f.style.display="none"),i(),x.un(o,"mousemove",t),x.un(l,"mouseup",n),x.un(o,"mouseup",n)}function i(){r.ie?o.selection.clear():window.getSelection().removeAllRanges()}var o=document,a=this.editor,s=a.container,l=a.document,d=this.getDom("toolbarbox"),c=this.getDom("bottombar"),u=this.getDom("scale"),f=this.getDom("scalelayer"),m=!1,h=null,p=0,g=a.options.minFrameWidth,b=0,v=0,y=0,C=0,N=this;this.editor.addListener("fullscreenchanged",function(e,t){t?N.disableScale():N.editor.options.scaleEnabled&&(N.enableScale(),t=N.editor.document.createElement("span"),N.editor.body.appendChild(t),N.editor.body.style.height=Math.max(x.getXY(t).y,N.editor.iframe.offsetHeight-20)+"px",x.remove(t))}),this.enableScale=function(){1!=a.queryCommandState("source")&&(u.style.display="",this.scaleEnabled=!0,x.on(u,"mousedown",e))},this.disableScale=function(){u.style.display="none",this.scaleEnabled=!1,x.un(u,"mousedown",e)}},isFullScreen:function(){return this._fullscreen},postRender:function(){a.prototype.postRender.call(this);for(var e=0;e<this.toolbars.length;e++)this.toolbars[e].postRender();function t(){clearTimeout(n),n=setTimeout(function(){i._updateFullScreen()})}var n,i=this,o=s.editor.dom.domUtils;o.on(window,"resize",t),i.addListener("destroy",function(){o.un(window,"resize",t),clearTimeout(n)})},showToolbarMsg:function(e,t){this.getDom("toolbarmsg_label").innerHTML=e,this.getDom("toolbarmsg").style.display="",t||(this.getDom("upload_dialog").style.display="none")},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e?e.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var e=this.getDom();e.style.zoom="1"==e.style.zoom?"100%":"1"}},c.inherits(l,s.editor.ui.UIBase);var i={};UE.ui.Editor=function(e){var a=new UE.Editor(e);a.options.editor=a,c.loadFile(document,{href:a.options.themePath+a.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var s=a.render;return a.render=function(r){r.constructor===String&&(a.key=r,i[r]=a),c.domReady(function(){function e(){var e;a.setOpt({labelMap:a.options.labelMap||a.getLang("labelMap")}),new l(a.options),r&&(r.constructor===String&&(r=document.getElementById(r)),r&&r.getAttribute("name")&&(a.options.textarea=r.getAttribute("name")),r&&/script|textarea/gi.test(r.tagName))&&(e=document.createElement("div"),r.parentNode.insertBefore(e,r),n=r.value||r.innerHTML,a.options.initialContent=/^[\t\r\n ]*$/.test(n)?a.options.initialContent:n.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),r.className&&(e.className=r.className),r.style.cssText&&(e.style.cssText=r.style.cssText),/textarea/i.test(r.tagName)?(a.textarea=r,a.textarea.style.display="none"):r.parentNode.removeChild(r),r.id&&(e.id=r.id,x.removeAttributes(r,"id")),(r=e).innerHTML=""),x.addClass(r,"edui-"+a.options.theme),a.ui.render(r),e=a.options,a.container=a.ui.getDom();for(var t,n=x.findParents(r,!0),i=[],o=0;t=n[o];o++)i[o]=t.style.display,t.style.display="block";for(e.initialFrameWidth?e.minFrameWidth=e.initialFrameWidth:(e.minFrameWidth=e.initialFrameWidth=r.offsetWidth,o=r.style.width,/%$/.test(o)&&(e.initialFrameWidth=o)),e.initialFrameHeight?e.minFrameHeight=e.initialFrameHeight:e.initialFrameHeight=e.minFrameHeight=r.offsetHeight,o=0;t=n[o];o++)t.style.display=i[o];r.style.height&&(r.style.height=""),a.container.style.width=e.initialFrameWidth+(/%$/.test(e.initialFrameWidth)?"":"px"),a.container.style.zIndex=e.zIndex,s.call(a,a.ui.getDom("iframeholder")),a.fireEvent("afteruiready")}a.langIsReady?e():a.addListener("langReady",e)})},a},UE.getEditor=function(e,t){var n=i[e];return n||(n=i[e]=new UE.ui.Editor(t)).render(e),n},UE.delEditor=function(e){var t;(t=i[e])&&(t.key&&t.destroy(),delete i[e])},UE.registerUI=function(e,t,n,i){c.each(e.split(/\s+/),function(e){UE._customizeUI[e]={id:i,execFn:t,index:n}})}}(),UE.registerUI("message",function(e){function o(){var e=d.ui.getDom("toolbarbox");e&&(r.style.top=e.offsetHeight+3+"px"),r.style.zIndex=Math.max(d.options.zIndex,d.iframe.style.zIndex)+1}var r,a=s.editor.ui.Message,l=[],d=e;d.addListener("ready",function(){r=document.getElementById(d.ui.id+"_message_holder"),o(),setTimeout(function(){o()},500)}),d.addListener("showmessage",function(e,t){t=p.isString(t)?{content:t}:t;var n=new a({timeout:t.timeout,type:t.type,content:t.content,keepshow:t.keepshow,editor:d}),i=t.id||"msg_"+(+new Date).toString(36);return n.render(r),(l[i]=n).reset(t),o(),i}),d.addListener("updatemessage",function(e,t,n){n=p.isString(n)?{content:n}:n,(e=l[t]).render(r),e&&e.reset(n)}),d.addListener("hidemessage",function(e,t){t=l[t];t&&t.hide()})}),UE.registerUI("autosave",function(e){var t=null,n=null;e.on("afterautosave",function(){clearTimeout(t),t=setTimeout(function(){n&&e.trigger("hidemessage",n),n=e.trigger("showmessage",{content:e.getLang("autosave.success"),timeout:2e3})},2e3)})})}()</script><script>var uid=0,nickname="",avatar="/Public/Home/default/img/default_avatar.jpg",root_aid=3147,bid=56,aid=3211;$(function(){window.Umeditor=UE.getEditor("container",{serverUrl:"/ueditor-upload.html",initialFrameHeight:800,iframeCssUrl:""})})</script><script>$(function(){var o=[];treelib.util.show_loading(),treelib.util.init_left_menu("book_detail_size"),treelib.action.change_verify(),$(".left_menu_tree_data_list").jstree({core:{animation:150},types:{root:{icon:"book_index_tree_icon_root",valid_children:["default","folder","file"]},default:{icon:"jstree-folder"},folder:{icon:"jstree-folder"},file:{icon:"jstree-file"}},plugins:["types"]}).on("select_node.jstree",function(t,e){var i,n=$(".left_menu_tree_data_list").jstree(!0),a=n.get_selected();if(aid=a[0],!aid)return!1;n.get_node(aid);"root"!=e.node.type?(i="/Book-ajax_article_content-id-"+bid+"-aid-"+aid+".html",n.is_open(aid)?n.close_node(aid):n.open_node(aid)):i="/Book-ajax_article_content-id-"+bid+".html",o[i]?($(".right_book").html(o[i]),treelib.util.init_left_menu("book_detail_size")):$.get(i,function(t){o[i]=t,$(".right_book").html(t),treelib.util.init_left_menu("book_detail_size")},"html")}),window.onload=function(){$(".left_menu_tree_data_list").jstree(!0).select_node(aid,!1)};var a,e=$("#comments_container").html();$(document).on("click",".tab_selecte:eq(1)",function(){UE.getEditor("container").destroy(),window.Umeditor=UE.getEditor("container",{serverUrl:"/ueditor-upload.html",initialFrameHeight:600})}).on("click",".tab_selecte:eq(2)",function(){$.get("/Book-ajax_get_comments-id-"+bid+".html","",function(t){t.status&&$("#comments_container").html(e+t.data)},"json")}).on("click",".tab_selecte:eq(3)",function(){}).on("click",".pagination a",function(){var t=$(this).attr("href");return"#"==t||(-1==t.indexOf("ajax_get_comments")&&(t=t.replace(/ajax_article_content|detail/,"ajax_get_comments")),$.get(t,function(t){t.status&&$("#comments_container").html(e+t.data)},"json")),!1}).on("click",".comments .reply_btn",function(){a=$(document).scrollTop(),$(document).scrollTop(0);var t=$(this).data("rid"),e=$(this).data("rname");$(".write_comment p").text("回复---"+e).show().data("rid",t).data("rname",e)}).on("click",".write_comment .gbg",function(){var t,i=$(".write_comment textarea").val(),n=$(".write_comment p").data("rid");if(i.length<4)return treelib.util.lib_tips("输入内容太少!"),!1;t=0<n?{rid:n,rname:$(".write_comment p").data("rname"),content:i}:{bid:bid,content:i},$.post("/Book-save_comment.html",t,function(t){var e;1==t.status?(0<n?($(document).scrollTop(a),e='<div class="comment_container fr"><div class="comment_user_container fl"><img class="comment_avatar" src="'+avatar+'"><p>'+nickname+'</p></div><div class="comment_right_container fl"><p class="comment_right_top"><span>回复---'+$(".write_comment p").data("rname")+'  刚刚</span><span class="fr"><a class="reply_btn" data-rid="'+n+'" data-rname="'+nickname+'" href="javascript:void(0)">回复</a></span></p><p class="comment_detail_content">'+i+'</p></div><div class="clear"></div></div>',$("#comment_"+n+" .comment_right_container").first().after(e),$(".write_comment p").text("").hide().data("rid",null).data("rname",null),$(document).scrollTop(a)):(e='<div class="comment_container" id="comment_'+t.data+'"><div class="comment_user_container fl"><img class="comment_avatar" src="'+avatar+'"><p>'+nickname+'</p></div><div class="comment_right_container fl"><p class="comment_right_top"><span> 刚刚</span><span class="fr"><a class="reply_btn" data-rid="'+t.data+'" data-rname="'+nickname+'" href="javascript:void(0)">回复</a></span></p><p class="comment_detail_content">'+i+'</p></div><div class="clear"></div></div>',$(".comments").prepend(e)),$(".write_comment textarea").val("")):treelib.util.lib_tips(t.info)},"json")}).on("click",".contribute_submit_container .gbg",function(){var t=$(".contribute_submit_container").serialize();return $.post("/Book-save_contribute.html",t,function(t){t.status&&($('.contribute_submit_container input[type="text"]').val(""),UE.getEditor("container").setContent("")),treelib.util.lib_tips(t.info)},"json"),!1}).on("click",".tab_container .give_praise",function(){if(bid)return $.post("/Book-good_book.html",{bid:bid},function(t){var e,i=$(".tab_container .give_praise");2==t.status?(-1==(e=parseInt(i.text())-1)&&(e=0),i.html('<img src="/Public/Home/default/img/give_praise.png" >'+e),$(".tab_container .give_praise").attr("title","赞一个")):1==t.status&&(e=parseInt(i.text())+1,i.html('<img src="/Public/Home/default/img/give_praise.png" >'+e),$(".tab_container .give_praise").attr("title","取消赞 ")),treelib.util.lib_tips(t.info)},"json"),!1}).on("click",".tab_container .collect",function(){if(bid)return $.post("/Book-fav_book.html",{bid:bid},function(t){var e,i=$(".tab_container .collect");2==t.status?(-1==(e=parseInt(i.text())-1)&&(e=0),i.html('<img src="/Public/Home/default/img/collect.png" >'+e),$(".tab_container .collect").attr("title","收藏")):1==t.status&&(e=parseInt(i.text())+1,i.html('<img src="/Public/Home/default/img/collect.png" >'+e),$(".tab_container .collect").attr("title","取消收藏 ")),treelib.util.lib_tips(t.info)},"json"),!1}),$(".left_menu_search_keyword").keyup(function(t){var e=$(".left_menu_search_keyword").val();13==((t=t||event).which||t.keyCode)&&$.post("/Book-search_keyword.html",{keyword:e,bid:bid},function(t){if(t.status){if(null==t.data)var e="<p>共搜到结果0条</p><ul>";else for(var e="<p>共搜到结果"+t.data.length+"条</p><ul>",i=0;i<t.data.length;i++)e+='<li data-id="'+t.data[i].id+'">'+t.data[i].title+"</li>";e+="</ul>",$(".left_menu_search_keyword_result").html(e)}else treelib.util.lib_tips(t.info)},"json")}),$(document).on("click",".left_menu_search_keyword_result li",function(){var t=$(".left_menu_tree_data_list").jstree(!0),e=t.get_selected();if(e.length)for(var i=0;i<e.length;i++)$(".left_menu_tree_data_list").jstree(!0).deselect_node(e[i]);return t.select_node($(this).attr("data-id")),!1})})</script></body></html>